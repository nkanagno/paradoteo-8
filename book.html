<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Marisa Drexel" />
  <title>Microsoft Word - game_programming_lecture_note_2_2009.doc</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Microsoft Word -
game_programming_lecture_note_2_2009.doc</h1>
<p class="author">Marisa Drexel</p>
<p class="date">2009-09-08T17:26:21+00:00</p>
</header>
<p><img src="cover_image.jpg" /></p>
<p><span id="titlepage.xhtml"></span></p>
<div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="100%" height="100%" viewbox="0 0 1200 1600" preserveaspectratio="none">
<image width="1200" height="1600" xlink:href="cover_image.jpg"></image>
</svg>
</div>
<p><span id="index_split_000.html"></span></p>
<p><span id="index_split_000.html#p1"></span></p>
<p>Lecture #1</p>
<p>Basic Skills</p>
<p><span id="index_split_001.html"></span></p>
<h2 class="calibre2"
id="index_split_001.html#calibre_pb_0">Introduction</h2>
<p>The Game Industry is a multi-billion dollar industry and still
growing. Years ago, the technology forced games to have simple designs.
Programs could often be developed by a small team of pure hackers with
the major requirement being a good idea. Back then, formal training and
education was often looked down on. Now, it is almost essential.</p>
<p>Nowadays, games are so complex they require large teams of
programmers, designers, artists, testers, advertisers, and producers to
organize and develop them. Games are now as complex as, if not more
than, the latest blockbuster film. It is interactive entertainment, pure
and simple.</p>
<p>The tools and training needed for game development are enormous, and
the complexities warrant academic education beyond a single course. In
fact, an entire undergraduate curriculum could be (and in some places
is) based on game development.</p>
<p>This lecture note is designed to help students to learn fundamental
principles that apply to game programming regardless of the language
they use to create the game. These principles include gathering input
from users, processing game data, and rendering game objects to the
screen. This lecture shows you how to use JavaScript to program a simple
game. Anyway, <strong>game</strong> <strong>programming is a habit, a
skill, and an art.</strong></p>
<p>Important note</p>
<p>It is the instructor’s intention to use <strong>HTML</strong>,
<strong>JavaScript</strong>, <strong>DHTML</strong>, and
<strong>CSS</strong> to explain the game programming concepts. As an
art, game programming is independent of language, meaning you can choose
any language you feel comfortable to work with the write games in any
platform as long as you understand the concepts of game programming.
However, the instructor will also use other programming languages (such
as Java) to explain game programming skills whenever it is deemed
necessary.</p>
<p>Language is just a tool that facilitates the project you are working
on. The instructor chooses the following combination, so the students do
not need to install any language, SDKs (system development kit), or
IDEs. You can begin writing games simply using applications that come
with Windows XP/2000/2003.</p>
<p>Once you learn the concept of programming games, you can apply the
skills and knowledge to a platform-sensitive language (or scripting
language), such as Visual Basic, C++, C#, Java, and so on. Each
language, certainly, has its very own supports of game programming. You
just need to be familiar with these language-specific supports to
develop games using these platform-sensitive languages, because the
concepts you learn in this class are fundamental and universal to all
languages.</p>
<p>What is a</p>
<p>A satisfying game can be played over and over again and there are
different strategies that lead to game?</p>
<p>success. So what is a (computer) game then? Here is an old-fashion
definition:</p>
<p>"A computer game is a software program in which one or more players
make decisions through the control of game objects and</p>
<p>resources, in pursuit of a goal."</p>
<p>Note that the definition does not talk about multimedia supports,
such as graphics, or sound effect, or in-game movies. Multimedia
obviously plays a important role in making nice, appealing games, so a
newer definition is:</p>
<p>"A computer game is a game composed of a computer-controlled virtual
universe with multimedia supports that players may</p>
<p>Game Programming – Penn Wu</p>
<p>1</p>
<p><span id="index_split_001.html#p2"></span>interact with in order to
achieve a goal or set of goals."</p>
<p>Object-oriented Most game programming languages adopt the
object-oriented model, which is a programming programming</p>
<p>paradigm that uses “objects” to design game programs. The term
“object” refers to any identifiable item in a game. For example, in a
game that has a ball moving from the left to right, the
<strong>ball</strong> is an object.</p>
<p>An object has many <strong>properties</strong> (also known as
<strong>attributes</strong>) that determine the appearance of the
object, the place the object should be, and so on. For example, a ball
has size, color, file name, ID</p>
<p>(identification), etc.. Each is an individual property of the ball
object, but altogether they decide what and how the ball should be.</p>
<p>An object also has functions, such as start, stop, turn left, hide,
show, etc.. Many programming languages provide <strong>methods</strong>
(functions that are part of the programming language) for programmers to
use. The game programmer’s job is to associate appropriate methods with
the object, or “to build the use-defined functions into the
objects”.</p>
<p>When the player play games, he/she will have much action, such as
clicking a mouse button, pressing a key, etc.. These user actions are
known as <strong>events</strong>. Most languages provide
<strong>event</strong> <strong>handlers</strong> for game programmers to
respond to the events. For example, Although object-oriented programming
is a complicated program paradigm, you only need to learn two “magic”
formulas and some basic concepts. These two formulas have two forms:
JavaScript and DHTML forms. They will be used throughout the entire
class.</p>
<p>In JavaScript, they are:</p>
<p>objectID.propertyName = "value";</p>
<p>and</p>
<p>objectID.MethodName();</p>
<p>For example, the following code block use the &lt;img&gt; HTML tags
to load an image file <strong>cat.gif</strong>, which is certainly an
object, because you can see it (identify it) on the body area of the
browser once the HTML page is loaded.</p>
<p>&lt;html&gt;&lt;body&gt;</p>
<p>&lt;img id="m1" src="cat.gif"</p>
<p>onClick="m1.src='dog.gif'"&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>The following section assigns an ID (which is m1) to the image
file.</p>
<p>id="m1"</p>
<p>In the following section, <strong>src</strong> is the name of a
property (meaning the source). It uses the <strong>propertyName =
“value”</strong> format to assign cat.gif as the value of &lt;img&gt;
tag.</p>
<p>src="cat.gif"</p>
<p>The following section uses the entire <strong>objectID.propertyName =
"value";</strong> format to tell the computer “when the player click on
the image, change the value of the <strong>m1</strong> object’s
<strong>src</strong> property to <strong>dog.gif</strong>.</p>
<p>onClick=" <strong>m1.src='dog.gif'</strong> "</p>
<p>JavaScript</p>
<p>JavaScript is the premier client-side scripting language used today
on the Web. It’s widely used in Game Programming – Penn Wu</p>
<p>2</p>
<p><span id="index_split_001.html#p3"></span>Basics</p>
<p>tasks ranging from the validation of form data to the creation of
complex user interfaces. Yet the language has capabilities that many of
its users have yet to discover.</p>
<p>JavaScript can be used to manipulate the very markup in the documents
in which it is contained.</p>
<p>As more developers discover its true power, JavaScript is becoming a
first class client-side Web technology, ranking alongside (X)HTML, CSS,
and XML. As such, it will be a language that any Web designer would be
remiss not to master. This chapter serves as a brief introduction to the
language and how it is included in Web pages.</p>
<p>JavaScript is not Java language, and does have direct relation to
Java language. Java was developed and created by Sun Micro, while
JavaScript is solely developed and created by Netscape.</p>
<p>JavaScript code must be embedded into an HTML document using the
&lt;script&gt; and &lt;/script&gt; tags. The format:</p>
<p>&lt;script language="JavaScript"&gt;</p>
<p>JavaScript code fragments</p>
<p>&lt;/script&gt;</p>
<p>In object oriented languages, object variables are called
"properties" and object functions are called "methods." For example,</p>
<p>&lt;html&gt;&lt;script language=JavaScript&gt;</p>
<p>window.alert("This is a warning message")</p>
<p>&lt;/script&gt;&lt;/html&gt;</p>
<p>The alert() method of the window (the browser window) object displays
a warning message on the Web page.</p>
<p>JavaScript use the following syntax:</p>
<p>• <strong>objectID.method()</strong>: for example, window.prompt().
The prompt method of the window object creates a pop-up prompt box.</p>
<p>• <strong>objectID.property</strong>: for example, navigator.appName.
Identify the appName property of the navigator object.</p>
<p>• <strong>object.method(object.property)</strong>: for example,
document.write(navigator.appName).</p>
<p>This displays the value of the appName property on the Web page.</p>
<p>When a web page is loaded, the browser's JavaScript interpreter
automatically creates objects for most of the components contained in
the document. This includes -- but is not limited to -- objects for the
document's forms, images, and hyperlinks. According to Netscape, the
developers of JavaScript, every page has the following objects:</p>
<p>• <strong>navigator</strong>: has properties for the name and version
of the Navigator being used, for the MIME</p>
<p>types supported by the client, and for the plug-ins installed on the
client.</p>
<p>• <strong>window</strong>: the top-level object; has properties that
apply to the entire window. There is also a window object for each
"child window" in a frames document.</p>
<p>• <strong>document</strong>: contains properties based on the content
of the document, such as title, background color, links, and forms.</p>
<p>• <strong>location</strong>: has properties based on the current
URL.</p>
<p>• <strong>history</strong>: contains properties representing URLs the
client has previously requested.</p>
<p>Other built-in JavaScript Objects include:</p>
<p>• <strong>Array</strong>: an Array object is used to store a set of
values in a single variable name.</p>
<p>• <strong>Date</strong>: The Date object is used to work with dates
and times.</p>
<p>• <strong>String</strong>: The String object is used to work with
text.</p>
<p>• <strong>Math</strong>: The built-in Math object includes
mathematical constants and functions.</p>
<p>For example,</p>
<p>Game Programming – Penn Wu</p>
<p>3</p>
<p><span id="index_split_001.html#p4"></span></p>
<p>&lt;script language="JavaScript"&gt;</p>
<p>document. <strong>write</strong>(document.
<strong>lastModified</strong>);</p>
<p>&lt;/script&gt;</p>
<p>Declaring</p>
<p>When a car runs, the speed changes all the time. The meter does the
reading of speed, and it gives variables</p>
<p>you different values every time when the speed changes. Consider the
following table: time</p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>15</p>
<p>16</p>
<p>17</p>
<p>18</p>
<p>19</p>
<p>20</p>
<p>speed</p>
<p>65</p>
<p>68</p>
<p>67</p>
<p>66</p>
<p>65</p>
<p>67</p>
<p>68</p>
<p>69</p>
<p>70</p>
<p>71</p>
<p>70</p>
<p>68</p>
<p>67</p>
<p>68</p>
<p>67</p>
<p>66</p>
<p>65</p>
<p>64</p>
<p>66</p>
<p>64</p>
<p>During the last 20 minutes, the value of speed varies up and down.
The value is never constant; it varies, so it is a variable.</p>
<p>In the world of game programming, when a programmer needs to handle a
property with its value changing all the time, he/she creates (or
declare) a “variable”. Variables hold the value when the users enter
them. Variables hold the values till the computer notify them to stop
holding them.</p>
<p>You can think of variables as "holding places" where values are
stored and retrieved. Each holding place has a unique name, which is any
combination of letters and numbers that does not begin with a number. In
JavaScript, the characters a-z, A-Z, and the underscore character "_"
are all considered to be unique letters.</p>
<p>JavaScript was loosely designed, so it does not require you to state
the kind of data type that will be associated with a variable. The
syntax JavaScript use to declare a variable is: var VariableName</p>
<p>The “var” keyword is not strictly required</p>
<p>For example,</p>
<p>var mileage = 10987; // number</p>
<p>var CompanyName = "Orange Inc. "; // string</p>
<p>var Readable = "true" // logical / boolean</p>
<p>var score;</p>
<p>var style = null;</p>
<p>Any kind of data type can be stored in any variable. Common types of
values include:</p>
<p>•</p>
<p>Numbers — any number, (ex. 5 or 3.14567)</p>
<p>•</p>
<p>Strings or Text — any strings enclosed in double quotation marks,
(ex. “$12.34”, “Hello!”)</p>
<p>•</p>
<p>Logical (Boolean) — either true or false</p>
<p>•</p>
<p>null — a special value that refers to nothing</p>
<p>Basic rules:</p>
<p>•</p>
<p>Case Sensitive Very important... JavaScript is case sensitive, which
means, upper case letters and lower case letters are interpreted as
being different. For example, the variables “apple”</p>
<p>and “Apple”, “ApPle”, “APPLE” are considered four individual variable
names.</p>
<p>•</p>
<p>Do not use the following words as variable names:</p>
<p>abstract delete</p>
<p>goto</p>
<p>null</p>
<p>this</p>
<p>boolean</p>
<p>do</p>
<p>if</p>
<p>package</p>
<p>throw</p>
<p>break</p>
<p>double</p>
<p>implements private</p>
<p>throws</p>
<p>byte</p>
<p>else</p>
<p>import</p>
<p>protected</p>
<p>transient</p>
<p>case</p>
<p>extends</p>
<p>in</p>
<p>public</p>
<p>true</p>
<p>catch</p>
<p>false</p>
<p>instanceof return</p>
<p>try</p>
<p>char</p>
<p>final</p>
<p>int</p>
<p>short</p>
<p>typeof</p>
<p>class</p>
<p>finally</p>
<p>interface</p>
<p>static</p>
<p>var</p>
<p>const</p>
<p>float</p>
<p>long</p>
<p>super</p>
<p>void</p>
<p>continue for</p>
<p>native</p>
<p>switch</p>
<p>while</p>
<p>default</p>
<p>function new</p>
<p>synchronized with</p>
<p>Game Programming – Penn Wu</p>
<p>4</p>
<p><span id="index_split_001.html#p5"></span></p>
<p>• Do not use such symbols as 8 ^ $@+() {}[]\|~!?/`”’:; as part of
variable name.</p>
<p>In the following example, “current_time” is the name of variable that
represents a certain registers on the computer memory (DRAMs). This
variable holds the readings of data and time, and set the readings ready
for the user to use.</p>
<p>With var keyword</p>
<p>Without var keyword</p>
<p>&lt;html&gt;&lt;script&gt;</p>
<p>&lt;html&gt;&lt;script&gt;</p>
<p>function st() {</p>
<p>function st() {</p>
<p><strong>var</strong> current_time=new Date()</p>
<p>current_time=new Date()</p>
<p>alert(current_time);</p>
<p>alert(current_time);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;button</p>
<p>&lt;button</p>
<p>onClick=st()&gt;Click&lt;/button&gt;</p>
<p>onClick=st()&gt;Click&lt;/button&gt;</p>
<p>&lt;html&gt;</p>
<p>&lt;html&gt;</p>
<p>The user clicks the button to call the st() function, and the st()
function in turns force the alert() method to display the most current
readings on a warning message box.</p>
<p>Create user-</p>
<p>When creating games, you need to use computer statements to instruct
the computer what to do.</p>
<p>defined</p>
<p>Each statement is considered an individual instruction. However, it
is very inconvenient to give functions</p>
<p>out instruction one by one, because the computer responds to each
instruction one by one.</p>
<p>Now, try another approach. Pack all the statements together into a
batch, and then name the batch with a uniquely identifiable ID. You can
then execute all the statements packed in that batch by simply calling
the ID. In JavaScript, such batch is known as a user-defined
function.</p>
<p>A JavaScript function is a collection of instructions (i.e.,
statements or commands) whose purpose is to accomplish a well-defined
task, based on the implementation of existing JavaScript objects,
methods, and properties. When the browser executes a function, it is
very similar to a VCR</p>
<p>executes the pre-programmed action. In JavaScript, a function's input
is called its parameters; its output is called the return value. There
are two types of functions: built-in functions and custom functions:
built-In and custom functions.</p>
<p>In JavaScript, the keyword “function” creates a custom function. A
function is defined inside the</p>
<p>&lt;SCRIPT&gt; and &lt;/SCRIPT&gt; tags; it consists of the keyword
function, followed by the following things:</p>
<p>• A name for the function;</p>
<p>• A list of arguments for the function (enclosed in parentheses and
separated by commas); and</p>
<p>• JavaScript statements defining the function (enclosed in curly
braces { } ).</p>
<p>The syntax:</p>
<p>function functionName(arguments) {</p>
<p>JavaScript statements</p>
<p>}</p>
<p>Additionally, once a function has been defined, it must be called in
order to execute it. For example, a JavaScript function whose purpose is
to compute the square of a number might be defined as follows:</p>
<p>&lt;html&gt;&lt;script&gt;</p>
<p>function sqr(n) {</p>
<p>document.write(n*n);</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>5</p>
<p><span id="index_split_001.html#p6"></span>&lt;/script&gt;</p>
<p>&lt;input type=text name=t1 onClick=sqr(t1.value)&gt;</p>
<p>&lt;/html&gt;</p>
<p>In this "sqr" function, sqr(n), the parenthesized variable "n" is
called a parameter. It represents the input entered to the text box. The
output is equal to number squared. Most of all, the user must click the
text box to execute the sqr() function.</p>
<p>CSS basics</p>
<p>Cascading Style Sheets (CSS) is a way to control the appearance and
dynamics of objects in a HTML document. It allows you to convert static
HTML objects into motion-enabled objects in an organized and efficient
manner.</p>
<p>You can use any existing HTML tag that formats objects in the
browser’s body area as a</p>
<p>“selector” by following the syntax:</p>
<p>selector { PropertyName <em>1</em>:value <em>1</em>; PropertyName
<em>2</em>:value <em>2</em>……}</p>
<p>For example, the pair of &lt;i&gt; and &lt;/i&gt; are HTML tags that
italicizes contents in between them.</p>
<p>However, it cannot specify color and font size. Compare the following
codes and their outputs.</p>
<p>Without CSS</p>
<p>With CSS</p>
<p>&lt;html&gt;&lt;body&gt;</p>
<p>&lt;html&gt;</p>
<p>&lt;i&gt;This is a sentence.&lt;/i&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p><strong>&lt;style&gt;</strong></p>
<p>i {color: red; font-size:24px}</p>
<p><strong>&lt;/style&gt;</strong></p>
<p>&lt;/head&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;i&gt;This is a sentence.&lt;/i&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p><em>This is a sentence.</em></p>
<p><em>This is a sentence.</em></p>
<p>Notice that you must define your CSS property sets in between
&lt;style&gt; and &lt;/style&gt;. And you are supposed to place your CSS
definitions between &lt;head&gt; and &lt;/head&gt;. Never place them
between</p>
<p>&lt;body&gt; and &lt;/body&gt;.</p>
<p>Pseudo-classes are also used in CSS to add different effects to some
selectors, or to a part of some selectors. When you want one tag but
different styles. In a web page you want different type style for
different paragraph. Pseudo Class can be defined in embedded style or an
external style.</p>
<p>The syntax for setting the style is:</p>
<p>.classID {property: value}</p>
<p>The syntax for calling the style is:</p>
<p>&lt;selector class="classID"&gt;...&lt;/selector&gt;</p>
<p>Consider the following example,</p>
<p>&lt;html&gt;&lt;style&gt;</p>
<p>.p1 {color:red;font-family:arial}</p>
<p>.p2 {color:green;font-family:times new roman}</p>
<p>&lt;/style&gt;</p>
<p>&lt;p class=p1&gt;This is red.&lt;/p&gt;</p>
<p>&lt;p class=p2&gt;This is green.&lt;/p&gt;</p>
<p>&lt;/html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>6</p>
<p><span id="index_split_001.html#p7"></span></p>
<p>There are two pseudo classes: p1 and p2. They are pseudo because they
are not an existing HTML</p>
<p>tag (like &lt;p&gt; tag). Now that they are pseudo classes to “p”,
they will automatically inherit the functions the &lt;p&gt; tag
has—creating a paragraph. The p1 class, however, is assigned two
styles:</p>
<p>{color:red;font-family:arial}</p>
<p>The p2 class is assigned two styles:</p>
<p>{color:green;font-family:times new roman}</p>
<p>To call the two classes, use</p>
<p>&lt;p class=p1&gt;..&lt;/p&gt;</p>
<p>and</p>
<p>&lt;p class=p2&gt;..&lt;/p&gt;.</p>
<p>Integrate CSS</p>
<p>In most cases, CSS properties are converted to JavaScript properties
by removing the data from with JavaScript the CSS property name and
capitalizing any words following the dash. For example, the CSS</p>
<p>property <strong>background-color</strong> becomes
<strong>backgroundColor</strong> in JavaScript.</p>
<p>&lt;html&gt;</p>
<p>&lt;u id=u1
onClick=u1.style.visibility="hidden"&gt;Hi!&lt;/u&gt;&lt;br&gt; This is
the line 2.</p>
<p>&lt;/html&gt;</p>
<p>In addition to identify each style, the keyword “this” is a good
alternative.</p>
<p>&lt;html&gt;</p>
<p>&lt;u onClick=this.style.display="none"&gt;Hi!&lt;/u&gt;&lt;br&gt;
This is the line 2.</p>
<p>&lt;/html&gt;</p>
<p>With new Internet Explorer, even the following works!</p>
<p>&lt;html&gt;</p>
<p>&lt;u onClick=style.display="none"&gt;Hi!&lt;/u&gt;&lt;br&gt; This is
the line 2.</p>
<p>&lt;/html&gt;</p>
<p>When click the word “Hi!”, the first line disappears, but the line
remains.</p>
<p>DHTML basics DHTML is Dynamic HyperText Markup Language. As the name
conveys, 'dynamic' is something that changes at any given time, but the
fact is that, every detail has to be pre-coded. DHTML is a combination
of HTML, CSS and JavaScript. DHTML is a feature of Netscape Communicator
4.0</p>
<p>and Microsoft Internet Explorer 4.0 and 5.0 and is entirely a
"client-side" technology.</p>
<p>Many features of DHTML can be duplicated with either Flash or Java,
DHTML provides an alternative that does not require plug-ins and embeds
seamlessly into a web page.</p>
<p>DHTML is useful for creating an advanced functionality web page. It
can be used to create animations, games, applications, provide new ways
of navigating through web sites, and create out-of-this world layout
that simply aren't possible with just HTML.</p>
<p>The underlying technologies of DHTML (HTML,CSS, JavaScript) are
standardized, the manner in which Netscape and Microsoft have
implemented them differ dramatically. For this reason, writing DHTML
pages that work in both browsers can be a very complex issue.</p>
<p>Game Programming – Penn Wu</p>
<p>7</p>
<p><span id="index_split_001.html#p8"></span><img src="index-8_1.png"
class="calibre5" alt="Image 1" /></p>
<p>A simply definition of DHTML is: Dynamic HTML is simply HTML that can
change even after a page has been loaded into a browser.</p>
<p>DHTML consist of:</p>
<p>•</p>
<p>DOM (Document Object Model): Core of DHTML</p>
<p>•</p>
<p>CSS: Style provider of DHTML</p>
<p>•</p>
<p>Scripting Language: JavaScript (or Jscript) as function provider of
DHTML</p>
<p>To sum all this up: CSS and "old HTML" are what you change, the DOM
is what makes it changeable, and client-side scripting is what actually
changes it. And that's dynamic HTML.</p>
<p>Additionally, Netscape and Internet Explorer use fundamentally
different approaches to create DHTML pages. For example, Netscape use
the &lt;layer&gt; tag to display a Web page inside a Web page, while
Internet Explorer uses &lt;iframe&gt; to do so. It is the intention of
this lecture to focus on Internet Explorer.</p>
<p>Consider the following DHTML code example,</p>
<p>&lt;html&gt;</p>
<p>&lt;u style="cursor:hand" onClick=alert("Hi!")&gt;Click&lt;/u&gt;</p>
<p>&lt;/html&gt;</p>
<p>This code is a combination of HTML, CSS, and JavaScript. &lt;html&gt;
and &lt;u&gt; are generic HTML</p>
<p>tags; style="cursor:hand" is a CSS style definition; onClick is a
JavaScript event handler and alert("Hi!") is a JavaScript method.</p>
<p>Consider the document.body.clientWidth and document.body.clientHeight
properties, and you will understand why DHTML can be used to create
games.</p>
<p>DHTML can be used to position objects based on the location and
measurement of other objects.</p>
<p>The clientWidth and clientHeight properties retrieve the width of the
object. The offsetWidth and offsetHeight properties retrieve the width
and height of the object relative to the layout or coordinate parent, as
specified by the offsetParent property.</p>
<p>Consider the following example,</p>
<p>&lt;html&gt;&lt;script&gt;</p>
<p>function cc() {</p>
<p>alert(document.body.clientWidth+"x"+document.body.clientHeight)</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;button onClick=cc()&gt;Click&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>When the user click the button, a warning message pops up telling the
user width and height of the currently opened window, as shown
below:</p>
<p>In the following example, we will force the screen size to change
when the user click the button.</p>
<p>&lt;html&gt;&lt;script&gt;</p>
<p>function shrinkIt() {</p>
<p>Game Programming – Penn Wu</p>
<p>8</p>
<p><span id="index_split_001.html#p9"></span><img src="index-9_1.png"
class="calibre5" alt="Image 2" /></p>
<p>x=document.body.clientWidth-100;</p>
<p>y=document.body.clientHeight-100;</p>
<p>window.resizeTo (x,y)</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;button onClick=shrinkIt()&gt;Click&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>First of all, we declare a variable x and assignment the value
document.body.clientWidth-100, which means “detect the current window
width and subtract 100 from it.” Second, we declare the y variable and
assign the value of y=document.body.clientHeight-100 to it, which means
“detect the current window height and subtract 100 from it.” Finally, we
use the resizeTo() method to change the size of window.</p>
<p>In the following example, the Web page (document) is the parent
object, the overflow area is the offset object. When the user click the
button, a warning message of “184:200” appears.</p>
<p>&lt;html&gt;</p>
<p>&lt;p id=dt STYLE="overflow:scroll; width:200; height:100"&gt;Add a
long paragraph here.....&lt;/p&gt;</p>
<p>&lt;button</p>
<p>onclick=alert(dt.clientWidth+":"+dt.offsetWidth)&gt;Click&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>DHTML is “dynamics”, so you can use innerText, outerText, innerHTML,
and outerHTML</p>
<p>properties to dynamically inserting texts or codes.</p>
<p>The syntax is:</p>
<p>objectID.innerText="strings"; <strong></strong></p>
<p>objectID.innerHTML="strings";</p>
<p>objectID.outerText="strings";</p>
<p>objectID.outerHTML="strings";</p>
<p>The innerText property sets or retrieves the text between the start
and end tags of the object. It is valid for block elements only. By
definition, elements that do not have both an opening and closing tag
cannot have an innerText property. When the innerText property is set,
the given string completely replaces the existing content of the
object.</p>
<p>For example,</p>
<p>&lt;html&gt;You can order &lt;b id=dt&gt;Pizza&lt;/b&gt;
here.&lt;br&gt;</p>
<p>&lt;button onclick="dt.innerText='Hamburg'"&gt;
Hamburg&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>Click the “Hamburg” button to replace the word “Pizza” with
“Hamburg”.</p>
<p>Consider this example,</p>
<p>&lt;P onMouseOver="bt.innerHTML='&lt;b&gt;bold&lt;/b&gt;'"</p>
<p>onMouseOut="bt.innerHTML='&lt;i&gt;italic&lt;/i&gt;'"&gt; It's &lt;i
id=bt&gt;italic&lt;/i&gt; now.</p>
<p>&lt;/P&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>9</p>
<p><span id="index_split_001.html#p10"></span>The inserted string will
be formatted by the HTML tag. Also, test the following code to view the
differences.</p>
<p>&lt;div id=dt&gt;&lt;b&gt;Dynamic HTML!&lt;/b&gt;&lt;/div&gt;</p>
<p>&lt;script&gt;</p>
<p>alert("innerText: "+dt.innerText)</p>
<p>alert("innerHTML: "+dt.innerHTML)</p>
<p>alert("outerText: "+dt.outerText)</p>
<p>alert("outerHTML: "+dt.outerHTML)</p>
<p>&lt;/script&gt;</p>
<p>However, the output of innerText and outerText look the same.</p>
<p>Using</p>
<p>CSS styles can integrate with JavaScript using DHTML format. One of
the beauties of using JavaScript</p>
<p>JavaScript is its capability to pack several commands into one
function. It is important to learn Functions in</p>
<p>how to use JavaScript function in DHTML.</p>
<p>DHTML</p>
<p>Consider the following example,</p>
<p>&lt;html&gt;&lt;script language=JavaScript&gt;</p>
<p>function moving() {</p>
<p>dt.style.left="250"; dt.style.top="200";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;p id=dt style="position:absolute;left:25;top:50"&gt;This is a
sentence.&lt;/p&gt;</p>
<p>&lt;button onClick=moving()&gt;Click&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>The sentence was originally display at the position (25, 50). When
the user click the button, the onClick event handler calls the moving()
JavaScript function, which in turn moves the sentence to (250, 200).</p>
<p>Consider another example,</p>
<p>&lt;html&gt;&lt;script language="JavaScript"&gt;</p>
<p>function coloring() {</p>
<p>dt.style.color="blue"; dt.style.backgroundColor="yellow";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;p id=dt style="color:red;background-color:blue"</p>
<p>onClick=coloring()&gt;This is a sentence.&lt;/p&gt;</p>
<p>&lt;/html&gt;</p>
<p>When the user clicks any place on the sentence, the onClick event
handler calls the coloring() function, so the colors changes.</p>
<p>Consider the third example,</p>
<p>&lt;html&gt;</p>
<p>&lt;img src="http://www.geocities.com/cistcom/bs.jpg"</p>
<p>style="width:100"</p>
<p>onClick="this.style.width='200'"&gt;</p>
<p>&lt;/html&gt;</p>
<p>We can use JavaScript function to add more options of image size.</p>
<p>&lt;html&gt;</p>
<p>&lt;script language=JavaScript&gt;</p>
<p>function size1() {img1.style.width="200"}</p>
<p>Game Programming – Penn Wu</p>
<p>10</p>
<p><span id="index_split_001.html#p11"></span>function size2()
{img1.style.width="300"}</p>
<p>function size3() {img1.style.width="400"}</p>
<p>&lt;/script&gt;</p>
<p>&lt;img id=img1 src=http://www.geocities.com/cistcom/bs.jpg</p>
<p>style="width:100"&gt;</p>
<p>&lt;button onClick=size1()&gt;Size 1&lt;/button&gt;</p>
<p>&lt;button onClick=size2()&gt;Size 2&lt;/button&gt;</p>
<p>&lt;button onClick=size3()&gt;Size 3&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>Game</p>
<p>This tutorial should have give n you a rough idea of the things that
matter when trying to create a programming</p>
<p>good computer game. But in the end the best way to learn is to do it
yourself. Although game is just the</p>
<p>programming may sound a big project to you at the current stage, it
really is not that far from matter doing it! what you have learned in
any programming course. It takes only a new way of thinking, and most of
all, a willingness to try. Game programming is just the matter doing
it!</p>
<p>There are few simple games created by the instructor as
demonstrations. It is time to try them. Do not worry if you don’t
understand the code. Details will be described in later lectures. For
now, just have fun!</p>
<p>Review</p>
<p>1. In a game that has a pitcher who pitches a baseball to a baseball
hitter, and a catcher who Questions</p>
<p>attempts to catch the baseball. Which is an object?</p>
<p>A. pitcher</p>
<p>B. hitter</p>
<p>C. baseball</p>
<p>D. all of the above.</p>
<p>2. Given a statement "A red baseball moves from left to right". Which
is the property of the baseball?</p>
<p>A. left to right</p>
<p>B. red</p>
<p>C. move</p>
<p>D. the word "baseball"</p>
<p>3. Given the following code, which is the property of the image
file?</p>
<p>&lt;img id="m1" src="cat.gif"&gt;</p>
<p>A. img</p>
<p>B. src</p>
<p>C. cat.gif</p>
<p>D. m1</p>
<p>4. Given the following code, which is the event handler?</p>
<p>&lt;img id="m1" src="cat.gif" onClick='this.src='dog.gif'"&gt; A.
id</p>
<p>B. src</p>
<p>C. onClick</p>
<p>D. img</p>
<p>5. Given the following code, which is the method?</p>
<p>window.alert("Welcome!")</p>
<p>A. window</p>
<p>B. alert()</p>
<p>Game Programming – Penn Wu</p>
<p>11</p>
<p><span id="index_split_001.html#p12"></span>C. Welcome!</p>
<p>D. All of the above</p>
<p>6. Given the following code segment, which is a boolean variable?</p>
<p>var selected = "true";</p>
<p>var Saturday = "Yes";</p>
<p>var vitamine = "good";</p>
<p>var monitor = "white";</p>
<p>A. selected</p>
<p>B. Saturday</p>
<p>C. vitamine</p>
<p>D. monitor</p>
<p>7. Given the following code segment, which is a user-defined
function?</p>
<p>function sqr(n) {</p>
<p>document.write(n*n);</p>
<p>window.alert(n+1);</p>
<p>n++;</p>
<p>}</p>
<p>A. sqr();</p>
<p>B. document.write()</p>
<p>C. window.alert()</p>
<p>D. n++</p>
<p>8. Given the following CSS code segment, which is a property?</p>
<p>&lt;style&gt; p {border: solid 1 black;}&lt;/style&gt;</p>
<p>A. &lt;style&gt;</p>
<p>B. p</p>
<p>C. border</p>
<p>D. solid 1 black</p>
<p>9. Given the following CSS code segment, which is a class?</p>
<p>&lt;style&gt;</p>
<p>p1 {border: solid 1 black;}</p>
<p>p2 {border: solid 1 blue;}</p>
<p>p3 {border: solid 1 red;}</p>
<p>.p4 {border: solid 1 blue;}</p>
<p>&lt;/style&gt;</p>
<p>A. p1</p>
<p>B. p2</p>
<p>C. p3</p>
<p>D. .p4</p>
<p>10. Given the following code, which statement is correct?</p>
<p>&lt;html&gt;&lt;script language="JavaScript"&gt;</p>
<p>function coloring() {</p>
<p>dt.style.color="blue"; dt.style.backgroundColor="yellow";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;p id=dt style="color:red;background-color:blue"</p>
<p>Game Programming – Penn Wu</p>
<p>12</p>
<p><span id="index_split_001.html#p13"></span>onClick=coloring()&gt;This
is a sentence.&lt;/p&gt;</p>
<p>&lt;/html&gt;</p>
<p>A. the onClick event handler calls the coloring() function.</p>
<p>B. when the coloring() function executes, the dt object turns
blue.</p>
<p>C. when the coloring() function executes, the dt object's background
color turns yellow.</p>
<p>D. All of the above</p>
<p>Game Programming – Penn Wu</p>
<p>13</p>
<p><span id="index_split_001.html#p14"></span><img src="index-14_1.png"
class="calibre5" alt="Image 3" /></p>
<p><strong></strong></p>
<p>Lab #1</p>
<p><span id="index_split_002.html"></span></p>
<h2 class="calibre2" id="index_split_002.html#calibre_pb_1">Introduction
to Game Programming</h2>
<p><strong></strong></p>
<p><strong>Preparation #1: Download image files</strong></p>
<p>1. Create a new directory named <strong>C:\lab1</strong>.</p>
<p>2. Use Internet Exploer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab1.zip (a zipped) file. Extract the files to C:\lab1
directory. Make sure the C:\lab1 directory contains:</p>
<p>•</p>
<p>ani_cat.gif</p>
<p>•</p>
<p>ball.gif</p>
<p>•</p>
<p>bat.gif</p>
<p>•</p>
<p>gopher1.gif</p>
<p>•</p>
<p>gopher2.gif</p>
<p><strong>Preparation #2:</strong> Sign up a free Web Hosting
Service</p>
<p>1. Use Internet Explorer to go to
<strong>http://www.geocities.com</strong> or
<strong>http://www.tripod.com</strong> to sign up a free web hosting
service. Be sure to learn to upload files and view your uploaded files
through the web.</p>
<p><strong>Learning Activity #1: A dropping letter</strong></p>
<p><strong></strong></p>
<p>Note: Do not worry if you don’t understand the code. Details will be
described in later lectures. For now, just have fun!</p>
<p><strong></strong></p>
<p>1. Change to the C:\lab1 directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\lab1\lab1_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>if (obj.style.pixelTop &gt;=
<strong>document.body.clientHeight</strong>) {</p>
<p>obj.style.pixelTop = 0; }</p>
<p>else {obj.style.pixelTop++; }</p>
<p>s1 = setTimeout("init()", 10);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;p id="obj" style="position:absolute; top:0"&gt;o&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer (do no use other browser) to execute the
file. <strong>Be sure to have your speaker or earphone</strong>
<strong>ready</strong> to hear the sound!</p>
<p>4. If the “Dig you notice the Information Bar?” warning box appears,
as shown below, click OK.</p>
<p>5. If the default information bar remains, right click the bar, and
then select “Allow Blocked Content…”, as shown below.</p>
<p>Game Programming – Penn Wu</p>
<p>14</p>
<p><span id="index_split_002.html#p15"></span><img src="index-15_1.png"
class="calibre5" alt="Image 4" /></p>
<p><img src="index-15_2.png" class="calibre5" alt="Image 5" /></p>
<p><img src="index-15_3.png" class="calibre5" alt="Image 6" /></p>
<p>6. You should now see a letter o dropping from top to bottom over and
over again.</p>
<p><strong></strong></p>
<p><strong></strong></p>
<p><strong></strong></p>
<p><strong>Learning Activity #2: Using animated Gif file as visual
effects</strong></p>
<p><strong></strong></p>
<p>Note: Do not worry if you don’t understand the code. Details will be
described in later lectures. For now, just have fun!</p>
<p><strong></strong></p>
<p>1. Change to the C:\lab1 directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\lab1\lab1_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;body onLoad=run()&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0;</p>
<p>function run() {</p>
<p><strong>document.body.clientWidth</strong> represents the current
browser width m1.style.left=i;</p>
<p>i+=5;</p>
<p>if (i&gt;=<strong>document.body.clientWidth</strong> -
m1.style.pixelWidth) {i=0;}</p>
<p>setTimeout("run()",70);</p>
<p>}</p>
<p><strong>m1.style.pixelWidth</strong> is the width of ant_cat.gif</p>
<p>&lt;/script&gt;</p>
<p>&lt;img id="m1" src="ani_cat.gif"</p>
<p>style="position:absolute;top:10;left:0"&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. The output now looks:
The cat will run across the screen.</p>
<p>Game Programming – Penn Wu</p>
<p>15</p>
<p><span id="index_split_002.html#p16"></span><img src="index-16_1.png"
class="calibre5" alt="Image 7" /></p>
<p><strong></strong></p>
<p><strong>Learning Activity #3: Effects of distance</strong></p>
<p><strong></strong></p>
<p>Note: Do not worry if you don’t understand the code. Details will be
described in later lectures. For now, just have fun!</p>
<p><strong></strong></p>
<p>1. Change to the C:\lab1 directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\lab1\lab1_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>m1.style.width = m1.style.pixelWidth + 10;</p>
<p>if (m1.style.pixelWidth &lt; 400) {</p>
<p>setTimeout("cc()", 50);</p>
<p>}</p>
<p>else {dd(); }</p>
<p>}</p>
<p>function dd() {</p>
<p>m1.style.width = m1.style.pixelWidth - 10;</p>
<p>if (m1.style.pixelWidth &gt; 10) {</p>
<p>setTimeout("dd()", 50);</p>
<p>}</p>
<p>else {cc(); }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;center&gt;&lt;img id=m1 src="bat.gif"
style="width:10"&gt;&lt;/center&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. The bat will fly toward
you and then backward.</p>
<p><strong>Learning Activity #4: Your First Game</strong></p>
<p>Note: Do not worry if you don’t understand the code. Details will be
described in later lectures. For now, just have fun!</p>
<p>1. Change to the C:\lab1 directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\lab1\lab1_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>Game Programming – Penn Wu</p>
<p>16</p>
<p><span id="index_split_002.html#p17"></span><img src="index-17_1.png"
class="calibre5" alt="Image 8" /></p>
<p>ball.style.pixelLeft=Math.floor(Math.random()*250);</p>
<p>ball.style.display="inline";</p>
<p>fall();</p>
<p>}</p>
<p>function fall() {</p>
<p>if (ball.style.pixelTop&gt;275) {ball.style.pixelTop=0;}</p>
<p>else { ball.style.pixelTop+=5;}</p>
<p>if (ball.style.pixelLeft&gt;=375) {ball.style.pixelLeft=0;}</p>
<p>else { ball.style.pixelLeft+=Math.floor(Math.random()*5);}</p>
<p>if (ball.style.pixelLeft+15&lt;=bar.style.pixelLeft+50 &amp;&amp;
ball.style.pixelLeft&gt;=bar.style.pixelLeft &amp;&amp;</p>
<p>ball.style.pixelTop&gt;=bar.style.pixelTop)</p>
<p>{ clearTimeout(s1); ball.style.display="none";}</p>
<p>else { s1=setTimeout("fall()",30);}</p>
<p>}</p>
<p>function move() {</p>
<p>var e=event.keyCode;</p>
<p>switch (e) {</p>
<p>case 37:</p>
<p>if(bar.style.pixelLeft &lt;= 0) {bar.style.pixelLeft = 0;}</p>
<p>else { bar.style.pixelLeft -= 5;}</p>
<p>break;</p>
<p>case 39:</p>
<p>if(bar.style.pixelLeft+50 &gt;= 400) {bar.style.pixelLeft = 350;}</p>
<p>else { bar.style.pixelLeft += 5;}</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()" onKeyDown="move()"&gt;</p>
<p>&lt;div style="position:absolute; width:400; height:300;
background-color:green; border:solid 2 red; top:10; left:10"&gt;</p>
<p>&lt;img id="ball" src="ball.gif" style="position:absolute;
display:none; width:15"&gt;</p>
<p>&lt;span id="bar" style="background-color:white; width:50;height:20;
position:absolute; top:277;left:165; border-bottom:solid 2
red"&gt;&lt;/span&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. To play the game, use
Left (←) and Right(→) arrow keys to move the bar. A sample output
looks:</p>
<p>Game Programming – Penn Wu</p>
<p>17</p>
<p><span id="index_split_002.html#p18"></span><strong>Learning Activity
#5: Random gophers</strong></p>
<p>Note: Do not worry if you don’t understand the code. Details will be
described in later lectures. For now, just have fun!</p>
<p>1. Change to the C:\lab1 directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\lab1\lab1_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img {position:absolute;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function gplace() {</p>
<p>g1.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-50));
g1.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-50));
g2.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-50));
g2.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-50));
g3.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-50));
g3.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-50)); gjump();</p>
<p>}</p>
<p>function gjump() {</p>
<p>var i = Math.floor(Math.random()*3)+1;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>g1.src="gopher2.gif";g2.src="gopher1.gif";g3.src="gopher1.gif";
break;</p>
<p>case 2:</p>
<p>g2.src="gopher2.gif";g1.src="gopher1.gif";g3.src="gopher1.gif";
break;</p>
<p>case 3:</p>
<p>g3.src="gopher2.gif";g1.src="gopher1.gif";g2.src="gopher1.gif";
break;</p>
<p>}</p>
<p>setTimeout("gplace()", 800);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="gplace()"&gt;</p>
<p>&lt;img src="gopher1.gif" id="g1"&gt;</p>
<p>&lt;img src="gopher1.gif" id="g2"&gt;</p>
<p>&lt;img src="gopher1.gif" id="g3"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. Each gopher will
stretch its head out of the hole randomly.</p>
<p>Game Programming – Penn Wu</p>
<p>18</p>
<p><span id="index_split_002.html#p19"></span><img src="index-19_1.png"
class="calibre5" alt="Image 9" /></p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload the following files to your remote web site (e.g.
Geocities.com)</p>
<p>•</p>
<p>ani_cat.gif</p>
<p>•</p>
<p>ball.gif</p>
<p>•</p>
<p>bat.gif</p>
<p>•</p>
<p>gopher1.gif</p>
<p>•</p>
<p>gopher2.gif</p>
<p>•</p>
<p>lab1_1.htm</p>
<p>•</p>
<p>lab1_2.htm</p>
<p>•</p>
<p>lab1_3.htm</p>
<p>•</p>
<p>lab1_4.htm</p>
<p>•</p>
<p>lab1_5.htm</p>
<p>2. Test your program remotely through the web. Make sure they
function correctly.</p>
<p>3. Log in to Blackboard, launch Assignment 01, and then scroll down
to question 11.</p>
<p>4. Copy and paste the URLs to your games to the textbox, such as:</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab1_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab1_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab1_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab1_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab1_5.htm</p>
<p>Note: No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>19</p>
<p><span id="index_split_002.html#p20"></span></p>
<p>Lecture #2</p>
<p>Sprite Programming - Game graphics</p>
<p><span id="index_split_003.html"></span></p>
<h2 class="calibre2"
id="index_split_003.html#calibre_pb_2">Introduction</h2>
<p>The term “graphics” refers to any computer device or program that
makes a computer capable of displaying and manipulating pictures.
Graphics images are used extensively in games. You are surrounded with
graphics as a matter of fact.</p>
<p>Before jumping into the details of how graphics work and how they are
applied to games, it's important to establish some ground rules and gain
an understanding of how computer graphics work in general. More
specifically, you need to have a solid grasp on what a graphics
coordinate system is, as well as how color is represented in computer
graphics.</p>
<p>The Graphics</p>
<p>All graphical computing systems use some sort of graphics coordinate
system to specify how Coordinate</p>
<p>points are arranged in a window or on the screen. Graphics coordinate
systems typically spell out System</p>
<p>the origin (0,0) of the system, as well as the axes and directions of
increasing value for each of the axes. If you're not a big math person,
this simply means that a coordinate system describes how to pinpoint any
location on the screen as an X-Y value. The traditional mathematical
coordinate system familiar to most of us is shown below:</p>
<p><em>y</em> axis</p>
<p><em>x</em> axis</p>
<p>(0, 0)</p>
<p>The Basics of</p>
<p>Before this lecture can move on and use some sample code to explain
the graphic programming Color</p>
<p>concepts, you need to have some background in computer and web color
theory.</p>
<p>The main function of color in a computer system is to accurately
reflect the physical nature of color within the confines of a computer,
which requires a computer color system to mix colors with accurate,
predictable results.</p>
<p>A color monitor has three electron guns: red, green, and blue, and
they are called the three color elements. The output from these three
guns converges on each pixel on the screen, exciting phosphors to
produce the appropriate color. The combined intensities of each gun
determine the resulting pixel color.</p>
<p>Technically speaking, Windows colors are represented by the
combination of the numeric intensities of the primary colors (red,
green, and blue). This color system is known as RGB (Red Green Blue) and
is standard across most graphical computer systems.</p>
<p>The following table shows the numeric values for the red, green, and
blue components of some basic colors. Notice that the intensities of
each color component range from 0 to 255 in value.</p>
<p>Table: Numeric RGB Color Component Values for Commonly Used Colors
<strong>Color</strong></p>
<p><strong>Red</strong></p>
<p><strong>Green</strong></p>
<p><strong>Blue</strong></p>
<p>White</p>
<p>255</p>
<p>255</p>
<p>255</p>
<p>Black</p>
<p>0</p>
<p>0</p>
<p>0</p>
<p>Light Gray</p>
<p>192</p>
<p>192</p>
<p>192</p>
<p>Dark Gray</p>
<p>128</p>
<p>128</p>
<p>128</p>
<p>Red</p>
<p>255</p>
<p>0</p>
<p>0</p>
<p>Game Programming – Penn Wu</p>
<p>20</p>
<p><span id="index_split_003.html#p21"></span><img src="index-21_1.png"
class="calibre5" alt="Image 10" /></p>
<p>Green</p>
<p>0</p>
<p>255</p>
<p>0</p>
<p>Blue</p>
<p>0</p>
<p>0</p>
<p>255</p>
<p>Yellow</p>
<p>255</p>
<p>255</p>
<p>0</p>
<p>Purple</p>
<p>255</p>
<p>0</p>
<p>255</p>
<p>For example,</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {width:20; height:70; border:solid 1 <strong>black</strong>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;span id="bar1" style="background-color:
<strong>red</strong>"&gt;&lt;/span&gt;</p>
<p>&lt;span id="bar2" style="background-color:
<strong>green</strong>"&gt;&lt;/span&gt;</p>
<p>&lt;span id="bar2" style="background-color:
<strong>blue</strong>"&gt;&lt;/span&gt;</p>
<p>&lt;/html&gt;</p>
<p>and the output looks:</p>
<p>Notice that the above colors are represented by using decimal values.
In CSS and DHTML, colors can be also defined as a hexadecimal notation
for the combination of Red, Green, and Blue color values (RGB). The
lowest value that can be given to one light source is 0 (hex #00) and
the highest value is 255 (hex #FF). For example,</p>
<p>Color</p>
<p>Color HEX</p>
<p>Color RGB</p>
<p>Black</p>
<p>#000000</p>
<p>rgb(0,0,0)</p>
<p>Red</p>
<p>#FF0000</p>
<p>rgb(255,0,0)</p>
<p>Lime</p>
<p>#00FF00</p>
<p>rgb(0,255,0)</p>
<p>Blue</p>
<p>#0000FF</p>
<p>rgb(0,0,255)</p>
<p>Yellow</p>
<p>#FFFF00</p>
<p>rgb(255,255,0)</p>
<p>Aqua</p>
<p>#00FFFF</p>
<p>rgb(0,255,255)</p>
<p>Purple</p>
<p>#FF00FF</p>
<p>rgb(255,0,255)</p>
<p>White</p>
<p>#FFFFFF</p>
<p>rgb(255,255,255)</p>
<p>Consider the following code, it uses a both hexadecimal and decimal
color values to specify color schemes.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {width:20; height:70; border:solid 1
<strong>rgb(0,0,0)</strong>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;span id="bar1" style="background-color:
<strong>rgb(255,0,0)</strong>"&gt;&lt;/span&gt;</p>
<p>&lt;span id="bar2" style="background-color:
<strong>#00FF00</strong>"&gt;&lt;/span&gt;</p>
<p>&lt;span id="bar2" style="background-color:
<strong>#0000FF</strong>"&gt;&lt;/span&gt;</p>
<p>&lt;/html&gt;</p>
<p>The output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>21</p>
<p><span id="index_split_003.html#p22"></span><img src="index-22_1.png"
class="calibre5" alt="Image 11" /></p>
<p>Some years ago, when most computers only supported
<strong>256</strong> different colors, a list of <strong>216</strong>
Web Safe Colors was suggested as a Web standard. The reason for this was
that the Microsoft and Mac operating system used 40 different "reserved"
fixed system colors (about 20 each).</p>
<p>We are not sure how important this is now, since most computers today
have the ability to display millions of different colors, but the choice
is left to you. The 216 cross-browser color palette was created to
ensure that all computers would display the colors correctly when
running a 256 color palette.</p>
<p>Sprite</p>
<p>A sprite is a general term for a graphic that can be moved
independently around the screen to programming</p>
<p>produce animated effects. Many sprites are programmed by the game
programmer and are created after the game starts, so they are also known
as movable object blocks. This type of sprites is actually a code blocks
that is temporarily stored in memory and is transferred to the
screen.</p>
<p>Given the following text arts (also known as ASCII arts), each is an
individual character-formed graphic simulating a stage of a human’s
dancing motion.</p>
<p>O</p>
<p>O</p>
<p>O</p>
<p>O</p>
<p>.|-.'</p>
<p>..|--,</p>
<p>`.|-</p>
<p>-.|--'</p>
<p>/ =</p>
<p>` =</p>
<p>= \.</p>
<p>` =</p>
<p>| \</p>
<p>/ |</p>
<p>/ \</p>
<p>/ \</p>
<p>/. \.</p>
<p>/. /.</p>
<p>/. |.</p>
<p>|. \.</p>
<p>By displaying one of them at a time in a sequence and then repeat the
sequence over and over again, you can create a sprite of dancing man. In
the following code, each ASCII art is placed in between &lt;pre&gt; and
&lt;/pre&gt;. The HTML &lt;pre&gt; tag defines preformatted text. The
text enclosed in the pre element usually preserves spaces and line
breaks. The text renders in a fixed-pitch font.</p>
<p>&lt;body onLoad=init()&gt;</p>
<p><strong>&lt;pre id="h1" style="display:none"&gt;</strong> O</p>
<p>.|-.'</p>
<p>/ =</p>
<p>| \</p>
<p>/. \.</p>
<p>&lt;/pre&gt;</p>
<p><strong>&lt;pre id="h2" style="display:none"&gt;</strong> O</p>
<p>..|--,</p>
<p>` =</p>
<p>/ |</p>
<p>/. /.</p>
<p>&lt;/pre&gt;</p>
<p><strong>&lt;pre id="h3" style="display:none"&gt;</strong> Ò.|-</p>
<p>= \.</p>
<p>/ \</p>
<p>/. |.</p>
<p>&lt;/pre&gt;</p>
<p><strong>&lt;pre id="h4" style="display:none"&gt;</strong> O</p>
<p>Game Programming – Penn Wu</p>
<p>22</p>
<p><span id="index_split_003.html#p23"></span>-.|--'</p>
<p>` =</p>
<p>/ \</p>
<p>|. \.</p>
<p>&lt;/pre&gt;</p>
<p>&lt;/body&gt;</p>
<p>Each &lt;pre&gt; tag is assigned an ID--h1, h2, h3, h4, so they can
be easily identified. They are also configured by
<strong>display:none</strong>, so they will not be displayed by
default.</p>
<p>In order to dynamically control the sprite, you can add the following
JavaScript code with DHTML support.</p>
<p>&lt;script&gt;</p>
<p>var i=1;</p>
<p>function init() {</p>
<p>if (i&gt;4) { i=1; }</p>
<p>else {</p>
<p>clear();</p>
<p>switch (i) {</p>
<p>case 1: h1.style.display='inline'; break;</p>
<p>case 2: h2.style.display='inline'; break;</p>
<p>case 3: h3.style.display='inline'; break;</p>
<p>case 4: h4.style.display='inline'; break;</p>
<p>}</p>
<p>i++;</p>
<p>}</p>
<p>s1 = setTimeout("init()", 100);</p>
<p>}</p>
<p>function clear() {</p>
<p>h1.style.display='none';</p>
<p>h2.style.display='none';</p>
<p>h3.style.display='none';</p>
<p>h4.style.display='none';</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>The <strong>init()</strong> function uses i++ to continuously adding
1 to the value of <em>i</em>. The following line forces the computer to
set the maximum to 4. Literally it means “if the value of <em>i</em> is
greater than 4, the value of <em>i</em> must return to 1”.</p>
<p>if (i&gt;4) { i=1; }</p>
<p>The following code block forces the computer to apply codes based on
the value of <em>i</em>. For example, when <em>i</em> = 3, on the codes
for case 3 are executed, the rest are ignored.</p>
<p>switch (i) {</p>
<p>case 1: h1.style.display='inline'; break;</p>
<p>case 2: h2.style.display='inline'; break;</p>
<p>case 3: h3.style.display='inline'; break;</p>
<p>case 4: h4.style.display='inline'; break;</p>
<p>}</p>
<p>The <strong>setTimeout()</strong> method forces the computer to
execute the init() function every 100</p>
<p>milliseconds.</p>
<p>The <strong>clear()</strong> function sets each ASCII art to be
hidden again (display=’none’). This function clears the background, so
you will not see double-, triple-, or multiple-images.</p>
<p>Game Programming – Penn Wu</p>
<p>23</p>
<p><span id="index_split_003.html#p24"></span><img src="index-24_1.png"
class="calibre5" alt="Image 12" /></p>
<p>A sample output looks:</p>
<p>Some sprites are pre-created animated .gif files. This kind of
sprites is rectangular graphic created by combining multiple GIF images
in one file. In other words, they are a batch of images, displayed one
after another to give the appearance of movement.</p>
<p>Although graphics design is not a topic of this course, Appendix A
provides a short lecture on how you can create animated GIF files.</p>
<p>Create</p>
<p>New game programmers usually relate this “term” to a pre-designed
software-produced graphics, graphics</p>
<p>but tend to forget the fact that many computer languages are also
capable of producing graphics programmatica</p>
<p>programmatically.</p>
<p>lly</p>
<p>Consider the following code, it uses CSS (cascade style sheet) to
specify how an area defined by</p>
<p>&lt;span&gt;…&lt;/span&gt; in a code division (defined by
&lt;div&gt;…&lt;/div&gt;) should look in a Web browser’s body area.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>embedded CSS style sheet</p>
<p>.wKey {</p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;div&gt;</p>
<p>&lt;!-- white keys --&gt;</p>
<p>&lt;span <strong>class="wKey"</strong> id="midC"&gt;&lt;/span&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/html&gt;</p>
<p>CSS uses &lt;style&gt;…&lt;/style&gt; to embed a style sheet onto an
HTML code. In this example, wKey is the name of style, which contains
the following attributes and their associated values in the format of
<em>atttributeName</em> : <em>value</em>.</p>
<p>•</p>
<p><strong>background-color : white</strong>. This set of attribute and
value simply defines the background of the object using this style as
<em>white</em>.</p>
<p>•</p>
<p><strong>border-top : solid 1 #cdcdcd</strong>. This sets the top
border to be a solid line with size of 1px and color value of #cdcdcd
(in the RGB format). This color combination produces the color of light
gray.</p>
<p>•</p>
<p><strong>height : 150px</strong>. This sets the height of the object
to be 150px.</p>
<p>•</p>
<p><strong>width : 40px</strong>. This sets the height of the object to
be 40px.</p>
<p>Game Programming – Penn Wu</p>
<p>24</p>
<p><span id="index_split_003.html#p25"></span><img src="index-25_1.png"
class="calibre5" alt="Image 13" /></p>
<p><img src="index-25_2.png" class="calibre5" alt="Image 14" /></p>
<p>The following line associates an object with ID <strong>midC</strong>
with the <strong>wKey</strong> style, such that all the styles wKey has
will apply to this midC object.</p>
<p>&lt;span <strong>class="wKey"</strong> id="midC"&gt;&lt;/span&gt; The
output of this code looks:</p>
<p>In order to add two more objects that are clones of the midC object,
simply add the following two lines. Just be sure to assign new IDs for
each of the two new objects!</p>
<p>&lt;span class="wKey" id="midC" style="left:50"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" <strong>id="midD"</strong>
style="left:91"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" <strong>id="midF"</strong>
style="left:132"&gt;&lt;/span&gt; The output now looks:</p>
<p>Take a close look at these three objects, they are placed closely
together, there’s no space between any consecutive ones. In order to
dynamically place each object on the web browser’s body area, you need
to use absolute positioning system. You do so by adding the following
bold line:</p>
<p>.wKey {</p>
<p><strong>position:absolute;</strong></p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>DHTML, with CSS, use two pre-defined variables -- <em>left</em> and
<em>top</em> -- to represent <em>x</em>- and <em>y</em>-</p>
<p>coordinate of the browser’s body area. In fact, most graphics in a
Windows program are drawn to the client area of a window, which uses the
Windows graphics coordinate system.</p>
<p>The following figures explains how the coordinates of the client area
begin in the upper-left Game Programming – Penn Wu</p>
<p>25</p>
<p><span id="index_split_003.html#p26"></span><img src="index-26_1.png"
class="calibre5" alt="Image 15" /></p>
<p><img src="index-26_2.png" class="calibre5" alt="Image 16" /></p>
<p><img src="index-26_3.png" class="calibre5" alt="Image 17" /></p>
<p>corner of the window and increase down and to the right, as you
learned earlier in the hour. This coordinate system is very important
because most GDI graphics operations are based on them.</p>
<p>Consequently, by adding the following bold line, all the three
objects’ y-coordinate are set to be 20px, which means they all are 20px
below the <em>x</em>-axis.</p>
<p>.wKey {</p>
<p>position:absolute;</p>
<p><strong>top:20;</strong></p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>The output now looks weird. There are 3 objects, supposedly, but only
one is displayed. What’s wrong?</p>
<p>The answer is, the absolute positioning system uses both
<em>left</em> and <em>top</em> to specify a given object of absolute
position. All the three objects’ <em>top</em> values are defined as 20px
in the above code segment.</p>
<p>It’s time to assign each object’s <em>left</em> value
individually.</p>
<p>&lt;span class="wKey" id="midC" <strong>style="left:50"</strong>
&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midD" <strong>style="left:91"</strong>
&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midE" <strong>style="left:132"</strong>
&gt;&lt;/span&gt; The above uses a technique known as <strong>inline
style</strong>, which means to add a style to the HTML tag as an
attribute of the tag. The syntax is:</p>
<p>style = "attributeName1:Value1;attributeName2:Value2;...;</p>
<p>attributeName <em>n</em>:Value <em>n</em>"</p>
<p>Game Programming – Penn Wu</p>
<p>26</p>
<p><span id="index_split_003.html#p27"></span><img src="index-27_1.png"
class="calibre5" alt="Image 18" /></p>
<p>The midC object is now assigned an initial point (20, 50), midD (20,
91), and midE (20, 132). The distance between 50 and 91 is 41. In this
code example, 41 is determined because each object is 40px wide (as
specified by width:40px), plus 1px as the space between two objects.</p>
<p>50 + 40 + 1 = 91</p>
<p>90 + 40 + 1 = 132</p>
<p>Take a good look at the output. There is a visible space between
every two objects.</p>
<p>(20, 91)</p>
<p>(20, 50)</p>
<p>(20, 132)</p>
<p>To make the above graphics looks like a section of piano keyboard,
add the following bold lines:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.wKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>A new CSS style</p>
<p><strong>.bKey {</strong></p>
<p><strong>position:absolute;</strong></p>
<p><strong>top:20;</strong></p>
<p><strong>background-color:black;</strong></p>
<p><strong>border:solid 1 white;</strong></p>
<p><strong>height:70px;</strong></p>
<p><strong>width:36px</strong></p>
<p><strong>}</strong></p>
<p>&lt;/style&gt;</p>
<p>&lt;div&gt;</p>
<p>&lt;!-- white keys --&gt;</p>
<p>&lt;span class="wKey" id="midC" style="left:50"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midD" style="left:91"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midE" style="left:132"&gt;&lt;/span&gt;</p>
<p><strong>&lt;!-- black keys --&gt;</strong></p>
<p><strong>&lt;span class="bKey" id="cSharp"
style="left:72"&gt;&lt;/span&gt;</strong> Game Programming – Penn Wu</p>
<p>27</p>
<p><span id="index_split_003.html#p28"></span><img src="index-28_1.png"
class="calibre5" alt="Image 19" /></p>
<p><strong>&lt;span class="bKey" id="dSharp"
style="left:114"&gt;&lt;/span&gt;</strong></p>
<p>&lt;/div&gt;</p>
<p>&lt;/html&gt;</p>
<p>The first added code segment defines a new CSS style named
<strong>bKey</strong>, which specifies how a black key should look. The
second simply adds two black keys in the division ( as defined by
&lt;div&gt; …</p>
<p>&lt;/div&gt;). Each black key has a unique ID.</p>
<p>The output now looks (Surprisingly, you create a graphic using DHTML
codes!): Creating</p>
<p>To add animated effects to the above graphics, you need to write
<strong>user-defined functions</strong>. Such animated</p>
<p>functions can perform visual effects. For example, you can add visual
effects to the keys, so they graphics</p>
<p>will have an effect of key-down-key-up.</p>
<p>programmatica</p>
<p>lly</p>
<p>Consider the following added bold codes:</p>
<p>&lt;span class="wKey" id="midC" style="left:50"
<strong>onMouseOver="CDown()"</strong></p>
<p><strong>onMouseOut="CUp()"</strong> &gt;&lt;/span&gt;</p>
<p>It uses two <strong>event handlers:</strong> <em>onMouseOver</em>
<strong></strong> and <em>onMouseOut</em> to call two different
user-defined functions: <em>CDown</em>() and <em>Cup</em>(). Such
programming techniques will be discussed in a later lecture.</p>
<p>For now, you just have to know what they are.</p>
<p>Two functions are created by adding the following lines to the HTML
file:</p>
<p>&lt;script&gt;</p>
<p>&lt;!-- for middle C --&gt;</p>
<p>function CDown() {</p>
<p>midC.style.borderTop="solid 1 black";</p>
<p>midC.style.borderLeft="solid 1 black";</p>
<p>midC.style.borderBottom="solid 1 black";</p>
<p>midC.style.borderRight="solid 1 #cdcdcd";</p>
<p>}</p>
<p>function CUp() {</p>
<p>midC.style.borderTop="solid 1 #cdcdcd";</p>
<p>midC.style.borderLeft="solid 1 #cdcdcd";</p>
<p>midC.style.borderBottom="solid 4 #cdcdcd";</p>
<p>midC.style.borderRight="solid 1 black";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>These two user-defined functions, CDown() and Cup(), are combinations
of DHTML statements.</p>
<p>The syntax is (notice that <strong>style</strong> is a keyword):</p>
<p>objectID. <strong>style</strong>.AttributeNme = "Value";</p>
<p>In CDown(), the first line changes the top border of the
<strong>midC</strong> object to “solid 1 black”, the second changes the
left border, the third changes the bottom border, and the fourth changes
the right border to “solid 1 #cdcdcd”.</p>
<p>Game Programming – Penn Wu</p>
<p>28</p>
<p><span id="index_split_003.html#p29"></span>Compare CDown() and CUp()
carefully and you will find out their color values in the reversed order
to each other. Also, be sure to know that the color values of CUp() are
exactly the same as those defined in wKey style.</p>
<p>function CDown() {</p>
<p>midC.style.borderTop="solid 1 <strong>black</strong>";</p>
<p>midC.style.borderLeft="solid 1 <strong>black</strong>";</p>
<p>midC.style.borderBottom="solid 1 <strong>black</strong>";</p>
<p>midC.style.borderRight="solid 1 <strong>#cdcdcd</strong>";</p>
<p>}</p>
<p>function CUp() {</p>
<p>midC.style.borderTop="solid 1 <strong>#cdcdcd</strong>";</p>
<p>midC.style.borderLeft="solid 1 <strong>#cdcdcd</strong>";</p>
<p>midC.style.borderBottom="solid 4 <strong>#cdcdcd</strong>";</p>
<p>midC.style.borderRight="solid 1 <strong>black</strong>";</p>
<p>}</p>
<p>By executing these two functions, the color of midC’s top border
changes from #cdcdcd to black, and then back to #cdcdcd. This creates an
effect of key-down-key-up. A complete code is available in the learning
activity, please learning this technique for your own good.</p>
<p>The advantage of creating graphic programmatically is that you can
easily apply dynamic functions to the graphics.</p>
<p>Adding visual</p>
<p>A technique called <strong>alpha</strong> is greatly used today to
create visual. Alpha is a value representing a effects to</p>
<p>pixel’s degree of transparency. The more transparent a pixel, the
less it hides the background graphics</p>
<p>against which the image is presented. In PNG, alpha is really the
degree of opacity: zero alpha programmatica</p>
<p>represents a completely transparent pixel, maximum alpha represents a
completely opaque pixel.</p>
<p>lly</p>
<p>But most people refer to alpha as providing transparency information,
not opacity information.</p>
<p>Many other techniques are available as explained in the following
table, which contains commonly used DHTML effects. The syntax of using
filter is:</p>
<p>filter:effectName(parameter)</p>
<p>Table: Common filter effects:</p>
<p>Effects</p>
<p>Description</p>
<p>Example</p>
<p>alpha()</p>
<p>Set a transparency level</p>
<p>{filter:alpha(opacity=2)}</p>
<p>blur()</p>
<p>Creates the impression of moving at {filter:blur(strength=5)}</p>
<p>high speed</p>
<p>chroma()</p>
<p>Makes a specific color transparent</p>
<p>{filter:chroma(color=#008855)}</p>
<p>dropshadow() Creates an offset solid silhouette</p>
<p>{filter:dropshadow(color=#0066cc)}</p>
<p>fliph</p>
<p>Creates a horizontal mirror image</p>
<p>{filter:fliph()}</p>
<p>flipv()</p>
<p>Creates a vertical mirror image</p>
<p>{filter:flipv()}</p>
<p>glow()</p>
<p>Adds radiance around the outside</p>
<p>{filter:glow(color=#ccffdd)}</p>
<p>edges of the object</p>
<p>grayscale()</p>
<p>Drops color information from the</p>
<p>image</p>
<p>invert()</p>
<p>Reverses the hue, saturation, and</p>
<p>{filter:invert()}</p>
<p>brightness values</p>
<p>light()</p>
<p>Project light sources onto an object</p>
<p>mask()</p>
<p>Creates a transparent mask from an</p>
<p>object</p>
<p>shadow()</p>
<p>Creates a solid silhouette of the</p>
<p>{filter:shadow(direction=10)}</p>
<p>object</p>
<p>wave()</p>
<p>Create a sine wave distortion along</p>
<p>the x- and y-axis</p>
<p>Game Programming – Penn Wu</p>
<p>29</p>
<p><span id="index_split_003.html#p30"></span><img src="index-30_1.png"
class="calibre5" alt="Image 20" /></p>
<p>the x- and y-axis</p>
<p>xray()</p>
<p>Shows just the edges of the object</p>
<p>{filter:xray()}</p>
<p>For example, you can use some of these functions to create visual
effects of texts.</p>
<p>&lt;html&gt;&lt;head&gt;&lt;style&gt;</p>
<p>font {font-family:arial;font-size:24px;width:100%;}</p>
<p>&lt;/style&gt;&lt;/head&gt;&lt;body&gt;</p>
<p>&lt;font style="filter:glow()"&gt;Glow&lt;/font&gt;</p>
<p>&lt;font style="filter:blur()"&gt;Blur&lt;/font&gt;</p>
<p>&lt;font style="filter:fliph()"&gt;Flip Horontally&lt;/font&gt;</p>
<p>&lt;font style="filter:flipv()"&gt;Flip Vertically&lt;/font&gt;</p>
<p>&lt;font style="filter:shadow()"&gt;Shadow&lt;/font&gt;</p>
<p>&lt;font style="filter:dropshadow()"&gt;Drop Shadow&lt;/font&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>The output looks:</p>
<p>On the other hand, some of them apply to images and graphics, too.
Consider the following example, it demonstrates how the original images
are displayed using some of these functions:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img {width:100}</p>
<p>&lt;/style&gt;</p>
<p>&lt;table&gt;</p>
<p>&lt;tr&gt;&lt;td&gt;Original&lt;/td&gt;&lt;td&gt;Alpha:&lt;/td&gt;&lt;td&gt;Gray:&lt;/td&gt;</p>
<p>&lt;td&gt;Invert:&lt;/td&gt;&lt;td&gt;Xray:&lt;/td&gt;&lt;/tr&gt;</p>
<p>&lt;tr&gt;&lt;td&gt;</p>
<p>&lt;img src="fujiwara.jpg"&gt;</p>
<p>&lt;/td&gt;&lt;td&gt;</p>
<p>&lt;img src="fujiwara.jpg" style="filter:alpha(Opacity=20)"&gt;</p>
<p>&lt;/td&gt;&lt;td&gt;</p>
<p>&lt;img src="fujiwara.jpg" style="filter:gray()"&gt;</p>
<p>&lt;/td&gt;&lt;td&gt;</p>
<p>&lt;img src="fujiwara.jpg" style="filter:invert()"&gt;</p>
<p>&lt;/td&gt;&lt;td&gt;</p>
<p>&lt;img src="fujiwara.jpg" style="filter:xray()"&gt;</p>
<p>&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</p>
<p>&lt;/html&gt;</p>
<p>The output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>30</p>
<p><span id="index_split_003.html#p31"></span><img src="index-31_1.png"
class="calibre5" alt="Image 21" /></p>
<p>Review</p>
<p>1. Which is the color combination of "red"?</p>
<p>Questions</p>
<p>A. #0000FF</p>
<p>B. rgb(255,255,0)</p>
<p>C. #00FF00</p>
<p>D. rgb(255,0,0)</p>
<p>2. Given the following code segment, what background color will the
object have?</p>
<p>style="background-color: #00FF00"</p>
<p>A. red</p>
<p>B. green</p>
<p>C. blue</p>
<p>D. yellow</p>
<p>3. Given the following code segment, which is the closet name of the
color?</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>A. lime</p>
<p>B. grey</p>
<p>C. orange</p>
<p>D. pink</p>
<p>4. Given the following code segment, which statement is correct?</p>
<p>&lt;script&gt;</p>
<p>img { width:35; height:40}</p>
<p>&lt;/script&gt;</p>
<p>A. the image height is set to be 40 centimeters</p>
<p>B. the image width is set to be 35 pixels</p>
<p>C. the image height is set to be 40 dot-per-inch</p>
<p>D. the image width is set to be 35 inches</p>
<p>5. Given the following code segment, which is the correct coordinate
combination of the object</p>
<p>"dot"?</p>
<p>dot.style.right=50;</p>
<p>dot.style.left=200;</p>
<p>dot.style.top=150;</p>
<p>dot.style.b0ttom=100;</p>
<p>Game Programming – Penn Wu</p>
<p>31</p>
<p><span id="index_split_003.html#p32"></span>A. (50, 200)</p>
<p>B. (50, 150)</p>
<p>C. (200, 150)</p>
<p>D. (150, 100)</p>
<p>6. Which is the correct way to create a glow effect?</p>
<p>A. &lt;span style="filter:glow()"&gt;Glow&lt;/span&gt; B. &lt;span
style="glow()"&gt;Glow&lt;/span&gt;</p>
<p>C. &lt;span style="filter:glow"&gt;Glow&lt;/span&gt;</p>
<p>D. &lt;span style="filter(glow)"&gt;Glow&lt;/span&gt; 7. __ is a
value representing a pixel’s degree of transparency.</p>
<p>A. Alpha</p>
<p>B. chroma</p>
<p>C. fliph</p>
<p>D. shadow</p>
<p>8. A(n) __ is a general term for a graphic that can be moved
independently around the screen to produce animated effects.</p>
<p>A. image</p>
<p>B. graphic</p>
<p>C. sprite</p>
<p>D. gif</p>
<p>9. Given the following code, which statement is incorrect?</p>
<p>&lt;pre id="h1" style="display:none"&gt;</p>
<p>O</p>
<p>.|-.'</p>
<p>/ =</p>
<p>| \</p>
<p>/. \.</p>
<p>&lt;/pre&gt;</p>
<p>A. It is an object, and its name is h1.</p>
<p>B. It is defaulted to be displayed as the word "none".</p>
<p>C. using h1.style.display='inline' can make it visible.</p>
<p>D. It is defaulted to be invisible.</p>
<p>10. Given the following code segment, which statement is correct?</p>
<p>function init() {</p>
<p>........</p>
<p>i++;</p>
<p>........</p>
<p>}</p>
<p>A. It uses i++ to continuously adding 1 to the value of i.</p>
<p>B. It uses i++ to continuously adding + to the value of i.</p>
<p>C. It uses i++ to continuously adding ++ to the value of i.</p>
<p>D. It uses i++ to continuously adding i to the value of i.</p>
<p>Game Programming – Penn Wu</p>
<p>32</p>
<p><span id="index_split_003.html#p33"></span></p>
<p>Lab #2</p>
<p>Game Graphics</p>
<p><strong></strong></p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab2.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong></strong></p>
<p><strong>Learning Activity #1: Basic Sprite Programming I</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab2_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=1;</p>
<p>function init() {</p>
<p>if (i&gt;4) { i=1; }</p>
<p>else {</p>
<p>clear();</p>
<p>switch (i) {</p>
<p>case 1: h1.style.display='inline'; break;</p>
<p>case 2: h2.style.display='inline'; break;</p>
<p>case 3: h3.style.display='inline'; break;</p>
<p>case 4: h4.style.display='inline'; break;</p>
<p>}</p>
<p>i++;</p>
<p>}</p>
<p>s1 = setTimeout("init()", 100);</p>
<p>}</p>
<p>function clear() {</p>
<p>h1.style.display='none';</p>
<p>h2.style.display='none';</p>
<p>h3.style.display='none';</p>
<p>h4.style.display='none';</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;pre id="h1" style="display:none"&gt;</p>
<p>O</p>
<p>.|-.'</p>
<p>/ =</p>
<p>| \</p>
<p>/. \.</p>
<p>&lt;/pre&gt;</p>
<p>&lt;pre id="h2" style="display:none"&gt;</p>
<p>O</p>
<p>..|--,</p>
<p>` =</p>
<p>/ |</p>
<p>/. /.</p>
<p>&lt;/pre&gt;</p>
<p>&lt;pre id="h3" style="display:none"&gt;</p>
<p>Ò.|-</p>
<p>= \.</p>
<p>Game Programming – Penn Wu</p>
<p>33</p>
<p><span id="index_split_003.html#p34"></span><img src="index-34_1.png"
class="calibre5" alt="Image 22" /></p>
<p>/ \</p>
<p>/. |.</p>
<p>&lt;/pre&gt;</p>
<p>&lt;pre id="h4" style="display:none"&gt;</p>
<p>O</p>
<p>-.|--'</p>
<p>` =</p>
<p>/ \</p>
<p>|. \.</p>
<p>&lt;/pre&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. A sample output
looks:</p>
<p><strong></strong></p>
<p><strong>Learning Activity #2: Basic Sprite Programming
II</strong></p>
<p><strong></strong></p>
<p>Note: Do not worry if you don’t understand the code. Details will be
described in later lectures. For now, just have fun!</p>
<p><strong></strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab2_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.pm {position: absolute;left=0; top:10 }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>if (ball.style.pixelLeft &gt; 60) { pacman.style.pixelLeft++; }</p>
<p>if (pacman.style.pixelLeft &gt; 70) { ghost.style.pixelLeft++;}</p>
<p>ball.style.pixelLeft++;</p>
<p>s1=setTimeout("init()", 10);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;pre id="ball" class="pm"&gt;</p>
<p>.-.</p>
<p>'-'</p>
<p>&lt;/pre&gt;</p>
<p>&lt;pre id="pacman" class="pm"&gt;</p>
<p>--.</p>
<p>/ o.-'</p>
<p>Game Programming – Penn Wu</p>
<p>34</p>
<p><span id="index_split_003.html#p35"></span><img src="index-35_1.png"
class="calibre5" alt="Image 23" /></p>
<p>\ '-.</p>
<p>'--'</p>
<p>&lt;/pre&gt;</p>
<p>&lt;pre id="ghost" class="pm"&gt;</p>
<p>.-.</p>
<p>| OO|</p>
<p>| |</p>
<p>'^^^'</p>
<p>&lt;/pre&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. A sample output looks:
<strong>Learning Activity #3: Creating graphics programmatically – A
Chess Board</strong> 1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab2_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.cell { width:30; height:30; border:solid 1 black; }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>code1="";</p>
<p>for (i=1; i&lt;=72; i++) {</p>
<p>if (i%9==0) { code1+="&lt;br&gt;"; }</p>
<p>else if (i%2==0) { code1+="&lt;span id=c"+i+" class=cell\n";
code1+="style='background-color:gray'&gt;&lt;/span&gt;"; }</p>
<p>else { code1+="&lt;span id=c"+i+" class=cell\n";
code1+="style='background-color:white'&gt;&lt;/span&gt;"; }</p>
<p>}</p>
<p>area1.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id="area1"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. A sample output
looks:</p>
<p><strong></strong></p>
<p>Game Programming – Penn Wu</p>
<p>35</p>
<p><span id="index_split_003.html#p36"></span><img src="index-36_1.png"
class="calibre5" alt="Image 24" /></p>
<p><strong></strong></p>
<p><strong></strong></p>
<p><strong>Learning Activity #4: Creating animated graphics
programmatically</strong> 1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab2_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.wKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>.bKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:black;</p>
<p>border:solid 1 white;</p>
<p>height:70px;</p>
<p>width:36px</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function Down() {</p>
<p>var keyID = event.srcElement.id;</p>
<p>document.getElementById(keyID).style.borderTop="solid 1 black";
document.getElementById(keyID).style.borderLeft="solid 1 black";
document.getElementById(keyID).style.borderBottom="solid 1 black";
document.getElementById(keyID).style.borderRight="solid 1 #cdcdcd";</p>
<p>}</p>
<p>function Up() {</p>
<p>var keyID = event.srcElement.id;</p>
<p>document.getElementById(keyID).style.borderTop="solid 1 #cdcdcd";
document.getElementById(keyID).style.borderLeft="solid 1 #cdcdcd";
document.getElementById(keyID).style.borderBottom="solid 4 #cdcdcd";
document.getElementById(keyID).style.borderRight="solid 1 black";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;div&gt;</p>
<p>&lt;span class="wKey" id="midC" style="left:50"</p>
<p>onClick="Down()" onMouseOut="Up()"&gt;&lt;/span&gt; Game Programming
– Penn Wu</p>
<p>36</p>
<p><span id="index_split_003.html#p37"></span><img src="index-37_1.png"
class="calibre5" alt="Image 25" /></p>
<p>&lt;span class="wKey" id="midD" style="left:91"</p>
<p>onClick="Down()" onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midE" style="left:132"</p>
<p>onClick="Down()" onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="cSharp"
style="left:72"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="dSharp"
style="left:114"&gt;&lt;/span&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. Use the mouse cursor to
move among the three keys, you should the visual effects.</p>
<p><strong>Learning Activity #5: Creating animation
programmatically</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab2_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function rotate1() {</p>
<p>m1.src='star2.gif';</p>
<p>m2.src='star1.gif';</p>
<p>m3.src='star2.gif';</p>
<p>m4.src='star1.gif';</p>
<p>m5.src='star2.gif';</p>
<p>setInterval("rotate2()",100);</p>
<p>}</p>
<p>function rotate2() {</p>
<p>m1.src='star1.gif';</p>
<p>m2.src='star2.gif';</p>
<p>m3.src='star1.gif';</p>
<p>m4.src='star2.gif';</p>
<p>m5.src='star1.gif';</p>
<p>setInterval("rotate1()",100);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown='rotate1()'&gt;</p>
<p>&lt;img id=m1 src="star1.gif"&gt;</p>
<p>&lt;img id=m2 src="star2.gif"&gt;</p>
<p>&lt;img id=m3 src="star1.gif"&gt;</p>
<p>&lt;img id=m4 src="star2.gif"&gt;</p>
<p>&lt;img id=m5 src="star1.gif"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to execute the file. Press any key, so the
stars rotate. A sample output looks: Game Programming – Penn Wu</p>
<p>37</p>
<p><span id="index_split_003.html#p38"></span><img src="index-38_1.png"
class="calibre5" alt="Image 26" /></p>
<p><strong></strong></p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to Blackboard, launch Assignment 02, and then scroll down
to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab2_1.gif</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab2_2.gif</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab2_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab2_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab2_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>38</p>
<p><span id="index_split_003.html#p39"></span></p>
<p>Lecture #3</p>
<p>Control of flows</p>
<p>Objective</p>
<p>Game programs are not linear--each statement executes in order, from
top to bottom--especially when the players have options. To create
interesting games, you need to write programs that execute (or skip)
sections of code based on some condition. This lecture discusses about
how you can control flows of a game program.</p>
<p><span id="index_split_004.html"></span></p>
<h2 class="calibre2"
id="index_split_004.html#calibre_pb_3">Introduction</h2>
<p>In computer science, control flow (or alternatively, flow of control)
refers to the order in which the individual statements or instructions
of an imperative program are performed or executed.</p>
<p>Within a programming language, a control flow statement is an
instruction that when executed can cause a change in the subsequent
control flow to differ from the natural sequential order in which the
instructions are listed. Discussion of control flow is almost always
restricted to a single thread of execution, as it depends upon a
definite sequence in which instructions are executed one at a time.</p>
<p>Consider the following example. The numbers at the beginning of each
indicates the line of the code. However, the sequence of the execution,
which is how the computer will read the statements are different.</p>
<p>Li</p>
<p>Code</p>
<p>ne</p>
<p>01 &lt;html&gt;&lt;body onLoad=cc()&gt;</p>
<p>02</p>
<p>03 &lt;script&gt;</p>
<p>04 var i=0;</p>
<p>05</p>
<p>06 function cc() {</p>
<p>07 m1.style.left=i;</p>
<p>08 i+=5;</p>
<p>09</p>
<p>10 <strong>if (i &gt;= document.body.clientWidth)</strong></p>
<p><strong></strong></p>
<p>11 <strong>{i=0;}</strong></p>
<p>12</p>
<p>13 setTimeout("cc()",70);</p>
<p>14 }</p>
<p>15 &lt;/script&gt;</p>
<p>16</p>
<p>17 &lt;img id=m1 src="ani_cat.gif"</p>
<p>18 style="position:absolute;top:10;left:0"&gt;</p>
<p>19</p>
<p>20 &lt;/body&gt;&lt;/html&gt;</p>
<p>The first line, &lt;html&gt;&lt;body onLoad=cc()&gt;, contains an
event handler <strong>onLoad</strong> which calls a user-defined
function <strong>cc()</strong> to make decision about what the computer
should respond to the changing of the <em>x</em>-coordinate of an image
file that has an ID <strong>m1</strong>. In other word, the execution
sequence is not necessary same as the line sequence.</p>
<p>Expressions,</p>
<p>An <strong>expression</strong> is a construct made up of variables,
operators, and method invocations, which are Statements,</p>
<p>constructed according to the syntax of the language, which evaluates
to a single value. You've and Blocks</p>
<p>already seen examples of expressions, illustrated in bold below:</p>
<p>•</p>
<p>var <strong>i = Math.floor(Math.random()*10)</strong>;</p>
<p>•</p>
<p>p1.innerHTML = " <strong>&lt;img src='my.gif'&gt;</strong> ";</p>
<p>•</p>
<p><strong>i++</strong>;</p>
<p>•</p>
<p>for (<strong>i=0</strong>; <strong>i&lt;=10</strong>;
<strong>i++)</strong></p>
<p>Game Programming – Penn Wu</p>
<p>39</p>
<p><span
id="index_split_004.html#p40"></span><strong>Statements</strong> are
roughly equivalent to sentences in natural languages. A statement forms
a complete unit of execution. The following types of expressions can be
made into a statement by terminating the expression with a semicolon
(;).</p>
<p>•</p>
<p>Assignment expressions</p>
<p>•</p>
<p>Any use of ++ or --</p>
<p>•</p>
<p>Method invocations</p>
<p>•</p>
<p>Object creation expressions</p>
<p>Such statements are called <strong>expression statements</strong>.
Here are some examples of expression statements.</p>
<p>x = 8933.234; // assignment statement</p>
<p>i++; // increment statement</p>
<p>document.write("Hello World!"); // method invocation statement
Bicycle myBike = new Bicycle(); // object creation statement</p>
<p>In addition to expression statements, there are two other kinds of
statements: declaration statements and control flow statements. A
declaration statement declares a variable. You have not seen any
examples of declaration statements, because JavaScript does not require
type declaration.</p>
<p>The following is an example used by other languages:</p>
<p>double aValue = 8933.234; //declaration statement</p>
<p>Finally, <strong>control flow</strong> statements regulate the order
in which statements get executed. Details of control flow statement will
be discussed in later section.</p>
<p>A <strong>block</strong> is a group of zero or more statements
between balanced braces and can be used anywhere a single statement is
allowed.</p>
<p>for (i=1; i&lt;=300; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 = "&lt;span id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y +"'&gt;.&lt;/span&gt;";
document.write(code1)</p>
<p>}</p>
<p>Noticeably, operators may be used in building expressions, which
compute values; expressions are the core components of statements;
statements may be grouped into blocks.</p>
<p>The if-then</p>
<p>The <strong>if-then</strong> statement is the most basic of all the
control flow statements. It tells your program to statement</p>
<p>execute a certain section of code only if a particular test evaluates
to true. In JavaScript, the syntax:</p>
<p>if (condition)</p>
<p>{</p>
<p>code to be executed if condition is true</p>
<p>}</p>
<p>Refer back to the above code, an <em>if..then</em> statement is used
in the format of JavaScript to determine if the value of variable
<em><strong>i</strong></em> is larger or equal to player’s web browser
width (which is represented by
<strong>document.body.clientWidth</strong>).</p>
<p>if (i&gt;=document.body.clientWidth-20)</p>
<p>If the evaluation result is true, then the computer executes:</p>
<p>{i=0;}</p>
<p>Game Programming – Penn Wu</p>
<p>40</p>
<p><span id="index_split_004.html#p41"></span><img src="index-41_1.png"
class="calibre5" alt="Image 27" /></p>
<p>If this test evaluates to false (meaning that the value of <em>i</em>
is less than that of document.body.clientWidth), control jumps to the
end of the if-then statement and continue with the following
statement:</p>
<p>setTimeout("cc()",70);</p>
<p><strong>setTimeout</strong> is a method that evaluates an expression
after a specified number of milliseconds has elapsed. The syntax is:</p>
<p>setTimeout(vCode, iMilliSeconds [, sLanguage])</p>
<p>The above statement uses the setTimeout method to evaluate the cc()
function after 70</p>
<p>milliseconds has elapsed. And, since it is place within the cc()
function, this setTimeout method forces the computer to execute cc()
every 70 milliseconds. In other words, over and over again.</p>
<p>Obviously, the first line &lt;body onLoad=cc()&gt; is only executed
once during the entire program life cycle. It’s mission is to start the
cc() function. All the control flow arrangement in cc() will determine
what the computer should do afterwards. The output thus looks: The
<strong>if..then</strong> statement used in this code provides a simple
<strong>decisive logic</strong>, which means “if the condition does not
make, forget the whole thing! You don’t get to have the second option!.”
Refer back to the following code block,</p>
<p>if (i &gt;= document.body.clientWidth)</p>
<p>{i=0;}</p>
<p>The condition is the part, i &gt;= document.body.clientWidth, which
can be either true or false. This statement read “if <em>i</em> is
greater than or equal to the value of the document body’s width of the
client’s browser, then <em>i</em> equals one”. However, it does not
describe what to do if the above condition is false.</p>
<p>The</p>
<p>The <strong>if-then-else</strong> statement provides a secondary path
of execution when an "if" clause evaluates if..then..else</p>
<p>to false. In JavaScript, the syntax:</p>
<p>statement</p>
<p>if (condition)</p>
<p>{</p>
<p>code to be executed if condition is true</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>code to be executed if condition is not true</p>
<p>}</p>
<p>In the following example, there are two user defined functions
<strong>cc()</strong> and <strong>dd()</strong>. They both use the
if..then..else statement to take some action if the expected condition
does not happen. To be more specific, <strong>m1</strong> is the ID of
an object (which is the bat.gif file) and its value of width increments
by 10px every time when the cc() is executed (and decrements by 10px
when dd() is executed).</p>
<p>Game Programming – Penn Wu</p>
<p>41</p>
<p><span id="index_split_004.html#p42"></span>The condition of cc() is
that the value of width must be less than 400px. If the condition is
false (meaning m1’s width value is &gt;=400), then call the dd()
function (or you can say to skip cc() and move to dd() function).</p>
<p>Reversely the condition of dd() is to be greater than 10px. If the
condition is false (meaning m1’s width value &lt;=10), then call the
cc() function.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>m1.style.width = m1.style.pixelWidth + 10;</p>
<p>if (m1.style.pixelWidth &lt; 400) {</p>
<p>setTimeout("cc()", 50);</p>
<p>}</p>
<p>else {dd(); }</p>
<p>}</p>
<p>function dd() {</p>
<p>m1.style.width = m1.style.pixelWidth - 10;</p>
<p>if (m1.style.pixelWidth &gt; 10) {</p>
<p>setTimeout("dd()", 50);</p>
<p>}</p>
<p>else {cc(); }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;center&gt;&lt;img id=m1 src="bat.gif"
style="width:10"&gt;&lt;/center&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>DHTML use the following syntax to represent attribute of a given
object (Note: style is a keyword).</p>
<p>objectID. <strong>style</strong>.AttributeName</p>
<p>The <strong>pixelWidth</strong> attribute of m1 is represented by
<strong>m1.style.pixelWidth</strong>, and its value is a string by
default, such as <strong>20px</strong>. The value pixelWidth holds is an
integer, so it can be evaluated by comparison operators (e.g. &gt;,
&lt;, &gt;=, &lt;=). For example, if (<strong>m1.style.pixelWidth &lt;
400</strong>) {</p>
<p>setTimeout("cc()", 50);</p>
<p>}</p>
<p>else {dd(); }</p>
<p><strong></strong></p>
<p>If the condition is true, the computer executes setTimeout(“cc()”,
50) after 50 milliseconds; otherwise, it calls the dd() function.</p>
<p>The <em>if..then..else</em> statement is good for anything that falls
to the two-state phenomena--either true or false. However, most games
are not that black or white; they are very colorful, and require more
than one simple decisive logics to make decisions. In this case, you can
consider using nested <em>if..then..else</em> statement, or using the
switch..case statement.</p>
<p>The</p>
<p>The <strong>switch..case</strong> statement is an alternative to the
If...Then...Else statement. It also makes code switch..case</p>
<p>easier to read especially when testing lots of different conditions.
It also makes the code more statement</p>
<p>efficient. In JavaScript, the <strong>switch..case</strong> statement
uses the following syntax: Game Programming – Penn Wu</p>
<p>42</p>
<p><span id="index_split_004.html#p43"></span> <em>switch</em>
(testexpression) {</p>
<p><em>Case</em> expressionlist1:</p>
<p>Statements;</p>
<p><em>Case</em> expressionlist2:</p>
<p>Statements;</p>
<p>..............</p>
<p>..............</p>
<p>default : statement;</p>
<p>}</p>
<p>where <em>testexpression</em> is a single expression, which is
evaluated at the top of the list. The <em>expressionlist</em> then lists
possible conditions and if the <em>testexpression</em> is equal to this
case, the code in that section is run.</p>
<p>When using a <em>switch..case</em> statement, you need to declare a
variable that will be matching against with the options in the case
list.</p>
<p>Inside the <em>switch..Case</em> statement, you define separate
<em>Case</em> statements for each condition to be checked against. In
this example, you have 5 and each one is set to respond to a different
blood type. If a match can be found, computer executes the code
immediately following the relevant Case statement.</p>
<p>Another point of interest is the <strong>break</strong> statement
after each case. Each <strong>break</strong> statement terminates the
enclosing switch statement. Control flow continues with the first
statement following the switch block. The <strong>break</strong>
statements are necessary because without them, case statements fall
through; that is, without an explicit break, control will flow
sequentially through subsequent case statements.</p>
<p>The <strong>default</strong> section handles all values that aren't
explicitly handled by one of the case sections. It is sometime good idea
to have the <strong>default</strong> section, but it depends on the
situation.</p>
<p>The random gopher game uses the <em>switch..case</em> statement to
controls the flow.</p>
<p>...............</p>
<p>&lt;script&gt;</p>
<p>..............</p>
<p><strong></strong></p>
<p><strong>switch (i) {</strong></p>
<p><strong>case 1:</strong></p>
<p><strong>g1.src="gopher2.gif";g2.src="gopher1.gif";g3.src="gopher1.gif";</strong>
<strong>break;</strong></p>
<p><strong></strong></p>
<p><strong>case 2:</strong></p>
<p><strong>g2.src="gopher2.gif";g1.src="gopher1.gif";g3.src="gopher1.gif";</strong>
<strong>break;</strong></p>
<p><strong></strong></p>
<p><strong>case 3:</strong></p>
<p><strong>g3.src="gopher2.gif";g1.src="gopher1.gif";g2.src="gopher1.gif";</strong>
<strong>break;</strong></p>
<p><strong>}</strong></p>
<p>................</p>
<p>&lt;/script&gt;</p>
<p>................</p>
<p>The <strong>gjump()</strong> function contains a variable
<em><strong>i</strong></em>, whose value is assigned by a random number
generator -- the <strong>Math.random()</strong> function -- of
JavaScript. By default, this random function returns a random number
between zero and 1 with the decimal point. The following is a list of
possibly results of Math.random():</p>
<p>Game Programming – Penn Wu</p>
<p>43</p>
<p><span id="index_split_004.html#p44"></span></p>
<p>0.47145134906738295</p>
<p>0.8141135558627748</p>
<p>0.696928080402613</p>
<p>0.9209730732076619</p>
<p>0.8254258690882129</p>
<p>0.03148481558914484</p>
<p>The results are unpredictable, ant they are all smaller than 1. To
generate a smaller range of random number in JavaScript, simply use the
following code:</p>
<p>var variableName=Math.floor(Math.random()*11)</p>
<p>where 11 dictates that the random number will fall between 0-10. To
increase the range to, say, 100, simply change 11 to 101 instead.</p>
<p>You may be curious as to why <strong>Math.round()</strong>, instead
of Math.floor(), is used in the above code.</p>
<p>While both successfully round off its containing parameter to an
integer within the designated range, Math.floor does so more “evenly”,
so the resulting integer isn’t lopsided towards either end of the number
spectrum. In other words, a more random number is returned using
Math.floor().</p>
<p>This code uses the following line to randomly generate four possible
values 0, 1, 2, and 3.</p>
<p>var i = Math.round(Math.random()*3);</p>
<p>Since 0 is not valid case (only 1, 2, and 3 are listed used in the
above code), the following exclude the possibility of 0 as result.</p>
<p>if (i &lt; 1) { i = Math.round(Math.random()*3); }</p>
<p>Consider the following code block. If the value of
<em><strong>i</strong></em> returns out to be 1, the computer will only
carry out the code of the case 1. The keyword break forces the flow to
stop, so the codes that belong to case 2 and case 3 will not be read and
executed by the computer.</p>
<p><strong>switch (i) {</strong></p>
<p><strong>case 1:</strong></p>
<p><strong>g1.src="gopher2.gif";g2.src="gopher1.gif";g3.src="gopher1.gif";</strong>
<strong>break;</strong></p>
<p>Similarly, if the value of <em><strong>i</strong></em> returns out to
be 2, the computer will only carry out the code of the case 2. Case 1
and case 3 are ignored.</p>
<p>case 1:</p>
<p>g1.src="gopher2.gif";g2.src="gopher1.gif";g3.src="gopher1.gif";
break;</p>
<p><strong>case 2:</strong></p>
<p><strong>g2.src="gopher2.gif";g1.src="gopher1.gif";g3.src="gopher1.gif";</strong>
<strong>break;</strong></p>
<p>case 3:</p>
<p>g3.src="gopher2.gif";g1.src="gopher1.gif";g2.src="gopher1.gif";
break;</p>
<p>Technically, the final break is not required because flow would fall
out of the switch statement anyway. However, we recommend using a break
so that modifying the code is easier and less error-prone.</p>
<p>The <em>for</em> loop</p>
<p>The <em>for</em> statement provides a compact way to iterate over a
range of values. Programmers often Game Programming – Penn Wu</p>
<p>44</p>
<p><span id="index_split_004.html#p45"></span>refer to it as the "for
loop" because of the way in which it repeatedly loops until a particular
condition is satisfied. The general form of the for statement can be
expressed as follows: for (initialization; termination; increment) {</p>
<p>statement(s);</p>
<p>}</p>
<p>When using this version of the for statement, keep in mind that:</p>
<p>•</p>
<p>The <em>initialization</em> expression initializes the loop; it's
executed once, as the loop begins.</p>
<p>•</p>
<p>When the <em>termination</em> expression evaluates to false, the loop
terminates.</p>
<p>•</p>
<p>The <em>increment</em> expression is invoked after each iteration
through the loop; it is perfectly acceptable for this expression to
increment or decrement a value.</p>
<p>Given the following code:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {position:absolute; color:red}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>code1 = "";</p>
<p>function draw_star() {</p>
<p>for (i=1; i&lt;=300; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 += "&lt;span id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y
+"'&gt;.&lt;/span&gt;";</p>
<p>}</p>
<p>bd.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body id="bd" onLoad="draw_star();"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>The <em>for</em> loop is set to repetitively add an objects to the
browser’s body area based on the following logic:</p>
<p>&lt;span id=dot <em><strong>n</strong></em> <strong></strong>
style='left: <em><strong>x</strong></em>; top:
<em><strong>y</strong></em>'&gt;.&lt;/span&gt; where
<em><strong>n</strong></em> represents a list of consecutive numbers
starting with 1 and end at 300, because the for loop definition:</p>
<p>for (i=1; i&lt;=300; i++)</p>
<p><strong>x</strong> and <strong>y</strong> are random numbers
generated by the <strong>Math.random()</strong> function multiplied by
the screen width and screen height. The <strong>Math.round()</strong>
function is used to round up/down the random values to integers.</p>
<p>Since <em>x</em> and <em>y</em> are inside the <em>{</em> and
<em>}</em> of the <em>for</em> loop, the computer will generate a set of
random numbers each time when <em>i</em> increments (i++). There will be
300 sets of randomly generated <em>x</em>- and <em>y</em>- coordinates,
each set is used to place one dot (.) one the browser’s body area. In
other words, the final client side HTML output consist 300 lines of:</p>
<p>&lt;span id=dot1 style='left:
<em><strong>x</strong></em><strong>1</strong>; top:
<em><strong>y</strong></em><strong>1</strong>'&gt;.&lt;/span&gt;</p>
<p>&lt;span id=dot2 style='left:
<em><strong>x</strong></em><strong>2</strong>; top:
<em><strong>y</strong></em><strong>2</strong>'&gt;.&lt;/span&gt; Game
Programming – Penn Wu</p>
<p>45</p>
<p><span id="index_split_004.html#p46"></span>.....................</p>
<p>.....................</p>
<p>&lt;span id=dot299 style='left:
<em><strong>x</strong></em><strong>299</strong>; top:
<em><strong>y</strong></em><strong>299</strong>'&gt;.&lt;/span&gt;</p>
<p>&lt;span id=dot300 style='left:
<em><strong>x</strong></em><strong>300</strong>; top:
<em><strong>y</strong></em><strong>300</strong>'&gt;.&lt;/span&gt;
Obviously the <em>for</em> loop is used to shorten the game code. For
example, the <strong>cc()</strong> function in the following code uses
the <em>for</em> loop to repeats itself 13 times. Each time it produce a
new HTML</p>
<p>statement, which will be inserted to a blank space on the web
browser’s body area with an ID</p>
<p><strong>area1</strong> (specified by the <strong>&lt;span
id=area1&gt;&lt;/span&gt;</strong> statement).</p>
<p>&lt;html&gt;</p>
<p>&lt;SCRIPT&gt;</p>
<p>function cc(){</p>
<p><strong>for (i=1; i&lt;=13; i++) {</strong></p>
<p><strong>area1.innerHTML += "&lt;img src=c" + i + ".gif id=c" + i +
"&gt;";</strong></p>
<p><strong>}</strong></p>
<p>}</p>
<p>&lt;/SCRIPT&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;span id=area1&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;&lt;html&gt;</p>
<p>The above bold code block will produce the following HTML codes,
which are to be inserted inside the &lt;span id=area1&gt;&lt;/span&gt;
code block.</p>
<p>&lt;img src=c1.gif id=c1&gt;</p>
<p>&lt;img src=c2.gif id=c2&gt;</p>
<p>&lt;img src=c3.gif id=c3&gt;</p>
<p>&lt;img src=c4.gif id=c4&gt;</p>
<p>&lt;img src=c5.gif id=c5&gt;</p>
<p>&lt;img src=c6.gif id=c6&gt;</p>
<p>&lt;img src=c7.gif id=c7&gt;</p>
<p>&lt;img src=c8.gif id=c8&gt;</p>
<p>&lt;img src=c9.gif id=c9&gt;</p>
<p>&lt;img src=c10.gif id=c10&gt;</p>
<p>&lt;img src=c11.gif id=c11&gt;</p>
<p>&lt;img src=c12.gif id=c12&gt;</p>
<p>&lt;img src=c13.gif id=c13&gt;</p>
<p>The <em>for</em> loop is very helpful in producing similar code block
repetitively, especially when you need to reproduce a large amount of
them. The property <strong>innerHTML</strong>, in DHTML, sets or
retrieves the HTML contents between the start and end tags of the object
(as in the above example</p>
<p>&lt;span&gt; and &lt;/span&gt;). It is valid for block elements only.
The syntax is: objectID.innerHTML="HTML contents"</p>
<p>Notice that the above code use a <strong>+=</strong> operator, which
mean “appending” or “adding without replacing the current content”. This
operator is used because when the <strong>innerHTML</strong> property is
set, the given HTML string completely replaces the existing content of
the object. You can remove the + sign (only the enlarged one) from the
following statement, and test the code again to see for yourself.</p>
<p>area1.innerHTML <strong>+</strong>= "&lt;img src=c" + i + ".gif id=c"
+ i + "&gt;"; Instead of using the innerHTML property, you can also
consider using the <strong>insertAdjacentHTML</strong></p>
<p>method, as shown in the following code.</p>
<p>Game Programming – Penn Wu</p>
<p>46</p>
<p><span id="index_split_004.html#p47"></span></p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>for (i=1; i&lt;=3; i++) {</p>
<p>p1.insertAdjacentHTML("BeforeBegin","&lt;img src='gopher"+i+"gif'</p>
<p>id=g"+i+"&gt;&lt;br&gt;")</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;span id=p1&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>The insertAdjacentHTML method inserts the given HTML text into the
element at the location.</p>
<p>The syntax is:</p>
<p>objectID.insertAdjacentHTML(location, string)</p>
<p>Available position values are:</p>
<p>• beforeBegin - Inserts the text immediately before the element.</p>
<p>• afterBegin - Inserts the text after the start of the element but
before all other content in the element.</p>
<p>• beforeEnd - Inserts the text immediately before the end of the
element but after all other content in the element.</p>
<p>• afterEnd - Inserts the text immediately after the end of the
element.</p>
<p>The <em>for..in</em></p>
<p>The for..in loop is a bit different from the other loops we've seen
so far. It allows you to loop statement</p>
<p>through the properties of a JavaScript object.</p>
<p>If you are unfamiliar with objects in JavaScript, think of them as
black boxes that can have a number of properties associated with them.
For example, a cat object might have a color property with a value of
"black", and an ears property with a value of 2! The basic for..in
construct looks like this:</p>
<p>for ( variable_name in object_name )</p>
<p>{</p>
<p>&lt; do stuff with the property here &gt;</p>
<p>&lt; the current property name is stored in variable_name &gt;</p>
<p>}</p>
<p>Note that, on each pass through the loop, the loop variable
variable_name holds the name of the current property. To obtain the
value of the current property, you would use the following syntax:
object_name[variable_name]</p>
<p>For example, this code loops through all the properties of the
navigator object (a built-in JavaScript object that holds information
about your browser, adds each property's name and value to a string,
then displays the resulting string in an alert box: function
display_nav_props ( )</p>
<p>{</p>
<p>var i;</p>
<p>var output_string = "";</p>
<p>Game Programming – Penn Wu</p>
<p>47</p>
<p><span id="index_split_004.html#p48"></span><img src="index-48_1.png"
class="calibre5" alt="Image 28" /></p>
<p>for ( i in navigator )</p>
<p>{</p>
<p>output_string += "The value of " + i +</p>
<p>" is: " + navigator[i] + "\n";</p>
<p>}</p>
<p>alert ( output_string );</p>
<p>}</p>
<p>The <em>while</em> loop The <strong>while</strong> loop is used when
you want the loop to execute and continue executing while the specified
condition is true. The syntax in JavaScript is:</p>
<p>while (condition)</p>
<p>{</p>
<p>code to be executed</p>
<p>}</p>
<p>The while statement evaluates <em>expression</em>, which must return
a boolean value. If the expression evaluates to true, the while
statement executes the <em>statement</em>(s) in the while block. The
while statement continues testing the expression and executing its block
until the expression evaluates to false.</p>
<p>For example, you can apply a while loop to a shooting game with the
logic “while the <em>x</em>-</p>
<p>coordinate is greater than or equal to 400, set the
<em>x</em>-coordinate value to 95”.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var i = 95; // declare a variable i</p>
<p>function shoot() {</p>
<p>b01.style.left=i; //let the current x-coordinate equal i value</p>
<p>i+=10; // i increment by 10</p>
<p><strong>while (i &gt;= 400) {</strong></p>
<p><strong>b01.style.display='none';</strong></p>
<p><strong>i=95;</strong></p>
<p><strong>}</strong></p>
<p>setTimeout("shoot()",20); // call shoot() after 20 milliseconds</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="shoot();b01.style.display='inline';"&gt;</p>
<p>&lt;img src="gun.gif"&gt;</p>
<p>&lt;img src="bullet.gif" id="b01" style="position:absolute;
display:none; top:20; left:95"&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>The output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>48</p>
<p><span id="index_split_004.html#p49"></span></p>
<p>Sometimes, the <strong>while</strong> statement and
<strong>if..then</strong> statement produce the same results. You can
write the Cat Running game using the while statement. For example,</p>
<p>&lt;html&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0;</p>
<p>function cc() {</p>
<p>m1.style.left=i;</p>
<p>i+=5;</p>
<p><strong>while (i&gt;=document.body.clientWidth-20) {i=0;
}</strong></p>
<p>setTimeout("cc()",70);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;img id=m1 src="ani_cat.gif"</p>
<p>style="position:absolute;top:10;left:0"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>You can always use a <em>while</em> loop to run the same block of
code while a specified condition is true.</p>
<p>The <em>do..while</em></p>
<p>Many programming language also provides a do-while statement, which
can be expressed as loop</p>
<p>follows:</p>
<p>do {</p>
<p>statement(s)</p>
<p>} while (expression);</p>
<p>The <strong>do..while</strong> statement is very similar to the while
statement. For example, function cancel_to_finish ( )</p>
<p>{</p>
<p>var confirm_result;</p>
<p>do</p>
<p>{</p>
<p>confirm_result = confirm ( "Press Cancel to finish!" );</p>
<p>} while ( confirm_result != 0 );</p>
<p>}</p>
<p>The difference between do-while and while is that do-while evaluates
its expression at the bottom of the loop instead of the top. Therefore,
the statements within the do block are always executed at least
once,</p>
<p>Use a do...while loop to run the same block of code while a specified
condition is true. This loop will always be executed at least once, even
if the condition is false, because the statements are executed before
the condition is tested.</p>
<p>Review</p>
<p>1. Which is a valid expression?</p>
<p>Questions</p>
<p>A. i = Math.floor(Math.random()*10);</p>
<p>B. i = i + 2;</p>
<p>C. i++;</p>
<p>D. for (i=0; i&lt;=10; i++)</p>
<p>2. Given the following code block, which statement is correct?</p>
<p>Game Programming – Penn Wu</p>
<p>49</p>
<p><span id="index_split_004.html#p50"></span></p>
<p>if (i&gt;=document.body.clientWidth-20) { i=i+1; }</p>
<p>A. If this test evaluates to false, control jumps to { i=i+1; }</p>
<p>B. It tests to determine if the value of variable i is larger or
equal to player’s web browser width.</p>
<p>C. document.body.clientWidth represents the server's resolution
values D. All of the above</p>
<p>3. Which is an example of "simple decisive logic"?</p>
<p>A. if (i&gt;= 3) { i++; } else { i--;}</p>
<p>B. if (i&gt;= 3) { i++; } else if { i--;} else {i=0;}</p>
<p>C. if (i&gt;= 3) { i++; }</p>
<p>D. None of the above</p>
<p>4. Given the following code block, which statement is correct?</p>
<p>if (eval(m1.style.width.replace('px','')) &lt; 400) {</p>
<p>setTimeout("cc()", 50);</p>
<p>}</p>
<p>A. The condition states that the value of width must be less than
400px.</p>
<p>B. If m1’s width value is &gt;=400, call the cc() function.</p>
<p>C. The condition states that it only allows 50 times of
executions.</p>
<p>D. If m1's width equals to 400 mulitpled by 50, then stops.</p>
<p>5. Given the following, which is a keyword that must always be
present?</p>
<p>m1.style.width</p>
<p>A. m1</p>
<p>B. style</p>
<p>C. width</p>
<p>D. all of the above</p>
<p>6. Given the following code segment, what does the replace() method
do?</p>
<p>eval(m1.style.width.replace('px',''));</p>
<p>A. It removes the 'px' substring.</p>
<p>B. It replaces the 'px' substring with the user's entry.</p>
<p>C. It replaces the 'px' substring with the new width value.</p>
<p>D. It replaces the ' substring with the 'px'.</p>
<p>7. Given the following code segment, which is the output if the value
of i is 0?</p>
<p>swith(i)</p>
<p>case 1: p1.innerHTML = "Apple"; break;</p>
<p>case 2: p1.innerHTML = "Orange"; break;</p>
<p>case 3: p1.innerHTML = "Banana"; break;</p>
<p>default: p1.innerHTML = "Grape"; break;</p>
<p>A. Apple</p>
<p>B. Orange</p>
<p>C. Banana</p>
<p>D. Grape</p>
<p>8. Given the following code segment, which is not a possible
output?</p>
<p>Game Programming – Penn Wu</p>
<p>50</p>
<p><span id="index_split_004.html#p51"></span>var i =
Math.floor(Math.random()*3);</p>
<p>A. 3</p>
<p>B. 2</p>
<p>C. 1</p>
<p>D. 0</p>
<p>9. Given the following code segment, what will be inserted to p1?</p>
<p>for (i=0; i&lt;=4; i++) {</p>
<p>p1.innerHTML += i;</p>
<p>}</p>
<p>A. 0123</p>
<p>B. 01234</p>
<p>C. 1234</p>
<p>D. 123</p>
<p>10. Given the following code segment, Which statement is correct?</p>
<p>while (i &gt;= 400) {</p>
<p>b01.style.display='none';</p>
<p>i=95;</p>
<p>b01.style.pixelLeft = i;</p>
<p>}</p>
<p>A. while the y-coordinate is greater than or equal to 400, set the
y-coordinate value to 95</p>
<p>B. while the y-coordinate is greater than or equal to 95, set the
y-coordinate value to 400</p>
<p>C. while the x-coordinate is greater than or equal to 400, set the
x-coordinate value to 95</p>
<p>D. while the x-coordinate is greater than or equal to 95, set the
x-coordinate value to 400</p>
<p>Game Programming – Penn Wu</p>
<p>51</p>
<p><span id="index_split_004.html#p52"></span><img src="index-52_1.png"
class="calibre5" alt="Image 29" /></p>
<p>Lab #3</p>
<p>Control of flows</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab3.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Shooting gun</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab3_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function shoot() {</p>
<p>var i = b01.style.pixelLeft;</p>
<p>if (i &lt;= document.body.clientWidth - b01.style.pixelWidth - 10)
{</p>
<p>b01.style.left=i + 10;</p>
<p>setTimeout("shoot()",20);</p>
<p>}</p>
<p>else {b01.style.display='none';</p>
<p>b01.style.left=95;</p>
<p>};</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="shoot();b01.style.display='inline';"&gt;</p>
<p>&lt;img src="gun.gif"&gt;</p>
<p>&lt;img src="bullet.gif" id="b01" style="position:absolute;
display:none; top:20; left:95"&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Note: Compare this version with the one in lecture note. This version
uses <strong>if..then</strong> statement; the other use
<strong>while</strong> <strong>loop</strong>.</p>
<p>3. Test the program. Press any key to shoot. Watch how the bullet
moves. A sample output looks: <strong>Learning Activity #2:
UFO</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab3_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.dots {position:absolute; color:white}</p>
<p>Game Programming – Penn Wu</p>
<p>52</p>
<p><span id="index_split_004.html#p53"></span><img src="index-53_1.png"
class="calibre5" alt="Image 30" /></p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>code1 ="";</p>
<p>function draw_star() {</p>
<p>for (i=1; i&lt;=600; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 += "&lt;span class=dots id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y
+"'&gt;.&lt;/span&gt;";</p>
<p>}</p>
<p>bar.innerHTML = code1;</p>
<p>}</p>
<p>function ufo_fly() {</p>
<p>ufo.style.left = Math.round(Math.random()*screen.width);</p>
<p>ufo.style.top = Math.round(Math.random()*screen.height);</p>
<p>setTimeout("ufo_fly()", 500);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor=black onLoad="draw_star();ufo_fly()"&gt;</p>
<p>&lt;div id="bar" style="z-index:0"&gt;&lt;/div&gt;</p>
<p>&lt;img src="ufo.gif" id="ufo"
style="position:absolute;z-index:3;"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A UFO will appear and move around the sky that
has 300 stars. A sample output looks: <strong>Learning Activity #3:
Shuffle-Organize playing card</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab3_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var code="";</p>
<p>function lineup(){</p>
<p>area1.innerText = "";</p>
<p>for (i=1; i&lt;=52; i++) {</p>
<p>if (i%13 == 0) {</p>
<p>code += "&lt;img src=c" + i + ".gif id=c" + i + "&gt;&lt;br&gt;";</p>
<p>}</p>
<p>else {</p>
<p>code += "&lt;img src=c" + i + ".gif id=c" + i + "&gt;";</p>
<p>}</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>53</p>
<p><span id="index_split_004.html#p54"></span><img src="index-54_1.png"
class="calibre5" alt="Image 31" /></p>
<p><img src="index-54_2.png" class="calibre5" alt="Image 32" /></p>
<p>area1.innerHTML = code;</p>
<p>code = "";</p>
<p>}</p>
<p>function scramble() {</p>
<p>area1.innerText = "";</p>
<p>for (i=1; i&lt;=52; i++) {</p>
<p>x = Math.round(Math.random()*200);</p>
<p>y = Math.round(Math.random()*200);</p>
<p>code += "&lt;img src=c" + i + ".gif id=c";</p>
<p>code += i + " style='position:absolute; ";</p>
<p>code += "left:" + x + "; top:" + y + "'&gt;";</p>
<p>}</p>
<p>area1.innerHTML = code;</p>
<p>code = "";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=scramble() onClick=scramble()
onKeyDown=lineup()&gt;</p>
<p>&lt;span id="area1"&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press any key to organize, click the mouse to
shuffle. A sample output looks: Before organizing</p>
<p>After organizing</p>
<p><strong>Learning Activity #4: Moving the ball</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab3_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function move() {</p>
<p>var i = event.keyCode;</p>
<p>switch(i) {</p>
<p>case 37:</p>
<p>if ( ball.style.pixelLeft &lt;= 10) { ball.style.pixelLeft=10; }</p>
<p>else { ball.style.pixelLeft -= 1; }</p>
<p>break;</p>
<p>case 39:</p>
<p>if ((ball.style.pixelLeft + ball.style.pixelWidth) &gt;=
area1.style.pixelWidth-10)</p>
<p>{ ball.style.pixelLeft = (area1.style.pixelWidth -
ball.style.pixelWidth -10);}</p>
<p>else { ball.style.pixelLeft += 1; }</p>
<p>Game Programming – Penn Wu</p>
<p>54</p>
<p><span id="index_split_004.html#p55"></span><img src="index-55_1.png"
class="calibre5" alt="Image 33" /></p>
<p>break;</p>
<p>case 38:</p>
<p>if ( ball.style.pixelTop &lt;= 10) { ball.style.pixelTop=10; }</p>
<p>else { ball.style.pixelTop -= 1;}</p>
<p>break;</p>
<p>case 40:</p>
<p>if ((ball.style.pixelTop + ball.style.pixelHeight) &gt;=
area1.style.pixelHeight-10)</p>
<p>{ ball.style.pixelTop = (area1.style.pixelHeight -
ball.style.pixelHeight -10);}</p>
<p>else { ball.style.pixelTop += 1; }</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onkeydown=move()&gt;</p>
<p>&lt;div id=area1 style="border:solid 1 black;</p>
<p>background-color:#abcdef;</p>
<p>width:300px; height:300px; top:10;left:10;</p>
<p>position:absolute"&gt; &lt;/div&gt;</p>
<p>&lt;img id=ball src="ball.gif" style="top:10;left:10;
position:absolute"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Use the ←, ↑ , →, ↓ arrow keys to move the ball.
A sample output looks: <strong>Learning Activity #5: Squeeze the
clown</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab3_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var k=0;</p>
<p>function goUp() {</p>
<p>bar.style.display='inline';</p>
<p>bar.style.pixelTop=bar.style.pixelTop - 5;</p>
<p>if (clown.style.pixelTop &lt;= 20) {</p>
<p>clown.style.pixelHeight = bar.style.pixelTop - 20;</p>
<p>clown.style.pixelWidth = clown.style.pixelWidth+1;</p>
<p>clown.style.pixelTop = 20;</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>55</p>
<p><span id="index_split_004.html#p56"></span><img src="index-56_1.png"
class="calibre5" alt="Image 34" /></p>
<p><img src="index-56_2.png" class="calibre5" alt="Image 35" /></p>
<p>else {</p>
<p>bar.style.pixelHeight=k;</p>
<p>k+=5;</p>
<p>clown.style.pixelTop=bar.style.pixelTop-120;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown=goUp()&gt;</p>
<p>&lt;hr style="position:absolute; left:10; top:0;</p>
<p>background-color:red; width:100;z-index:2" size="20px"
align="left"&gt;</p>
<p>&lt;img id="clown" src="clown.jpg" style="position:absolute; left:20;
top:280; width:54; z-index:3"&gt;</p>
<p>&lt;span id="bar" style="position:absolute; left:10; top:400;
background-color:red; width:100; display:none;
z-index:1"&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press the [Enter] key to pump up the clown. If
the clown hit the ceiling, the clown gets squeezed. Two sample output
are:</p>
<p>Clown not squeezed</p>
<p>Clown squeezed</p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to Blackboard, launch Assignment 03, and then scroll down
to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab3_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab3_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab3_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab3_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab3_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>56</p>
<p><span id="index_split_004.html#p57"></span></p>
<p>Lecture #4</p>
<p>Event and Event Handler</p>
<p><span id="index_split_005.html"></span></p>
<h2 class="calibre2"
id="index_split_005.html#calibre_pb_4">Introduction</h2>
<p>The most dramatic switch for most people new to game programming is
the fact that Windows-based game programs are event-driven, which means
such game programs can respond to their operating system environment, as
opposed to the environment taking cues from the program. In this
lecture, you will learn to use event handlers to detect and respond to
user’s activity.</p>
<p>What is an</p>
<p>When a user plays a game, any activity the user has is an
<strong>event</strong>. Objects on the game can contain event?</p>
<p>the so-called <strong>event handler</strong> that can trigger your
functions to respond to such events. For example, you add an
<strong>onClick</strong> event handler to trigger a function when the
user clicks that button (an object).</p>
<p>&lt;button onClick="myFunction()"&gt;Click Me&lt;/button&gt; In this
case, the button is an object, and it has an event handler
<strong>onClick</strong> that triggers a user-defined function named
<strong>myFunction()</strong>.</p>
<p>During normal program execution, a large number of events occur, so
skilled use of the event-oriented programming is very rewarding. It
opens up possibilities for creating very intricate and complex game
programs.</p>
<p>The DOM (Document Object Model) contains many objects that store a
variety of information about the browser, the computer running the
browser, visited URLs, and so on. You can use them to make your game
program more joyful.</p>
<p>The event</p>
<p>According to DHTML, the <strong>event</strong> object represents the
state of an event (meaning whenever the object</p>
<p>event occurs), the state of the keyboard keys, the location of the
mouse, and the state of the mouse buttons. In other words, the
<strong>event</strong> object stores data about events.</p>
<p>Whenever an event fires, the computer places appropriate data about
the event into the event object - for example, where the mouse pointer
was on the screen at the time of the event, which mouse buttons were
being pressed at the time of the event, and other useful
information.</p>
<p>Since the event object is a fairly active object, and it constantly
changing its properties, you need to have a good handle of the even
object. There are some general-purpose properties of the event object
covered in this article are listed in the following table.</p>
<p>Event object’s</p>
<p>Description</p>
<p>property</p>
<p>SrcElement</p>
<p>The element that fired the event</p>
<p>type</p>
<p>Type of event</p>
<p>returnValue</p>
<p>Determines whether the event is cancelled</p>
<p>cancelBubble</p>
<p>Can cancel an event bubble</p>
<p><strong></strong></p>
<p><strong>The event.srcElement property</strong></p>
<p>The srcElement and type properties contain the data that effectively
encapsulates our object/event pair.</p>
<p>The srcElement property returns the element that fired the event.
This is an object, and has the same properties as the element. For
example, given an image object</p>
<p>&lt;html&gt;&lt;body&gt;</p>
<p><strong>&lt;img id='Image1' src='picture1.jpg'</strong></p>
<p>Game Programming – Penn Wu</p>
<p>57</p>
<p><span id="index_split_005.html#p58"></span>
<strong>onClick="p1.innerText=event.srcElement.id"</strong></p>
<p><strong>onDblClick="p1.innerText=event.srcElement.src"</strong></p>
<p><strong>onMouseOver="p1.innerText=event.srcElement.tagName"&gt;</strong></p>
<p>&lt;p id=p1&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>When clicking on this image with an <strong>id</strong> attribute of
'Image1', and a <strong>src</strong> attribute of 'picture1.jpg', then
<strong>event.srcElement.id</strong> will return 'Image1', and when
double clicking on it the <strong>event.srcElement.src</strong> will
return 'xxxxx/picture1.jpg'. Notice that the <strong>xxxxx/</strong>
part will be extended because the computer internally converts relative
URLs into absolute URLs.</p>
<p>Similarly, the srcElement has a tagName property:</p>
<p>event.srcElement.tagName</p>
<p>will return 'IMG'. And we can also read styles, so if the image has a
style height of 100px, then
<strong>event.srcElement.style.height</strong> will return '100px'.</p>
<p><strong>The event.type property</strong></p>
<p>The <strong>type</strong> property displays the event name. If the
event handler is the <strong>onClick</strong>, the type will be</p>
<p>'Click', and if the event is onKeyPress, then type will be
'KeyPress'.</p>
<p>&lt;body</p>
<p><strong>onClick</strong>="status='You used the
'+<strong>event.type</strong>+'</p>
<p>event handler to click on me!'"</p>
<p><strong>onKeyPress</strong>="status='You used the
'+<strong>event.type</strong>+'</p>
<p>event handler to click on me!'"&gt;</p>
<p>&lt;/body&gt;</p>
<p>There are some event properties designed for the mouse buttons. A
detailed discussed is available in a later lecture.</p>
<p>clientX</p>
<p>Mouse pointer X coordinate relative to window</p>
<p>clientY</p>
<p>Mouse pointer Y coordinate relative to window</p>
<p>offsetX</p>
<p>Mouse pointer X coordinate relative to element that fired the event
offsetY</p>
<p>Mouse pointer Y coordinate relative to element that fired the event
button</p>
<p>Any mouse buttons that are pressed</p>
<p>For example, the following displays the current mouse position in the
browser's status window.</p>
<p>&lt;html&gt;&lt;body onmousemove="status = '(' + event.
<strong>x</strong> + ', ' +</p>
<p>event. <strong>y</strong> + ')'"&gt;</p>
<p>&lt;/body&lt;/html&gt;</p>
<p>There are also some event properties designed for the computer
keyboard. A detailed discussed is available in a later lecture.</p>
<p>altKey</p>
<p>True if the alt key was also pressed</p>
<p>ctrlKey</p>
<p>True if the ctrl key was also pressed</p>
<p>shiftKey</p>
<p>True if the shift key was also pressed</p>
<p>keyCode</p>
<p>Returns UniCode value of key pressed</p>
<p>Consider the following. It displays a message only when the user
press the Shift key.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>if (window.event. <strong>shiftKey</strong>)</p>
<p>Game Programming – Penn Wu</p>
<p>58</p>
<p><span id="index_split_005.html#p59"></span> p1.innerText="Why did you
press the Shift key?"</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="cc()"&gt;</p>
<p>&lt;p id=p1&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>As we proceed through this class, you will see how you can
successfully employ the event objects to enhance your game
programming.</p>
<p>Events and</p>
<p><strong>Events</strong> are the user’s activities, such as clicking a
button, pressing a key, moving the mouse event handlers</p>
<p>cursor around an object, and so on.</p>
<p>You can use the event handlers to detect a particular user activity,
for example, clicking a mouse button, and call a function to render some
results (such as an alert message) as response to the user’s
activity.</p>
<p>To allow you to run your bits of code when these events occur,
JavaScript provides us with event handlers. All the event handlers in
JavaScript start with the word on, and each event handler deals with a
certain type of event. Here's a list of all the event handlers in
JavaScript, along with the objects they apply to and the events that
trigger them:</p>
<p>Table: Common Event Handlers</p>
<p><strong>Event handler</strong></p>
<p><strong>Applies to:</strong></p>
<p><strong>Triggered when:</strong></p>
<p><strong>onAbort</strong></p>
<p>Image</p>
<p>The loading of the image is</p>
<p>cancelled.</p>
<p><strong>onBlur</strong></p>
<p>Button, Checkbox, FileUpload, Layer,</p>
<p>The object in question loses</p>
<p>Password, Radio, Reset, Select, Submit,</p>
<p>focus (e.g. by clicking</p>
<p>Text, TextArea, Window</p>
<p>outside it or pressing the</p>
<p>TAB key).</p>
<p><strong>onCut</strong></p>
<p>Document</p>
<p>Fires on the source element</p>
<p>when the object or selection</p>
<p>is removed from the</p>
<p>document and added to the</p>
<p>system clipboard.</p>
<p><strong>onClick</strong></p>
<p>Button, Document, Checkbox, Link,</p>
<p>The object is clicked on.</p>
<p>Radio, Reset, Submit</p>
<p><strong>onDblClick</strong></p>
<p>Document, Link</p>
<p>The object is double-clicked</p>
<p>on.</p>
<p><strong>onDragDrop</strong></p>
<p>Window</p>
<p>An icon is dragged and</p>
<p>dropped into the browser.</p>
<p><strong>onError</strong></p>
<p>Image, Window</p>
<p>A JavaScript error occurs.</p>
<p><strong>onPaste</strong></p>
<p>Document</p>
<p>Fires on the target object</p>
<p>when the user pastes data,</p>
<p>transferring the data from</p>
<p>the system clipboard to the</p>
<p>document.</p>
<p><strong>onKeyDown</strong></p>
<p>Document, Image, Link, TextArea</p>
<p>The user presses a key.</p>
<p><strong>onKeyPress</strong></p>
<p>Document, Image, Link, TextArea</p>
<p>The user presses or holds</p>
<p>down a key.</p>
<p><strong>onKeyUp</strong></p>
<p>Document, Image, Link, TextArea</p>
<p>The user releases a key.</p>
<p><strong>onLoad</strong></p>
<p>Image, Window</p>
<p>The whole page has finished</p>
<p>loading.</p>
<p><strong>onMouseDown</strong> Button, Document, Link</p>
<p>The user presses a mouse</p>
<p>button.</p>
<p><strong>onMouseMove</strong> None</p>
<p>The user moves the mouse.</p>
<p>Game Programming – Penn Wu</p>
<p>59</p>
<p><span id="index_split_005.html#p60"></span><img src="index-60_1.png"
class="calibre5" alt="Image 36" /></p>
<p><strong>onMouseOut</strong></p>
<p>Image, Link</p>
<p>The user moves the mouse</p>
<p>away from the object.</p>
<p><strong>onMouseOver</strong></p>
<p>Image, Link</p>
<p>The user moves the mouse</p>
<p>over the object.</p>
<p><strong>onMouseUp</strong></p>
<p>Button, Document, Link</p>
<p>The user releases a mouse</p>
<p>button.</p>
<p><strong>onMove</strong></p>
<p>Window</p>
<p>The user moves the browser</p>
<p>window or frame.</p>
<p><strong>onResize</strong></p>
<p>Window</p>
<p>The user resizes the browser</p>
<p>window or frame.</p>
<p><strong>onUnload</strong></p>
<p>Window</p>
<p>The user leaves the page.</p>
<p>A complete list of event handler is available at</p>
<p>http://msdn.microsoft.com/workshop/author/dhtml/reference/events.asp?frame=true.</p>
<p>To use an event handler, you usually place the event handler name
within the HTML tag of the object you want to work with, followed by and
assignment sign "=" and the associated JavaScript codes. For
example:</p>
<p>&lt;button <strong>onClick="alert('Thank You!')"</strong> &gt;Click
Me&lt;/button&gt; Using events</p>
<p>In a previous lecture, you tried the following code, which uses the
event handler. You can now and event</p>
<p>replace the event handler with anyone in the above table to test how
they apply to your game handlers in</p>
<p>scenario.</p>
<p>game</p>
<p>programming</p>
<p>&lt;html&gt;</p>
<p><strong></strong></p>
<p>&lt;script&gt;</p>
<p>var i=2;</p>
<p>function cc() {</p>
<p>if (i&gt;3) {i=1;}</p>
<p>m1.src="logo"+i+".gif";</p>
<p>i++;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body <strong>onKeyDown</strong>="cc()"&gt;</p>
<p>&lt;img id=m1 src="logo1.gif"/&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>An ideal sample output should look:</p>
<p><strong></strong></p>
<p><strong></strong></p>
<p>The truth is, as you probably already found out, not every event
handler can fit in this game. You must choose the event handler
wisely.</p>
<p>Consider the following. It uses the <strong>onMouseDown</strong>
event handler to trigger the cc() function.</p>
<p>Inside the cc() function, the button property of the event object (as
in <strong>event.button</strong>) passes the mouse button value to the
variable <em>i</em>. This value is then used to decide which .gif file
to be displayed: 1 for car_left.gif, and 2 for car_right.gif.</p>
<p>Game Programming – Penn Wu</p>
<p>60</p>
<p><span id="index_split_005.html#p61"></span><img src="index-61_1.png"
class="calibre5" alt="Image 37" /></p>
<p><img src="index-61_2.png" class="calibre5" alt="Image 38" /></p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>var i = event.button;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>p1.innerHTML = "&lt;img src='car_left.gif'&gt;"; break; case 2:</p>
<p>p1.innerHTML = "&lt;img src='car_right.gif'&gt;"; break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onMouseDown=cc()&gt;</p>
<p>&lt;p id=p1&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>When clicking either the left or right mouse button, one of the .gif
file appears: or</p>
<p>The logic behind the scene is that the button property returns:
event.button value</p>
<p>Description</p>
<p>1</p>
<p>Left Mouse Button</p>
<p>2</p>
<p>Right Mouse Button</p>
<p>4</p>
<p>Middle Mouse Button</p>
<p>A detailed discussion about using mice as user input device is
available at later lecture.</p>
<p>Where can you</p>
<p>Many games require the computer to trigger user functions. The
question is when and where can use event</p>
<p>you use the event handlers? Basically, there are two ways:</p>
<p>handlers?</p>
<p>•</p>
<p><strong>Automatic</strong>: When the page (document) is opened, or a
panel (an area) is opened, let the newly opened page/panel automatically
triggers functions.</p>
<p>•</p>
<p><strong>On-demand</strong>: Create an object inside the page or
panel, and embed the demanded event handler onto that object.</p>
<p>In the following code, there are two functions:
<strong>init()</strong> and <strong>spin()</strong>. The statement,</p>
<p>&lt;body onLoad=<strong>init()</strong>&gt;</p>
<p>uses an <strong>onLoad</strong> event handler to trigger the
<strong>init()</strong> function whenever the page is loaded or
refreshed, because the &lt;body&gt;…&lt;/body&gt; tags construct the
contents of the body area of browser.</p>
<p>The statement,</p>
<p>&lt;button OnMouseDown=" <strong>spin()</strong>"</p>
<p>onMouseUp="clearTimeout(spinning)"&gt;Spin&lt;/button&gt; uses the
<strong>onMouseDown</strong> event handler to trigger the spin()
function ONLY when the player holds a mouse button. In other words, it
is triggered on demand.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function <strong>init()</strong> {</p>
<p>card1.src=Math.floor(Math.random()*55)+".gif";</p>
<p>Game Programming – Penn Wu</p>
<p>61</p>
<p><span id="index_split_005.html#p62"></span><img src="index-62_1.png"
class="calibre5" alt="Image 39" /></p>
<p>card2.src=Math.floor(Math.random()*55)+".gif";</p>
<p>}</p>
<p>function <strong>spin()</strong> {</p>
<p>card1.src=Math.floor(Math.random()*55)+".gif";</p>
<p>card2.src=Math.floor(Math.random()*55)+".gif";</p>
<p>spinning=setTimeout("spin()", 100);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=<strong>init()</strong>&gt;</p>
<p>&lt;table&gt;&lt;tr&gt;</p>
<p>&lt;td&gt;&lt;img id=card1&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img id=card2&gt;&lt;/td&gt;</p>
<p>&lt;/tr&gt;&lt;/table&gt;</p>
<p>&lt;button OnMouseDown=" <strong>spin()</strong>"</p>
<p>onMouseUp="clearTimeout(spinning)"&gt;Spin&lt;/button&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>This code has access to 55 .gif files with file names of 0.gif,
1.gif, 2.gif, …., and 54.gif. To randomly pick a .gif and assign it to
<strong>card1</strong> (as in &lt;img id=card1), this code use:
<strong>card1</strong>.src=Math.floor(Math.random()*55)+".gif"; Each
time when init() and spin() functions are trigger, a random number is
generated and used to make up a file name for card1, such as
<em>n</em>.gif, where <em>n</em> is the random number.</p>
<p>The last statement of the spin() function creates an object (named
<strong>spinning</strong>), which is used to represent the setTimeout
method. The spinning object triggers the spin() function every 100</p>
<p>milliseconds.</p>
<p>spinning=setTimeout("spin()", 100);</p>
<p>To end this loop, the following statement is used. The
<strong>onMouseUp</strong> event handler triggers the
<strong>clearTimeout</strong> method when the player release the mouse
button.</p>
<p>&lt;button OnMouseDown="spin()"</p>
<p><strong>onMouseUp="clearTimeout(spinning)</strong>"&gt;Spin&lt;/button&gt;
When being executed, click the Spin button and hold the mouse, the cards
spins till you release the mouse button.</p>
<p>Given the following HTML code which will load a GIF image file named
<strong>pencil.gif</strong> with an ID</p>
<p><strong>pen</strong>.</p>
<p>&lt;html&gt;</p>
<p>&lt;body&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>62</p>
<p><span id="index_split_005.html#p63"></span><img src="index-63_1.png"
class="calibre5" alt="Image 40" /></p>
<p><img src="index-63_2.png" class="calibre5" alt="Image 41" /></p>
<p>&lt;img id="pen" src="pencil.gif"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>By adding the following CSS definition, this pencil.gif file will use
absolute positioning system on the browser’s body area, so it can be
moved around with some JavaScript codes.</p>
<p>&lt;style&gt;</p>
<p>img {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>In order to move the pencil.gif file, we create a JavaScript function
named <strong>MovePenn()</strong> containing two events:
<strong>event.clientX</strong> and <strong>event.clientY</strong>.</p>
<p>•</p>
<p>The <strong>clientX</strong> property of event object sets or
retrieves the x-coordinate of the mouse pointer's position relative to
the client area of the window, excluding window decorations and scroll
bars.</p>
<p>•</p>
<p>The <strong>clientY</strong> property sets or retrieves the
y-coordinate of the mouse pointer's position relative to the client area
of the window, excluding window decorations and scroll bars.</p>
<p>&lt;script&gt;</p>
<p>function MovePen() {</p>
<p>pen.style.left=event.clientX-30;</p>
<p>pen.style.top=event.clientY-25;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>The absolute positioning system also uses the <em>x</em>- and
<em>y</em>-coordinates to place the pencil.gif one the browser’s body
area. In the above code, we use <strong>pen.style.left</strong> to
represent the <em>x</em>-coordinate, and <strong>pen.style.top</strong>
to represent <em>y</em>-coordinate of the starting point of the
pencil.gif file. The starting point of images is always defaulted to
start with the upper-leftmost point.</p>
<p>(pen.style.left, pen.style.top)</p>
<p>54px</p>
<p>48px</p>
<p>The pencil.gif file has a dimension of 48px × 54px. You can detect
the dimension using any image software (such as Paint) or even the
Internet Explorer (by right clicking the image file and select
Properties).</p>
<p>Dimension: 48 × 54</p>
<p>In order to move the pencil inside the pencil.gif file around the
body area of browser with the mouse cursor, we need to continuously
assign the current <em>x</em>- and <em>y</em>-coordinates of mouse
cursor to <strong>pen.style.left</strong> and
<strong>pen.style.top</strong>. The MovePen() function thus must contain
the following code: pen.style.left=event.clientX;</p>
<p>pen.style.top=event.clientY;</p>
<p>Game Programming – Penn Wu</p>
<p>63</p>
<p><span id="index_split_005.html#p64"></span><img src="index-64_1.png"
class="calibre5" alt="Image 42" /></p>
<p><img src="index-64_2.png" class="calibre5" alt="Image 43" /></p>
<p>However, we want the mouse cursor to point at the pencil inside the
pencil.gif file, it is necessary to adjust the values of event.clientX
and event.clienY.</p>
<p>(clientX, clientY)</p>
<p>(clientX-<strong>30</strong>, clientY-<strong>25</strong>)</p>
<p>After a few trials, <strong>(clientX-30, clientY-25)</strong> seems
to be a pair of ideal values (Note: You can use other pairs, too), so
the code is modified to:</p>
<p>pen.style.left=event.clientX-30;</p>
<p>pen.style.top=event.clientY-25;</p>
<p>In JavaScript, as well as many other languages, a user-defined
function must be called or it will not execute. You can use the
<strong>OnMouseMove</strong> event handler to call the MovePen()
function whenever the user attempts to move the pencil.</p>
<p>&lt;img id="pen" src="pencil.gif"
<strong>OnMouseMove=MovePen()</strong>&gt; The complete code now
looks:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function MovePen() {</p>
<p>pen.style.left=event.clientX-30;</p>
<p>pen.style.top=event.clientY-25;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;img id="pen" src="pencil.gif" OnMouseMove=MovePen()&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>When you test this code, you can move the pencil around the body area
of the browser by first putting the mouse cursor on the pencil.gif file
and then moving the cursor.</p>
<p>The event object and event handlers are very useful to the game
programming, and technically can be applied to any aspects of game
programming. For example, they can work with DTHML</p>
<p>text appending methods, innerHTML, to draw scribble lines.</p>
<p>Game Programming – Penn Wu</p>
<p>64</p>
<p><span id="index_split_005.html#p65"></span><img src="index-65_1.png"
class="calibre5" alt="Image 44" /></p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.dots {position:absolute;font-size:78}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>code = "";</p>
<p>function cc() {</p>
<p>x = event.clientX;</p>
<p>y = event.clientY;</p>
<p>code += "&lt;span class=dots style='left: " + x +"; top: " + y</p>
<p>+"'&gt;.&lt;/span&gt;";</p>
<p>area1.innerText = "";</p>
<p>area1.innerHTML = code;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onMouseMove=cc() style="cursor:arrow"&gt;</p>
<p>&lt;div id=area1&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>When being executed, you can move the mouse to draw free shape
(scribble) lines.</p>
<p>Drag and drop</p>
<p>Many games require the Drag-and-Drop function. There are several
reasons you might want to incorporate this Drag-and-Drop ability into
your games. One of the simplest reasons is to reorganize Data. As an
example, you might want to have a queue of items that your users can
reorganize. Instead of putting an input or select box next to each item
to represent its order, you could make the entire group of items
draggable. Or perhaps you want to have an object that can be moved
around by your users.</p>
<p>"Moving object" is the topic of a later lecture. For now, you just
have to know how the events and event handlers help to create the
Drag-and-Drop ability; particularly how you can use event handlers to
support this capacity so that the play can click on an item and drag it,
and finally move the item.</p>
<p>To make your DHTML games support Drag-and-Drop, the following code
must be used. It defines a “dragme” class.</p>
<p>var ie=document.all;</p>
<p>var nn6=document.
<strong>getElementById</strong>&amp;&amp;!document.all; var
isdrag=false;</p>
<p>var x,y;</p>
<p>var dobj;</p>
<p>function movemouse(e)</p>
<p>Game Programming – Penn Wu</p>
<p>65</p>
<p><span id="index_split_005.html#p66"></span>{</p>
<p>if (isdrag)</p>
<p>{</p>
<p>dobj.style.left = nn6 ? tx + e. <strong>clientX</strong> - x : tx
+</p>
<p><strong>event.clientX</strong> - x;</p>
<p>dobj.style.top = nn6 ? ty + e. <strong>clientY</strong> - y : ty
+</p>
<p><strong>event.clientY</strong> - y;</p>
<p>return false;</p>
<p>}</p>
<p>}</p>
<p>function selectmouse(e)</p>
<p>{</p>
<p>var fobj = nn6 ? e.target : <strong>event.srcElement</strong>;</p>
<p>var topelement = nn6 ? "HTML" : "BODY";</p>
<p>while (fobj. <strong>tagName</strong> != topelement &amp;&amp;
fobj.className !=</p>
<p>"dragme")</p>
<p>{</p>
<p>fobj = nn6 ? fobj.parentNode : fobj.parentElement;</p>
<p>}</p>
<p>if (fobj.className=="dragme")</p>
<p>{</p>
<p>isdrag = true;</p>
<p>dobj = fobj;</p>
<p>tx = parseInt(dobj.style.left+0);</p>
<p>ty = parseInt(dobj.style.top+0);</p>
<p>x = nn6 ? e.clientX : <strong>event.clientX;</strong></p>
<p>y = nn6 ? e.clientY : <strong>event.clientY</strong>;</p>
<p>document.onmousemove=movemouse;</p>
<p>return false;</p>
<p>}</p>
<p>}</p>
<p>document.onmousedown=selectmouse;</p>
<p>document.onmouseup=new Function("isdrag=false");</p>
<p>To understand this code, you need to have a strong background in
JavaScript and DHTML, but do not worry about it for now. It is displayed
here to give you an ideal how the event and event handler model
contribute to the gram programming.</p>
<p>As to you, simply treat this code as a library code. You do so by
saving it as an individual file with extension <strong>.js</strong>,
such this file can be used as a library file. To call this library file
from another DHTML file (e.g. lab4_5.htm), simply add the following line
between &lt;head&gt; and &lt;/head&gt; of the lab4_4.htm file.</p>
<p>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</p>
<p>Add the class="dragme" to whichever image you wish to make draggable.
For example,</p>
<p>&lt;img id="cy1" <strong>class=</strong>" <strong>dragme</strong>"
src="cy1.jpg"&gt; Review</p>
<p>1. Given the following code, which is the name of the user-defined
function?</p>
<p>Questions</p>
<p>&lt;button id="click" onClick="Click()"&gt;Click Me&lt;/button&gt; A.
click</p>
<p>B. onClick</p>
<p>C. Click</p>
<p>D. Click Me</p>
<p>Game Programming – Penn Wu</p>
<p>66</p>
<p><span id="index_split_005.html#p67"></span></p>
<p>2. Which is an example of the state of an event?</p>
<p>A. the state of the keyboard keys</p>
<p>B. the location of the mouse</p>
<p>C. the state of the mouse buttons</p>
<p>D. All of the above</p>
<p>3. Which event object's property determines whether the event is
cancelled?</p>
<p>A. SrcElement</p>
<p>B. type</p>
<p>C. returnValue</p>
<p>D. cancelBubble</p>
<p>4. Given the following code block, what will be displayed on the
status bar?</p>
<p>&lt;img id='clown' src='clown.jpg'</p>
<p>onClick="status=event.srcElement.id"&gt;</p>
<p>A. clown</p>
<p>B. clown.jpg</p>
<p>C. IMG</p>
<p>D. all of the above</p>
<p>5. Given the following code block, what will be displayed on the
status bar?</p>
<p>&lt;body onClick="status='You used the '+event.type+'</p>
<p>event handler to click on me!'"&gt;</p>
<p>A. Click</p>
<p>B. onClick</p>
<p>C. event.click</p>
<p>D. event.onClick</p>
<p>6. Which is an example of event?</p>
<p>A. clicking a button</p>
<p>B. pressing a key</p>
<p>C. moving the mouse cursor around an object</p>
<p>D. All of the above</p>
<p>7. Which event handler is triggered when the object or selection is
removed from the document and added to the system clipboard?</p>
<p>A. onClick</p>
<p>B. onCut</p>
<p>C. onPaste</p>
<p>D. onKeyPress</p>
<p>8. Which event handler is triggered when the user moves the browser
window or frame?</p>
<p>A. onWindowMove</p>
<p>B. onMouseMove</p>
<p>C. onDocumentMove</p>
<p>D. onMove</p>
<p>9. Which triggers the init() function whenever the page is loaded or
refreshed?</p>
<p>A. &lt;body onStart=init()&gt;</p>
<p>B. &lt;body onLoad=init()&gt;</p>
<p>C. &lt;body onInit=init()&gt;</p>
<p>D. &lt;body onHold=init()&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>67</p>
<p><span id="index_split_005.html#p68"></span></p>
<p>10. How do you determinate the following code block?</p>
<p>objSpin=setTimeout("spin()", 100);</p>
<p>A. clearTimeout(objSpin);</p>
<p>B. clearTimeout("objSpin", 100);</p>
<p>C. clear("objSpin", 100);</p>
<p>D. clear(objSpin);</p>
<p>Game Programming – Penn Wu</p>
<p>68</p>
<p><span id="index_split_005.html#p69"></span><strong>Appendix A: More
members exposed by the event object</strong> MoreInfo</p>
<p>Retrieves the MoreInfo content of an entry banner in an ASX file
through the event object.</p>
<p>nextPage</p>
<p>Retrieves the position of the next page within a print template.</p>
<p>propertyName Sets or retrieves the name of the property that changes
on the object.</p>
<p>qualifier</p>
<p>Sets or retrieves the name of the data member provided by a data
source object.</p>
<p>reason</p>
<p>Sets or retrieves the result of the data transfer for a data source
object.</p>
<p>recordset</p>
<p>Sets or retrieves from a data source object a reference to the
default record set.</p>
<p>repeat</p>
<p>Retrieves whether the onkeydown event is being repeated.</p>
<p>returnValue</p>
<p>Sets or retrieves the return value from the event.</p>
<p>saveType</p>
<p>Retrieves the clipboard type when oncontentsave fires.</p>
<p>screenX</p>
<p>Retrieves the x-coordinate of the mouse pointer's position relative
to the user's screen.</p>
<p>screenY</p>
<p>Sets or retrieves the y-coordinate of the mouse pointer's position
relative to the user's screen.</p>
<p>srcFilter</p>
<p>Sets or retrieves the filter object that caused the onfilterchange
event to fire.</p>
<p>srcUrn</p>
<p>Retrieves the Uniform Resource Name (URN) of the behavior that fired
the event.</p>
<p>toElement</p>
<p>Sets or retrieves a reference to the object toward which the user is
moving the mouse pointer.</p>
<p>type</p>
<p>Sets or retrieves the event name from the event object.</p>
<p>userName</p>
<p>Retrieves the sFriendlyName parameter that is passed to the
useService method.</p>
<p>wheelDelta</p>
<p>Retrieves the distance and direction the wheel button has rolled.</p>
<p>x</p>
<p>Sets or retrieves the x-coordinate, in pixels, of the mouse pointer's
position relative to a relatively positioned parent element.</p>
<p>y</p>
<p>Sets or retrieves the y-coordinate, in pixels, of the mouse pointer's
position relative to a relatively positioned parent element.</p>
<p>Game Programming – Penn Wu</p>
<p>69</p>
<p><span id="index_split_005.html#p70"></span><img src="index-70_1.png"
class="calibre5" alt="Image 45" /></p>
<p>Lab #4</p>
<p>Event and Event Handler</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab4.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Drawing</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p><strong></strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab4_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function MovePen() {</p>
<p>pen.style.left=event.clientX-30;</p>
<p>pen.style.top=event.clientY-25;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;img id="pen" src="pencil.gif" OnMouseMove=MovePen()&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #2: Grimace Geckos</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab4_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.aOut {position:absolute}</p>
<p>Game Programming – Penn Wu</p>
<p>70</p>
<p><span id="index_split_005.html#p71"></span><img src="index-71_1.png"
class="calibre5" alt="Image 46" /></p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function popup() {</p>
<p>var k = Math.floor(Math.random()*4);</p>
<p>area1.innerText="";</p>
<p>for (i=1; i&lt;=k; i++) {</p>
<p>var x = Math.floor(Math.random()*200);</p>
<p>var y = Math.floor(Math.random()*200);</p>
<p>codes = "&lt;img class=aout id=geico" + i +" src='geico.gif'"; codes
+= "style='left:" + x +"; top:" + y +"'"</p>
<p>codes += " onClick=bar()&gt;";</p>
<p>area1.innerHTML += codes;</p>
<p>}</p>
<p>setTimeout("popup()", 1000)</p>
<p>}</p>
<p>function bar() {</p>
<p>area2.insertAdjacentHTML('BeforeBegin','&lt;b
style=color:red&gt;|&lt;/b&gt;');</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=popup()&gt;</p>
<p>&lt;div id=area1 style="width:300;height:300"&gt;&lt;/div&gt;</p>
<p>&lt;div id=area2&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. When some geckos randomly appear, use the mouse
click to hit them. A red bar grows each time when you hit a geico. A
sample output looks:</p>
<p><strong>Learning Activity #3: An incomplete slot machine</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab4_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>var k = Math.floor(Math.random()*55);</p>
<p>area1.innerHTML += "&lt;img id=g"+i+" src="+k+".gif&gt;"</p>
<p>Game Programming – Penn Wu</p>
<p>71</p>
<p><span id="index_split_005.html#p72"></span><img src="index-72_1.png"
class="calibre5" alt="Image 47" /></p>
<p>}</p>
<p>}</p>
<p>function spin() {</p>
<p>area1.innerText="";</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>var k = Math.floor(Math.random()*55);</p>
<p>area1.innerHTML += "&lt;img id=g"+i+" src="+k+".gif&gt;"</p>
<p>}</p>
<p>spinning=setTimeout("spin()",100);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id=area1&gt;&lt;/div&gt;</p>
<p>&lt;button onMouseDown=spin()</p>
<p>onMouseUp=clearTimeout(spinning)&gt;Spin&lt;/button&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Click the Spin button and hold the mouse, the
cards spins till you release the mouse button. A sample output
looks:</p>
<p><strong>Learning Activity #4: A simple Black Jack game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab4_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function serve() {</p>
<p>dealer1.src=Math.floor(Math.random()*52)+1+".gif";</p>
<p>dealer2.src=Math.floor(Math.random()*52)+1+".gif";</p>
<p>player2.src=Math.floor(Math.random()*52)+1+".gif";</p>
<p>}</p>
<p>function add_card() {</p>
<p>p1.innerHTML+="&lt;img id=player3 src=" +
(Math.floor(Math.random()*52)+1)+ ".gif&gt;";</p>
<p>}</p>
<p>function again() {</p>
<p>p1.innerText="";</p>
<p>player1.src="back.gif";</p>
<p>serve();</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>72</p>
<p><span id="index_split_005.html#p73"></span><img src="index-73_1.png"
class="calibre5" alt="Image 48" /></p>
<p><img src="index-73_2.png" class="calibre5" alt="Image 49" /></p>
<p><img src="index-73_3.png" class="calibre5" alt="Image 50" /></p>
<p>&lt;body onLoad=serve()&gt;</p>
<p>&lt;center&gt;&lt;table width="300px"&gt;</p>
<p>&lt;tr height="80px"&gt;</p>
<p>&lt;tb&gt;</p>
<p>&lt;img id=dealer1&gt;</p>
<p>&lt;img id=dealer2&gt;</p>
<p>&lt;/tb&gt;</p>
<p>&lt;tr height="40px"&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;tr height="80px"&gt;</p>
<p>&lt;td&gt;</p>
<p>&lt;img id=player1 src="back.gif"&gt;</p>
<p>&lt;img id=player2&gt;</p>
<p>&lt;span id=p1&gt;&lt;/span&gt;</p>
<p>&lt;/tb&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;tr height="40px"&gt;</p>
<p>&lt;td&gt;</p>
<p>&lt;button onClick=add_card()&gt;Add Card&lt;/button&gt;</p>
<p>&lt;button
onClick="player1.src=Math.floor(Math.random()*52)+1+'.gif'"&gt;Reveal&lt;/button&gt;</p>
<p>&lt;button onClick=again()&gt;Play Again&lt;/button&gt;</p>
<p>&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;/table&gt;&lt;/center&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. When starting the game, you are given two cards.
One card’s value is not disclosed by default. Please Add Card if you
want to add more card(s). Please Reveal to disclose the last card. A
sample output looks:</p>
<p>Start</p>
<p>Add a card</p>
<p>Flip the card</p>
<p><strong>Learning Activity #5: Puzzle</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p><strong></strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab4_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;style&gt;</p>
<p>.dragme{position:relative;}</p>
<p>Game Programming – Penn Wu</p>
<p>73</p>
<p><span id="index_split_005.html#p74"></span>td {border:solid 1 red;
text-align:center; font-size:12px}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>for (i=1;i&lt;=12; i++) {</p>
<p>var x = Math.floor(Math.random()*50);</p>
<p>var y = Math.floor(Math.random()*100);</p>
<p>pic.innerHTML += "&lt;img class='dragme' src=monalisa"+ i + ".gif
style='left:" + x +</p>
<p>"; top:" + y + "'</p>
<p>ondragstart='this.style.zIndex=3;this.style.left=event.clientX;this.style.top=event</p>
<p>.clientY'&gt;";</p>
<p>}</p>
<p>}</p>
<p>function dd() {</p>
<p>tb.style.display='none';</p>
<p>pic.innerText='';</p>
<p>for (k=1;k&lt;=12; k++) {</p>
<p>if (k%3 == 0) {</p>
<p>pic.innerHTML+="&lt;img src=monalisa" + k +".gif style='border: solid
1 white'&gt;&lt;br&gt;";</p>
<p>}</p>
<p>else {</p>
<p>pic.innerHTML+="&lt;img src=monalisa" + k +".gif style='border: solid
1 white'&gt;";</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;button onClick=dd()&gt;Solve&lt;/button&gt;</p>
<p>&lt;table border=0 cellspacing=0 id=tb
style="position:relative;"&gt;</p>
<p>&lt;tr height="52px"&gt;</p>
<p>&lt;td width="60px"&gt;1&lt;/td&gt;</p>
<p>&lt;td width="64px"&gt;2&lt;/td&gt;</p>
<p>&lt;td width="60px"&gt;3&lt;/td&gt;</p>
<p>&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;tr height="94px"&gt;</p>
<p>&lt;td&gt;4&lt;/td&gt;</p>
<p>&lt;td&gt;5&lt;/td&gt;</p>
<p>&lt;td&gt;6&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;tr height="82px"&gt;</p>
<p>&lt;td&gt;7&lt;/td&gt;</p>
<p>&lt;td&gt;8&lt;/td&gt;</p>
<p>&lt;td&gt;9&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>74</p>
<p><span id="index_split_005.html#p75"></span><img src="index-75_1.png"
class="calibre5" alt="Image 51" /></p>
<p>&lt;tr height="62px"&gt;</p>
<p>&lt;td&gt;10&lt;/td&gt;</p>
<p>&lt;td&gt;11&lt;/td&gt;</p>
<p>&lt;td&gt;12&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;/table&gt;</p>
<p>&lt;div id="pic" style="position:relative;"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Move each piece to its expected cell. A sample
output looks: <strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 04, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab4_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab4_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab4_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab4_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab4_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>75</p>
<p><span id="index_split_005.html#p76"></span><img src="index-76_1.png"
class="calibre5" alt="Image 52" /></p>
<p><img src="index-76_2.png" class="calibre5" alt="Image 53" /></p>
<p><img src="index-76_3.png" class="calibre5" alt="Image 54" /></p>
<p>Lecture #5</p>
<p>Using mouse buttons for input control</p>
<p><span id="index_split_006.html"></span></p>
<h2 class="calibre2"
id="index_split_006.html#calibre_pb_5">Introduction</h2>
<p>The players interact with a game by giving user inputs. To most
games, user inputs encompass the entire communications between a player
and a game. There are many user input devices that are used in game
programming, such as keyboard, mice, joysticks, flight sticks, touchpad,
pointing devices, and many other user input devices have brought
extended input capabilities to the game player; however, none is as
popular as the mouse.</p>
<p>This lecture discusses the basic concepts of user input handling, but
it will focus on the mouse. A later lecture will discuss the keyboard in
details.</p>
<p>Common User</p>
<p>Input devices are the physical hardware that allows a user to
interact with a game. Input devices Input Devices</p>
<p>all perform the same function: converting information provided by the
user into a form understandable by the computer. Input devices form the
link between the user and your game.</p>
<p>Even though you can’t directly control the input device hardware, you
can certainly control how it is interpreted in your game. Currently,
there are three primary types of user input devices:</p>
<p>•</p>
<p>The keyboard.</p>
<p>•</p>
<p>The mouse.</p>
<p>•</p>
<p>Joysticks.</p>
<p>Why the</p>
<p>Operating system such as Windows, Linux, and Macintosh have all adopt
the mouse as a standard mouse?</p>
<p>input device, so it is a nature for the mouse to be the most popular
user input device for game programming.</p>
<p>The mouse, however, does not share the wide range of input
applications to games that the keyboard has. A mouse usually has 2 or 3
buttons, or 2 buttons with one wheel, while a computer keyboard has at
least 101 keys. Additionally, the mouse was primarily designed as a
point-and-click device. The truth is many games do not follow the
point-and-click paradigm.</p>
<p>Surprisingly the mouse has the mobility to quickly move around a
given area, so it does have a recognizable usefulness, which is
dependent totally on the type of game and the type of user interaction
dictated by the game. It is very important to learn how to handle user
inputs with the mouse.</p>
<p>Mouse</p>
<p>When you move the mouse, a series of events is set off, and most
computer languages provide a Anatomy</p>
<p>series of mouse messages that are used to convey mouse events to
recognizable actions. The previous lecture discussed how the events and
event handlers work closely together to detect and respond to user's
activities. You should now try to understand how a mouse works so you
can have a better manipulation of them in your games.</p>
<p>2-button mouse</p>
<p>2 buttons with one wheel</p>
<p>3-button mouse</p>
<p>A mouse is usually equipped with 1-3 buttons. Each button is an
individual interface that sends signals to the computer. A mouse is
commonly used to make selections and position the cursor, but, in a
graphical user interfaces environment, the mouse is also used to trace
and record x- and y-coordinates of any given objects.</p>
<p>Mouse Event</p>
<p>JavaScript includes a number of event handlers for detecting mouse
actions. Your game script can Game Programming – Penn Wu</p>
<p>76</p>
<p><span id="index_split_006.html#p77"></span><img src="index-77_1.png"
class="calibre5" alt="Image 55" /></p>
<p>Handlers</p>
<p>use them detect the movement of the mouse pointer and when a button
is clicked, released, or both. They are:</p>
<p>•</p>
<p><strong>onMouseOver</strong>: The mouse is moved over an element.</p>
<p>•</p>
<p><strong>onMouseOut</strong>: The mouse is moved off an element.</p>
<p>•</p>
<p><strong>onMouseMove</strong>: The mouse is moved.</p>
<p>•</p>
<p><strong>onMouseDown</strong>: A mouse button is pressed.</p>
<p>•</p>
<p><strong>onMouseUp</strong>: A mouse button is released.</p>
<p>•</p>
<p><strong>onClick</strong>: When a mouse button is clicked.</p>
<p>•</p>
<p><strong>onDblClick:</strong> When a mouse button is double
clicked.</p>
<p><strong>The onMouseOver event hander</strong></p>
<p>The <strong>onMouseOver</strong> handler is called when the mouse
pointer moves over a link or other object. In the following example, the
onMouseOver handler tells the computer to change the image file’s source
from <strong>gopher.gif</strong> to <strong>gopher2.gif</strong> when
the play mouse over the image file. The keyword</p>
<p>“this” is used in the <strong>this.src='gopher2.gif'</strong>
statement simply because the onMouseOver handler is used inline with the
&lt;img&gt; tag.</p>
<p>&lt;img src="gopher.gif"
<strong>onMouseOver="this.src='gopher2.gif'"</strong> &gt; The
<strong>onMouseOut</strong> handler is the opposite—it is called when
the mouse pointer moves out of the object's border. Unless something
strange happens, this always happens some time after the onMouseOver
event is called.</p>
<p>&lt;img src="gopher.gif" onMouseOver="this.src='gopher2.gif'"</p>
<p><strong>onMouseOut="this.src='gopher.gif'"</strong> &gt;</p>
<p>In the above example, the onMouseOut handler changes the file source
from gopher2.gif back to gopher.gif. Guess what? This is a very commonly
used trick used to create a visual effect of an object.</p>
<p><strong>TheonMouseMove event hander</strong></p>
<p>The <strong>onMouseMove</strong> event occurs any time the mouse
pointer moves. As you might imagine, this happens quite often—the event
can trigger hundreds of times as the mouse pointer moves across a page.
For example,</p>
<p>&lt;body onMouseMove="status</p>
<p>='('+<strong>event.clientX</strong>+'
,'+<strong>event.clientY</strong>+')'";&gt;&lt;/body&gt; When moving the
mouse cursor around, a pair of <em>x</em>- and <em>y</em>-coordinate
appears on the status bar in the form of ( <em>x</em>, <em>y</em>).
Noticeably, the value of <em>x</em> and <em>y</em> will continuously
change as response to the mouse’s movement.</p>
<p><strong>The onMouseDown and onMouseUp event hander</strong></p>
<p>To give you even more control of what happens when the mouse button
is pressed, two more events are included:</p>
<p>•</p>
<p><strong>onMouseDown</strong> is used when the user presses the mouse
button.</p>
<p>•</p>
<p><strong>onMouseUp</strong> is used when the user releases the mouse
button.</p>
<p>Refer to the keyboard code of a previous lecture. You can apply
<strong>onMouseDown</strong> and <strong>onMouseUp</strong> methods to
it. For example,</p>
<p>&lt;span class="wKey" id="midC" style="left:50"
<strong>onMouseDown</strong>="CDown()"</p>
<p><strong>onMouseUp</strong>="CUp()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midD" style="left:91"
<strong>onMouseDown</strong>="DDown()"</p>
<p>Game Programming – Penn Wu</p>
<p>77</p>
<p><span
id="index_split_006.html#p78"></span><strong>onMouseUp</strong>="DUp()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midE" style="left:132"</p>
<p><strong>onMouseDown</strong>="EDown()"
<strong>onMouseUp</strong>="EUp()"&gt;&lt;/span&gt; <strong>The onClick
and onDblClick event hander</strong></p>
<p>The onMouseDown and onMouseUp event handlers are the two halves of a
mouse click. You can also use events to detect when the mouse button is
clicked. The basic event handler for this is <strong>onClick</strong>.
This event handler is called when the mouse button is clicked while
positioned over the appropriate object.</p>
<p>The <strong>onDblClick</strong> event handler is similar to onClick,
but is only used if the user double-clicks on an object. In the
following example, onClick triggers the cc() function, while onDblClick
triggers dd() function.</p>
<p>&lt;button onClick="cc()" onDblClick="dd()"&gt;Rotate&lt;/button&gt;
If you want to detect an entire click, use onClick. Use onMouseUp and
onMouseDown to detect just one or the other.</p>
<p>The event</p>
<p>Internet Explorer supports JavaScript’s event object, and it provides
the following common object’s</p>
<p>properties for record information of mouse movement. The data they
record can be retrieved as properties for</p>
<p>reference to your game if you know how to use them:</p>
<p>mouse</p>
<p>•</p>
<p><strong>event.button</strong>: The mouse button that was pressed.
This value is 1 for the left button and usually 2 for the right
button.</p>
<p>•</p>
<p><strong>event.clientX</strong>: The x-coordinate (column, in pixels)
where the event occurred.</p>
<p>•</p>
<p><strong>event.clientY</strong>: The y-coordinate (row, in pixels)
where the event occurred.</p>
<p>The <strong>event.clientX</strong> property returns the horizontal
coordinate within the application's client area at which the event
occurred (as opposed to the coordinates within the page). For example,
clicking in the top-left corner of the client area will always result in
a mouse event with a clientX value of 0, regardless of whether the page
is scrolled horizontally.</p>
<p>Similarly, <strong>event.clientY</strong> returns the horizontal
coordinate within the application's client area at which the event
occurred (as opposed to the coordinates within the page). For example,
clicking in the top-left corner of the client area will always result in
a mouse event with a clientX value of 0, regardless of whether the page
is scrolled horizontally.</p>
<p>Syntax is:</p>
<p>event.clientX;</p>
<p>and</p>
<p>event.clientY</p>
<p>For example,</p>
<p>&lt;html&gt;</p>
<p>&lt;body onMouseMove="p1.innerText</p>
<p>='('+<strong>event.clientX</strong>+'
,'+<strong>event.clientY</strong>+')'";&gt;</p>
<p>&lt;p id=p1&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>When executing the code, you will see a ( <em>x</em>, <em>y</em>)
coordinate set in the body area.</p>
<p>Game Programming – Penn Wu</p>
<p>78</p>
<p><span id="index_split_006.html#p79"></span><img src="index-79_1.png"
class="calibre5" alt="Image 56" /></p>
<p><img src="index-79_2.png" class="calibre5" alt="Image 57" /></p>
<p><img src="index-79_3.png" class="calibre5" alt="Image 58" /></p>
<p>Consider the following code. It creates a red area starting at the
point (100px, 100px) with a width of 100px and height of 50px.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.ar {position:absolute; left:100px; top:100px;</p>
<p>width:100px; height:50px;</p>
<p>background-Color:red; border:solid 1 red}</p>
<p>&lt;/style&gt;</p>
<p>&lt;body onMouseMove=cc()&gt;</p>
<p>&lt;div class=ar id=area1&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>By adding the following bold lines, which means “when the mouse
cursor’s <em>y</em>-coordinate between 100px and 150px change the
background color to white; otherwise, set the background color to
red”.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.ar {position:absolute; left:100px; top:100px;</p>
<p>width:100px; height:50px;</p>
<p>background-Color:red; border:solid 1 red}</p>
<p>&lt;/style&gt;</p>
<p><strong>&lt;script&gt;</strong></p>
<p><strong>function cc() {</strong></p>
<p><strong>if ((event.clientY &gt;= 100) &amp;&amp; (event.clientY &lt;=
150)) {</strong></p>
<p><strong>area1.style.backgroundColor="white";</strong></p>
<p><strong>}</strong></p>
<p><strong>else {</strong></p>
<p><strong>area1.style.backgroundColor="red";</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong>&lt;/script&gt;</strong></p>
<p><strong></strong></p>
<p>&lt;body onMouseMove=cc()&gt;</p>
<p>&lt;div class=ar id=area1&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Notice that the <strong>onMouseMove</strong> handler is placed inside
the &lt;body&gt; tag, which means “when the mouse is moved around the
body area”.</p>
<p>to</p>
<p>Game Programming – Penn Wu</p>
<p>79</p>
<p><span id="index_split_006.html#p80"></span><img src="index-80_1.png"
class="calibre5" alt="Image 59" /></p>
<p><img src="index-80_2.png" class="calibre5" alt="Image 60" /></p>
<p>The <strong>event.button</strong> property is used to determine which
mouse button has been clicked. To safely detect a mouse button you have
to use the <strong>onMouseDown</strong> or <strong>onMouseUp</strong>
events.</p>
<p>In the previous lecture, there was a explanation about how you could
use the <strong>onMouseDown</strong> event handler to trigger the cc()
function in the following example. This code is also a good example for
the <strong>event.button</strong> property.</p>
<p>Again, the event.button property is designed to set or retrieve the
mouse button pressed by the user. Possible values of the
<strong>event.button</strong> property for Internet Explorer are: 0</p>
<p>Default. No button is pressed.</p>
<p>1</p>
<p>Left button is pressed.</p>
<p>2</p>
<p>Right button is pressed.</p>
<p>3</p>
<p>Left and right buttons are both pressed.</p>
<p>4</p>
<p>Middle button is pressed.</p>
<p>5</p>
<p>Left and middle buttons both are pressed.</p>
<p>6</p>
<p>Right and middle buttons are both pressed.</p>
<p>7</p>
<p>All three buttons are pressed.</p>
<p>Inside the cc() function, the button property of the event object (as
in <strong>event.button</strong>) passes the mouse button value to the
variable <em>i</em>. This value is then used to decide which .gif file
to be displayed: 1 for car_left.gif, and 2 for car_right.gif.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>var i = <strong>event.button</strong>;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>p1.innerHTML = "&lt;img src='car_left.gif'&gt;"; break; case 2:</p>
<p>p1.innerHTML = "&lt;img src='car_right.gif'&gt;"; break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onMouseDown=cc() <strong>onContextMenu="return
false"</strong> &gt;</p>
<p>&lt;p id=p1&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>When clicking either the left or right mouse button, one of the .gif
file appears: or</p>
<p>In this case, the event.button returns a numerical value to the
computer. The computer in turn gives it to the variable <em>i</em> for
evaluation. Notice that this property is read/write. The property has a
default value of 0. This property is used with the
<strong>onmousedown</strong>, <strong>onmouseup</strong>, and
<strong>onmousemove</strong> events. For other events, it defaults to 0
regardless of the state of the mouse buttons.</p>
<p>In addition to <strong>clientX</strong>, <strong>clientY</strong>,
and <strong>button</strong> properties, Internet Explorer also works
with the following properties of the event object.</p>
<p>event.offsetX sets or retrieves the x-coordinate of the mouse
pointer's position relative to the object firing the event.</p>
<p>Game Programming – Penn Wu</p>
<p>80</p>
<p><span id="index_split_006.html#p81"></span><img src="index-81_1.png"
class="calibre5" alt="Image 61" /></p>
<p>event.offsetY Sets or retrieves the y-coordinate of the mouse
pointer's position relative to the object firing the event.</p>
<p>event.screenX sets and retrieves the x-coordinate of the mouse
pointer's position relative to the user's screen.</p>
<p>event.screenY sets or retrieves the y-coordinate of the mouse
pointer's position relative to the user's screen.</p>
<p>event.x</p>
<p>sets or retrieves the x-coordinate, in pixels, of the mouse pointer's
position relative to a relatively positioned parent element.
Technically, this property is similar to clientX.</p>
<p>event.y</p>
<p>sets or retrieves the y-coordinate, in pixels, of the mouse pointer's
position relative to a relatively positioned parent element.
Technically, this property is similar to clientY.</p>
<p>The following figure illustrates the starting point of these
properties.</p>
<p>screenX, screenY</p>
<p>clientX, clientY</p>
<p>offsetX, offsetY</p>
<p>The following example demonstrates how these properties are different
from each other. Be sure to run this code to see for yourself.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>p1.innerText = "(offsetX, offsetY)= (" + event.offsetX + " ," +</p>
<p>event.offsetY +")";</p>
<p>p2.innerText = "(clientX, clientY)= (" + event.clientX + " ," +</p>
<p>event.clientY +")";</p>
<p>p3.innerText = "(screenX, screenY)= (" + event.screenX + " ," +</p>
<p>event.screenY +")";</p>
<p>p4.innerText="(x, y)= (" + event.x + " ," + event.y +")";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;span id=p1&gt;&lt;/span&gt;&lt;br&gt;</p>
<p>&lt;span id=p2&gt;&lt;/span&gt;&lt;br&gt;</p>
<p>&lt;span id=p3&gt;&lt;/span&gt;&lt;br&gt;</p>
<p>&lt;span id=p4&gt;&lt;/span&gt;&lt;br&gt;</p>
<p>&lt;body onMouseMove=cc()&gt;</p>
<p>&lt;div style="position:absolute; width:300;height:300;</p>
<p><strong>left:100;top:100</strong>;background-Color:red"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>81</p>
<p><span id="index_split_006.html#p82"></span><img src="index-82_1.png"
class="calibre5" alt="Image 62" /></p>
<p><img src="index-82_2.png" class="calibre5" alt="Image 63" /></p>
<p>&lt;/html&gt;</p>
<p>When executing this code, move the cursor around the red area and
compare the x- and y-coordinates of them.</p>
<p>(offsetX, offsetY)=(100 ,102)</p>
<p>(clientX, clientY)=(202 ,204)</p>
<p>(screenX, screenY)=(549 ,433)</p>
<p>(x, y)=(202 ,204)</p>
<p>The difference between (offsetX, offsetY) and (clientX, clientY) was
caused by the following setting of the above code, which sets the
starting point of the red area as (100, 100), while the starting point
of the browser’s body area remains being (0, 0):
<strong>left:100;top:100</strong>;</p>
<p>Disable right</p>
<p>One annoying feature of the GUI (graphical user interfaces) is its
support of mouse right click, click</p>
<p>especially when the right click is used to trigger some menu. For
example, when you right click on a blank space of the browser’s body
area, the following menu pops up.</p>
<p>This menu may disgrace your game programs, so many programmers choose
to disable it. To do so, simply add the bold section to the &lt;body&gt;
tag.</p>
<p>&lt;body <strong>onContextMenu="return false"</strong> &gt;</p>
<p>Test the code in Internet Explorer 5.0 or later. When you attempt to
right-click anywhere on the page, the shortcut menu is not
displayed.</p>
<p>Another solution is to redefine what the right click should do. For
example, in the following code, the right click is now used to trigger
the <strong>new_right_click()</strong> function.</p>
<p>&lt;html&gt;</p>
<p>&lt;script language="JavaScript"&gt;</p>
<p>function new_right_click() {</p>
<p>g1.style.display="inline";</p>
<p>}</p>
<p>function click(e) {</p>
<p>if (document.all) {</p>
<p>if (event.button == 2) {</p>
<p>Game Programming – Penn Wu</p>
<p>82</p>
<p><span id="index_split_006.html#p83"></span><img src="index-83_1.png"
class="calibre5" alt="Image 64" /></p>
<p><img src="index-83_2.png" class="calibre5" alt="Image 65" /></p>
<p><img src="index-83_3.png" class="calibre5" alt="Image 66" /></p>
<p><img src="index-83_4.png" class="calibre5" alt="Image 67" /></p>
<p><img src="index-83_5.png" class="calibre5" alt="Image 68" /></p>
<p><img src="index-83_6.png" class="calibre5" alt="Image 69" /></p>
<p><img src="index-83_7.png" class="calibre5" alt="Image 70" /></p>
<p><img src="index-83_8.png" class="calibre5" alt="Image 71" /></p>
<p><img src="index-83_9.png" class="calibre5" alt="Image 72" /></p>
<p><img src="index-83_10.png" class="calibre5" alt="Image 73" /></p>
<p><img src="index-83_11.png" class="calibre5" alt="Image 74" /></p>
<p>new_right_click();</p>
<p>return false;</p>
<p>}</p>
<p>}</p>
<p>if (document.layers) {</p>
<p>if (e.which == 3) {</p>
<p>new_right_click();</p>
<p>return false;</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>if (document.layers) {</p>
<p>document.captureEvents(Event.MOUSEDOWN);</p>
<p>}</p>
<p>document.onmousedown=click;</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;img id=g1 src=cat.gif style="display:none"&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>Execute the code, and right click the mouse. The cat appears, but the
above menu won’t.</p>
<p>The cursor</p>
<p>With CSS, you can change the value of the cursor declaration to use
different cursor styles to shape</p>
<p>enhance the appearance of your game. The syntax is:</p>
<p>element { cursor: Value }</p>
<p>where <em>element</em> is any HTML tag or user-declared style name,
<em>cursor</em> is a keyword, and <em>value</em> is the anyone from the
following list.</p>
<p><strong>Look</strong></p>
<p><strong>Values</strong></p>
<p><strong>Example</strong></p>
<p>default</p>
<p>cursor:default</p>
<p>crosshair</p>
<p>cursor:crosshair</p>
<p>hand</p>
<p>cursor:hand</p>
<p>pointer</p>
<p>cursor:pointer</p>
<p>Cross browser</p>
<p>cursor:pointer;cursor:hand</p>
<p>move</p>
<p>cursor:move</p>
<p>text</p>
<p>cursor:text</p>
<p>wait</p>
<p>cursor:wait</p>
<p>help</p>
<p>cursor:help</p>
<p>n-resize</p>
<p>cursor:n-resize</p>
<p>Game Programming – Penn Wu</p>
<p>83</p>
<p><span id="index_split_006.html#p84"></span><img src="index-84_1.png"
class="calibre5" alt="Image 75" /></p>
<p><img src="index-84_2.png" class="calibre5" alt="Image 76" /></p>
<p><img src="index-84_3.png" class="calibre5" alt="Image 77" /></p>
<p><img src="index-84_4.png" class="calibre5" alt="Image 78" /></p>
<p><img src="index-84_5.png" class="calibre5" alt="Image 79" /></p>
<p><img src="index-84_6.png" class="calibre5" alt="Image 80" /></p>
<p><img src="index-84_7.png" class="calibre5" alt="Image 81" /></p>
<p><img src="index-84_8.png" class="calibre5" alt="Image 82" /></p>
<p><img src="index-84_9.png" class="calibre5" alt="Image 83" /></p>
<p><img src="index-84_10.png" class="calibre5" alt="Image 84" /></p>
<p><img src="index-84_11.png" class="calibre5" alt="Image 85" /></p>
<p><img src="index-84_12.png" class="calibre5" alt="Image 86" /></p>
<p><img src="index-84_13.png" class="calibre5" alt="Image 87" /></p>
<p><img src="index-84_14.png" class="calibre5" alt="Image 88" /></p>
<p>ne-resize</p>
<p>cursor:ne-resize</p>
<p>e-resize</p>
<p>cursor:e-resize</p>
<p>se-resize</p>
<p>cursor:se-resize</p>
<p>s-resize</p>
<p>cursor:s-resize</p>
<p>sw-resize</p>
<p>cursor:sw-resize</p>
<p>w-resize</p>
<p>cursor:w-resize</p>
<p>nw-resize</p>
<p>cursor:nw-resize</p>
<p>progress</p>
<p>cursor:progress</p>
<p>not-allowed</p>
<p>cursor:not-allowed</p>
<p>no-drop</p>
<p>cursor:no-drop</p>
<p>vertical-text</p>
<p>cursor:vertical-text</p>
<p>all-scroll</p>
<p>cursor:all-scroll</p>
<p>col-resize</p>
<p>cursor:col-resize</p>
<p>row-resize</p>
<p>cursor:row-resize</p>
<p>For example, when you mouse the cursor on top of the image file, the
cursor turns into a cross.</p>
<p>&lt;img src="gopher.gif" style=" <strong>cursor:
crosshair</strong>"&gt; You can even use your own custom images as
cursors. The syntax is: element { cursor : url("FileName"), value }</p>
<p>Notice that the <strong>.cur</strong> extension refers to the file
extension for the Windows Cursor file. This is one format that cursors
(the mouse pointer design) can be stored in, under Microsoft Windows 3.x
and later. In Windows 95, NT and later, this format has been largely
superseded by the ANI format which allows animated and color cursor
designs.</p>
<p>The CUR format also allows transparency so that cursors do not have
to appear rectangular when displayed on screen. For example,</p>
<p>body { cursor : url("custom.cur"), pointer }</p>
<p>Note: The custom images as cursors is only supported in Internet
Explorer 6.0 or later, which is why we also included pointer, so if the
browser dose not support custom cursors at least the default pointer
will be displayed.</p>
<p>In the following game, the mouse cursor is changed to a graphic of
pen, so it creates a visual effect of writing on the browser's body area
using a pen.</p>
<p>Game Programming – Penn Wu</p>
<p>84</p>
<p><span id="index_split_006.html#p85"></span><img src="index-85_1.png"
class="calibre5" alt="Image 89" /></p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.dots {position:absolute;font-size:30}</p>
<p><strong>body {</strong></p>
<p><strong>cursor : url("pencil.cur"), pointer</strong></p>
<p><strong>}</strong></p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>x = event.clientX;</p>
<p>y = event.clientY;</p>
<p>codes = "&lt;span class=dots style='left: " + x;</p>
<p>codes += "; top: " + y +"'&gt;.&lt;/span&gt;"; area1.innerHTML +=
codes;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onMouseMove=cc()&gt;</p>
<p>&lt;div id=area1&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>A sample output looks:</p>
<p>The cursor changes to</p>
<p>a pencil</p>
<p>Review</p>
<p>1. Which is the event handler that functions only when the mouse is
moved off an element?</p>
<p>Questions</p>
<p>A. onMouseOver</p>
<p>B. onMouseOut</p>
<p>C. onMouseMove</p>
<p>D. onMouseDown</p>
<p>2. The onMouseDown and onMouseUp together makes the function of
__.</p>
<p>A. onMouseClick</p>
<p>B. onClick</p>
<p>C. onKeyClick</p>
<p>D. onButtonClick</p>
<p>3. Given the following code block, which statement is correct?</p>
<p>&lt;img src="gopher.gif" onMouseOver="this.src='gopher2.gif'"&gt; A.
The onMouseOver handler change the image file’s source from gopher2.gif
to gopher.gif.</p>
<p>B. The onMouseOver handler change the image file’s source from
gopher.gif to gopher2.gif.</p>
<p>Game Programming – Penn Wu</p>
<p>85</p>
<p><span id="index_split_006.html#p86"></span>C. The word "this" in
this.src='gopher2.gif' refers to the gopher2.gif image file D.
onMouseOver must be replaced with onMouseMove to make this code
work.</p>
<p>4. Which code block is equivalent to the following one?</p>
<p>&lt;body onMouseMove="status</p>
<p>='('+event.clientX+' ,'+event.clientY+')'";&gt;&lt;/body&gt; A.
&lt;body onMouseMove="status='('+event.X+'
,'+event.Y+')'";&gt;&lt;/body&gt; B. &lt;body
onMouseMove="status='('+client.X+' ,'+client.Y+')'";&gt;&lt;/body&gt; C.
&lt;body onMouseMove="status='('+X+' ,'+Y+')'";&gt;&lt;/body&gt; D.
&lt;body onMouseMove="status='('+clientX+'
,'+clientY+')'";&gt;&lt;/body&gt; 5. Which statement about event.button
is correct?</p>
<p>A. This value is 0 for the left button and usually 1 for the right
button.</p>
<p>B. This value is 1 for the left button and usually 2 for the right
button.</p>
<p>C. This value is 0 for the left button and usually 2 for the right
button.</p>
<p>D. This value is 1 for the left button and usually 4 for the right
button.</p>
<p>6. Which sets or retrieves the y-coordinate of the mouse pointer's
position relative to the object firing the event?</p>
<p>A. event.offsetY</p>
<p>B. event.clientY</p>
<p>C. event.screenY</p>
<p>D. event.Y</p>
<p>7. Which can disable the right click function?</p>
<p>A. &lt;body onMenuClick="return false"&gt;</p>
<p>B. &lt;body onRightClick="return false"&gt;</p>
<p>C. &lt;body onContextMenu="return false"&gt;</p>
<p>D. &lt;body onContextClick="return false"&gt;</p>
<p>8. Which is the correct way to change the mouse cursor to a question
mark?</p>
<p>A. cursor:wait</p>
<p>B. cursor:question</p>
<p>C. cursor:mark</p>
<p>D. cursor:help</p>
<p>9. The .cur file extension refers to __.</p>
<p>A. Windows Cursor file</p>
<p>B. Windows icon file</p>
<p>C. Windows graphic file</p>
<p>D. Windows screen saver file</p>
<p>10. In Internet Explorer, which value of event.button indicates all
three buttons are pressed?</p>
<p>A. 7</p>
<p>B. 6</p>
<p>C. 5</p>
<p>D. 3</p>
<p>Game Programming – Penn Wu</p>
<p>86</p>
<p><span id="index_split_006.html#p87"></span><img src="index-87_1.png"
class="calibre5" alt="Image 90" /></p>
<p>Lab #5</p>
<p>Using mouse buttons for input control</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab5.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Using custom mouse cursor</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab5_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.dots {position:absolute;font-size:30}</p>
<p><strong>body {</strong></p>
<p><strong>cursor : url("pencil.cur"), pointer</strong></p>
<p><strong>}</strong></p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>code = "";</p>
<p>function cc() {</p>
<p>x = event.clientX;</p>
<p>y = event.clientY;</p>
<p>code += "&lt;span class=dots style='left: " + x +"; top: " + y
+"'&gt;.&lt;/span&gt;"; area1.innerText = "";</p>
<p>area1.innerHTML = code;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onMouseMove=cc()&gt;</p>
<p>&lt;div id=area1&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p>The cursor changes to</p>
<p>a pencil</p>
<p><strong>Learning Activity #2: Angry cat</strong></p>
<p>Game Programming – Penn Wu</p>
<p>87</p>
<p><span id="index_split_006.html#p88"></span><img src="index-88_1.png"
class="calibre5" alt="Image 91" /></p>
<p><img src="index-88_2.png" class="calibre5" alt="Image 92" /></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>4. Change to the C:\games directory.</p>
<p>5. Use Notepad to create a new file named
<strong>C:\games\lab5_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function anger() {</p>
<p>cat.src='cat.gif'</p>
<p>setTimeout("cat.src='cat1.gif'", 1000);</p>
<p>cat.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth -</p>
<p>cat.style.pixelWidth));</p>
<p>cat.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight -</p>
<p>cat.style.pixelHeight));</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;div id=area1&gt;</p>
<p>&lt;img id="cat" src=cat1.gif onMouseOver="anger()"
style="position:absolute"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/html&gt;</p>
<p>6. Test the program. Move the cursor to approach the cat, the cat
jumps and get angry. A sample output looks: Original</p>
<p>Angry cat</p>
<p><strong>Learning Activity #3: A simple Tic-Tac-Toe</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab5_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;style&gt;</p>
<p>.dragme {position:relative;}</p>
<p>area2, area3 { position:absolute }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>codes = "&lt;table border=1 cellspacing=0&gt;";</p>
<p>for (i=1; i&lt;=3; i++) {</p>
<p>Game Programming – Penn Wu</p>
<p>88</p>
<p><span id="index_split_006.html#p89"></span><img src="index-89_1.png"
class="calibre5" alt="Image 93" /></p>
<p>codes += "&lt;tr height=54&gt;&lt;td
width=54&gt;&amp;nbsp;&lt;/td&gt;"; codes += "&lt;td
width=54&gt;&amp;nbsp;&lt;/td&gt;";</p>
<p>codes += "&lt;td width=54&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;";</p>
<p>}</p>
<p>codes += "&lt;table&gt;";</p>
<p>area1.innerHTML= codes;</p>
<p>}</p>
<p>function insertx() {</p>
<p>area2.innerHTML += "&lt;img src=x.gif class='dragme'&gt;";</p>
<p>}</p>
<p>function inserto() {</p>
<p>area3.innerHTML += "&lt;img src=o.gif class='dragme'&gt;";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body onLoad="cc()"&gt;</p>
<p>&lt;span id=area1&gt;&lt;/span&gt;</p>
<p>&lt;div id=area2 onMouseUp=insertx()&gt;&lt;img id=x0 src=x.gif
class=dragme&gt;&lt;/div&gt;</p>
<p>&lt;div id=area3 onMouseUp=inserto()&gt;&lt;img id=o0 src=o.gif
class=dragme&gt;&lt;/div&gt;</p>
<p>&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #4: A simple Roulette wheel</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game. <strong>A later lecture will
explain how the ball can move in</strong> <strong>a circle</strong>.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab5_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var r=120; a=0;</p>
<p>function cc() {</p>
<p>b1.style.left=197+r*Math.sin(a);</p>
<p>b1.style.top=197+r*Math.cos(a);</p>
<p>if (a &gt;= Math.PI *2) { a=0; }</p>
<p>else { a += Math.PI/180; }</p>
<p>Game Programming – Penn Wu</p>
<p>89</p>
<p><span id="index_split_006.html#p90"></span><img src="index-90_1.png"
class="calibre5" alt="Image 94" /></p>
<p>rotating=setTimeout("cc()", 2);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;img id=b1 src="white_ball.gif" style="position:absolute;
z-index:1; left:20; top:20"&gt;</p>
<p>&lt;img src=wheel.gif style="position:absolute;</p>
<p>z-index:0; left:0; top:0"&gt;</p>
<p>&lt;div style="position:absolute; left:50; top:400;"&gt;</p>
<p>&lt;button onClick="cc()"&gt;Rotate&lt;/button&gt;</p>
<p>&lt;button onClick=clearTimeout(rotating)&gt;Stop&lt;/button&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;html&gt;</p>
<p>3. Test the program. Click the Rotate button to start, and Stop to
stop. A sample output looks: <strong>Learning Activity #5: Mini Monopoly
Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Copy the lab5_5.htm (the one you downloaded previously) to the
C:\games directory.</p>
<p>3. Use Notepad to open the <strong>C:\games\lab5_5.htm</strong> file,
and add the following bold lines between &lt;html&gt; and</p>
<p>&lt;body&gt; tags. (this part of code import the dragndrop.js library
file and a function dice()):</p>
<p>&lt;html&gt;</p>
<p><strong></strong></p>
<p><strong>&lt;head&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;style&gt;</strong></p>
<p><strong>.dragme{position:relative;}</strong></p>
<p><strong>td {
font-size:11px;text-align:center;font-family:arial}</strong></p>
<p><strong>.cards {position:absolute; width:120; height:60;</strong></p>
<p><strong>border:solid 1 black; text-align:center;
font-size:16px;</strong></p>
<p><strong>color:white; }</strong></p>
<p><strong>&lt;/style&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;script&gt;</strong></p>
<p><strong></strong></p>
<p><strong>function init() {</strong></p>
<p><strong>for (i=1;i&lt;=2;i++) {</strong></p>
<p>Game Programming – Penn Wu</p>
<p>90</p>
<p><span id="index_split_006.html#p91"></span><strong>var
k=Math.floor(Math.random()*6)+1;</strong></p>
<p><strong>area1.innerHTML += "&lt;img src=d"+k+".gif border=2&gt;
";</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p><strong>function dice() {</strong></p>
<p><strong>area1.innerText="";</strong></p>
<p><strong>for (i=1;i&lt;=2;i++) {</strong></p>
<p><strong>var k=Math.floor(Math.random()*6)+1;</strong></p>
<p><strong>area1.innerHTML += "&lt;img src=d"+k+".gif border=2&gt;
";</strong></p>
<p><strong>}</strong></p>
<p><strong>tossing=setTimeout("dice()", 50);</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p><strong>function chancewShow() {</strong></p>
<p><strong>cchance.style.backgroundColor="white";</strong></p>
<p><strong>cchance.style.fontSize="10px";</strong></p>
<p><strong>cchance.style.color="black";</strong></p>
<p><strong>var j = Math.floor(Math.random()*3);</strong></p>
<p><strong>switch (j) {</strong></p>
<p><strong>case 0: cchance.innerText="You won $50!"; break;</strong></p>
<p><strong>case 1: cchance.innerText="You lost $100!"; break;</strong>
<strong>case 2: cchance.innerText="Speeding fine, $20!";
break;</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p><strong>function chestShow() {</strong></p>
<p><strong>cchest.style.backgroundColor="white";</strong></p>
<p><strong>cchest.style.fontSize="10px";</strong></p>
<p><strong>cchest.style.color="black";</strong></p>
<p><strong>var j = Math.floor(Math.random()*3);</strong></p>
<p><strong>switch (j) {</strong></p>
<p><strong>case 0: cchest.innerText="Christmas donation, $50!";
break;</strong> <strong>case 1: cchest.innerText="State Tax $100!";
break;</strong> <strong>case 2: cchest.innerText="You won the lottery of
$20!"; break;</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p><strong>function cover() {</strong></p>
<p><strong>cchance.style.backgroundColor="red";</strong></p>
<p><strong>cchance.style.fontSize="16px";</strong></p>
<p><strong>cchance.style.color="white";</strong></p>
<p><strong>cchance.innerText="Chance";</strong></p>
<p><strong></strong></p>
<p><strong>cchest.style.backgroundColor="green";</strong></p>
<p><strong>cchest.style.fontSize="16px";</strong></p>
<p><strong>cchest.style.color="white";</strong></p>
<p><strong>cchest.innerText="Community Chest";</strong></p>
<p><strong>}</strong></p>
<p><strong>&lt;/script&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</strong></p>
<p><strong>&lt;/head&gt;</strong></p>
<p><strong></strong></p>
<p>&lt;/body&gt;</p>
<p>4. Replace the &lt;body&gt; tag with the following line:</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>5. At the end of the code, add the following bold lines between
&lt;/table&gt; and &lt;/body&gt; tags:</p>
<p>&lt;/table&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>91</p>
<p><span id="index_split_006.html#p92"></span><img src="index-92_1.png"
class="calibre5" alt="Image 95" /></p>
<p><img src="index-92_2.png" class="calibre5" alt="Image 96" /></p>
<p><img src="index-92_3.png" class="calibre5" alt="Image 97" /></p>
<p><strong>&lt;/td&gt;&lt;td&gt;</strong></p>
<p><strong>&lt;span id=area1&gt;&lt;/span&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;div class="cards" id="cchance" style="left:200;
top:150;</strong> <strong>background-Color:red;"
onClick="chancewShow()"&gt;Chance&lt;/div&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;div class="cards" id="cchest" style="left:310;
top:270;</strong> <strong>background-Color:green;"
onClick="chestShow()"&gt;Community Chest&lt;/div&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;button onMouseDown="dice();cover()"
onMouseUp=clearTimeout(tossing)&gt;Toss</strong>
<strong>Dice&lt;/button&gt;</strong></p>
<p><strong>&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;img src="08_castle.gif" class="dragme"&gt;</strong></p>
<p><strong>&lt;img src="15_Knight.gif" class="dragme"&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>6. Test the program. To play, first move the two chess pieces to the
Go cell. Toss the dice, calculate the points, and move forwards. Click
either Chance or Community block when you arrive at one of them. A
sample output looks:</p>
<p>initial</p>
<p>Toss dice and move chess piece</p>
<p>Reading community chest</p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 05, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab5_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab5_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab5_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab5_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab5_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>92</p>
<p><span id="index_split_006.html#p93"></span><img src="index-93_1.png"
class="calibre5" alt="Image 98" /></p>
<p>Lecture #6</p>
<p>Using keyboard for input control</p>
<p><span id="index_split_007.html"></span></p>
<h2 class="calibre2"
id="index_split_007.html#calibre_pb_6">Introduction</h2>
<p>The keyboard has been the computer input device for the longest time,
even since the old days when there was no such thing called mouse and
graphical user interface. As a matter of fact, even today, the keyboard
is still a useful input device for a wide range of games. For example,
any game involving the player moving an object around will benefit from
using the arrow keys. In this lecture, you will learn many games that
uses the arrow keys to move objects.</p>
<p>Basic</p>
<p>JavaScript support some keyboard event handlers, which are very
useful in responding to the user keyboard-input when keys on a keyboard
are pressed. These events are what make it possible for JavaScript
related event</p>
<p>to “react” when a key is pressed:</p>
<p>handlers</p>
<p>Table: Keyboard related event handlers</p>
<p><strong>Event handler</strong></p>
<p><strong>functions</strong></p>
<p>Onkeypress</p>
<p>invokes JavaScript code when a key is pressed</p>
<p>Onkeydown</p>
<p>invokes JavaScript code when a key is held down (but not yet</p>
<p>released)</p>
<p>onkeyup</p>
<p>invokes JavaScript code when a key is has been released after being
pressed.</p>
<p>These events can be bind to most elements on a game page. But, you
will probably stick to either the “document” element in most cases. For
example, the code below uses the <strong>onkeypress</strong> property of
the <strong>document</strong> element to call the <strong>show</strong>
function, which in turns changes the display attribute’s value from
“<strong>none</strong>” to “<strong>inline</strong>”. In other words,
when the user presses any key, the <strong>cat.gif</strong> appears.</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>function show(){</p>
<p>m1.style.display="inline";</p>
<p>}</p>
<p>document. <strong>onkeypress</strong>=show;</p>
<p>&lt;/script&gt;</p>
<p>&lt;img id=m1 src="cat.gif" style="display:none"&gt; In the following
example, the <strong>onKeyDown</strong> is used to display the time the
page was loaded, while <strong>onKeyUp</strong> displays the current
time.</p>
<p>&lt;script&gt;</p>
<p>function init_time() {</p>
<p>init_time = Date();</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init_time()</p>
<p>onKeyDown="t1.innerText=init_time"</p>
<p>onKeyUp="t2.innerText=Date()"&gt;</p>
<p>Starting time: &lt;b id=t1&gt;&lt;/b&gt;&lt;br&gt;</p>
<p>Ending time: &lt;b id=t2&gt;&lt;/b&gt;</p>
<p>A sample output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>93</p>
<p><span id="index_split_007.html#p94"></span><img src="index-94_1.png"
class="calibre5" alt="Image 99" /></p>
<p><img src="index-94_2.png" class="calibre5" alt="Image 100" /></p>
<p>To further demonstrate how the keyboard-related even handlers work in
game programming, create a new project called kb.htm with the following
contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;body <strong>onkeydown</strong>=cc()&gt;</p>
<p>&lt;div id=area1 style="border:solid 1 black;</p>
<p>background-color:#abcdef;</p>
<p>width:300; height:300;"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;img id=ball src="ball.gif" style="top:315;</p>
<p>left:10; position:absolute"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Use Internet Explorer to run the code. It creates a pale-blue area
with a rolling ball below it.</p>
<p>The &lt;body&gt; tag contains an <strong>onKeyDown</strong></p>
<p>event, which will detect if the user ever</p>
<p>presses any key.</p>
<p>A user-defined function <strong>cc()</strong> is assigned to the</p>
<p>onKeyDown event handler, although it is not</p>
<p>yet created. You will soon create and define</p>
<p>what this cc() function can do.</p>
<p>The <strong>&lt;div&gt;</strong> and <strong>&lt;/div&gt;</strong>
defines the pale-blue area. All its properties, such as border,</p>
<p>background color, width, and height, are</p>
<p>defined using CSS. The id attribute simply</p>
<p>defines the ID of this area.</p>
<p>The &lt;img&gt; tag loads the animated gif file. It also uses CSS to
define properties. Noticeably, the position is set to be absolute, which
means the position value set <strong>(top, left)</strong> is based on
the Web browser’s origin. The ID of the gif file is ball.</p>
<p>The KeyCode</p>
<p>The <strong>keyCode</strong> property of the Event object returns
UniCode value of key pressed. The returned value is the key's numerical
value, not the American National Standards Institute (ANSI) value.</p>
<p>You can use keyCode to detect when the user has pressed an arrow or
function key, which cannot be specified by the key property.</p>
<p>The syntax is:</p>
<p>event.keyCode</p>
<p>For example, you can display each key’s key code on the status bar by
using the following code:</p>
<p>&lt;body onKeyDown="status=event.keyCode"&gt;</p>
<p>Press the Alt key, you see a value 18 on the status bar:</p>
<p>Table: Common Key Codes</p>
<p>Game Programming – Penn Wu</p>
<p>94</p>
<p><span id="index_split_007.html#p95"></span><strong>Key
Code</strong></p>
<p><strong></strong></p>
<p><strong>Key Code</strong></p>
<p><strong></strong></p>
<p><strong>Key Code</strong></p>
<p><strong></strong></p>
<p><strong>Key Code</strong></p>
<p>A 65</p>
<p>0 48</p>
<p>+ 107</p>
<p>[Alt] 18</p>
<p>B 66</p>
<p>1 49</p>
<p>- 109</p>
<p>[Enter] 13</p>
<p>C 67</p>
<p>2 50</p>
<p>* 106</p>
<p>[Shift] 16</p>
<p>D 68</p>
<p>3 51</p>
<p>/ 111</p>
<p>[Ctrl] 17</p>
<p>E 69</p>
<p>4 52</p>
<p>` 192</p>
<p>[CapsLock] 20</p>
<p>F 70</p>
<p>5 53</p>
<p>, 188</p>
<p>[Esc] 27</p>
<p>G 71</p>
<p>6 54</p>
<p>. 190</p>
<p>[Backspace] 8</p>
<p>H 72</p>
<p>7 55</p>
<p>/ 191</p>
<p>[Insert] 45</p>
<p>I 73</p>
<p>8 56</p>
<p>; 186</p>
<p>[Home] 36</p>
<p>J 74</p>
<p>9 57</p>
<p>‘ 222</p>
<p>[PageUp] 33</p>
<p>K 75</p>
<p>F1 112</p>
<p>[ 219</p>
<p>[Delete] 46</p>
<p>L 76</p>
<p>F2 113</p>
<p>] 221</p>
<p>[End] 35</p>
<p>M 77</p>
<p>F3 114</p>
<p>\ 220</p>
<p>[PageDown] 34</p>
<p>N 78</p>
<p>F4 115</p>
<p>= 187</p>
<p>[PrintScreen]</p>
<p>O 79</p>
<p>F5 116</p>
<p>[ScrollLock] 145</p>
<p>P 80</p>
<p>F6 117</p>
<p>[Pause] 19</p>
<p>Q 81</p>
<p>F7 118</p>
<p>R 82</p>
<p>F8 119</p>
<p>S 83</p>
<p>F9 120</p>
<p>T 84</p>
<p>F10 121</p>
<p>U 85</p>
<p>F11 122</p>
<p>V 86</p>
<p>F12 123</p>
<p>W 87</p>
<p>← 37</p>
<p>X 88</p>
<p>↑ 38</p>
<p>Y 89</p>
<p>→ 39</p>
<p>Z 90</p>
<p>↓ 40</p>
<p>You can create a function <strong>cc()</strong> and use the keyCode
property of the event object to determine weather or not the user
presses the <strong>Left</strong> arrow key (←). This Left arrow key has
a numerical value 37. A simple <strong>if..then</strong> decisive logic
can make this decision.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>if(event.keyCode==37) {</p>
<p>ball.style.pixelLeft -= 10;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onkeydown=cc()&gt;</p>
<p>&lt;div id=area1 style="border:solid 1 black;</p>
<p>background-color:#abcdef;</p>
<p>width:300; height:300;"&gt;</p>
<p>&lt;img id=ball src="ball.gif" style="top:10;left:10;
position:relative"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>In the following line, “ball” is the ID of the gif file, so
“ball.style.left” represents the horizontal value of the position value
set <strong>(top, left)</strong>. “<strong>style</strong>” is a keyword
that indicates Cascading Style Sheet.</p>
<p>ball.style.pixelLeft -= 10;</p>
<p>The original value of “ball.style.left” is set to the 10, as
specified by “left:10”. The above line is techinically the same as:</p>
<p>Game Programming – Penn Wu</p>
<p>95</p>
<p><span id="index_split_007.html#p96"></span></p>
<p>ball.style.pixelLeft = ball.style.pixelLeft - 10;</p>
<p>In the old days, the above line would look:</p>
<p>ball.style.left = eval(ball.style.left.replace('px','')) - 10;</p>
<p>The difference between <strong>left</strong> and
<strong>pixelLeft</strong> is that the value of left is a string, such
as <strong>120px</strong>. The value of pixelLeft is an integer, such as
<strong>120</strong>. Since a string value cannot be calculated
arithematically, you need to use the <strong>replace()</strong> method
to remove the ‘<strong>px</strong>’ substring.</p>
<p>ball.style.left. <strong>replace('px','')</strong></p>
<p>Consequently, a value of 120px becomes 120. But, 120 is still a
string made of 1, 2, and 0, not an integer.</p>
<p>The <strong>eval()</strong> method then convert the number-like
string to the <strong>integer</strong> data type. In other words, 120
now means one-hundred-and-twenty, no longer a string that reads
one-two-zero. With the new XHTML, CSS and JavaScript standard, you can
ignore this old technique. However, the instructor purposely brings up
this issue for your reference (see learning activity #1 for
details).</p>
<p>The following line tells the computer to subtract 10 from the current
“ball.style.pixlLeft” each time when the user press the
<strong>Left</strong> arrow key (←).</p>
<p>if(event.keyCode==37) {</p>
<p>ball.style.pixelLeft -= 10;</p>
<p>}</p>
<p>According to the following table, the Up, Right, and Down arrow keys
have values of 38, 39, and 40. Similarly, you can use the following line
to add 10 to the current “ball.style.left” each time when the user press
the <strong>Right</strong> arrow key (→).</p>
<p>if(event.keyCode==39) {</p>
<p>ball.style.pixelLeft += 10;</p>
<p>}</p>
<p>The change the vertical position, you need to modify the current
value of “ball.style.top”, which represents the vertical value of the
position value set <strong>(top, left)</strong>.</p>
<p>if(event.keyCode==38) {</p>
<p>ball.style.pixelTop -= 10;</p>
<p>}</p>
<p>if(event.keyCode==40) {</p>
<p>ball.style.pixelTop += 10;</p>
<p>}</p>
<p>The code now looks:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>if(event.keyCode==37) {</p>
<p>ball.style.pixelLeft -= 10;</p>
<p>}</p>
<p>if(event.keyCode==39) {</p>
<p>ball.style.pixelLeft += 10;</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>96</p>
<p><span id="index_split_007.html#p97"></span><img src="index-97_1.png"
class="calibre5" alt="Image 101" /></p>
<p>if(event.keyCode==38) {</p>
<p>ball.style.pixelTop -= 10;</p>
<p>}</p>
<p>if(event.keyCode==40) {</p>
<p>ball.style.pixelTop += 10;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onkeydown=cc()&gt;</p>
<p>&lt;div id=area1 style="border:solid 1 black;</p>
<p>background-color:#abcdef;</p>
<p>width:300; height:300;"&gt;</p>
<p>&lt;img id=ball src="ball.gif" style="top:10;left:10;
position:relative"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Use Internet to run the code, and use the ←, ↑, →, and ↓ keys to move
the ball.</p>
<p>By the way, some keys, like [Shift], [Control] and [Alt], aren’t
normally thought of as sending characters, but modify the characters
sent by other keys. For many keys, no key codes are returned on keydown
and keyup events. Instead the keyCode value is just zero, Characters
that give a zero keycode when typed include those listed below, as well
as any key when the Alt/Option key is held down.</p>
<p>- _ ~ ! @ # $ % ^ &amp; * ( ) + | : &lt; &gt; ?</p>
<p>Internet Explorer provides the following properties.</p>
<p>Table: Keyboard related properties of the Event object</p>
<p>Properties</p>
<p>Description</p>
<p>altKey,</p>
<p>Boolean properties that indicate whether the Alt, Ctrl, Meta, and
ctrlKey,</p>
<p>shiftKey</p>
<p>Shift keys were pressed at time of the event.</p>
<p>keycode</p>
<p>Property indicating the Unicode for the key pressed.</p>
<p>type</p>
<p>A string indicating the type of event, such as "mouseover",</p>
<p>"click", etc.</p>
<p>Game Programming – Penn Wu</p>
<p>97</p>
<p><span id="index_split_007.html#p98"></span>For example, to create a
code that requires the user to hold the Shift key and then press the C
key to play the C# sound, use:</p>
<p>&lt;script&gt;</p>
<p>function cs() {</p>
<p>if ((event.shiftKey) &amp;&amp; (event.keyCode==67)) {</p>
<p>document.Cs.play();</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown=cs()&gt;</p>
<p>&lt;embed src="Cs0.wav" autostart=false hidden=true name="Cs"</p>
<p>mastersound&gt;</p>
<p>&lt;/body&gt;</p>
<p>There are few properties that work only with Netscape or Firefox, but
are not discussed in this lecture. They are:</p>
<p>Properties</p>
<p>Description</p>
<p>metaKey</p>
<p>Boolean property that indicate whether the Meta key</p>
<p>was pressed at the time of the event.</p>
<p>charCode</p>
<p>Property indicating the Unicode for the key pressed.</p>
<p>which</p>
<p>Legacy property indicating the Unicode for the key</p>
<p>pressed.</p>
<p>Both <em><strong>if..then</strong></em> and
<em><strong>switch..case</strong></em> statements are frequently used to
make decision as what to respond to the user’s input from keyboard. For
example,</p>
<p>&lt;script&gt;</p>
<p>function move_witch() {</p>
<p>if (event.keyCode==37) {</p>
<p>w1.style.pixelLeft -= 10;}</p>
<p>if (event.keyCode==38) {</p>
<p>w1.style. pixelTop -= 10;}</p>
<p>if (event.keyCode==39) {</p>
<p>w1.style. pixelLeft += 10;}</p>
<p>if (event.keyCode==40) {</p>
<p>w1.style. pixelTop += 10;}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>You can rewrite the above code using <strong>switch..case</strong>
statement.</p>
<p>&lt;script&gt;</p>
<p>function move_witch() {</p>
<p>var i = event.keyCode;</p>
<p>switch (i) {</p>
<p>case 37:</p>
<p>w1.style.pixelLeft -= 10; break;</p>
<p>case 38:</p>
<p>w1.style. pixelTop -= 10; break;</p>
<p>case 39:</p>
<p>w1.style. pixelLeft += 10; break;</p>
<p>case 40:</p>
<p>w1.style. pixelTop += 10; break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>98</p>
<p><span id="index_split_007.html#p99"></span><img src="index-99_1.png"
class="calibre5" alt="Image 102" /></p>
<p><img src="index-99_2.png" class="calibre5" alt="Image 103" /></p>
<p>Technically speaking, the <strong>switch..case</strong> statement is
a multi-way decision statement. Unlike the multiple-decision statement
that can be created using <strong>if..then</strong>. The switch
statement evaluates the conditional expression and tests it against
numerous constant values. The branch corresponding to the value that the
expression matches is taken during execution.</p>
<p>Sample Games</p>
<p>Use Paint to create a gif file (named board.gif) that looks:</p>
<p>Modify the kb.htm file to:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>if(event.keyCode==37) {</p>
<p>ball.style.left -= 10;</p>
<p>}</p>
<p>if(event.keyCode==39) {</p>
<p>ball.style.left += + 10;</p>
<p>}</p>
<p>if(event.keyCode==38) {</p>
<p>ball.style.top -= 10;</p>
<p>}</p>
<p>if(event.keyCode==40) {</p>
<p>ball.style.top += 10;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onkeydown=cc()&gt;</p>
<p><strong>&lt;img id=board src="board.gif"&gt;</strong></p>
<p>&lt;img id=ball src="ball.gif" style="top:315;left:10"</p>
<p>style="position:absolute"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Use Internet to run the code, you just create a maze game.</p>
<p>Game Programming – Penn Wu</p>
<p>99</p>
<p><span id="index_split_007.html#p100"></span></p>
<p>This code can be written using the switch..case statement. For
example,</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>var i = event.keyCode;</p>
<p>switch (i) {</p>
<p>case 37:</p>
<p>ball.style.pixelLeft -= 10;</p>
<p>break;</p>
<p>case 39:</p>
<p>ball.style.pixelLeft += 10;</p>
<p>break;</p>
<p>case 38:</p>
<p>ball.style.pixelTop -= 10;</p>
<p>break;</p>
<p>case 40:</p>
<p>ball.style.pixelTop += 10;</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onkeydown=cc()&gt;</p>
<p>&lt;img id=board src="board.gif"&gt;</p>
<p>&lt;img id=ball src="ball.gif" style="top:315;left:10"</p>
<p>style="position:absolute"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Use keyboard</p>
<p>Many objects have the properties of width and height. You can
increase or decrease the values of to control the</p>
<p>them to create visual effects. In the following example, the
&lt;img&gt; tag is given and ID m1.</p>
<p>width and</p>
<p>Consequently, “m1.style.width” represents the <strong>width</strong>
property of this image object.</p>
<p>height of an</p>
<p>object</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>if (event.keyCode==38) {</p>
<p><strong>m1.style.pixelWidth</strong> += 10;</p>
<p>}</p>
<p>if (event.keyCode==40) {</p>
<p>m1.style.pixelWidth -= 10;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown=cc()&gt;</p>
<p>&lt;center&gt;&lt;img id=m1 src="bat.gif"
style="width:10"&gt;&lt;/center&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>When you run the code, the Up and Down arrow keys will increase and
decrease the value of width. On the screen, the change of value creates
effect of zoom in and zooms out.</p>
<p>Game Programming – Penn Wu</p>
<p>100</p>
<p><span id="index_split_007.html#p101"></span><img
src="index-101_1.png" class="calibre5" alt="Image 104" /></p>
<p><img src="index-101_2.png" class="calibre5" alt="Image 105" /></p>
<p>to</p>
<p>Review</p>
<p>1. Which event handler invokes JavaScript code when a key is held
down, but not yet released?</p>
<p>Questions</p>
<p>A. onKeyOn</p>
<p>B. Onkeypress</p>
<p>C. Onkeydown</p>
<p>D. onkeyup</p>
<p>2. Which is not a keyboard related event handlers?</p>
<p>A. onKeyOn</p>
<p>B. Onkeypress</p>
<p>C. Onkeydown</p>
<p>D. onkeyup</p>
<p>4. Given the following code block, which statement is correct?</p>
<p>&lt;body onKeyDown="status = new Date();"</p>
<p>onLoad="document.title=new Date()"</p>
<p>onKeyUp="p1.innerText=new Date()"&gt;</p>
<p>A. When the user loads the page, the current data and time is display
on the status bar.</p>
<p>B. When the user press and hold the [Enter] key, the current data and
time is displayed on the status bar.</p>
<p>C. When the user press and then release the [Enter] key, the current
data and time is displayed on the status bar.</p>
<p>D. All of the above</p>
<p>4. Which property of the Event object returns UniCode value of key
pressed?</p>
<p>A. event.keyType</p>
<p>B. event.keyCode</p>
<p>C. event.key</p>
<p>D. event.keypress</p>
<p>5. Given the following code block, which statement is incorrect?</p>
<p>&lt;body onKeyDown="status=event.keyCode"&gt;</p>
<p>A. When you press any key, the status bar displays the string
"event.keyCode".</p>
<p>B. When you press the Alt key, the status bar displays the value
18.</p>
<p>C. When you press the left arrow key, the status bar displays the
value 37.</p>
<p>D. When you press the P key, the status bar displays the value
80.</p>
<p>6. When Unicode value is what you get when you press the Scroll Lock
key?</p>
<p>A. 145</p>
<p>B. 125</p>
<p>C. 135</p>
<p>D. 105</p>
<p>7. Given the following code, which statement is correct?</p>
<p>ball.style.left.replace('px',''))</p>
<p>Game Programming – Penn Wu</p>
<p>101</p>
<p><span id="index_split_007.html#p102"></span>A. It uses the replace()
method to remove "px" from "10px".</p>
<p>B. It uses the replace() method to remove "10px" from "10px".</p>
<p>C. It sets the value of ball.style.left to null.</p>
<p>D. All of the above</p>
<p>8. Which property of the event object returns a boolean outcome?</p>
<p>A. altKey</p>
<p>B. ctrlKey</p>
<p>C. shiftKey</p>
<p>D. All of the above</p>
<p>9. Given the following code block, which statement is correct?</p>
<p>if ((event.shiftKey) &amp;&amp; (event.keyCode==37)) {</p>
<p>m1.src="1.gif";</p>
<p>}</p>
<p>A. To change the value of src property of m1 object to "1.gif", you
can press either Shift key or C</p>
<p>key.</p>
<p>B. To change the value of src property of m1 object to "1.gif", you
can press both Shift key and C</p>
<p>key.</p>
<p>C. To change the value of src property of m1 object to "1.gif", you
cannot press Shift key nor C</p>
<p>key.</p>
<p>D. None of the above.</p>
<p>10. Which is the correct way to detect what key has been pressed?</p>
<p>A. &lt;body onKeyDown="status=event.keyCode"&gt;</p>
<p>B. &lt;body onKeyDown="status=event.keyPressCode"&gt; C. &lt;body
onKeyDown="status=event.keyTypeCode"&gt;</p>
<p>D. &lt;body onKeyDown="status=event.keyOnCode"&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>102</p>
<p><span id="index_split_007.html#p103"></span></p>
<p>Lab #6</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab6.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Labyrinth</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab6_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function cc() {</p>
<p>var i = event.keyCode;</p>
<p>switch (i) {</p>
<p>case 37:</p>
<p>ball.style.left=eval(ball.style.left.replace('px','')) - 10;</p>
<p>break;</p>
<p>case 39:</p>
<p>ball.style.left=eval(ball.style.left.replace('px','')) + 10;</p>
<p>break;</p>
<p>case 38:</p>
<p>ball.style.top=eval(ball.style.top.replace('px','')) - 10;</p>
<p>break;</p>
<p>case 40:</p>
<p>ball.style.top=eval(ball.style.top.replace('px','')) + 10;</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onkeydown=cc()&gt;</p>
<p>&lt;img id=board src="board.gif"&gt;</p>
<p>&lt;img id=ball src="ball.gif" style="top:315;left:10"
style="position:absolute"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Note: This version use <em>switch..case</em>, so be sure to compare
this version with the one in the lecture which use <em>if..then</em>
statement.</p>
<p>3. Test the program. Use ← , ↑ , → , and ↓ arrow keys to move the
ball. A sample output looks: Game Programming – Penn Wu</p>
<p>103</p>
<p><span id="index_split_007.html#p104"></span><img
src="index-104_1.png" class="calibre5" alt="Image 106" /></p>
<p><strong>Learning Activity #2: Music Keyboard</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to open the <strong>C:\games\lab6_2.htm</strong> (you
just downloaded it) which has the contents inside the dash lines:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.wKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>.bKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:black;</p>
<p>border:solid 1 white;</p>
<p>height:70px;</p>
<p>width:36px</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>&lt;!-- for middle C --&gt;</p>
<p>function CDown() {</p>
<p>midC.style.borderTop="solid 1 black";</p>
<p>midC.style.borderLeft="solid 1 black";</p>
<p>midC.style.borderBottom="solid 1 black";</p>
<p>midC.style.borderRight="solid 1 #cdcdcd";</p>
<p>}</p>
<p>function CUp() {</p>
<p>midC.style.borderTop="solid 1 #cdcdcd";</p>
<p>midC.style.borderLeft="solid 1 #cdcdcd";</p>
<p>midC.style.borderBottom="solid 4 #cdcdcd";</p>
<p>midC.style.borderRight="solid 1 black";</p>
<p>}</p>
<p>&lt;!-- for middle D --&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>104</p>
<p><span id="index_split_007.html#p105"></span>function DDown() {</p>
<p>midD.style.borderTop="solid 1 black";</p>
<p>midD.style.borderLeft="solid 1 black";</p>
<p>midD.style.borderBottom="solid 1 black";</p>
<p>midD.style.borderRight="solid 1 #cdcdcd";</p>
<p>}</p>
<p>function DUp() {</p>
<p>midD.style.borderTop="solid 1 #cdcdcd";</p>
<p>midD.style.borderLeft="solid 1 #cdcdcd";</p>
<p>midD.style.borderBottom="solid 4 #cdcdcd";</p>
<p>midD.style.borderRight="solid 1 black";</p>
<p>}</p>
<p>&lt;!-- for middle E --&gt;</p>
<p>function EDown() {</p>
<p>midE.style.borderTop="solid 1 black";</p>
<p>midE.style.borderLeft="solid 1 black";</p>
<p>midE.style.borderBottom="solid 1 black";</p>
<p>midE.style.borderRight="solid 1 #cdcdcd";</p>
<p>}</p>
<p>function EUp() {</p>
<p>midE.style.borderTop="solid 1 #cdcdcd";</p>
<p>midE.style.borderLeft="solid 1 #cdcdcd";</p>
<p>midE.style.borderBottom="solid 4 #cdcdcd";</p>
<p>midE.style.borderRight="solid 1 black";</p>
<p>}</p>
<p>3. Add the following lines to the existing contents:</p>
<p><strong>function Downkeys() {</strong></p>
<p><strong>var i = event.keyCode;</strong></p>
<p><strong></strong></p>
<p><strong>if (event.shiftKey) {</strong></p>
<p><strong>switch (i) {</strong></p>
<p><strong>case 67: document.Cs.play(); break;</strong></p>
<p><strong>case 68: document.Ds.play(); break;</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p><strong>else {</strong></p>
<p><strong>switch (i) {</strong></p>
<p><strong>case 67: CDown(); document.Csound.play(); break;</strong></p>
<p><strong>case 68: DDown(); document.Dsound.play(); break;</strong></p>
<p><strong>case 69: EDown(); document.Esound.play(); break;</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p><strong>function Upkeys() {</strong></p>
<p><strong>var i = event.keyCode;</strong></p>
<p><strong>switch (i) {</strong></p>
<p><strong>case 67: CUp(); break;</strong></p>
<p><strong>case 68: DUp(); break;</strong></p>
<p><strong>case 69: EUp(); break;</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p><strong>document.onkeydown=Downkeys;</strong></p>
<p><strong>document.onkeyup=Upkeys;</strong></p>
<p><strong>&lt;/script&gt;</strong></p>
<p><strong></strong></p>
<p>Game Programming – Penn Wu</p>
<p>105</p>
<p><span id="index_split_007.html#p106"></span><img
src="index-106_1.png" class="calibre5" alt="Image 107" /></p>
<p><strong></strong></p>
<p><strong>&lt;div&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;span class="wKey" id="midC"
style="left:50"&gt;&lt;/span&gt;</strong></p>
<p><strong>&lt;span class="wKey" id="midD"
style="left:91"&gt;&lt;/span&gt;</strong></p>
<p><strong>&lt;span class="wKey" id="midE"
style="left:132"&gt;&lt;/span&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;span class="bKey" id="cSharp"
style="left:72"&gt;&lt;/span&gt;</strong></p>
<p><strong>&lt;span class="bKey" id="dSharp"
style="left:114"&gt;&lt;/span&gt;</strong></p>
<p><strong>&lt;/div&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;!-- white key sound files --&gt;</strong></p>
<p><strong>&lt;embed src="C0.wav" autostart=false hidden=true
name="Csound" mastersound&gt;</strong></p>
<p><strong>&lt;embed src="D0.wav" autostart=false hidden=true
name="Dsound" mastersound&gt;</strong></p>
<p><strong>&lt;embed src="E0.wav" autostart=false hidden=true
name="Esound" mastersound&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;!-- black key sound files --&gt;</strong></p>
<p><strong>&lt;embed src="Cs0.wav" autostart=false hidden=true name="Cs"
mastersound&gt;</strong></p>
<p><strong>&lt;embed src="Ds0.wav" autostart=false hidden=true name="Ds"
mastersound&gt;</strong></p>
<p><strong></strong></p>
<p><strong>&lt;/html&gt;</strong></p>
<p>4. Test the program. Press C, D, and Key first, and then Shift+C,
Shift+D to play corresponding sounds. A sample output looks:</p>
<p><strong>Learning Activity #3: snake game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab6_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var x=190; y=384;</p>
<p>var k=1; n=0;</p>
<p>function draw(){</p>
<p>var i = event.keyCode;</p>
<p>switch (i) {</p>
<p>case 37: n=1; k=0; break;</p>
<p>case 38: n=0; k=1; break;</p>
<p>case 39: n=-1; k=0; break;</p>
<p>case 40: n=0; k=-1; break;</p>
<p>}</p>
<p>}</p>
<p>function cc() {</p>
<p>if ((x&lt;=10) || (x&gt;=394) || (y&lt;=-10) || (y&gt;=400)) {</p>
<p>p1.innerText="Game over!";</p>
<p>}</p>
<p>else {</p>
<p>y-=k; x-=n;</p>
<p>codes = "&lt;span style='position:absolute;left:"+x;</p>
<p>Game Programming – Penn Wu</p>
<p>106</p>
<p><span id="index_split_007.html#p107"></span><img
src="index-107_1.png" class="calibre5" alt="Image 108" /></p>
<p>codes += "; top:"+ y +"'&gt;.&lt;/span&gt;"; area1.innerHTML +=
codes;</p>
<p>setTimeout("cc()", 0.1);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body OnLoad=cc() onKeyDown=draw()&gt;</p>
<p>&lt;div id=area1 style="position:absolute; width:400;</p>
<p>height:400; border:solid 3 black; color:red;</p>
<p>background-Color: black; left:0; top:10;"&gt;&lt;/div&gt;</p>
<p>&lt;p id=p1 style="position:absolute; left:160;top:200; color:
white"&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Use ← , ↑ , → , and ↓ arrow keys to move. A
sample output looks: <strong>Learning Activity #4: Flying
witch</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab6_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img { position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>a1_x=document.body.clientWidth;</p>
<p>a1_y=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>c1_x=0;</p>
<p>c1_y=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>Game Programming – Penn Wu</p>
<p>107</p>
<p><span id="index_split_007.html#p108"></span>w1_x=200;</p>
<p>w1_y=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>b1_x=Math.floor(Math.random()*document.body.clientWidth);</p>
<p>b1_y=document.body.clientHeight;</p>
<p>codes="&lt;img id=a1 src=airplane.gif
style='left:"+a1_x+";top:"+a1_y+"'&gt;"; codes+="&lt;img id=c1
src=cloud.gif style='left:"+c1_x+";top:"+c1_y+"'&gt;"; codes+="&lt;img
id=w1 src=witch.gif style='left:"+w1_x+";top:"+w1_y+"'&gt;";
codes+="&lt;img id=b1 src=bird.gif
style='left:"+b1_x+";top:"+b1_y+"'&gt;"; p1.innerHTML=codes;</p>
<p>airplane();</p>
<p>cloud();</p>
<p>witch();</p>
<p>bird();</p>
<p>}</p>
<p>function airplane() {</p>
<p>if (a1.style.pixelLeft &gt; 0) {</p>
<p>a1.style.pixelLeft-=10;</p>
<p>}</p>
<p>else {</p>
<p>a1.style.left=document.body.clientWidth;</p>
<p>a1.style.top=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>}</p>
<p>setTimeout("airplane()", 20);</p>
<p>}</p>
<p>function cloud() {</p>
<p>if (c1.style.pixelLeft &lt; document.body.clientWidth) {</p>
<p>c1.style.pixelLeft += 10;</p>
<p>}</p>
<p>else {</p>
<p>c1.style.pixelLeft=0;</p>
<p>c1.style.pixelTop=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>}</p>
<p>setTimeout("cloud()", 100);</p>
<p>}</p>
<p>function witch() {</p>
<p>if (w1.style.pixelLeft &lt; document.body.clientWidth) {</p>
<p>w1.style.pixelLeft += 10;</p>
<p>}</p>
<p>else {</p>
<p>w1.style.pixelLeft=0;</p>
<p>w1.style.pixelTop=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>}</p>
<p>setTimeout("witch()", 100);</p>
<p>}</p>
<p>function bird() {</p>
<p>if (b1.style.pixelTop &gt; 0) {</p>
<p>b1.style.pixelTop -= 10;</p>
<p>b1.style.pixelLeft -= 10;</p>
<p>}</p>
<p>else {</p>
<p>b1.style.pixelLeft=Math.floor(Math.random()*document.body.clientWidth);
b1.style.pixelTop=document.body.clientHeight;</p>
<p>Game Programming – Penn Wu</p>
<p>108</p>
<p><span id="index_split_007.html#p109"></span><img
src="index-109_1.png" class="calibre5" alt="Image 109" /></p>
<p>}</p>
<p>setTimeout("bird()", 50);</p>
<p>}</p>
<p>function move_witch() {</p>
<p>var i = event.keyCode;</p>
<p>switch (i) {</p>
<p>case 37:</p>
<p>w1.style.pixelLeft -= 10; break;</p>
<p>case 38:</p>
<p>w1.style.pixelTop -= 10; break;</p>
<p>case 39:</p>
<p>w1.style.pixelLeft += 10; break;</p>
<p>case 40:</p>
<p>w1.style.pixelTop += 10; break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init() onKeyDown="move_witch()"&gt;</p>
<p>&lt;span id=p1&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Use ← , ↑ , → , and ↓ arrow keys to move the
witch to avoid crashing into any object. A sample output looks:</p>
<p><strong>Learning Activity #5: Jet Fighters</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab6_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>ap01.style.pixelLeft=Math.floor(Math.random()*300);</p>
<p>cc();</p>
<p>}</p>
<p>var k = 2;</p>
<p>function cc() {</p>
<p>if (ap01.style.pixelLeft &gt; document.body.clientWidth - 20) { k =
-2; }</p>
<p>else if (ap01.style.pixelLeft &lt; 10) { k = 2; }</p>
<p>ap01.style.pixelLeft += k;</p>
<p>setTimeout("cc()",5);</p>
<p>Game Programming – Penn Wu</p>
<p>109</p>
<p><span id="index_split_007.html#p110"></span><img
src="index-110_1.png" class="calibre5" alt="Image 110" /></p>
<p>}</p>
<p>function fly() {</p>
<p>if(event.keyCode==37) {</p>
<p>st01.style.pixelLeft -= 10;</p>
<p>}</p>
<p>if(event.keyCode==39) {</p>
<p>st01.style.pixelLeft += 10;</p>
<p>}</p>
<p>if(event.keyCode==38) {</p>
<p>st01.style.pixelTop -= 10;</p>
<p>}</p>
<p>if(event.keyCode==40) {</p>
<p>st01.style.pixelTop += 10;</p>
<p>}</p>
<p>if(event.keyCode==83) {</p>
<p>b01.style.pixelLeft = st01.style.pixelLeft + 20;</p>
<p>status = st01.style.pixelWidth;</p>
<p>b01.style.pixelTop = st01.style.pixelTop;</p>
<p>b01.style.display='inline';</p>
<p>fire();</p>
<p>}</p>
<p>}</p>
<p>function fire() {</p>
<p>b01.style.pixelTop -= 10;</p>
<p>setTimeout("fire()",50);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body id="bd" onkeydown=fly() onLoad=init()&gt;</p>
<p>&lt;img id=ap01 src="e_plan.gif" style="position:absolute"&gt;</p>
<p>&lt;img id=st01 src="shooter.gif" style="position:absolute;
top:200;left:100"&gt;</p>
<p>&lt;span id=b01
style="position:absolute;display:none"&gt;!&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Note: Because collision detection and response is the topic of a
later lecture, how you can modify this code so that the bullet can
destroy the plane will be discussed in a later lecture.</p>
<p>3. Test the program. Use ← , ↑ , → , and ↓ arrow keys to move
airplane. Press the S key to shoot a bullet. A sample output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>110</p>
<p><span id="index_split_007.html#p111"></span></p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 06, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab6_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab6_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab6_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab6_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab6_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>111</p>
<p><span id="index_split_007.html#p112"></span><img
src="index-112_1.png" class="calibre5" alt="Image 111" /></p>
<p>Lecture #7</p>
<p>Handling moving Objects</p>
<p><span id="index_split_008.html"></span></p>
<h2 class="calibre2"
id="index_split_008.html#calibre_pb_7">Introduction</h2>
<p>Moving objects is an extremely important topic in all games because
they provide an effective means of conveying movement while also
allowing objects to interact with one another. By learning how to move
objects in a game, you can create some interesting games.</p>
<p>For example, in the ball bouncing game (you created in a previous
lecture), there are two objects: the ball and the paddle (a customized
cursor). These two objects must be coded to be movable because they all
move and interact with each other. The ball floats inside a given area
while the paddle can be moved by the player to bounce back the ball.</p>
<p>In this example, the movement of ball is in essence the movement of
an image file, while the paddle is the mouse cursor (whose movement is
handled by the operating systems). But it points out the truth that
moving objects are typically bitmap images, and the game programmers’
job is to keep track of the position, velocity, width, height, Z-index
(or layers), and visibility. A previous lecture had explained how the
coordinate system is used by the computer to position an object using (
<em>x</em>, <em>y</em>) format.</p>
<p>In terms of DHTML games, CSS is responsible for the appearance of
objects, while a scripting language (e.g. Javascript) is responsible for
how objects move, behave, and interact with other objects. For example,
in the ball bouncing game,</p>
<p>•</p>
<p>CSS is used to define the dimension (width and height), background
color, and border of the area, in which the ball is defined by CSS its
initial position and visibility.</p>
<p>•</p>
<p>JavaScript codes creates two functions <strong>dd()</strong> and
<strong>ff()</strong>. The dd() function moves the ball continuously
from top-left to right-bottom direction. The ff() function is a reversed
function of dd().</p>
<p>&lt;html&gt;&lt;body onClick="t1.style.display='block';dd()"&gt;</p>
<p>&lt;script&gt;</p>
<p>var j=0;</p>
<p>var i=Math.round(Math.random()*1000);</p>
<p>function dd() {</p>
<p>t1.style.left=i;</p>
<p>t1.style.top=j;</p>
<p>status="("+i+","+j+")";</p>
<p>i++;j+=Math.round(Math.random()*10);</p>
<p>if ((j&gt;=400) || (i&gt;=600)) {clearTimeout(s1);ff()}</p>
<p>if (i&lt;=8) {i=8;i+=20;j+=10}</p>
<p>s1=setTimeout("dd()",50);</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>112</p>
<p><span id="index_split_008.html#p113"></span>function ff() {</p>
<p>t1.style.left=i;</p>
<p>t1.style.top=j;</p>
<p>status="("+i+","+j+")";</p>
<p>j-=10;i-=5;</p>
<p>if (j&lt;=0) {clearTimeout(s2);dd();} else</p>
<p>{s2=setTimeout("ff()",50);}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;div style="position:absolute; top:0 ;left:0; width:608;
height:408; background-color:#abcdef;</p>
<p>cursor:vertical-text"&gt;</p>
<p>&lt;img id=t1 src="ball.gif" style="position:absolute;
top:0;display:none"</p>
<p>onMouseOver="clearTimeout(s1);ff()"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>The movement of the ball is determined by its ( <em>x</em>,
<em>y</em>) coordinates in the browser’s body area.</p>
<p>DHTML uses left and top attributes to represent <em>x</em> and
<em>y</em> respectively. The syntax to use them are:
objectID.style.left</p>
<p>and</p>
<p>objectID.style.top</p>
<p>where <strong>objectID</strong> is the ID you assigned to the object
you want to move. For example, t1 is the ID</p>
<p>of the ball.gif according to the following statement. The object's ID
varies according to the object, while the keywords
<strong>style</strong>, <strong>left</strong>, and <strong>top</strong>
must stay.</p>
<p>&lt;img id=t1 src="ball.gif" .............&gt;</p>
<p>When the values of an object’s ( <em>x</em>, <em>y</em>) change, the
object moves from its original location to the new location. In the
following example, two variables <em><strong>i</strong></em> and
<em><strong>j</strong></em> will assign values of ( <em>x</em>,
<em>y</em>) to the <strong>t1</strong></p>
<p>object.</p>
<p>function dd() {</p>
<p>t1.style.left=i;</p>
<p>t1.style.top=j;</p>
<p>...................</p>
<p><strong>i++;j+=Math.round(Math.random()*10);</strong></p>
<p>....................</p>
<p>s1=setTimeout("dd()",50);</p>
<p>}</p>
<p>The <strong>setTimeout()</strong> method will call the dd() function
every 50 milliseconds, and each time when dd() executes, the following
line forces <em><strong>i</strong></em> and <em><strong>j</strong></em>
to change their values. In other words, the ( <em>x</em>, <em>y</em>)
value of <strong>t1</strong> is renewed each time when dd() executes.
Since <strong>t1</strong> receives a new position value set (
<em>x</em>, <em>y</em>), it keeps on moving from previous ( <em>x</em>,
<em>y</em>) to current ( <em>x</em>, <em>y</em>) to create a visual
effect of moving ball.</p>
<p>Creating a</p>
<p>A motion object must have identifiable properties with valid values
for the computer to know motion effects</p>
<p>how to manage it motion. Game programming using object-oriented
technique to handle motion is basically the implementation of an
object’s properties. Most programming languages provide the following
properties to define the motion of a given object in a game that is
capable of Game Programming – Penn Wu</p>
<p>113</p>
<p><span id="index_split_008.html#p114"></span>moving over time. The
basic techniques for finding an object’s property are the same in very
language. In terms of DHTML, for example, the general syntax for finding
an element’s HTML</p>
<p>property values is:</p>
<p>getElementByID(objectID).style.PropertyName;</p>
<p>where, <strong>objectID</strong> is the ID you assign to a given
object, while the word “<strong>style</strong>” is a keyword that must
stay as it is. As to the <strong>PropertyName</strong>, it must be a
valid property. In DHTML game programming, you will frequently use the
following properties:</p>
<p>•</p>
<p>position (such as left, top, pixelLeft, pixelTop, etc.)</p>
<p>•</p>
<p>visibility</p>
<p>•</p>
<p>z-index</p>
<p>Consider the following example; <strong>m1</strong> is the ID of the
image file g1.gif (which is an object).</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function init()</p>
<p>{</p>
<p>var x=document.getElementById('m1').style.pixelLeft;</p>
<p>var y=document.getElementById('m1').style.pixelTop;</p>
<p>status="("+x+", "+y+")";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;img id=m1 src=g1.gif&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>The following line tells the computer to get the value of pixelLeft
of the <strong>m1</strong> object.</p>
<p>var x=document.getElementById('m1').style.pixelLeft;</p>
<p>In previous lectures, you had learned that the above line can be
simplified to: var x=<strong>m1</strong>.style.pixelLeft;</p>
<p>So, what is the point using <strong>getElementById()</strong>? When
using it with <strong>srcElement</strong>, you will make your long codes
very concise. The <strong>srcElement</strong> property sets or retrieves
the object that fired the event. The syntax is:</p>
<p>[ oObject = ] event.srcElement</p>
<p>The optional <strong>[ oObject = ]</strong> part refers to the object
that specifies or receives the event that fired.</p>
<p>For example,</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function change_color() {</p>
<p>var oldID = event.srcElement.id;</p>
<p>document.getElementById(oldID).style.color=oldID;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;button id="red"
onclick="change_color()"&gt;Red&lt;/button&gt;</p>
<p>&lt;button id="blue"
onclick="change_color()"&gt;Color&lt;/button&gt;</p>
<p>&lt;/html&gt;</p>
<p>In the above code, the following line detects the ID of the button
you click (e.g. “red” or “green”), Game Programming – Penn Wu</p>
<p>114</p>
<p><span id="index_split_008.html#p115"></span><img
src="index-115_1.png" class="calibre5" alt="Image 112" /></p>
<p><img src="index-115_2.png" class="calibre5" alt="Image 113" /></p>
<p>and assign the value to a variable named <strong>oldID</strong>.</p>
<p>var oldID = event.srcElement.id;</p>
<p>The following line tells the computer to change the text color of the
button to the value held by the oldID variable (which is either “red” or
“green”).</p>
<p>document.getElementById(oldID).style.
<strong>color</strong>=oldID;</p>
<p>You will be using this programming technique often in the later
lectures. When executing the above code, you first see:</p>
<p>After clicking on the buttons, the colors change from black to red
and black to blue.</p>
<p>The SrcElement DOM object is generated any time that an event is
called, and it contains the element that called the event in the first
place. One of the principle advantages of using it is that you can
radically simplify your DHTML scripting code by assigning an event on a
single container object, then checking the SrcElement to see which
object within that container actually fired the event.</p>
<p>DHTML</p>
<p>DHTML uses the <strong>position</strong> property to sets or
retrieves the type of positioning used for the object.</p>
<p>position</p>
<p>Te syntax is:</p>
<p>systems</p>
<p>objectID.style.position=value</p>
<p>Possible values are:</p>
<p>•</p>
<p><strong>static</strong>: Default. Object has no special positioning;
it follows the layout rules of HTML.</p>
<p>•</p>
<p><strong>absolute</strong>: Object is positioned relative to parent
element’s position or to the body object if its parent element is not
positioned using the <strong>top</strong> and <strong>left</strong>
properties.</p>
<p>•</p>
<p><strong>relative</strong>: Object is positioned according to the
normal flow, and then offset by the <strong>top</strong> and
<strong>left</strong> properties.</p>
<p>A simple demonstration illustrates the point. Suppose that you had
three &lt;DIV&gt; elements within another &lt;DIV&gt; element, one of
each color red, green or blue. You can place a general event handler on
the containing DIV that can then be used to intercept either the outside
division or any of the three smaller DIV elements.</p>
<p>&lt;script&gt;</p>
<p>function getColor(){</p>
<p>var src=event.srcElement;</p>
<p>alert(src.style.backgroundColor);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;div</p>
<p>style="background-color:black; color:white; width:500px;</p>
<p>cursor:hand;"</p>
<p>onclick="getColor()"&gt;Black</p>
<p>&lt;div</p>
<p>style="background-color:red; color:black; width:150px;</p>
<p>Game Programming – Penn Wu</p>
<p>115</p>
<p><span
id="index_split_008.html#p116"></span><strong>position:relative</strong>"&gt;</p>
<p>Red Box&lt;/div&gt;</p>
<p>&lt;div style="background-color:green; color:black; width:150px;
<strong>position:relative</strong>"&gt;</p>
<p>Green Box&lt;/div&gt;</p>
<p>&lt;div</p>
<p>style="background-color:blue; color:black; width:150px;</p>
<p><strong>position:relative</strong>"&gt;</p>
<p>Blue Box&lt;/div&gt;</p>
<p>&lt;/div&gt;</p>
<p>This technique is common for dealing with a large number of items
that have similar actions and are contained in a single element.
Collapsible trees, subordinate selections, input elements, and behaviors
can all make use of this technique.</p>
<p>Setting the property to absolute pulls the object out of the "flow"
of the document and positions it regardless of the layout of surrounding
objects. If other objects already occupy the given position, they do not
affect the positioned object, nor does the positioned object affect
them. Instead, all objects are drawn at the same place, causing the
objects to overlap. This overlap is controlled by using the z-index
attribute or property. Absolutely positioned objects do not have
margins, but they do have borders and padding.</p>
<p>To enable absolute positioning on an object you must specify at least
one of the top, bottom, left, or right properties, in addition to
setting the position property to absolute. Otherwise, these positioning
properties use their default value of absolute, which causes the object
to render immediately after the preceding elements, according to the
layout rules of HTML.</p>
<p>Object</p>
<p>The <strong>visibility</strong> property sets if an element should be
visible or invisible. The <strong>display</strong> property sets
Visibility and</p>
<p>how/if an element is displayed. Invisible elements take up space on
the page. Use the "display"</p>
<p>Display</p>
<p>property to create invisible elements that do not take up space.</p>
<p>The syntax is:</p>
<p>objectID.style.visibility=value</p>
<p>and</p>
<p>objectID.style.display=value</p>
<p>Command values of Visibility project include:</p>
<p><strong>Value</strong></p>
<p><strong>Description</strong></p>
<p>visible</p>
<p>The element is visible</p>
<p>hidden</p>
<p>The element is invisible</p>
<p>collapse</p>
<p>When used in table elements, this value removes a row or column, but
it does not affect the table layout. The space taken up by the row or
column will be available for other content. If this value is used on
other elements, it renders as "hidden"</p>
<p>Command values of Display project include:</p>
<p><strong>Value</strong></p>
<p><strong>Description</strong></p>
<p>none</p>
<p>The element will not be displayed</p>
<p>block</p>
<p>The element will be displayed as a block-level element, with a line
break before and after the element</p>
<p>inline</p>
<p>The element will be displayed as an inline element, with no line
break before or after the element</p>
<p>Game Programming – Penn Wu</p>
<p>116</p>
<p><span id="index_split_008.html#p117"></span>list-</p>
<p>The element will be displayed as a list</p>
<p>item</p>
<p>run-in</p>
<p>The element will be displayed as block-level or inline element
depending on context</p>
<p>compact</p>
<p>The element will be displayed as block-level or inline element
depending on context</p>
<p>For example,</p>
<p>&lt;html&gt;</p>
<p>&lt;u onClick=this.style.display="none"&gt;Make me
disappear!&lt;/u&gt; This is a line.&lt;br&gt;</p>
<p>&lt;b onClick=this.style.visibility="hidden"&gt;Make me
invisible!&lt;/b&gt; This is another line.</p>
<p>&lt;/html&gt;</p>
<p>When click the sentence “Make me disappear!”, it disappears (being
removed). When click the sentence “Make me invisible!”, it becomes
invisible (their character space remain there) Layering</p>
<p>Most of the Web pages are meant to be 2D (2 dimensional), so objects
on the Web pages can be Objects – z-positioned by X and Y coordinates,
or its horizontal and vertical positioning. CSS positioning index
property</p>
<p>uses the Z axis to layer objects on top of each other. With the
z-index property, you can specify the layer on which an object lies.</p>
<p>By setting the z-index higher or lower, you can move the object up or
down in the stack.</p>
<p>Basically, the bigger the value is; the more front its layer will be.
Also,</p>
<p>•</p>
<p>A positive value positions the element above text that has no defined
z-index.</p>
<p>•</p>
<p>A negative value positions it below.</p>
<p>•</p>
<p>Set this parameter to null to remove the attribute.</p>
<p>The syntax is:</p>
<p>objectID.style.zIndex="value";</p>
<p>Z-index property is relative to x and y-axis, it will not work
without x and y-axis, that is, top and left properties. For example,</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>u {z-index:3;position:absolute;left:55;top:25;background-</p>
<p>color:red}</p>
<p>b {z-index:2;position:absolute;left:65;top:35;background-</p>
<p>color:green}</p>
<p>i {z-index:1;position:absolute;left:75;top:45;background-</p>
<p>color:blue}</p>
<p>&lt;/style&gt;</p>
<p>&lt;u&gt;This is layer1.&lt;/u&gt;</p>
<p>&lt;b&gt;this is layer2.&lt;/b&gt;</p>
<p>&lt;i&gt;This is layer3.&lt;/i&gt;</p>
<p>&lt;/html&gt;</p>
<p>One can also integrate the CSS style with HTML tags, for
instance:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>u {z-index:3;position:absolute;top:55px;left:25px;background-</p>
<p>color:red}</p>
<p>i {z-index:2;position:absolute;top:65px;left:55px;background-</p>
<p>color:green}</p>
<p>Game Programming – Penn Wu</p>
<p>117</p>
<p><span id="index_split_008.html#p118"></span><img
src="index-118_1.png" class="calibre5" alt="Image 114" /></p>
<p>b {z-index:1;position:absolute;top:75px;background-color:blue}</p>
<p>&lt;/style&gt;</p>
<p>&lt;u&gt;this goes to the top.&lt;/u&gt;</p>
<p>&lt;i&gt;this goes to the middle.&lt;/i&gt;</p>
<p>&lt;b&gt;this goes the bottom.&lt;/b&gt;</p>
<p>&lt;/html&gt;</p>
<p>The output looks:</p>
<p>Continuous</p>
<p>A motion object also have built-in functions, such as start, stop,
turn left, turn right, and so on.</p>
<p>motion</p>
<p>The term "built-in" implies that the game programmer must create
these functions and given them to the object. Most programming languages
provide methods to allow game programmers to create "user-defined
function", which then serves as the "built-in" function of the object
for the players to use to control the object's motion.</p>
<p>JavaScript is relatively weak on the support of such methods, but you
can use the following JavaScript method to handle motions of your DHTML
games.</p>
<p>•</p>
<p><strong>setTimeout()</strong> - executes a code some time in the
future</p>
<p>•</p>
<p><strong>clearTimeout()</strong> - cancels the setTimeout()</p>
<p>Note: The setTimeout() and clearTimeout() are both methods of the
HTML DOM Window object.</p>
<p>To use the setTimeout() method, the formal syntax is:</p>
<p>var variableNmae=setTimeout("statement", milliseconds) Although, you
can simplify the syntax to:</p>
<p>setTimeout("statement", milliseconds);</p>
<p>it is highly recommended that you use the formal syntax, so you can
use the clearTimeout() method to cancel it. The syntax of clearTimeout()
method is:</p>
<p>clearTimeout(variableName)</p>
<p>Due to the object-oriented programming model, methods are controlled
by the programming language's run-time environment (meaning the
background engine), so they cannot be destroyed, deleted, or terminated
by the user.</p>
<p>You can create an object, such as a variable in this setTimeout()
case, to transfer all the setTimeout() method's function to this object.
Consequently, you can destroy, delete, or terminate the object any time
you want by using clearTimeout(variableName).</p>
<p>Additionally, the setTimeout() method returns a value - In the
statement above, the value is stored in a variable called t. If you want
to cancel this setTimeout(), you can refer to it using the variable
name.</p>
<p>Drag and drop</p>
<p>“Drag and drop” describes a particular action you can move an element
from one location to another by dragging it with the mouse. Click an
object, such as a image, then hold down the mouse button as you drag the
object to a new location. You drop the object by releasing the mouse
button.</p>
<p>This function is made possible by a good handling of ( <em>x</em>,
<em>y</em>) coordinates using mouse buttons’</p>
<p>Game Programming – Penn Wu</p>
<p>118</p>
<p><span id="index_split_008.html#p119"></span>positioning systems:
<strong>event.clientX</strong> and <strong>event.clientY</strong>. Given
the following code which is saved as an external code file (with a name
such as dragndrop.js). You can use this code file as library code to
provide drag-and-drop function to other DHTML codes.</p>
<p>var dragapproved=false</p>
<p>var z,x,y</p>
<p>function move(){</p>
<p>if (event.button==1 &amp;&amp; dragapproved){</p>
<p>z.style.pixelLeft=temp1+event.clientX-x</p>
<p>z.style.pixelTop=temp2+event.clientY-y</p>
<p>return false</p>
<p>}</p>
<p>}</p>
<p>function drags(){</p>
<p>if (!document.all)</p>
<p>return</p>
<p>if (event.srcElement.className=="drag"){</p>
<p>dragapproved=true</p>
<p>z=event.srcElement</p>
<p>temp1=z.style.pixelLeft</p>
<p>temp2=z.style.pixelTop</p>
<p>x=event.clientX</p>
<p>y=event.clientY</p>
<p>document.onmousemove=move</p>
<p>}</p>
<p>}</p>
<p>document.onmousedown=drags</p>
<p>document.onmouseup=new Function("dragapproved=false") There are four
user-defined variables: dragapproved, <em>z</em>, <em>x</em>, and
<em>y</em>. The variable <strong>dragapproved</strong> is merely used as
a reference that indicates whether or not any mouse button is currently
pressed and held. If no mouse button is pressed and held, the value of
dragapproved is <strong>false</strong>.</p>
<p>The variable <em><strong>z</strong></em> is just a temporarily name
of the object that is being dragged. It is used only when an object is
dragged.</p>
<p>The variables <em><strong>x</strong></em> and
<em><strong>y</strong></em> represents the mouse cursor’s ( <em>x</em>,
<em>y</em>) coordinates, which is exactly the
<strong>event.clientX</strong> and <strong>event.clientY</strong>. The
values of <em>x</em> and <em>y</em> variable change as the mouse cursor
moves.</p>
<p>The following statement triggers the drags() function when an object
is dragged.</p>
<p>document.onmousedown=drags</p>
<p>In the drags() function, the following line verifies if an object
being dragged has a class name</p>
<p>“drag”, and this is the reason why you need to add
<strong>class="drag"</strong> to any object that may be dragged and
dropped (e.g. &lt;img id=obj <strong>class="drag"</strong>
src=cat.gif&gt;).</p>
<p>if (event.srcElement.className=="drag")</p>
<p>The following line assigns the real ID of the object being dragged to
<em><strong>z</strong></em>.</p>
<p>z=event.srcElement</p>
<p>Two variables <strong>temp1</strong> and <strong>temp2</strong> are
added to represent the current (z.style.left, z.style.top) coordinates
of the dragged object, as shown below: Game Programming – Penn Wu</p>
<p>119</p>
<p><span id="index_split_008.html#p120"></span><img
src="index-120_1.png" class="calibre5" alt="Image 115" /></p>
<p>temp1=z.style.pixelLeft</p>
<p>temp2=z.style.pixelTop</p>
<p>Notice that <strong>pixelLeft</strong> and <strong>pixelTop</strong>
are new CSS positioning properties that specify or receive the
<strong>left</strong> and <strong>top</strong> position in pixels
respectively. A detailed discussion is available at a later lecture
note.</p>
<p>Once a dragged object is checked and verified to have the
<strong>class=”drag”</strong> class name, the following statement
triggers the move() function.</p>
<p>document.onmousemove=move</p>
<p>The <strong>move()</strong> function uses the following statement to
detect if the left button of a mouse is still pressed and held.</p>
<p>if (event.button==1 &amp;&amp; dragapproved){</p>
<p>..........</p>
<p>}</p>
<p>If the left button is pressed and held, the following statements
update the values of (left, top) of the dragged object.</p>
<p>z.style.pixelLeft=temp1+event.clientX-x</p>
<p>z.style.pixelTop=temp2+event.clientY-y</p>
<p>The logic is the new values of (<strong>z.style.pixelLeft</strong>,
<strong>z.style.pixelTop</strong>) equals to the old one
(<strong>temp1</strong>, <strong></strong></p>
<p><strong>temp2</strong>) subtract the difference of new mouse cursor
(<strong>event.clientX</strong>, <strong>event.clientY</strong>) and old
mouse cursor ( <em><strong>x</strong></em>,
<em><strong>y</strong></em>).</p>
<p>Speed</p>
<p>Moving object sometimes involves in the control of speed. In the
Flying Witch game, for example, the bird moves faster than the witch
does. In other words, these two objects have different speeds, as shown
below.</p>
<p>function witch() {</p>
<p>..........</p>
<p>..........</p>
<p><strong>setTimeout("witch()", 100);</strong></p>
<p>}</p>
<p>function bird() {</p>
<p>..........</p>
<p>..........</p>
<p><strong>setTimeout("bird()", 50);</strong></p>
<p>}</p>
<p>The functions <strong>setTimeout</strong> and
<strong>setInterval</strong> are similar, and they both can control the
speed of a function. However, in fact, these two functions perform very
differently. The <strong>setTimeout</strong> function delays for a
specified time period and then triggers execution of a specified
function.</p>
<p>Game Programming – Penn Wu</p>
<p>120</p>
<p><span id="index_split_008.html#p121"></span>Once the function is
triggered the setTimeout has finished. You can terminate the execution
of the setTimeout before it triggers the function by using the
<strong>clearTimeout</strong> function.</p>
<p>In this game programming class, you frequently see setTimeout used at
the end of a function to trigger another execution of the same function
perhaps passing it different parameters. Where this is done the time
from the first triggering of the function until the next will be the
specified delay time plus the time taken to execute the function. Here
is an example: moreSnow();</p>
<p>function moreSnow() {</p>
<p>// content of moreSnow function</p>
<p>setTimeout("moreSnow()", speed);</p>
<p>}</p>
<p>The <strong>setInterval</strong> function also delays for a specified
time before triggering the execution of a specific function. However,
after triggering that function the command doesn’t complete. Instead it
waits for the specified time again and then triggers the function again
and continues to repeat this process of triggering the function at the
specified intervals until either the web page is unloaded or the
clearInterval function is called.</p>
<p>The above code using <strong>setTimeout</strong> could have been
written using <strong>setInterval</strong> instead and would have looped
slightly faster since the loop would not have waited for the content of
the function to be processed before triggering the repetition. Here is
the above code rewritten to us setInterval: moreSnow();</p>
<p>setInterval("moreSnow()", speed);</p>
<p>function moreSnow() {</p>
<p>// content of moreSnow function</p>
<p>}</p>
<p>On the other hand, if you replace the setTimeout function with
setInterval. When pressing any key. The code will fail. It is because
pressing key will continuously trigger the shoot() function, but the
setInterval doesn’t complete a loop--it simply delays the looping.
Starting a new loop before completing the old loop will fail the
game.</p>
<p>function shoot() {</p>
<p>var i = b01.style.pixelLeft;</p>
<p>if (i &lt;= 400) {</p>
<p>b01.style.pixelLeft=i + 10;</p>
<p>setTimeout("shoot()",20);</p>
<p>}</p>
<p>else {b01.style.display='none';</p>
<p>b01.style.pixelLeft=95;</p>
<p>};</p>
<p>}</p>
<p>Which of the two functions you should choose to use depends on what
you are trying to achieve.</p>
<p>If different parameters need to be passed to the function on each
call or the content of the function decides whether or not to call
itself again then setTimeout is the one to use. Where the function just
needs triggering at regular intervals then the setInterval function may
produce simpler code within the function particularly if it has multiple
exit points.</p>
<p>Directions</p>
<p>Objects may move in any direction, linear or non-linear. The term
“linear” implies sequence, while “non-linear” implies skipping the
sequence.</p>
<p>In the snake game (you created previously), the snake line moves in a
<strong>leaner</strong> direction. Each time when you use arrow keys to
change a direction, the line move point by point with an increment of
Game Programming – Penn Wu</p>
<p>121</p>
<p><span id="index_split_008.html#p122"></span><strong>1</strong>, as
illustrated below.</p>
<p>..............</p>
<p>case 37: n=1; k=0; break;</p>
<p>case 38: n=0; k=1; break;</p>
<p>case 39: n=-1; k=0; break;</p>
<p>case 40: n=0; k=-1; break;</p>
<p>..............</p>
<p>y-=k; x-=n;</p>
<p>codes = "&lt;span style='position:absolute;left:"+x;</p>
<p>codes += "; top:"+ y +"'&gt;.&lt;/span&gt;"; area1.innerHTML +=
codes;</p>
<p>setTimeout("cc()", 0.1);</p>
<p>..............</p>
<p>If ( <em>x1</em>, <em>y1</em>) = (10<strong>0</strong>, 100) and you
press the left arrow key (the key code is 37), then the very next dot is
placed at ( <em>x2</em>, <em>y2</em>) = (10<strong>1</strong>, 100), and
the next one is (10<strong>2</strong>, 100), (10<strong>3</strong>,
100),…… In other words, to move from (100, 100) to (119, 100). You need
to move in a sequence of 100, 101, 102, 103, 104, 105, 106, …, 117, 118,
119 along the <em>x</em> axis.</p>
<p>(100, 100)</p>
<p>(119, 100)</p>
<p>To handle a linear direction movement, simply use
<strong>increment</strong> or <strong>decrement</strong>. In the ball
bouncing example, two variables <em><strong>i</strong></em> and
<em><strong>j</strong></em> will assign values of ( <em>x</em>,
<em>y</em>) to the <strong>t1</strong> object.</p>
<p>function dd() {</p>
<p>t1.style.left=i;</p>
<p>t1.style.top=j;</p>
<p>...................</p>
<p><strong>i++;j+=Math.round(Math.random()*10);</strong></p>
<p>....................</p>
<p>s1=setTimeout("dd()",50);</p>
<p>}</p>
<p>where, i++ means i is incremented by 1, which is equivalent to i = i+
1. In JavaScript, the increment and decrement operators act on only one
operand. They are hence called Unary operators. They can be used either
before or after a variable as in: a++;</p>
<p>b--;</p>
<p>or</p>
<p>++a;</p>
<p>--b;</p>
<p>When these operators are used as prefixes, JavaScript first adds one
to the variable and then returns the value. When used as suffixes, the
value is first returned and then the variable is incremented.</p>
<p>Game Programming – Penn Wu</p>
<p>122</p>
<p><span id="index_split_008.html#p123"></span><img
src="index-123_1.png" class="calibre5" alt="Image 116" /></p>
<p>When the increment or decrement is larger than 1, use the following
syntax: x += <em>n</em>; or x -= <em>n</em>;</p>
<p>where <em>n</em> is an number, and <em>n</em> is not necessary an
integer. For example, in the Roulette Wheel game, there is a code block
that uses increment that is π/180 which is a decimal value since π is
3.1412.</p>
<p>if (a &gt;= Math.PI *2) { a=0; }</p>
<p>else { <strong>a += Math.PI/180;</strong> }</p>
<p>You may need to move objects in directions such as northeast,
southeast, northwest, and southwest. Assuming the object ID is
<strong>obj</strong>, then the direction control in DHTMLs are (where
<em>n</em> is an positive number):</p>
<p>•</p>
<p><strong>NE</strong>: obj.style.pixelLeft + <em>n</em>;
obj.style.pixelTop - <em>n</em>;</p>
<p>•</p>
<p><strong>SE</strong>: obj.style.pixelLeft + <em>n</em>;
obj.style.pixelTop + <em>n</em>;</p>
<p>•</p>
<p><strong>NW</strong>: obj.style.pixelLeft - <em>n</em>;
obj.style.pixelTop - <em>n</em>;</p>
<p>•</p>
<p><strong>SW</strong>: obj.style.pixelLeft - <em>n</em>;
obj.style.pixelTop + <em>n</em>; When you want an object to jump from on
location to another, and ignore all the points between the new and old
locations, you are handling a movement of non-linear direction. For
example, in the Flying UFO game, the <strong>ufo</strong> object’s (
<em>x</em>, <em>y</em>) values are generated randomly by the
<strong>Math.random()</strong> method each time when the
<strong>ufo_fly()</strong> function executes.</p>
<p>function ufo_fly() {</p>
<p>ufo.style.pixelLeft = Math.round(Math.random()*screen.width);</p>
<p>ufo.style.pixelTop = Math.round(Math.random()*screen.height);</p>
<p>setTimeout("ufo_fly()", 500);</p>
<p>}</p>
<p>Consequently, the <strong>ufo</strong> object moves in a random
unpredictable mode.</p>
<p>Moving along a To move an object along a circle, as the ball in the
Roulette Wheel game, you need to understand circle</p>
<p>how computers create a circle.</p>
<p>According to geometry, a <strong>circle</strong> is the set of all
points in a plane at a fixed distance (known as <strong>radius)</strong>
from a fixed point (known as <strong>center</strong>).</p>
<p>All the points on the circumference of the circle has a set of (
<em>x</em>, <em>y</em>) coordinates. The <em>x</em> value is determined
by:</p>
<p>centerX + radius × Sinθ</p>
<p>and <em>y</em> is determined by:</p>
<p>centerY + radius × Cosθ</p>
<p>Game Programming – Penn Wu</p>
<p>123</p>
<p><span id="index_split_008.html#p124"></span>where θ is incremented by
π/180, and 0 ≤ θ <em>≤</em> 2π, because the circumference of a circle is
2π.</p>
<p>radius</p>
<p>center</p>
<p>Consider the following code, it uses (197, 197) as the ( <em>x</em>,
<em>y</em>) of the center and 120 as radius.</p>
<p>var r=120; a=0;</p>
<p>function cc() {</p>
<p>b1.style.pixelLeft=197+r*Math.sin(a);</p>
<p>b1.style.pixelTop=197+r*Math.cos(a);</p>
<p>if (a &gt;= Math.PI *2) { a=0; }</p>
<p>else { a += Math.PI/180; }</p>
<p>rotating=setTimeout("cc()", 2);</p>
<p>}</p>
<p>The line <strong>b1.style.pixelLeft=197+r*Math.sin(a);</strong> is
actually the expression of centerX + radius × Sinθ</p>
<p>and <strong>if (a &gt;= Math.PI *2) { a=0; }</strong> is actually the
DHTML expression of 0 ≤ θ <em>≤</em> 2π</p>
<p>while <strong>a += Math.PI/180;</strong> means to increment by π/180.
Consequently, each time when the <strong>cc()</strong> function
executes, the object moves along the circumference of a circle that has
the radius 120 and is centered at (197, 197).</p>
<p>Review</p>
<p>1. In terms of DHTML games, __ is responsible for the appearance of
objects, while __ is Questions</p>
<p>responsible for how objects move, behave, and interact with other
objects.</p>
<p>A. CSS, HTML</p>
<p>B. HTML, CSS</p>
<p>C. CSS, scripting language</p>
<p>D. scripting, CSS</p>
<p>2. Given the following code block, which statement is correct?</p>
<p>function dd() {</p>
<p>t1.style.left=i;</p>
<p>t1.style.top=j;</p>
<p>.........</p>
<p>}</p>
<p>A. t1.style.top represents the x-coordinate of the t1 object.</p>
<p>B. t1.style.left represents the y-coordinate of the t1.object.</p>
<p>C. t1.style.left represents the x-coordinate of the t1.object.</p>
<p>D. t1.style.top is equivalent to t1.getElementById().style.top</p>
<p>3. Which is equivalent to the following line?</p>
<p>var x=m1.style.pixelLeft;</p>
<p>Game Programming – Penn Wu</p>
<p>124</p>
<p><span id="index_split_008.html#p125"></span></p>
<p>A. var x=document.getElementById('m1').style.pixelLeft;</p>
<p>B. var x=m1.getElementById().style.pixelLeft;</p>
<p>C. var x=m1.getElementById('m1').style.pixelLeft;</p>
<p>D. var x=document.getElementById().m1.style.pixelLeft;</p>
<p>4. Given the following code, which statement is correct?</p>
<p>function change_color() {</p>
<p>var oldID = event.srcElement.id;</p>
<p>document.getElementById(oldID).style.color=oldID;</p>
<p>}</p>
<p>A. oldID will represent the ID of the object that triggers the
event.</p>
<p>B. oldID represents the previous ID of the object that triggers the
event, because srcElement.id will assign a new ID to it.</p>
<p>C. event.srcElement.id retrieve the ID of the mouse button.</p>
<p>D. event.srcElement.id retrieve the key code of the mouse button.</p>
<p>5. Which statement is correct?</p>
<p>A. The default position is "absolute".</p>
<p>B. The srcElement property sets or retrieves the object that fired
the event.</p>
<p>C. The display property sets if an element should be visible or
invisible.</p>
<p>D. The visibility property sets how/if an element is displayed</p>
<p>6. Which sets an object's position according to the normal flow, and
then offset by the op and left properties?</p>
<p>A. position:static</p>
<p>B. position:absolute</p>
<p>C. position:relative</p>
<p>D. position:physical</p>
<p>7. Which item will be on the front?</p>
<p>A. &lt;img id="m1" style=z-index: 1&gt;</p>
<p>B. &lt;img id="m2" style=z-index: 2&gt;</p>
<p>C. &lt;img id="m3" style=z-index: 3&gt;</p>
<p>D. &lt;img id="m4" style=z-index: 4&gt;</p>
<p>8. Which can control the speed of a function in JavaScript?</p>
<p>A. speed();</p>
<p>B. setTimeout();</p>
<p>C. controlTime();</p>
<p>D. setSpeed();</p>
<p>9. Given an object with ID "t1", which can move this object toward
northwest?</p>
<p>A. t1.style.pixelLeft + 2; t1.style.pixelTop + 2;</p>
<p>B. t1.style.pixelLeft + 2; t1.style.pixelTop - 2;</p>
<p>C. t1.style.pixelLeft - 2; t1.style.pixelTop - 2;</p>
<p>D. t1.style.pixelLeft - 2; t1.style.pixelTop + 2;</p>
<p>10. Given a center coordinate (100, 150) and a radius 25. Which
represents the y value of any point on the circle?</p>
<p>A. 100 + 25 * Sin</p>
<p>B. 150 + 25 * Sin</p>
<p>C. 100 + 25 * Cos</p>
<p>Game Programming – Penn Wu</p>
<p>125</p>
<p><span id="index_split_008.html#p126"></span>D. 150 + 25 * Cos</p>
<p>Game Programming – Penn Wu</p>
<p>126</p>
<p><span id="index_split_008.html#p127"></span><img
src="index-127_1.png" class="calibre5" alt="Image 117" /></p>
<p>Lab #7</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab7.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Drag and Drop</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab7_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.drag {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>var codes = "";</p>
<p>var x, y;</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=6; i++) {</p>
<p>x = Math.floor(Math.random()*document.body.clientWidth/2);</p>
<p>y = Math.floor(Math.random()*document.body.clientHeight/2);</p>
<p>codes += "&lt;img id='cy" + i + "' class='drag'"; codes += " src=cy"
+i + ".jpg style='left: "+x+";top:"+y+"'&gt;&lt;br&gt;";</p>
<p>}</p>
<p>area1.innerHTML = codes;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;span id=area1&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>127</p>
<p><span id="index_split_008.html#p128"></span><img
src="index-128_1.png" class="calibre5" alt="Image 118" /></p>
<p><strong>Learning Activity #2: USA Map</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab7_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.drag {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;img src="usa.gif"&gt;</p>
<p>&lt;table class="drag" border=1 cellspacing=0&gt;</p>
<p>&lt;tr&gt;</p>
<p>&lt;td&gt;California&lt;/td&gt;</p>
<p>&lt;td&gt;Oregan&lt;/td&gt;</p>
<p>&lt;td&gt;Washington&lt;/td&gt;</p>
<p>&lt;td&gt;Nevada&lt;/td&gt;</p>
<p>&lt;td&gt;Arizona&lt;/td&gt;</p>
<p>&lt;td&gt;Utah&lt;/td&gt;</p>
<p>&lt;td&gt;Idaho&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;tr&gt;</p>
<p>&lt;td&gt;&lt;img src="state1.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img src="state2.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img src="state3.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img src="state4.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img src="state5.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img src="state6.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img src="state7.gif" class="drag"&gt;&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;/table&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #3: Roulette Wheel 2</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>Game Programming – Penn Wu</p>
<p>128</p>
<p><span id="index_split_008.html#p129"></span><img
src="index-129_1.png" class="calibre5" alt="Image 119" /></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab7_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=1;</p>
<p>function spin() {</p>
<p>if (i&gt;=16) {i=1; }</p>
<p>else {</p>
<p>i++;</p>
<p>}</p>
<p>m1.src="wheel_"+i+".gif";</p>
<p>spinning = setTimeout("spin()", 100);</p>
<p>}</p>
<p>var r=120; a=0;</p>
<p>function cc() {</p>
<p>b1.style.left=197+r*Math.sin(a);</p>
<p>b1.style.top=197+r*Math.cos(a);</p>
<p>if (a &gt;= Math.PI *2) { a=0; }</p>
<p>else { a += Math.PI/180; }</p>
<p>rotating=setTimeout("cc()", 2);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;img id=m1 src="wheel_1.gif"&gt;</p>
<p>&lt;img id=b1 src="white_ball.gif" style="position:absolute;
z-index:1; left:20; top:20"&gt;</p>
<p>&lt;div style="position:absolute; left:50; top:400;"&gt;</p>
<p>&lt;button onClick="cc();spin()"&gt;Rotate&lt;/button&gt;</p>
<p>&lt;button onClick="clearTimeout(rotating);
clearTimeout(spinning)"&gt;Stop&lt;/button&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #4: Running Bugs</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>Game Programming – Penn Wu</p>
<p>129</p>
<p><span id="index_split_008.html#p130"></span></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab7_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.ants {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=8; i++) {</p>
<p>x=Math.floor(Math.random()*document.body.clientWidth);</p>
<p>y=Math.floor(Math.random()*document.body.clientHeight);</p>
<p>codes = "&lt;img src=ant"+i+".gif id=a"+i+" class=ants"</p>
<p>codes += " style='left:"+x+";top:"+y+"'&gt;"; area1.innerHTML +=
codes;</p>
<p>}</p>
<p>}</p>
<p>function move() {</p>
<p>a1.style.pixelLeft -= 5;</p>
<p>a1.style.pixelTop += 5;</p>
<p>a2.style.pixelTop += 5;</p>
<p>a3.style.pixelLeft += 5;</p>
<p>a3.style.pixelTop += 5;</p>
<p>a4.style.pixelLeft -= 5;</p>
<p>a5.style.pixelLeft += 5;</p>
<p>a6.style.pixelLeft -= 5;</p>
<p>a6.style.pixelTop -= 5;</p>
<p>a7.style.pixelTop -= 5;</p>
<p>a8.style.pixelLeft += 5;</p>
<p>a8.style.pixelTop -= 5;</p>
<p>if (a1.style.pixelLeft &lt;= 0) {a1.style.pixelLeft =
document.body.clientWidth; }</p>
<p>if (a1.style.pixelTop &gt;= document.body.clientHeight)
{a1.style.pixelTop = 0; }</p>
<p>if (a2.style.pixelTop &gt;= document.body.clientHeight)
{a2.style.pixelTop = 0; }</p>
<p>if (a3.style.pixelLeft &gt;= document.body.clientWidth)
{a3.style.pixelLeft = 0; }</p>
<p>if (a3.style.pixelTop &gt;= document.body.clientHeight)
{a3.style.pixelTop = 0; }</p>
<p>if (a4.style.pixelLeft &lt;= 0) {a4.style.pixelLeft =
document.body.clientWidth; }</p>
<p>if (a5.style.pixelLeft &gt;= document.body.clientWidth)
{a5.style.pixelLeft = 0; }</p>
<p>if (a6.style.pixelLeft &lt;= 0) {a6.style.pixelLeft =
document.body.clientWidth; }</p>
<p>if (a6.style.pixelTop &lt;= 0) {a6.style.pixelTop =
document.body.clientHeight; }</p>
<p>if (a7.style.pixelLeft &lt;= 0) {a7.style.pixelLeft =
document.body.clientWidth; }</p>
<p>if (a8.style.pixelLeft &gt;= document.body.clientWidth)
{a8.style.pixelLeft = 0; }</p>
<p>if (a8.style.pixelTop &lt;= 0) {a8.style.pixelTop =
document.body.clientHeight; }</p>
<p>Game Programming – Penn Wu</p>
<p>130</p>
<p><span id="index_split_008.html#p131"></span><img
src="index-131_1.png" class="calibre5" alt="Image 120" /></p>
<p>setTimeout("move()", 20);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init();move()"&gt;</p>
<p>&lt;script id=area2&gt;&lt;/script&gt;</p>
<p>&lt;span id=area1&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #5: Rush Hour Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab7_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.dragr {position:absolute}</p>
<p>.dragc {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var dragapproved=false</p>
<p>var z,x,y</p>
<p>function move(){</p>
<p>if (event.button==1 &amp;&amp; dragapproved) {</p>
<p>var clsName = event.srcElement.className;</p>
<p>switch (clsName) {</p>
<p>case "dragr":</p>
<p>z.style.pixelLeft=temp1+event.clientX-x;</p>
<p>break;</p>
<p>case "dragc":</p>
<p>z.style.pixelTop=temp2+event.clientY-y</p>
<p>break;</p>
<p>}</p>
<p>return false</p>
<p>}</p>
<p>}</p>
<p>function drags(){</p>
<p>var clsName = event.srcElement.className;</p>
<p>Game Programming – Penn Wu</p>
<p>131</p>
<p><span id="index_split_008.html#p132"></span><img
src="index-132_1.png" class="calibre5" alt="Image 121" /></p>
<p>if (!document.all) { return }</p>
<p>if ((clsName=="dragr") || (clsName=="dragc")) {</p>
<p>dragapproved=true</p>
<p>z=event.srcElement</p>
<p>temp1=z.style.pixelLeft</p>
<p>temp2=z.style.pixelTop</p>
<p>x=event.clientX</p>
<p>y=event.clientY</p>
<p>document.onmousemove=move</p>
<p>}</p>
<p>}</p>
<p>&lt;!-- generating table --&gt;</p>
<p>function cc() {</p>
<p>codes = "&lt;table cellspacing=2 border=1";</p>
<p>codes += " style='left:0; top:0; position:absolute'&gt;"; for (h=1;
h&lt;=8; h++) {</p>
<p>codes += "&lt;tr height=36&gt;";</p>
<p>for (i=1; i&lt;=8; i++) {</p>
<p>codes += "&lt;td width=36&gt;&amp;nbsp;&lt;/td&gt;";</p>
<p>}</p>
<p>codes += "&lt;/tr&gt;";</p>
<p>}</p>
<p>codes += "&lt;/table&gt;";</p>
<p>area1.innerHTML = codes;</p>
<p>}</p>
<p>document.onmousemove=move</p>
<p>document.onmousedown=drags</p>
<p>document.onmouseup=new Function("dragapproved=false")</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=cc()&gt;</p>
<p>&lt;div id=area1&gt;&lt;/div&gt;</p>
<p>&lt;img id="rc1" class=dragr src="rcar01.gif" style="left:4;
top:4"&gt;</p>
<p>&lt;img id="rc2" class=dragr src="rcar02.gif" style="left:172;
top:156"&gt;</p>
<p>&lt;img id="rc3" class=dragr src="rcar03.gif" style="left:46;
top:232"&gt;</p>
<p>&lt;img id="cc1" class=dragc src="ccar01.gif" style="left:46;
top:118"&gt;</p>
<p>&lt;img id="cc2" class=dragc src="ccar02.gif" style="left:256;
top:42"&gt;</p>
<p>&lt;img id="cc3" class=dragc src="ccar03.gif" style="left:130;
top:118"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>Game Programming – Penn Wu</p>
<p>132</p>
<p><span id="index_split_008.html#p133"></span>1. Upload all files you
created in this lab to your remote web server.</p>
<p>2. Log in to to Blackboard, launch Assignment 07, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab7_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab7_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab7_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab7_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab7_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>133</p>
<p><span id="index_split_008.html#p134"></span></p>
<p>Lecture #8</p>
<p>Collision detection and response</p>
<p><span id="index_split_009.html"></span></p>
<h2 class="calibre2"
id="index_split_009.html#calibre_pb_8">Introduction</h2>
<p>Collision detection and collision response is the act of detecting
whether or not a collision has happened, and if so, responding to the
collision. In physical simulations, video games and computational
geometry, collision detection includes algorithms from checking for
intersection between two given solids, to calculating trajectories,
impact times and impact points in a physical simulation. There are
several methods of collision detection, and the right one for the job
depends on the shape of the object.</p>
<p>DHTML allows developers to create client-side applications of a type
that was once possible only with server-side programming. By combining
JavaScript with Cascading Style Sheets, it's possible to perform
effective collision detection.</p>
<p>The following JavaScript example uses two screen elements (which
could be images, layers, divisions, or anything else in the document
object hierarchy) called <strong>myObject1</strong> and
<strong>myObject2</strong>.</p>
<p>The variables x and y hold either a true or a false value, depending
on whether the two objects overlap on either the horizontal plane or the
vertical plane. If both x and y evaluate to true, then the two objects
have collided.</p>
<p>x = ((myObject1.style.posLeft &gt;= myObject2.style.posLeft)
&amp;&amp; (myObject.style.posLeft &lt;= myObject2.style.posLeft));</p>
<p>y = ((myObject.style.posTop &gt;= myObject2.style.posTop) &amp;&amp;
(myObject1.style.posTop &lt;= myObject2.style.posTop));</p>
<p>if (x &amp;&amp; y)</p>
<p>{</p>
<p>// Collision has occurred.</p>
<p>}</p>
<p>The <strong>move_crab()</strong> function, for example, use the
<em>if</em> statement with programming logic similar to the above
one.</p>
<p>function move_crabs() {</p>
<p>var redSpeed = Math.floor(Math.random()*20);</p>
<p>.............</p>
<p>red.style.pixelLeft += redSpeed;</p>
<p>.............</p>
<p><strong>if (red.style.pixelLeft + 32 &gt;=
area2.style.pixelLeft)</strong> {</p>
<p>clearTimeout(s1);alert("Winner is the red crab!");}</p>
<p>.............</p>
<p>}</p>
<p>The following line is the spine of the collision detection, it
determine whether or not the <strong>red</strong> object and the
<strong>area2</strong> object collide.</p>
<p>One-</p>
<p>Handling collision detection in 2D graphics is based on a simple
idea--determine whether or not dimensional</p>
<p>two or more graphics collide with one another. In a Web game, for
example, graphics are in a collision</p>
<p>shape of rectangle, so you can simply try to detect whether two or
more rectangular areas are in detection</p>
<p>any way touching or overlapping each other.</p>
<p>A rectangular image has four vertexes. In the following graphic, 1,
2, 3, and 4 represent each of Game Programming – Penn Wu</p>
<p>134</p>
<p><span id="index_split_009.html#p135"></span><img
src="index-135_1.png" class="calibre5" alt="Image 122" /></p>
<p>the vertexes:</p>
<p>Assuming this graphic is given an object ID <strong>obj1</strong>,
the (x, y) coordinates of these 4 vertexes can be represented by:</p>
<p>•</p>
<p>1: (obj1.style.pixelLeft, obj1.style.pixelTop)</p>
<p>•</p>
<p>2: (obj1.style.pixelLeft + obj1.style.width, obj1.style.pixelTop)</p>
<p>•</p>
<p>3: (obj1.style.pixelLeft + obj1.style.width, obj1.style.pixelTop +
obj1.style.height)</p>
<p>•</p>
<p>4: (obj1.style.pixelLeft, obj1.style.pixelTop + obj1.style.height) A
simple implementation of this method is as follows:</p>
<p>&lt;html&gt;&lt;style&gt;</p>
<p>.drag {position: absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function obj1Move() {</p>
<p>obj1.style.left = obj1.style.pixelLeft + 5;</p>
<p>s1 = setTimeout("obj1Move()", 50);</p>
<p>}</p>
<p>function obj2Move() {</p>
<p>obj2.style.left = obj2.style.pixelLeft + 5;</p>
<p><strong>if (obj2.style.pixelLeft &gt;= obj1.style.pixelLeft)
{</strong></p>
<p><strong>clearTimeout(s1);</strong></p>
<p><strong>clearTimeout(s2);</strong></p>
<p><strong>p1.innerText = "Game Over!";</strong></p>
<p><strong>}</strong></p>
<p>else {</p>
<p>s2 = setTimeout("obj2Move()", 20);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="obj1Move();obj2Move();"&gt;</p>
<p>&lt;img id="obj1" class="drag" src="pac1.gif"</p>
<p>style="top:10;left:200"&gt;</p>
<p>&lt;img id="obj2" class="drag" src='gst1.gif'
style="top:10;left:10"&gt;</p>
<p>&lt;p id=p1 class="drag" style="top:150; left:140;"&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>There are two image files: <strong>pac1.gif</strong> and
<strong>gst1.gif</strong>. Their IDs are <strong>obj1</strong> and
<strong>obj2</strong> respectively. In the obj1Move() function, the
<strong>obj1</strong> is set to increment its value of
<em>x</em>-coordinate by 5px every 50</p>
<p>milliseconds, as shown below:</p>
<p>obj1.style.left = obj1.style.pixelLeft + 5;</p>
<p>Similarly, the <strong>obj2</strong> is set to increment its value of
<em>x</em>-coordinate by 5px every 20 milliseconds, as shown below:</p>
<p>obj2.style.left = obj2.style.pixelLeft + 5;</p>
<p>Game Programming – Penn Wu</p>
<p>135</p>
<p><span id="index_split_009.html#p136"></span><img
src="index-136_1.png" class="calibre5" alt="Image 123" /></p>
<p><img src="index-136_2.png" class="calibre5" alt="Image 124" /></p>
<p><img src="index-136_3.png" class="calibre5" alt="Image 125" /></p>
<p><img src="index-136_4.png" class="calibre5" alt="Image 126" /></p>
<p><img src="index-136_5.png" class="calibre5" alt="Image 127" /></p>
<p><img src="index-136_6.png" class="calibre5" alt="Image 128" /></p>
<p><img src="index-136_7.png" class="calibre5" alt="Image 129" /></p>
<p><img src="index-136_8.png" class="calibre5" alt="Image 130" /></p>
<p>Since obj2 moves faster then obj1, obj2 will soon catch up and
overlaps with obj1. You can use the following code block to detect such
collision, and the logic is “if the <em>x</em>-coordinate of obj2 is
greater than or equal to the <em>x</em>-coordinate of obj1”:</p>
<p>if (obj2.style.pixelLeft &gt;= obj1.style.pixelLeft)</p>
<p>Two-</p>
<p>In a given plant, rectangles are two-dimensional: vertical and
horizontal. In many games, dimensional</p>
<p>collisions can happen in any direction, vertically, horizontally, or
both. The following figure collision</p>
<p>illustrates four of the possible directions these two image files
overlap with each other.</p>
<p>detection</p>
<p>A rectangular area has four vertexes, but you can use the diagonal to
define the perimeter of the rectangle. This diagonal is drawn by
connecting the top-left-most point and bottom-right-most point. The
following figure uses (x1, y1) and (x2, y2) to indicate the four
coordinate sets of each images (obj1 and obj2).</p>
<p>obj1</p>
<p>obj2</p>
<p>When the value of x1 increases, the object moves from left to right,
and vica versa. When the value of y1 increases, the object moves from
top to bottom, and vica versa. Therefore, the set of (x1, y1) take care
of the left and top border.</p>
<p>Similarly, the change in values of (x2, y2) handles the right and
bottom border.</p>
<p>Once you understand the logic, you can write codes to detect the
collision of these two images from any direction. First, you can try to
define four variables to represent (x1, y1) and (x2, y2) of both image
file:</p>
<p>Game Programming – Penn Wu</p>
<p>136</p>
<p><span id="index_split_009.html#p137"></span><img
src="index-137_1.png" class="calibre5" alt="Image 131" /></p>
<p><img src="index-137_2.png" class="calibre5" alt="Image 132" /></p>
<p>The values of (x1, y1) of obj1 are assigned to (left1, top1) by the
following statements: left1 = obj1.style.pixelLeft;</p>
<p>top1 = obj1.style.pixelTop;</p>
<p>The value of (x2, y2) can be easily determined, they are:</p>
<p>•</p>
<p>x2 = x1 + width</p>
<p>•</p>
<p>y2 = y1 + height</p>
<p>So you can translate them into:</p>
<p>right1 = obj1.style.pixelLeft + obj1.style.width;</p>
<p>bottom1 = obj1.style.pixelTop + obj1.style.height;</p>
<p>The following is an example of how you handle the coding in
DHTML.</p>
<p>&lt;script&gt;</p>
<p>var left1, left2;</p>
<p>var right1, right2;</p>
<p>var top1, top2;</p>
<p>var bottom1, bottom2;</p>
<p>left1 = obj1.style.pixelLeft;</p>
<p>left2 = obj2.style.pixelLeft;</p>
<p>right1 = obj1.style.pixelLeft + obj1.style.width;</p>
<p>right2 = obj2.style.pixelLeft + obj2.style.width;</p>
<p>top1 = obj1.style.pixelTop;</p>
<p>top2 = obj2.style.pixelTop;</p>
<p>bottom1 = obj1.style.pixelTop + obj1.style.height;</p>
<p>bottom2 = obj2.style.pixelTop + obj2.style.height;</p>
<p>.................</p>
<p>.................</p>
<p>function obj2Move() {</p>
<p>obj2.style.left = obj2.style.pixelLeft + 5;</p>
<p>if <strong>(((bottom1 &lt; top2) || (top1 &gt; bottom2) || (right1
&lt; left2)</strong></p>
<p><strong>|| (left1 &gt; right2))</strong> {</p>
<p>clearTimeout(s1);</p>
<p>clearTimeout(s2);</p>
<p>p1.innerText = "Game Over!";</p>
<p>}</p>
<p>else {</p>
<p>s2 = setTimeout("obj2Move()", 20);</p>
<p>}</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>137</p>
<p><span id="index_split_009.html#p138"></span><img
src="index-138_1.png" class="calibre5" alt="Image 133" /></p>
<p><img src="index-138_2.png" class="calibre5" alt="Image 134" /></p>
<p><img src="index-138_3.png" class="calibre5" alt="Image 135" /></p>
<p>&lt;/script&gt;</p>
<p>In the Jet Fighter game, the <strong>check()</strong> function
handles the collision detection. The <strong>ap01</strong> object is the
enemy’s airplane, while <strong>b01</strong> is the bullet.</p>
<p>The check() function uses a simple logic. First, the b01’s pixelLeft
must be between ap01.style.pixelLeft and ap01.style.pixelLeft + 70.
Second, the b01’s pixelTop must be less than or equal to
ap01.style.pixelTop. Notice that the dimension of <strong>ap01</strong>
is 70 × 70, meaning both the width and height are 70px.</p>
<p>function check() {</p>
<p>if ((b01.style.pixelLeft &gt;= ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &lt;= ap01.style.pixelLeft + 70) &amp;&amp;
(b01.style.pixelTop &lt;= ap01.style.pixelTop +70))</p>
<p>{</p>
<p>ap01.src="explode.gif";</p>
<p>setTimeout("ap01.style.display='none'",1000);</p>
<p>}</p>
<p>}</p>
<p>The following lines check if the b01’s pixelLeft is between
ap01.style.pixelLeft and ap01.style.pixelLeft + 70:</p>
<p>(b01.style.pixelLeft &gt;= ap01.style.pixelLeft) &amp;&amp;</p>
<p>(b01.style.pixelLeft &lt;= ap01.style.pixelLeft + 70)</p>
<p>The following line check if the less than or equal to
ap01.style.pixelTop: (b01.style.pixelTop &lt;= ap01.style.pixelTop
+70)</p>
<p>When all the three conditions are true, the following line changes
the image of ap01 to another one that is an animated flame.</p>
<p>ap01.src="explode.gif"; <strong></strong></p>
<p>Over-detecting</p>
<p>The method usually works fairly well to rectangles. But it has a
problem of “over-detecting”</p>
<p>collisions. For example, the Pacman graphic is not rectangular, it is
roundish. When it is put in a rectangular image file, as shown below,
there will be a distance between each vertex and the graphics. The blue
area in the following figure represents the blank space.</p>
<p>Game Programming – Penn Wu</p>
<p>138</p>
<p><span id="index_split_009.html#p139"></span><img
src="index-139_1.png" class="calibre5" alt="Image 136" /></p>
<p>Because the roundish shape of the graphics, the vertexes of each
image file contains empty space.</p>
<p>But the bounding rectangles of each image are clearly intersecting,
so a traditional collision detecting algorithm as the above code uses
will have deviations.</p>
<p>One acceptable solution to this over-detecting problem is to define a
somewhat smaller rectangle than the full extents of the image, and use
this smaller rectangle for the collision detection.</p>
<p>A good idea, in this case, is to use 80% of the full bounding box of
the image. To do so, you need to remove 20% of the space from the
rectangular image. You can define six new variables: <strong>obj1Width,
obj1Height, obj1ColWidth, obj1ColHeight, obj_X_offset,</strong> and
<strong>obj_Y_offset.</strong></p>
<p>obj1Width = obj1.style.pixelWidth;</p>
<p>obj1Height = obj1.style.pixelHeight;</p>
<p>obj1ColWidth = objWidth * 0.8;</p>
<p>obj1ColHeight = objHeight * 0.8;</p>
<p>obj1_X_offset = (objWidth - objColWidth) / 2;</p>
<p>obj1_Y_offset = (objHeight - objColHeight) / 2;</p>
<p>During initialization, wherever the above code retrieves the width
and height of <strong>obj1</strong>, and uses them to calculate the
<strong>obj1ColWidths</strong> and <strong>obj1ColHeights</strong> to be
20% smaller. It also defines the offset fields to describe where to set
the bounding box relative to the object’s coordinates.</p>
<p>Advanced</p>
<p>In a previous lecture, you learned the techniques of handling drag
and drop. Similar technique can collision</p>
<p>be used to detect collisions. For example, when the monsters are
bumping into PacMan, you can detection</p>
<p>check whether the floating DIV element is touching or overlapping a
valid Drag Target.</p>
<p>assuming,</p>
<p>&lt;DIV class="drag"&gt;</p>
<p>&lt;IMG SRC="mind.gif" WIDTH=115 HEIGHT=45 BORDER=0&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>As in the previous technique, there is nothing unusual about the DIV
element, except that it has been given a class name. Of course, you
would set the WIDTH and HEIGHT attributes of the IMG to fit your images.
It is important that all IMGs have the same WIDTH and HEIGHT.</p>
<p>Repeat this declaration for each DIV you want to make draggable.
Finally add an absolutely positioned DIV to your page like this:</p>
<p>&lt;DIV ID="floater"
style="visibility:hidden;position:absolute"&gt;</p>
<p>&lt;IMG SRC="trans.gif" WIDTH=115 HEIGHT=45 BORDER=0&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>This floating DIV is the only moving element in the page, the rest of
the DIVs are not absolutely positioned, and therefore cannot be moved.
Also notice that the IMG inside the DIV is given a SRC, even though it
is initially invisible. This is because of a bug in IE4 that prevents
dynamically setting the SRC of an IMG if the original SRC is not
specified.</p>
<p>The reason we need this algorithm is that since the mouse is over the
floating DIV, the onmouseup event's srcElement will not be accurate.
Also, since the surface area of the floating DIV is quite large, it is
quite possible that the DIV may overlap two or more potential
targets.</p>
<p>Game Programming – Penn Wu</p>
<p>139</p>
<p><span id="index_split_009.html#p140"></span>Only by comparing the
area of overlap of each target, can we accurately determine which the
target the user intended was. Happily, the Collision Detection Algorithm
can do this.</p>
<p>The algorithm goes something like this:</p>
<p>Given 2 rectangular objects of the same size,</p>
<p>the Horizontal and Vertical overlap between</p>
<p>them is given by :</p>
<p>hOverlap = W - |x2-x1|</p>
<p>vOverlap = H - |y2-y1|</p>
<p>where</p>
<p>W=width of the objects</p>
<p>H=Height of the objects</p>
<p>x1,y1=Top Left co-ordinates of Obj 1</p>
<p>x2,y2=Top Left co-ordinates of Obj 2</p>
<p>if both hOverlap and vOverlap are positive</p>
<p>their product gives the area of overlap of</p>
<p>the 2 objects.</p>
<p>if either or both are negative, the objects</p>
<p>do not overlap (have not collided).</p>
<p>Note: This algorithm was devised by Stanley Rajasingh.</p>
<p>Now that we have the algorithm, coding the <strong>onMouseup</strong>
handler is a trivial exercise. Looking at it we see -</p>
<p>function DragEnd(){</p>
<p>if(!DragEl) return;</p>
<p>X1=floater.style.pixelLeft;</p>
<p>Y1=floater.style.pixelTop;</p>
<p>MaxArea=0;</p>
<p>TargetElem=null;</p>
<p>Targets=document.all;</p>
<p>for(i=0;i&lt;Targets.length;i++)</p>
<p>if(Targets[i].className=="dnd"){</p>
<p>X2=getRealPos(Targets[i].children[0],"Left");</p>
<p>Y2=getRealPos(Targets[i].children[0],"Top");</p>
<p>hOverlap=floater.offsetWidth-Math.abs(X2-X1);</p>
<p>vOverlap=floater.offsetHeight-Math.abs(Y2-Y1);</p>
<p>areaOverlap=((hOverlap&gt;0)&amp;&amp;(vOverlap&gt;0))?hOverlap*vOverlap:0;
if(areaOverlap&gt;MaxArea){</p>
<p>MaxArea=areaOverlap;</p>
<p>TargetElem=Targets[i];</p>
<p>}</p>
<p>}</p>
<p>floater.style.visibility='hidden';</p>
<p>if(TargetElem){</p>
<p>//Swap Images</p>
<p>DragEl.src=TargetElem.children[0].src;</p>
<p>TargetElem.children[0].src=floater.children[0].src;</p>
<p>} else {</p>
<p>//Restore Original Image</p>
<p>DragEl.src=floater.children[0].src;</p>
<p>return;</p>
<p>}</p>
<p>DragEl=null;</p>
<p>Game Programming – Penn Wu</p>
<p>140</p>
<p><span id="index_split_009.html#p141"></span>}</p>
<p>The magic <em>for</em> loop cycles through each element in the above
code is that it checks to see if it is a valid Drag Target
(className=="dnd"). If it is, the code applies the Collision Detection
Algorithm to obtain the overlap area. The element which has the largest
overlap with the floating DIV becomes the
<strong>TargetElem</strong>.</p>
<p>Once the target has been obtained, the function swaps the source and
target images, and then hides the floating DIV, creating the illusion
that the <strong>Drag Source</strong> and <strong>Drag Target</strong>
have exchanged places. Finally it resets the Drag Source pointer
<strong>(DragEl)</strong> to null, indicating that the dragging has
ended.</p>
<p>Be aware that since this algorithm takes over the
<strong>onMouseOver</strong>, <strong>onMouseUp</strong>, and
<strong>onMouseMove</strong> handlers of the document, any other element
on the page that uses these events, such as a DHTML menu, will not
function. In order to prevent this you might want to overload these
handlers rather than taking over them entirely.</p>
<p>Collision Math</p>
<p>Given two objects <em><strong>X</strong></em> and
<em><strong>Y</strong></em> with position vectors <em>rx</em> and
<em>ry</em>, you want to be able to test whether or not the objects are
collided as a function of <em>rx</em> - <em>ry</em>.</p>
<p>The solution is that objects <em><strong>X</strong></em> and
<em><strong>Y</strong></em> overlap if the set</p>
<p>{( <em>x</em>, <em>y</em>) | <em>x</em> ∈ <em>X</em> ∧ <em>y</em> ∈
<em>Y</em> ∧ <em>x</em> + <em>rx</em> = <em>y</em> + <em>ry</em> }</p>
<p>is non-empty. This is equivalent to the condition of</p>
<p><em></em></p>
<p><em>rx</em> - <em>ry</em> ∈ <em>Z</em></p>
<p>where <strong>Z</strong> is the set</p>
<p>{ <em>y</em> – <em>x</em> | <em>x</em> ∈ <em>X</em> ∧ <em>y</em> ∈
<em>Y</em>}</p>
<p>If <strong>X</strong> and <strong>Y</strong> are arbitrary shapes,
then the shape <strong>Z</strong> should be pre-computed. However there
is no easy way to efficiently determine membership of a point in an
arbitrary shape in JavaScript (unless perhaps you separately encode the
shape <strong>Z</strong> as a suitable array of arrays).</p>
<p>One can avoid this problem by making all sprites a rectangular shape,
in which case if <strong>X</strong> is a rectangle with width <em>w</em>
x and height <em>h</em> x and <strong>Y</strong> is a rectangle with
width <em>w</em> y and height <em>h</em> y, then <strong>Z</strong></p>
<p>will be rectangle with width <em>w</em> x + <em>w</em> y and height
<em>h</em> x + <em>h</em> y. Which explains the following code: function
collided (element1, element2) {</p>
<p>var x1 = element1.offsetLeft;</p>
<p>var x2 = element2.offsetLeft - element1.offsetWidth;</p>
<p>var x3 = element2.offsetLeft + element2.offsetWidth;</p>
<p>if (x2 &lt;= x1 &amp;&amp; x1 &lt;= x3) {</p>
<p>var y1 = element1.offsetTop;</p>
<p>var y2 = element2.offsetTop - element1.offsetHeight;</p>
<p>var y3 = element2.offsetTop + element2.offsetHeight;</p>
<p>return y2 &lt;= y1 &amp;&amp; y1 &lt;= y3;</p>
<p>}</p>
<p>else {</p>
<p>return false;</p>
<p>}</p>
<p>}</p>
<p>In the above code, <strong>element1</strong> is <strong>X</strong>,
<strong>element2</strong> is <strong>Y</strong>, and the variables
<strong>x2</strong>, <strong>x3</strong>, <strong>y2</strong> and
<strong>y3</strong> represent the boundaries of
<strong>element2</strong> as if it had a size of the hypothetical
<strong>Z</strong> object.</p>
<p>The other thing to watch with collision detection is that if you are
checking it once per game loop, Game Programming – Penn Wu</p>
<p>141</p>
<p><span id="index_split_009.html#p142"></span>then you want to make
sure that the objects aren't moving towards each other so fast that they
can skip past each other, i.e. their total distance travelled relative
to each other per game loop should not exceed the size of the vector
corresponding to their combined width and height.</p>
<p>Review</p>
<p>1. Handling collision detection in 2D graphics is based on
determining __.</p>
<p>Questions</p>
<p>A. if two objects' shapes are symmetrical.</p>
<p>B. whether or not two or more objects collide with one another.</p>
<p>C. if two objects' motions are synchronous.</p>
<p>D. whether or not two or more objects resemble one another.</p>
<p>2. Which can express the following sentence:</p>
<p>"If the x-coordinate of obj2 is greater than or equal to the
x-coordinate of obj1"</p>
<p>A. if ((obj2.style.pixelLeft &gt; z.style.pixelLeft) &amp;&amp;
(obj2.style.pixelLeft = z.style.pixelLeft)) B. if (z.style.pixelLeft
&gt;= obj2.style.pixelLeft)</p>
<p>C. if (obj2.style.pixelLeft &gt;= z.style.pixelLeft)</p>
<p>D. if ((z.style.pixelLeft &gt; obj2.style.pixelLeft) &amp;&amp;
(z.style.pixelLeft = obj2.style.pixelLeft)) 3. Given the following
rectangular object with an ID "z", which can represent the (x, y)
coordinate of the vertex 3 using DHTML?</p>
<p>1---2</p>
<p>| |</p>
<p>| |</p>
<p>4---3</p>
<p>A. (z.style.pixelLeft + object.style.width, z.style.pixelTop)</p>
<p>B. (z.style.pixelLeft, z.style.pixelTop)</p>
<p>C. (z.style.pixelLeft, z.style.pixelTop + object.style.height)</p>
<p>D. (z.style.pixelLeft + object.style.width, z.style.pixelTop +
object.style.height) 4. Given the following rectangular object with an
ID "z", which can represent the (x, y) coordinate of the vertex 2 using
DHTML?</p>
<p>1---2</p>
<p>| |</p>
<p>| |</p>
<p>4---3</p>
<p>A. (z.style.pixelLeft + object.style.width, z.style.pixelTop)</p>
<p>B. (z.style.pixelLeft, z.style.pixelTop)</p>
<p>C. (z.style.pixelLeft, z.style.pixelTop + object.style.height)</p>
<p>D. (z.style.pixelLeft + object.style.width, z.style.pixelTop +
object.style.height) 5. Given an object that has dimension of 60 X 60
and the ID "b", which can represent the (x, y) coordinate of the vertex
4 using DHTML?</p>
<p>1---2</p>
<p>| |</p>
<p>| |</p>
<p>4---3</p>
<p>A. (b.style.pixelLeft + 60, b.style.pixelTop + 60)</p>
<p>B. (b.style.pixelLeft, b.style.pixelTop + 60)</p>
<p>C. (b.style.pixelLeft + 60, b.style.pixelTop)</p>
<p>D. (b.style.pixelLeft, b.style.pixelTop)</p>
<p>Game Programming – Penn Wu</p>
<p>142</p>
<p><span id="index_split_009.html#p143"></span></p>
<p>6. Which can determine if the less than or equal to
ap01.style.pixelTop?</p>
<p>A. if (b01.style.pixelTop &lt;= ap01.style.pixelTop)</p>
<p>B. if (ap01.style.pixelTop &lt;= b01.style.pixelTop)</p>
<p>C. if ((ap01.style.pixelTop &lt; b01.style.pixelTop) &amp;&amp;
(ap01.style.pixelTop &lt; b01.style.pixelTop) D. if ((b01.style.pixelTop
&lt; ap01.style.pixelTop) &amp;&amp; (b01.style.pixelTop &lt;
ap01.style.pixelTop)) 7. Which can determine if the b01's pixelLeft is
between ap01.style.pixelLeft and ap01.style.pixelLeft + 70?</p>
<p>A. if (b01.style.pixelTop &lt;= ap01.style.pixelTop + 70)</p>
<p>B. if ((b01.style.pixelLeft &gt;= ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &lt;=</p>
<p>ap01.style.pixelLeft + 70))</p>
<p>C. if ((b01.style.pixelLeft &lt;= ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &gt;=</p>
<p>ap01.style.pixelLeft + 70))</p>
<p>D. if ((b01.style.pixelLeft &gt; ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &lt; ap01.style.pixelLeft</p>
<p>+ 70) &amp;&amp; (b01.style.pixelLeft = ap01.style.pixelLeft))</p>
<p>8. Which can force the "z" object to change its value of the "src"
property to "apple.gif"?</p>
<p>A. z.src = "apple.gif"</p>
<p>B. z.style.src = "apple.gif"</p>
<p>C. z.style.Src = "apple.gif"</p>
<p>D. z = "apple.gif"</p>
<p>9. The term "over-detecting" means __.</p>
<p>A. a rectangular image file with over-sized graphics that cause
unexpected collision.</p>
<p>B. a rectangular image file with over-programmed code to make the
collision detection function over sensitive.</p>
<p>C. a rectangular image file that contains polygons that makes the
collision detection function over sensitive.</p>
<p>D. a rectangular image file that contains graphics that does not
fully fill the rectangular area, such that the unfilled area become
blank space when collision happens.</p>
<p>10. What statement is correct about "collision detection and
response"?</p>
<p>A. It is the act of detecting whether or not a collision has
happened.</p>
<p>B. It uses algorithms from checking for intersection between two
given solids.</p>
<p>C. Collision detection is responsible for determining whether or not
a collision happens, while collision response handles the counter-action
when the collision is detected.</p>
<p>D. All of the above.</p>
<p>Game Programming – Penn Wu</p>
<p>143</p>
<p><span id="index_split_009.html#p144"></span></p>
<p>Lab #8</p>
<p>Collision detection and response</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab8.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Simple Pacman I</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab8_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.drag {position: absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function obj1Move() {</p>
<p>obj1.style.left = eval(obj1.style.left.replace('px','')) + 5;</p>
<p>s1 = setTimeout("obj1Move()", 50);</p>
<p>}</p>
<p>function obj2Move() {</p>
<p>obj2.style.left = eval(obj2.style.left.replace('px','')) + 5;</p>
<p>if (eval(obj2.style.left.replace('px','')) &gt;=</p>
<p>eval(obj1.style.left.replace('px',''))) {</p>
<p>clearTimeout(s1);</p>
<p>clearTimeout(s2);</p>
<p>p1.innerText = "Game Over!";</p>
<p>}</p>
<p>else {</p>
<p>s2 = setTimeout("obj2Move()", 20);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="obj1Move();obj2Move();"&gt;</p>
<p>&lt;img id="obj1" class="drag" src="pac1.gif"
style="top:10;left:200"&gt;</p>
<p>&lt;img id="obj2" class="drag" src='gst1.gif'
style="top:10;left:10"&gt;</p>
<p>&lt;p id=p1 class="drag" style="top:150; left:140;"&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Obj2 chases Obj1, and when they overlap each
other, the game is over. Click Refresh to restart the game. A sample
output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>144</p>
<p><span id="index_split_009.html#p145"></span><img
src="index-145_1.png" class="calibre5" alt="Image 137" /></p>
<p><img src="index-145_2.png" class="calibre5" alt="Image 138" /></p>
<p>to</p>
<p><strong>Learning Activity #2: Simple Pacman II</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab8_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.drag {position: absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script src="dragndrop.js"&gt;&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>var left1, left2;</p>
<p>var top1, top2;</p>
<p>function obj1Move2Right() {</p>
<p>left1 = eval(obj1.style.left.replace('px',''));</p>
<p>top1 = eval(obj1.style.top.replace('px',''));</p>
<p>if (left1 &gt;= (document.body.clientWidth - 100)) {</p>
<p>clearTimeout(ToRight);</p>
<p>obj1Move2Left();</p>
<p>}</p>
<p>else {</p>
<p>obj1.src="pac1.gif"</p>
<p>obj1.style.left = left1 + 2;</p>
<p>eat();</p>
<p>ToRight = setTimeout("obj1Move2Right()", 20);</p>
<p>}</p>
<p>}</p>
<p>function obj1Move2Left() {</p>
<p>left1 = eval(obj1.style.left.replace('px',''));</p>
<p>top1 = eval(obj1.style.top.replace('px',''));</p>
<p>if (left1 &lt;= 0) {</p>
<p>clearTimeout(ToLeft);</p>
<p>obj1Move2Right();</p>
<p>}</p>
<p>else {</p>
<p>obj1.src="pac2.gif"</p>
<p>obj1.style.left = left1 - 2;</p>
<p>ToLeft = setTimeout("obj1Move2Left()", 20);</p>
<p>}</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>145</p>
<p><span id="index_split_009.html#p146"></span><img
src="index-146_1.png" class="calibre5" alt="Image 139" /></p>
<p>function dots() {</p>
<p>scripts ="function eat() {";</p>
<p>k = (document.body.clientWidth - 100) / 20;</p>
<p>for (i=1; i&lt;=k; i++) {</p>
<p>codes = "&lt;img id=d"+i+ " src='dot.gif' class='drag'"; codes += "
style='z-index:1;top:30; left:"+ i*20+"'&gt;"; area1.innerHTML +=
codes;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;script src="eat.js"&gt;&lt;/script&gt;</p>
<p>&lt;body onLoad="dots();obj1Move2Right();"&gt;</p>
<p>&lt;img id="obj1" class="drag" src="pac1.gif" style="top:10;left:0;
z-index:2"&gt;</p>
<p>&lt;span id=area1&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #3: Racing Crabs</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab8_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>div, img { position: absolute;left:10px }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>area1.style.width = document.body.clientWidth - 80;</p>
<p>area1.style.borderRight = "solid 2 white";</p>
<p>area2.style.pixelLeft = document.body.clientWidth - 70;</p>
<p>}</p>
<p>function move_crabs() {</p>
<p>var redSpeed = Math.floor(Math.random()*20);</p>
<p>var greenSpeed = Math.floor(Math.random()*20);</p>
<p>var blueSpeed = Math.floor(Math.random()*20);</p>
<p>var whiteSpeed = Math.floor(Math.random()*20);</p>
<p>red.style.pixelLeft += redSpeed;</p>
<p>green.style.pixelLeft += greenSpeed;</p>
<p>blue.style.pixelLeft += blueSpeed;</p>
<p>Game Programming – Penn Wu</p>
<p>146</p>
<p><span id="index_split_009.html#p147"></span><img
src="index-147_1.png" class="calibre5" alt="Image 140" /></p>
<p>white.style.pixelLeft += whiteSpeed;</p>
<p>if (red.style.pixelLeft + 32 &gt;= area2.style.pixelLeft) {</p>
<p>clearTimeout(s1);alert("Winner is the red crab!");}</p>
<p>else if (green.style.pixelLeft + 32 &gt;= area2.style.pixelLeft)
{</p>
<p>clearTimeout(s1);alert("Winner is the green crab!");}</p>
<p>else if (blue.style.pixelLeft + 32 &gt;= area2.style.pixelLeft) {</p>
<p>clearTimeout(s1);alert("Winner is the blue crab!");}</p>
<p>else if (white.style.pixelLeft + 32 &gt;= area2.style.pixelLeft)
{</p>
<p>clearTimeout(s1);alert("Winner is the white crab!");}</p>
<p>else { s1 = setTimeout("move_crabs()", 200); }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div style="background-color:black; width:100%; height:130;
z-index:2" id="area1"&gt;</p>
<p>&lt;img style="background-color:red; top:20; z-index:3"
src="crab.gif" id="red"&gt;&lt;br&gt;</p>
<p>&lt;img style="background-color:green; top:45; z-index:3"
src="crab.gif"</p>
<p>id="green"&gt;&lt;br&gt;</p>
<p>&lt;img style="background-color:blue; top:70; z-index:3"
src="crab.gif" id="blue"&gt;&lt;br&gt;</p>
<p>&lt;img style="background-color:white; top:95; z-index:3"
src="crab.gif"</p>
<p>id="white"&gt;&lt;br&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;div style="background-color:black; width:60; height:130;
z-index:1"</p>
<p>id="area2"&gt;&lt;/div&gt;</p>
<p>&lt;button style="position:absolute; top:200;"
onClick="move_crabs()"&gt;Play&lt;/button&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Click the Play button to start. Click the
browser’s Refresh button to reset. A sample output looks:</p>
<p><strong>Learning Activity #4: Jet Fighter</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab8_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;SCRIPT&gt;</p>
<p>function init() {</p>
<p>ap01.style.left=Math.floor(Math.random() *
document.body.clientWidth)-120; st01.style.left=Math.floor(Math.random()
* document.body.clientWidth); st01.style.top=Math.floor(Math.random() *
document.body.clientHeight); Game Programming – Penn Wu</p>
<p>147</p>
<p><span id="index_split_009.html#p148"></span>if ((st01.style.pixelTop
&lt;= 100) || (st01.style.pixelTop &gt;=</p>
<p>document.body.clientHeight)) {</p>
<p>st01.style.top=Math.floor(Math.random() *
document.body.clientHeight); }</p>
<p>b01.style.pixelLeft=st01.style.pixelLeft + 35;</p>
<p>b01.style.pixelTop=st01.style.pixelTop - 10;</p>
<p>cc();</p>
<p>}</p>
<p>function cc() {</p>
<p>check()</p>
<p>r_width = eval(document.body.clientWidth) - 120;</p>
<p>ap01.style.pixelLeft=ap01.style.pixelLeft + 10;</p>
<p>if (ap01.style.pixelLeft &gt;= r_width)</p>
<p>{</p>
<p>clearTimeout(s1);dd();</p>
<p>}</p>
<p>else {</p>
<p>s1 = setTimeout("cc()",100);</p>
<p>}</p>
<p>}</p>
<p>function dd() {</p>
<p>check()</p>
<p>ap01.style.pixelLeft=ap01.style.pixelLeft - 10;</p>
<p>if (ap01.style.pixelLeft &lt;= 10) {</p>
<p>clearTimeout(s2);cc();</p>
<p>}</p>
<p>else {</p>
<p>s2 = setTimeout("dd()",100);</p>
<p>}</p>
<p>}</p>
<p>function fly() {</p>
<p>var e=event.keyCode;</p>
<p>switch (e) {</p>
<p>case 37:</p>
<p>st01.style.pixelLeft=st01.style.pixelLeft - 10;</p>
<p>break;</p>
<p>case 39:</p>
<p>st01.style.pixelLeft=st01.style.pixelLeft + 10;</p>
<p>break;</p>
<p>case 38:</p>
<p>st01.style.pixelTop=st01.style.pixelTop - 10;</p>
<p>break;</p>
<p>case 40:</p>
<p>st01.style.pixelTop=st01.style.pixelTop + 10;</p>
<p>break;</p>
<p>case 83:</p>
<p>b01.style.display='inline';</p>
<p>b01.style.pixelLeft=st01.style.pixelLeft + 35;</p>
<p>b01.style.pixelTop=st01.style.pixelTop - 10;</p>
<p>shoot();</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>function shoot() {</p>
<p>if (b01.style.pixelTop == 0) {</p>
<p>Game Programming – Penn Wu</p>
<p>148</p>
<p><span id="index_split_009.html#p149"></span><img
src="index-149_1.png" class="calibre5" alt="Image 141" /></p>
<p>b01.style.display='none';</p>
<p>clearTimeout(sh);</p>
<p>}</p>
<p>else {</p>
<p>b01.style.top=b01.style.pixelTop - 5;</p>
<p>}</p>
<p>sh = setTimeout("shoot()",5);</p>
<p>}</p>
<p>function check() {</p>
<p>if ((b01.style.pixelLeft &gt;= ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &lt;= ap01.style.pixelLeft + 70) &amp;&amp;
(b01.style.pixelTop &lt;= ap01.style.pixelTop))</p>
<p>{</p>
<p>ap01.src="explode.gif";</p>
<p>setTimeout("ap01.style.display='none'",1000);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor=000000; onkeydown="fly();" onLoad=init()&gt;</p>
<p>&lt;img id=ap01 src="e_plan.gif" style="position:absolute;
z-index:3"&gt;</p>
<p>&lt;img id=st01 src="shooter.gif" style="position:absolute;"&gt;</p>
<p>&lt;b id=b01 style="position:absolute; color:white; display:none;
z-index=2"&gt;!&lt;/b&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #5: Shooting Crabs</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab8_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.bee {position:relative; background-color:yellow; z-index: 1}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>codes ="";</p>
<p>for (i=1; i&lt;=5; i++) {</p>
<p>codes += "&lt;img class='bee' id=c" + i + " src='crab.gif'
/&gt;";</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>149</p>
<p><span id="index_split_009.html#p150"></span> area1.innerHTML +=
codes;</p>
<p>moveLeft();</p>
<p>}</p>
<p>function moveLeft() {</p>
<p>leftSide = area1.style.pixelLeft + 5*32;</p>
<p>if (leftSide &gt;= 300) {</p>
<p>if (area1.style.pixelTop &gt;= 200) {</p>
<p>clearTimeout(sf);</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelTop += 20;</p>
<p>clearTimeout(sf); moveRight();</p>
<p>}</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelLeft += 5;</p>
<p>sf = setTimeout("moveLeft()", 100);</p>
<p>}</p>
<p>}</p>
<p>function moveRight() {</p>
<p>if (area1.style.pixelLeft == 0) {</p>
<p>if (area1.style.pixelTop &gt;= 200) {</p>
<p>clearTimeout(sr);</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelTop += 20;</p>
<p>clearTimeout(sr); moveLeft();</p>
<p>}</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelLeft -= 5;</p>
<p>sr = setTimeout("moveRight()", 100);</p>
<p>}</p>
<p>}</p>
<p>function shoot() {</p>
<p>var e=event.keyCode;</p>
<p>switch(e) {</p>
<p>case 37:</p>
<p>shooter.style.pixelLeft-=2; break;</p>
<p>case 39:</p>
<p>shooter.style.pixelLeft+=2; break;</p>
<p>case 83:</p>
<p>b1.style.pixelLeft = shooter.style.pixelLeft + 14;</p>
<p>b1.style.display = 'inline';</p>
<p>fire();</p>
<p>}</p>
<p>}</p>
<p>function fire() {</p>
<p>if (b1.style.pixelTop == 0) {</p>
<p>b1.style.display='none';</p>
<p>b1.style.top = 270;</p>
<p>clearTimeout(ss);</p>
<p>}</p>
<p>else {</p>
<p>b1.style.pixelTop -= 5;</p>
<p>if ((b1.style.pixelTop &lt;= area1.style.pixelTop + 20) &amp;&amp;
(b1.style.pixelTop &gt;=area1.style.pixelTop)) {</p>
<p>Game Programming – Penn Wu</p>
<p>150</p>
<p><span id="index_split_009.html#p151"></span><img
src="index-151_1.png" class="calibre5" alt="Image 142" /></p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 31)) {</p>
<p>c1.style.visibility='hidden'; b1.style.display='none';}</p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft + 32) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 61)) {</p>
<p>c2.style.visibility='hidden'; b1.style.display='none';}</p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft + 64) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 93)) {</p>
<p>c3.style.visibility='hidden'; b1.style.display='none';}</p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft + 96) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 127)) {</p>
<p>c4.style.visibility='hidden'; b1.style.display='none';}</p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft + 128) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 159)) {</p>
<p>c5.style.visibility='hidden'; b1.style.display='none';}</p>
<p>}</p>
<p>ss = setTimeout("fire()", 20);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init() onKeyDown=shoot()&gt;</p>
<p>&lt;div style="position:absolute; width:300; height:300;
background-color: black"&gt;</p>
<p>&lt;span id="area1" style="position:absolute;"&gt;&lt;/span&gt;</p>
<p>&lt;span id="b1" style="position:absolute; top:270; display:none;
color:white; z-index:2"&gt;!&lt;/span&gt;</p>
<p>&lt;span id="shooter" style="position:absolute; top:275;
color:white"&gt;&lt;b&gt;_|_&lt;/b&gt;&lt;/span&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press S to shoot, Press → or ← to move to left
or right. A sample output looks: <strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 08, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>Game Programming – Penn Wu</p>
<p>151</p>
<p><span id="index_split_009.html#p152"></span>•</p>
<p>http://www.geocities.com/cis261/lab8_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab8_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab8_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab8_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab8_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>152</p>
<p><span id="index_split_009.html#p153"></span></p>
<p>Lecture #9</p>
<p>Applying sound effects</p>
<p><span id="index_split_010.html"></span></p>
<h2 class="calibre2"
id="index_split_010.html#calibre_pb_9">Introduction</h2>
<p>In our environment, all the sound you can hear through your ears are
analog sounds. Even the sounds that come from the speaker of your
computer are analog sounds. However, computers are digital machines,
which mean computers do not process analog sounds.</p>
<p>The concept is when a microphone converts sound waves to voltage
signals, the resulting signal is an analog (or continuous) signal. The
sound card in your computer converts this analog signal to a digital
signal for a computer to process.</p>
<p>Analog to digital (A/D) converters handle the task of converting
analog signals to digital signals, which is also referred to as
sampling. The process of converting an analog signal to a digital signal
doesn't always yield exact results. How closely a digital wave matches
its analog counterpart is determined by the frequency at which it is
sampled, as well as the amount of information stored at each sample.</p>
<p>Common music Operating systems, such as Windows XP, take care of the
communication between the game file types</p>
<p>codes and A/D converter of the sound card. Digital sounds in Windows
are known as <strong>waves</strong>, which refer to the physical sound
waves from which digital sounds originate. Windows waves are stored in
files with a <strong>.WAV</strong> file extension, and can be stored in
a wide range of formats to accommodate different sound qualities. More
specifically, you can save waves in frequencies from 8kHz to 44kHz with
either 8 or 16 bits per sample and as either mono or stereo.</p>
<p>Musical Instrument Digital Interface, or <strong>MIDI</strong>, has
established a standard interface between musical instruments. MIDI is
commonly used with a dedicated keyboard to control a synthesizer.</p>
<p>The keyboard inputs musical information (such as musical notes), such
that the synthesizer can generate electronic sound output (such as
songs). MIDI is popular in generating sound effects for games.</p>
<p>Creating and</p>
<p>To be able to create and modify your own sounds, you need some type
of software sound editing editing sounds</p>
<p>utility. Sound editing utilities usually provide a means of sampling
sounds from a microphone, CD-ROM, or line input. There are many free,
open source, sound editing tools you can easily find on the
Internet.</p>
<p>The truth is that no matter what tool you choose to use, the process
of editing sounds is technically the same.</p>
<p>•</p>
<p>waveform: Determine whether the sound volume is too loud or too soft.
Waveform of a sound is the graphical appearance of the sound when
plotted over time.</p>
<p>•</p>
<p>Clipping: zooming in on the waveform in a sound editor and cutting
out the silence that appears before and after the sound.</p>
<p>•</p>
<p>Latency is the amount of time between when you queue a sound for
playing and when the user actually hears it. Latency should be kept to a
minimum so that sounds are heard when you want them to be heard without
any delay.</p>
<p>Background</p>
<p>DHTML uses HTML’s &lt;BGSOUND&gt; and &lt;EMBED&gt; tags to allow you
to associate a sound file sound/music</p>
<p>to a web game page as background sounds or soundtracks. Although it
plays a background sound when the page is opened, you then uses the
<strong>autostart="false"</strong> property and value to keep the sound
file from being played automatically.</p>
<p>The &lt;BGSOUND&gt; tag may be placed either within the
&lt;HEAD&gt;..&lt;/HEAD&gt; or the</p>
<p>&lt;BODY&gt;..&lt;/BODY&gt; portion of the page. For example,</p>
<p>&lt;HTML&gt;&lt;BODY&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>153</p>
<p><span id="index_split_010.html#p154"></span><img
src="index-154_1.png" class="calibre5" alt="Image 143" /></p>
<p>&lt;bgsound SRC="game1.mid" autostart="true" /&gt;</p>
<p>&lt;/BODY&gt;&lt;/HTML&gt;</p>
<p>and</p>
<p>&lt;HTML&gt;&lt;head&gt;</p>
<p>&lt;bgsound SRC="game1.mid" <strong>autostart="false"
/</strong>&gt;</p>
<p>&lt;/head&gt;&lt;/HTML&gt;</p>
<p>Microsoft documents specify more parameters for the &lt;BGSOUND&gt;
tag than are currently supported. The following table lists the
supported ones:</p>
<p>Parameter</p>
<p>Description</p>
<p>autostart="value" Set the value to TRUE to being playing the music
immediately upon page load.</p>
<p>ID=" <em>idvalue</em>"</p>
<p>An identifier to be used for references in associated style sheet,
hypertext links, and JavaScript code. Must begin with a letter and may
include underscores. ID should be unique within the scope of the
document. If duplicated, the collection of identical-ID elements may be
referenced by their ordinal numbers.</p>
<p>LOOP=" <em>n</em>"</p>
<p>Specifies how many times the sound will loop.</p>
<p>SRC=" <em>url</em>"</p>
<p>Specifies the URL of the sound file. As shown above, sound files can
be in any recognizable format (for example: "midi, wav, au") VOLUME="
<em>n</em>"</p>
<p>Determines the loudness of the background sound. Values may range
from -10,000 (weakest) to 0 (loudest). Not supported by the MAC.</p>
<p>You can use the HTML <strong>TITLE</strong> attribute to describe an
HTML tag. This capability is particularly important for elements that do
not normally have textual information associated with them, such as the
<strong>bgSound</strong> object, which specifies a sound file to play in
the background of a Web page.</p>
<p>The following example uses the TITLE attribute with the bgSound
object to describe the background sound.</p>
<p>&lt;BGSOUND SRC="soundfile.mid" <strong>TITLE="Sound of falling
water" /</strong>&gt; The <strong>&lt;EMBED&gt;</strong> tag allows
documents of any type to be embedded, including music files. For
example, the following use of the EMBED element mimics the behavior of
the BGSOUND tag.</p>
<p>&lt;EMBED type="audio/x-midi" src="cis261.mid"
<strong>autostart="false"</strong></p>
<p><strong>hidden="true"</strong> &gt;</p>
<p>When you embed a sound, it plays as soon as the page loads, you can
use the <strong>autostart</strong></p>
<p><strong>=</strong>" <strong>false</strong>" property and values to
prevent the sound file from being played as soon as the page is
loaded.</p>
<p>The <strong>hidden</strong> property, when being set to true,
controls the visibility of the sound file icon. If you do not supply
HIDDEN, then the sound file icon will be visible, as shown below.</p>
<p>The EMBED element must appear inside the BODY element of the
document. Additionally, Internet Explorer relies on the resource
specified in the SRC attribute to ultimately determine which application
to use to display the embedded document.</p>
<p>You can call a sound playback function from the onMouseOver event
handler. For example, Game Programming – Penn Wu</p>
<p>154</p>
<p><span id="index_split_010.html#p155"></span>&lt;button</p>
<p>onMouseOver="playSound();return true"</p>
<p>onMouseOut ="stopSound();return true"</p>
<p>&gt;Play&lt;/button&gt;</p>
<p>This technique applies to the design of the Piano game. When a user
move mouse over the key, the computer plays the Csound file.</p>
<p>............</p>
<p>............</p>
<p>&lt; <strong>span class="wKey" id="midC" style="left:50"</strong></p>
<p><strong>onMouseOver="Down();document.Csound.play()"</strong></p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>............</p>
<p>............</p>
<p>&lt;span class="bKey" id="cSharp" style="left:72"</p>
<p>onMouseOver="document.Cs.play()"&gt;&lt;/span&gt;</p>
<p>...........</p>
<p>...........</p>
<p>&lt;embed src="C0.wav" autostart=false hidden=true name="Csound"</p>
<p>mastersound&gt;</p>
<p>...........</p>
<p>...........</p>
<p>&lt;/html&gt;</p>
<p>You can add an sound effect to the Jet Fighter game (you created it
in a previous lecture) by adding the following bold faced lines:</p>
<p>function check() {</p>
<p>if ((b01.style.pixelLeft &gt;= ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &lt;= ap01.style.pixelLeft + 70) &amp;&amp;
(b01.style.pixelTop &lt;= ap01.style.pixelTop + 70))</p>
<p>{</p>
<p><strong>document.explosion.play()</strong></p>
<p>ap01.src="explode.gif";</p>
<p>setTimeout("ap01.style.display='none'",1000);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor=000000; onkeydown="fly();" onLoad=init()&gt;</p>
<p>&lt;img id=ap01 src="e_plan.gif" style="position:absolute;
z-index:3"&gt;</p>
<p>&lt;img id=st01 src="shooter.gif" style="position:absolute;"&gt;</p>
<p>&lt;b id=b01 style="position:absolute; color:white; display:none;
z-index=2"&gt;!&lt;/b&gt;</p>
<p><strong>&lt;embed src="explosion.wav" autostart=false
hidden=true</strong> <strong>name="explosion"
mastersound&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>Certainly, you must load the explosion.wav sound file to the same
directory as the Jet Fighter file resides.</p>
<p>Play sound</p>
<p>With Microsoft Internet Explorer, there are several ways to play a
sound file using DHTML and</p>
<p>/music file</p>
<p>JavaScript, without opening a separate window for sound control.
Assuming you add the using</p>
<p>following MIDI file:</p>
<p>JavaScript</p>
<p>&lt;embed name="mysound" src="game1.mid"</p>
<p>Game Programming – Penn Wu</p>
<p>155</p>
<p><span id="index_split_010.html#p156"></span>autostart=false
hidden=true mastersound&gt;</p>
<p>To start playing the game1.mid file via the EMBED tag, use:</p>
<p>document.mySound.play()</p>
<p>To stop playing, use:</p>
<p>document.mySound.stop()</p>
<p>A complete code sample is:</p>
<p>&lt;script&gt;</p>
<p>function playSound(){</p>
<p><strong>document.sound1.play();</strong></p>
<p>}</p>
<p>function stopSound(){</p>
<p><strong>document.sound1.stop();</strong></p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;embed src="game1.mid" autostart="false" hidden="True"</p>
<p>name="sound1"&gt;</p>
<p>&lt;button onClick="playSound()"&gt;Play&lt;/button&gt;</p>
<p>&lt;button onClick="stopSound()"&gt;Stop&lt;/button&gt;</p>
<p>&lt;/body&gt;</p>
<p>If you use the &lt;bgsound&gt; tag, you have to do it differently.
Assuming you add the sound file using the following code:</p>
<p>&lt;bgsound id="kick" loop=1&gt;</p>
<p>To start playing a sound file game1.mid via the BGSOUND tag, use:
document.all['kick'].src='game1.mid'</p>
<p>To stop playing, use:</p>
<p>document.all['kick'].src='nosound.mid'</p>
<p>Notice that <strong>game1.mid</strong> stands for the name of the
sound file that you actually want to play; <strong>nosound.mid</strong>
is a “do-nothing” sound file, which means it does not play any sound at
all, but can be used to stop the playback of other sound files.</p>
<p>A complete code sample is:</p>
<p>&lt;script&gt;</p>
<p>function playSound(){</p>
<p><strong>document.all['kick'].src='game1.mid'</strong></p>
<p>}</p>
<p>function stopSound(){</p>
<p><strong>document.all['kick'].src='nosound.mid'</strong></p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;button onClick="playSound()"&gt;Play&lt;/button&gt;</p>
<p>&lt;button onClick="stopSound()"&gt;Stop&lt;/button&gt; Game
Programming – Penn Wu</p>
<p>156</p>
<p><span id="index_split_010.html#p157"></span>&lt;bgsound id="kick"
loop=1 autostart="false"&gt; One trick you need to know is that you
don’t need to use the <strong>&lt;bgsound&gt;</strong> tag to include
all files you need to play, simply include the first sound file is good
enough. Remember, the more sound files you include to your code using
&lt;bgsound&gt; and &lt;embed&gt; tags, the longer it takes to load the
game file. For example, you can use JavaScript to switch between the
game1.mid and game2.mid soundtracks every 20 seconds.</p>
<p>&lt;BODY&gt;</p>
<p>&lt;BGSOUND SRC="game1.mid" ID="cis261" autostart="true" /&gt;</p>
<p>&lt;SCRIPT&gt;</p>
<p>setInterval("changeSound()",20000);</p>
<p>function changeSound(){</p>
<p>if (document.all.cis261.src == "game1.mid")</p>
<p>document.all.cis261.src = "game2.mid"</p>
<p>else document.all.cis261.src = "game1.mid";</p>
<p>}</p>
<p>&lt;/SCRIPT&gt;</p>
<p>&lt;/BODY&gt;</p>
<p>JavaScript</p>
<p>Want to add a short sound effect to your page for certain actions,
such as when the user moves the Sound effect</p>
<p>mouse over a link? This is a simple yet versatile script that lets
you do just like! Relying on IE's BGSOUND attribute (and hence IE5+
only), the script can easily add a sound effect to a single item (ie: 1
link), or thanks to a helper function, all items of the specified
element (ie: all &lt;a&gt; tags). This makes it very easy to add a sound
effect to an entire menu's links, for example.</p>
<p>Add the below script to the &lt;HEAD&gt; section of your page, and
change "var soundfile" to point to where your sound file is located.</p>
<p><strong>&lt;bgsound src="#" id="soundeffect" loop=1 autostart="true"
/&gt;</strong></p>
<p>&lt;script&gt;</p>
<p>var soundfile="game1.mid"</p>
<p>function playsound(soundfile){</p>
<p>if (document.all &amp;&amp; document.getElementById){</p>
<p>document.getElementById("soundeffect").src="" //reset first in case
of problems</p>
<p>document.getElementById("soundeffect").src=soundfile</p>
<p>}</p>
<p>}</p>
<p>function bindsound(tag, soundfile, masterElement){</p>
<p>if (!window.event) return</p>
<p>var source=event.srcElement</p>
<p>while (source!=masterElement &amp;&amp; source.tagName!="HTML"){</p>
<p>if (source.tagName==tag.toUpperCase()){</p>
<p>playsound(soundfile)</p>
<p>break</p>
<p>}</p>
<p>source=source.parentElement</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>Set up an element to receive the JavaScript sound, whether
onMouseover, onClick etc. For example, the below plays a sound when the
mouse moves over a link: Game Programming – Penn Wu</p>
<p>157</p>
<p><span id="index_split_010.html#p158"></span>&lt;button
onClick="playsound(soundfile)"&gt;Play 1&lt;/button&gt; or</p>
<p>&lt;button onMouseover="playsound(soundfile)"&gt;Play
2&lt;/button&gt; The second line shows that you can pass in a different
wav file to play for any link other than the default specified within
the script (var soundfile).</p>
<p>Digital sound</p>
<p>To sample a sound, you just store the amplitude of the sound wave at
regular intervals. Taking theory</p>
<p>samples at more frequent intervals causes the digital signal to more
closely approximate the analog signal and, therefore, sound more like
the analog wave when played. So, when sampling sounds the rate
(frequency) at which the sound is sampled is very important, as well as
how much data is stored for each sample. The unit of measurement for
frequency is Hertz (Hz), which specifies how many samples are taken per
second. As an example, CD-quality audio is sampled at 44,000Hz (44kHz),
which means that when you're listening to a music CD you're actually
hearing 44,000 digital sound samples every second.</p>
<p>In addition to the frequency of a sampled sound, the number of bits
used to represent the amplitude of the sound impacts the sound quality,
as well as whether the sound is a stereo or mono sound. Knowing this,
it's possible to categorize the quality of a digital sound according to
the following properties:</p>
<p>•</p>
<p>Frequency</p>
<p>•</p>
<p>Bits-per-sample</p>
<p>•</p>
<p>Mono/stereo</p>
<p>The frequency of a sampled sound typically falls somewhere in the
range of 8kHz to 44kHz, with 44kHz representing CD-quality sound. The
bits-per-sample of a sound is usually either 8bps (bits per sample) or
16bps, with 16bps representing CD-quality audio; this is also known as
16-bit audio. A sampled sound is then classified as being either mono or
stereo, with mono meaning that there is only one channel of sound,
whereas stereo has two channels. As you might expect, a stereo sound
contains twice as much information as a mono sound. Not surprisingly,
CD-quality audio is always stereo. Therefore, you now understand that a
CD-quality sound is a 44kHz 16-bit stereo sound.</p>
<p>Although it would be great to incorporate sounds that are CD-quality
into all of your games, the reality is that high-quality sounds take up
a lot of memory and can therefore be burdensome to play if your game
already relies on a lot of images and other memory-intensive
resources.</p>
<p>Granted, most computers these days are capable of ripping through
memory-intensive multimedia objects such as MP3 songs like they are
nothing, but games must be designed for extreme efficiency. Therefore,
it's important to consider ways to minimize the memory and processing
burden on games every chance you get. One way to minimize this burden is
to carefully choose a sound quality that sounds good without hogging too
much memory.</p>
<p>Review</p>
<p>1. Where can you place a sound file using the &lt;BGSOUND&gt;
tag?</p>
<p>Questions</p>
<p>A. between &lt;head&gt; and &lt;/head&gt;</p>
<p>B. between &lt;body&gt; and &lt;/body&gt;</p>
<p>C. A and B</p>
<p>D. None of the above</p>
<p>2. Where can you place a sound file using the &lt;EMBED&gt; tag?</p>
<p>A. between &lt;head&gt; and &lt;/head&gt;</p>
<p>B. between &lt;body&gt; and &lt;/body&gt;</p>
<p>C. A and B</p>
<p>D. None of the above</p>
<p>3. Which causes the cis261.mid sound file to play automatically when
the page is loaded?</p>
<p>A. &lt;bgsound src="cis261.mid" autostart="true"&gt; Game Programming
– Penn Wu</p>
<p>158</p>
<p><span id="index_split_010.html#p159"></span>B. &lt;bgsound
src="cis261.mid" autostart="yes"&gt; C. &lt;bgsound src="cis261.mid"
start=1&gt;</p>
<p>D. &lt;bgsound src="cis261.mid" start="auto"&gt; 4. Which sets the
embedded MIDI file as an visible object on the page?</p>
<p>A. &lt;EMBED src="cis261.mid" display="true"&gt; B. &lt;EMBED
src="cis261.mid" hidden="true"&gt; C. &lt;EMBED src="cis261.mid"
hidden="visible"&gt; D. &lt;EMBED src="cis261.mid"
display="invisible"&gt; 5. Given the following code segment, which can
play the sound?</p>
<p>&lt;embed name="s1" src="cis261.mid" autostart="false"
mastersound&gt; A. window.s1.play();</p>
<p>B. document.s1.play();</p>
<p>C. window.play(s1);</p>
<p>D. document.play(s1);</p>
<p>6. Given the following code segment, which can play the sound?</p>
<p>&lt;bgsound id="c1" autostart="false"&gt;</p>
<p>A. document.all['c1'].src='c261.mid'</p>
<p>B. document.play('c1'); c1.src='c261.mid'</p>
<p>C. document.all.c1.src == "c261.mid"</p>
<p>D. document.play('c1').src='c261.mid'</p>
<p>7. Given the following code segment, which is a "do-nothing" sound
file?</p>
<p>function playSound() {</p>
<p>var b1="m2.mid";</p>
<p>document.all['a1'].src='m1.mid';</p>
<p>document.b1.play(); }</p>
<p>function stopSound() {</p>
<p>var d1="m4.mid";</p>
<p>document.all['c1'].src='m3.mid';</p>
<p>document.d1.stop(); }</p>
<p>&lt;/script&gt;</p>
<p>A. m1.mid</p>
<p>B. m2.mid</p>
<p>C. m3.mid</p>
<p>D. m4.mid</p>
<p>8. When click the following button, which sound file will be
played?</p>
<p>&lt;button
onMouseOver="Down();document.E.play()"&gt;Play&lt;/button&gt; A.
&lt;embed src="C.wav" autostart=false hidden=true name="C"
mastersound&gt; B. &lt;embed src="D.wav" autostart=false hidden=true
name="D" mastersound&gt; C. &lt;embed src="E.wav" autostart=false
hidden=true name="E" mastersound&gt; D. &lt;embed src="F.wav"
autostart=false hidden=true name="F" mastersound&gt; 9. Given the
following code segment, which sound will be played automatically?</p>
<p>&lt;embed id="s1" src="hit.wav" autostart=false mastersound&gt;</p>
<p>&lt;bgsound id="s2" src="circusride.mid"&gt; Game Programming – Penn
Wu</p>
<p>159</p>
<p><span id="index_split_010.html#p160"></span>&lt;bgsound id="s3"
/&gt;</p>
<p>A. s1</p>
<p>B. s2</p>
<p>C. s3</p>
<p>D. All of the above</p>
<p>10. If you wish to switch between two MIDI files every 20 seconds,
which method will you choose to use?</p>
<p>A. setInterval()</p>
<p>B. setLoop()</p>
<p>C. setSwitch()</p>
<p>D. setReturn()</p>
<p>Game Programming – Penn Wu</p>
<p>160</p>
<p><span id="index_split_010.html#p161"></span></p>
<p>Lab #9</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab9.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1:</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Rename the <strong>jet_fighter.htm</strong> file to
<strong>lab9_1.htm</strong>.</p>
<p>3. Use Notepad to open the <strong>C:\games\lab9_1.htm</strong>
file.</p>
<p>4. Add the following bold-faced lines:</p>
<p>...............</p>
<p>...............</p>
<p>function check() {</p>
<p>if ((b01.style.pixelLeft &gt;= ap01.style.pixelLeft) &amp;&amp;
(b01.style.pixelLeft &lt;= ap01.style.pixelLeft + 70) &amp;&amp;
(b01.style.pixelTop &lt;= ap01.style.pixelTop + 70))</p>
<p>{</p>
<p><strong>document.explosion.play()</strong></p>
<p>ap01.src="explode.gif";</p>
<p>setTimeout("ap01.style.display='none'",1000);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor=000000; onkeydown="fly();" onLoad=init()&gt;</p>
<p>&lt;img id=ap01 src="e_plan.gif" style="position:absolute;
z-index:3"&gt;</p>
<p>&lt;img id=st01 src="shooter.gif" style="position:absolute;"&gt;</p>
<p>&lt;b id=b01 style="position:absolute; color:white; display:none;
z-index=2"&gt;!&lt;/b&gt;</p>
<p><strong>&lt;embed src="explosion.wav" autostart=false hidden=true
name="explosion"</strong></p>
<p><strong>mastersound&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>5. Test the program. Whenever you hit the enemy’s plan, the
explosion.wav sound file is played.</p>
<p><strong>Learning Activity #2: Gun shot</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab9_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>161</p>
<p><span id="index_split_010.html#p162"></span><img
src="index-162_1.png" class="calibre5" alt="Image 144" /></p>
<p>function shoot() {</p>
<p>var i = b01.style.pixelLeft;</p>
<p>if (i &lt;= 400) {</p>
<p>b01.style.display='inline';</p>
<p>b01.style.left=i + 10;</p>
<p>setTimeout("shoot()",20);</p>
<p>}</p>
<p>else {</p>
<p>b01.style.display='none';</p>
<p>b01.style.left=95;</p>
<p>};</p>
<p>}</p>
<p>function playsound() {</p>
<p>document.all['gunshot'].src='gunshot.wav'</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="playsound();shoot();"&gt;</p>
<p>&lt;img src="gun.gif"&gt;</p>
<p>&lt;img src="bullet.gif" id="b01" style="position:absolute;
display:none; top:20; left:95"&gt;&lt;/span&gt;</p>
<p><strong>&lt;bgsound id="gunshot" /&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press any key to fire the gunshot; you should
hear the sound effect, too. A sample output looks:</p>
<p><strong>Learning Activity #3: Squeeze the clown</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab9_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var k=0;</p>
<p>function goUp() {</p>
<p>bar.style.display='inline';</p>
<p>bar.style.top=bar.style.pixelTop - 5;</p>
<p>Game Programming – Penn Wu</p>
<p>162</p>
<p><span id="index_split_010.html#p163"></span><img
src="index-163_1.png" class="calibre5" alt="Image 145" /></p>
<p>if (clown.style.pixelTop &lt;= 20) {</p>
<p>clown.style.height=eval(bar.style.top.replace('px','')) - 20;</p>
<p>clown.style.width = eval(clown.style.width.replace('px',''))+1;
clown.style.Top = 20;</p>
<p><strong>document.hit.play()</strong></p>
<p>}</p>
<p>else {</p>
<p>bar.style.height=k;</p>
<p>k+=5;</p>
<p>clown.style.top=bar.style.pixelTop-120;</p>
<p>}</p>
<p>if ( eval(clown.style.height.replace('px','')) &lt;=10) {</p>
<p>clearTimeout(s1);}</p>
<p>else {</p>
<p>s1=setTimeout("goUp()",20); }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown=goUp()&gt;</p>
<p>&lt;hr style="position:absolute; left:10; top:0;</p>
<p>background-color:red; width:100;z-index:2" size="20px"
align="left"&gt;</p>
<p>&lt;img id="clown" src="clown.jpg" style="position:absolute; left:20;
top:280; width:54; z-index:3"&gt;</p>
<p>&lt;span id="bar" style="position:absolute; left:10; top:400;
background-color:red; width:100; display:none;
z-index:1"&gt;&lt;/span&gt;</p>
<p><strong>&lt;embed src="hit.wav" autostart=false hidden=true
name="hit" mastersound&gt;</strong></p>
<p><strong>&lt;bgsound src="circusride.mid"&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. When the page is loaded, the background music
plays. When squeezing the clown, you will hear a sound effect. A sample
output looks:</p>
<p><strong>Learning Activity #4</strong></p>
<p><strong></strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab9_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var x=190; y=384;</p>
<p>Game Programming – Penn Wu</p>
<p>163</p>
<p><span id="index_split_010.html#p164"></span><img
src="index-164_1.png" class="calibre5" alt="Image 146" /></p>
<p>var k=1; n=0;</p>
<p>function draw(){</p>
<p>var i = event.keyCode;</p>
<p>switch (i) {</p>
<p>case 37: n=1; k=0; document.left.play(); break;</p>
<p>case 38: n=0; k=1; document.up.play(); break;</p>
<p>case 39: n=-1; k=0; document.right.play(); break;</p>
<p>case 40: n=0; k=-1; document.down.play(); break;</p>
<p>}</p>
<p>}</p>
<p>function cc() {</p>
<p>if ((x&lt;=10) || (x&gt;=394) || (y&lt;=-10) || (y&gt;=400)) {</p>
<p>p1.innerText="Game over!";</p>
<p>}</p>
<p>else {</p>
<p>y-=k; x-=n;</p>
<p>codes = "&lt;span style='position:absolute;left:"+x;</p>
<p>codes += "; top:"+ y +"'&gt;.&lt;/span&gt;"; area1.innerHTML +=
codes;</p>
<p>setTimeout("cc()", 0.1);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body OnLoad=cc() onKeyDown=draw()&gt;</p>
<p>&lt;div id=area1 style="position:absolute; width:400;</p>
<p>height:400; border:solid 3 black; color:red;</p>
<p>background-Color: black; left:0; top:10;"&gt;&lt;/div&gt;</p>
<p>&lt;p id=p1 style="position:absolute; left:160;top:200; color:
white"&gt;&lt;/p&gt;</p>
<p><strong>&lt;embed src="left.wav" autostart=false hidden=true
name="left" mastersound&gt;</strong></p>
<p><strong>&lt;embed src="right.wav" autostart=false hidden=true
name="right" mastersound&gt;</strong></p>
<p><strong>&lt;embed src="up.wav" autostart=false hidden=true name="up"
mastersound&gt;</strong></p>
<p><strong>&lt;embed src="down.wav" autostart=false hidden=true
name="down" mastersound&gt;</strong></p>
<p><strong>&lt;bgsound src="canzone.mid"&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #5: Piano</strong></p>
<p>Game Programming – Penn Wu</p>
<p>164</p>
<p><span id="index_split_010.html#p165"></span>Note: This game is meant
to be simple and easy for the sake of demonstrating programming
concepts. Please do not hesitate to enhance the appearance or functions
of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab9_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.wKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:white;</p>
<p>border-top:solid 1 #cdcdcd;</p>
<p>border-left:solid 1 #cdcdcd;</p>
<p>border-bottom:solid 4 #cdcdcd;</p>
<p>border-right:solid 1 black;</p>
<p>height:150px;</p>
<p>width:40px</p>
<p>}</p>
<p>.bKey {</p>
<p>position:absolute;</p>
<p>top:20;</p>
<p>background-color:black;</p>
<p>border:solid 1 white;</p>
<p>height:70px;</p>
<p>width:36px</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function Down() {</p>
<p>var keyID = event.srcElement.id;</p>
<p>document.getElementById(keyID).style.borderTop="solid 1 black";
document.getElementById(keyID).style.borderLeft="solid 1 black";
document.getElementById(keyID).style.borderBottom="solid 1 black";
document.getElementById(keyID).style.borderRight="solid 1 #cdcdcd";</p>
<p>}</p>
<p>function Up() {</p>
<p>var keyID = event.srcElement.id;</p>
<p>document.getElementById(keyID).style.borderTop="solid 1 #cdcdcd";
document.getElementById(keyID).style.borderLeft="solid 1 #cdcdcd";
document.getElementById(keyID).style.borderBottom="solid 4 #cdcdcd";
document.getElementById(keyID).style.borderRight="solid 1 black";</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;div&gt;</p>
<p>&lt;span class="wKey" id="midC" style="left:50"</p>
<p>onMouseOver="Down();document.Csound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midD" style="left:91"</p>
<p>onMouseOver="Down();document.Dsound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midE" style="left:132"</p>
<p>onMouseOver="Down();document.Esound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>165</p>
<p><span id="index_split_010.html#p166"></span><img
src="index-166_1.png" class="calibre5" alt="Image 147" /></p>
<p>&lt;span class="wKey" id="midF" style="left:173"</p>
<p>onMouseOver="Down();document.Fsound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midG" style="left:214"</p>
<p>onMouseOver="Down();document.Gsound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midA" style="left:255"</p>
<p>onMouseOver="Down();document.Asound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="midB" style="left:296"</p>
<p>onMouseOver="Down();document.Bsound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="wKey" id="highC" style="left:337"</p>
<p>onMouseOver="Down();document.CHsound.play()"</p>
<p>onMouseOut="Up()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="cSharp" style="left:72"</p>
<p>onMouseOver="document.Cs.play()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="dSharp" style="left:114"</p>
<p>onMouseOver="document.Ds.play()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="fSharp" style="left:196"</p>
<p>onMouseOver="document.Fs.play()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="gSharp" style="left:238"</p>
<p>onMouseOver="document.Fs.play()"&gt;&lt;/span&gt;</p>
<p>&lt;span class="bKey" id="aSharp" style="left:280"</p>
<p>onMouseOver="document.As.play()"&gt;&lt;/span&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;!-- white key sound files --&gt;</p>
<p>&lt;embed src="C0.wav" autostart=false hidden=true name="Csound"
mastersound&gt;</p>
<p>&lt;embed src="D0.wav" autostart=false hidden=true name="Dsound"
mastersound&gt;</p>
<p>&lt;embed src="E0.wav" autostart=false hidden=true name="Esound"
mastersound&gt;</p>
<p>&lt;embed src="F0.wav" autostart=false hidden=true name="Fsound"
mastersound&gt;</p>
<p>&lt;embed src="G0.wav" autostart=false hidden=true name="Gsound"
mastersound&gt;</p>
<p>&lt;embed src="A0.wav" autostart=false hidden=true name="Asound"
mastersound&gt;</p>
<p>&lt;embed src="B0.wav" autostart=false hidden=true name="Bsound"
mastersound&gt;</p>
<p>&lt;embed src="C1.wav" autostart=false hidden=true name="CHsound"
mastersound&gt;</p>
<p>&lt;!-- black key sound files --&gt;</p>
<p>&lt;embed src="Cs0.wav" autostart=false hidden=true name="Cs"
mastersound&gt;</p>
<p>&lt;embed src="Ds0.wav" autostart=false hidden=true name="Ds"
mastersound&gt;</p>
<p>&lt;embed src="Fs0.wav" autostart=false hidden=true name="Fs"
mastersound&gt;</p>
<p>&lt;embed src="Gs0.wav" autostart=false hidden=true name="Gs"
mastersound&gt;</p>
<p>&lt;embed src="As0.wav" autostart=false hidden=true name="As"
mastersound&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Use the mouse to play a piece of music now.</p>
<p>Game Programming – Penn Wu</p>
<p>166</p>
<p><span
id="index_split_010.html#p167"></span><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 09, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab9_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab9_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab9_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab9_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab9_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>167</p>
<p><span id="index_split_010.html#p168"></span></p>
<p>Lecture #10</p>
<p>Score boards</p>
<p><span id="index_split_011.html"></span></p>
<h2 class="calibre2"
id="index_split_011.html#calibre_pb_10">Introduction</h2>
<p>Many people consider scoring the extension of collision detection,
and should be part of the collision response. Once you create a game
code that allows two or more objects to collide, you frequently need a
method to keep and display the score the play earned. However, there are
many situations in which you have nothing to collide when keeping the
game score. The instructor, thus, believes score keeping should be an
individual topic, and is completely independent of the collision
response.</p>
<p>The scoring keeping function can be an individual function, or it can
be placed into other function.</p>
<p>This lecture will introduce you to the world of scoring in game
programming.</p>
<p>Use variables</p>
<p>In a computer game, the player earns or loses score points in
according to the game rules the to keep the</p>
<p>programmers defined. The score points may increase, decrease, or stay
the same depending on how score</p>
<p>the players stick to the game rules. In other words, the score point
is not a fixed value, because it varies as the players continue to play
the game.</p>
<p>In terms of programming, programmers declare variables to keep such
continuously changing values in a temporary holding area (namely
computer's memory). If the values need to be updated, the new value
replaces the old one to be stored in that temporary holding area. It is
necessary to assign a name to that holding area, such that the computer
can always locate the correct temporary holding area if there are more
than one variable.</p>
<p>In any programming language, the process to tell the computer to find
some memory space as a temporary particular holding area is known as
“declaring a variable.” The name of the variable is also the ID of the
temporary holding area. The values of the variable, such as a string, a
number, or a date which directly represents a constant value, are known
as <strong>literals</strong>.</p>
<p>In JavaScript, you declare a variable by using the following syntax:
var <em><strong>VariableName</strong></em> = "InitialValue";</p>
<p>where <strong>var</strong> is a keyword, <em>VariableNmae</em> is the
name you assign to that variable. If the variable has an initial value
(meaning its first value before being updated by the computer), add it
next to the = sign.</p>
<p>For example,</p>
<p>var playerName = "Helen";</p>
<p>var gameName = 'Tic Tac Toe';</p>
<p>var score = 0;</p>
<p>The use of single (') or double quotes (") specifies that these two
values--<strong>Helen</strong> and <strong>Tic Tac Toe</strong>--</p>
<p>are strings. The term “string” refers to a series of alphanumeric
characters, usually forming a piece of text.</p>
<p>A game code segment consists of lines of statements with sequence
arranged by the programmer.</p>
<p>When computer execute the codes, statements are executed on a
sequential basis. Consider the following code segments:</p>
<p>var myScore = 0;</p>
<p>myScore = myScore + 5;</p>
<p>myScore += 50;</p>
<p>myScore = myScore - 10;</p>
<p>myScore -= 5;</p>
<p>Game Programming – Penn Wu</p>
<p>168</p>
<p><span id="index_split_011.html#p169"></span>The first line declares
the variable <strong>myScore</strong> with an initial value
<strong>0</strong>. The second line means</p>
<p>“myScore now equals to whatever myScore currently has plus 5”, so the
new value is 5 after this statement is executed (0 + 5 =5).</p>
<p>The following line uses the increment operator (+=) to tell the
computer to “add 50 to the current value of myScore”, so the value after
execution is 55 (5 + 50 = 55).</p>
<p>myScore += 50;</p>
<p>The increment (++) operator is a unary operator that can increment a
value by adding 1 to it. You can either place the increment operator to
the left of a variable (known as pre-increment), or place it to the
right of a variable (known as post-increment). In the following example,
both x and y variables will have a new value 1 after the execution.</p>
<p>var x=0; y=0;</p>
<p>++x;</p>
<p>y++;</p>
<p>When you need to increment by adding 2 or larger, the increment
operator changes to (+= <em>n</em>, where <em>n</em> is usually an
integer). For example,</p>
<p>myScore += 50;</p>
<p>The following line tells the computer to subtract 10 from the current
value of myScore, so the value after execution is 45 (55 – 10 = 45).</p>
<p>myScore = myScore - 10;</p>
<p>The last line uses the decrement operator (-=) to subtract 5 from the
current value of myScore, so the value after execution is 40 (45 – 5 =
40).</p>
<p>The concept of decrement (--) operator is opposite to that of
increment operator. So, the values of x and y after execution in the
following example are 0.</p>
<p>var x=1; y=1;</p>
<p>x--;</p>
<p>y--;</p>
<p>When you need to decrement by 2 or larger, the operator changes to
(-= <em>n</em>, where <em>n</em> is usually an integer).</p>
<p>Adding /</p>
<p>Keeping score in essence is to add or subtract certain number from a
variable’s current value. In the Decreasing</p>
<p>number guessing game, the following code creates two textboxes: one
(t1) is visible; the other (t2) is Score:</p>
<p>invisible.</p>
<p>The <strong>start()</strong> function use the
<strong>Math.random()</strong> method to generate a random number in the
range of</p>
<p>[1-64] (or from 1 to 64). The random number is then temporarily
assigned to the <strong>t2</strong> textbox as its value. The
<strong>t1</strong> textbox, on the other hand, is for the player to
enter a number to guess what number the computer will randomly
generates.</p>
<p>...............</p>
<p>...............</p>
<p>function start() {</p>
<p>var k=Math.floor(Math.random()*64);</p>
<p>f1.t2.value=k;</p>
<p>...............</p>
<p>...............</p>
<p>&lt;form name=f1&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>169</p>
<p><span id="index_split_011.html#p170"></span>Enter a number
(1-64):</p>
<p>&lt;input type=text name=t1 size=5&gt;</p>
<p>&lt;input type=hidden name=t2&gt;</p>
<p>&lt;/form&gt;</p>
<p>...............</p>
<p>...............</p>
<p>&lt;p&gt;Your Score: &lt;b id=p1&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>...............</p>
<p>...............</p>
<p>When the player clicks the Stop button to trigger the stop()
function, the <strong>score</strong> variable is used to update and keep
the increment (adding) or decrement (decreasing) of the player’s
score.</p>
<p>function stop() {</p>
<p>clearTimeout(sf);</p>
<p><strong>if (f1.t1.value==f1.t2.value) { score+=1000; p1.innerText =
score;}</strong></p>
<p><strong>else { score -=1; p1.innerText = score;}</strong></p>
<p>}</p>
<p>The logic is simple. Compare the value of the player’s entry, t1, and
the random number generated by the computer (which is temporarily stored
to t2 textbox). If the are exactly the same, the <strong>score</strong>
variable increments it value of 1000; otherwise, it decrement by 1.</p>
<p>The following line displays the updated score in the
<strong>p1</strong> object, the <strong>innerText</strong> property
forces the value to be a <strong>string</strong> (text-based)
literal.</p>
<p><strong>p1.innerText = score;</strong></p>
<p>In the Punching Duck game, the punch() function forces the glove to
move toward northeast till the <strong>gv.style.pixelTop</strong> value
is less than or equal to 0.</p>
<p>function punch() {</p>
<p>gv.style.pixelLeft+=2;</p>
<p>gv.style.pixelTop-=2;</p>
<p>if (gv.style.pixelTop &lt;=0)</p>
<p>{clearTimeout(s2);gv.style.pixelTop=200;gv.style.pixelLeft=10;}</p>
<p>else {s2=setTimeout("punch()", 20);}</p>
<p>for (i=1; i&lt;=10; i++) {</p>
<p>code3="if ((gv.style.pixelLeft &gt;= d"+i+".style.pixelLeft)
&amp;&amp;"; code3+=" (gv.style.pixelLeft &lt;= (d"+i+".style.pixelLeft
+ 61)) &amp;&amp; "; code3+=" (gv.style.pixelTop &lt;=
d"+i+".style.pixelTop)) ";
code3+="{d"+i+".style.display='none';d"+i+".src='noduck.gif';"</p>
<p>code3+="score+=10;p1.innerText=score}";</p>
<p>eval(code3);</p>
<p>}</p>
<p>}</p>
<p>When the glove moves, the following code block generates 10 similar
codes segments which will detect the collision of the
<strong>gv</strong> object with any of the 10 ducks (d1, d2, d3, …,
d10).</p>
<p>for (i=1; i&lt;=10; i++) {</p>
<p>code3="if ((gv.style.pixelLeft &gt;= d"+i+".style.pixelLeft)
&amp;&amp;"; code3+=" (gv.style.pixelLeft &lt;= (d"+i+".style.pixelLeft
+ 61)) &amp;&amp; "; code3+=" (gv.style.pixelTop &lt;=
d"+i+".style.pixelTop)) ";
code3+="{d"+i+".style.display='none';d"+i+".src='noduck.gif';"</p>
<p>code3+="score+=10;p1.innerText=score}";</p>
<p>eval(code3);</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>170</p>
<p><span id="index_split_011.html#p171"></span><img
src="index-171_1.png" class="calibre5" alt="Image 148" /></p>
<p><img src="index-171_2.png" class="calibre5" alt="Image 149" /></p>
<p>The following is a sample output of the above code block for d3: if
((gv.style.pixelLeft &gt;= <strong>d3</strong>.style.pixelLeft)
&amp;&amp; (gv.style.pixelLeft &lt;= (d3.style.pixelLeft + 61))
&amp;&amp; (gv.style.pixelTop &lt;= d3.style.pixelTop))</p>
<p>{d3.style.display='none';d3.src='noduck.gif'</p>
<p><strong>score+=10</strong>;p1.innerText=score }</p>
<p>In plain English, it means “if gv’s pixelLeft value is greater than
or equal to that of d3 and gv’s pixelLeft value is less than or equal to
d3’s plus 61 (the width of d3) and gv’s pixelTop value is less than or
equal to d3’s, then …. add 10 to the value of the variable
<strong>score</strong>……”</p>
<p>In other words, the above <em>for</em> loop builds a system of
collision detection for each of the 10 ducks.</p>
<p>The collision detection is based on three borders—left, right, and
bottom, of each of the d <em>n</em> (where <em>n</em> is 1, 2, 3, … 10)
object.</p>
<p>Notice that it takes 5 movements for the glove to move across the
duck, as shown below: Each movement forces the computer to add 10 to the
value of <strong>score</strong>, so the player earns 50 points (50 + 50
+ 50 + 50 + 50) each time when he/she punches the duck with ID
<strong>d3</strong>.</p>
<p>In the Shooting Crab game, the <strong>fire()</strong> function
detects the collision of <strong>c1</strong> and <strong>area1</strong>
object. If the collision happens, the score variable is incremented by
10.</p>
<p>function fire() {</p>
<p>if (b1.style.pixelTop == 0) {</p>
<p>b1.style.display='none';</p>
<p>b1.style.top = 270;</p>
<p>clearTimeout(ss);</p>
<p>}</p>
<p>else {</p>
<p>b1.style.pixelTop -= 5;</p>
<p>if ((b1.style.pixelTop &lt;= area1.style.pixelTop + 20) &amp;&amp;
(b1.style.pixelTop &gt;=area1.style.pixelTop)) {</p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 31))</p>
<p>{</p>
<p>c1.style.display='none';b1.style.display="none";</p>
<p>clearTimeout(ss); <strong>score += 10;</strong></p>
<p><strong>gd.innerText = score;</strong> newCrab() }</p>
<p>}</p>
<p>ss = setTimeout("fire()", 20);</p>
<p>}</p>
<p>}</p>
<p>Store the score</p>
<p>JavaScript can create, read, and erase HTTP (HyperText Transfer
Protocol) cookies. A cookie is a in a JavaScript</p>
<p>small text file a Web server sends to a web client computer to store
information about the user. A Game Programming – Penn Wu</p>
<p>171</p>
<p><span id="index_split_011.html#p172"></span>Cookie</p>
<p>JavaScript game may set a cookie file to keep the game score
temporarily.</p>
<p>Cookies allow you to store information on the client computer.
However, a cookie can only hold string based name/value pairs (i.e
<em>name=value</em> settings). The cookie property of the document
object set the cookie. The format is:</p>
<p>document.cookie = " <em>CookieName =Value</em>";</p>
<p>Consider the following example. The <strong>scr</strong> variable
keeps the updated value.</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var scr = 0;</p>
<p>var d = new Date();</p>
<p>function set_score() {</p>
<p><strong>document.cookie = "score ="+scr;</strong></p>
<p>scr += 5;</p>
<p>}</p>
<p>function read_score() {</p>
<p>p1.innerText = "Score: " + document.cookie.split("=")[1];</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="set_score();read_score()"&gt;</p>
<p>&lt;button
onClick="set_score();read_score()"&gt;Click&lt;/button&gt;</p>
<p>&lt;p id="p1"&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Since the data stored in a cookie has a format of
<em>CookieName=Value</em>, you can use the split() function to break the
data into a string array in which <em>CookieName</em> is the first
element and Value is the <em>second</em>. The following get the seconds
elements:</p>
<p>document.cookie.split("=")[1]</p>
<p>Similarly, to retrieve the name of cookie, use</p>
<p>document.cookie.split("=")[0]</p>
<p>Store the score</p>
<p>Values held by a variable can then be saved to local file permanently
or kept in the computer’s in a text file</p>
<p>physical memory temporarily. JavaScript support reading from and
writing to local file with the support of ActiveX objects (Internet
Explorer only).</p>
<p>The <strong>OpenTextFile</strong> method opens a specified file and
returns a TextStream object that can be used to read from, write to, or
append to the file. The syntax is:</p>
<p>object.OpenTextFile(filename[, iomode[, create[, format]]])</p>
<p>where,</p>
<p>•</p>
<p><em>object</em>: is always the name of a FileSystemObject.</p>
<p>•</p>
<p><em>filename</em>: String expression that identifies the file to
open.</p>
<p>•</p>
<p><em>iomode</em>: Can be one of three constants: ForReading (1),
ForWriting (2), or ForAppending (8).</p>
<p>•</p>
<p><em>create</em>: Boolean value that indicates whether a new file can
be created if the specified filename doesn't exist. The value is True if
a new file is created, False if it isn't created. If omitted, a new file
isn't created.</p>
<p>•</p>
<p><em>format</em>: One of three Tristate values used to indicate the
format of the opened file. If omitted, Game Programming – Penn Wu</p>
<p>172</p>
<p><span id="index_split_011.html#p173"></span>the file is opened as
ASCII.</p>
<p>The <strong>CreateTextFile</strong> method Creates a specified file
name and returns a TextStream object that can be used to read from or
write to the file. The syntax is:</p>
<p>object.CreateTextFile(filename[, overwrite[, unicode]])</p>
<p>where,</p>
<p>•</p>
<p><em>object</em>: the name of a FileSystemObject or Folder object.</p>
<p>•</p>
<p><em>filename</em>: String expression that identifies the file to
create.</p>
<p>•</p>
<p><em>overwrite</em>: Boolean value that indicates whether you can
overwrite an existing file. The value is true if the file can be
overwritten, false if it can't be overwritten. If omitted, existing
files are not overwritten.</p>
<p>•</p>
<p><em>unicode</em>: Boolean value that indicates whether the file is
created as a Unicode or ASCII file.</p>
<p>The value is true if the file is created as a Unicode file, false if
it's created as an ASCII file. If omitted, an ASCII file is assumed.</p>
<p>Consider the following code, which illustrates how to use the
CreateTextFile method to create and open a text file.</p>
<p>var fso = new ActiveXObject("Scripting.FileSystemObject"); var a =
fso.CreateTextFile("c:\\testfile.txt", true); a.WriteLine("This is a
test.");</p>
<p>a.Close();</p>
<p>The following code illustrates the use of the OpenTextFile method to
open a file for appending text: var fs, a, ForAppending;</p>
<p>ForAppending = 8;</p>
<p>fs = new ActiveXObject("Scripting.FileSystemObject"); a =
fs.OpenTextFile("c:\\testfile.txt", ForAppending, false);</p>
<p>...</p>
<p>a.Close();</p>
<p>You can simplify the above code to:</p>
<p>var fs, a;</p>
<p>fs = new ActiveXObject("Scripting.FileSystemObject"); a =
fs.OpenTextFile("c:\\testfile.txt", <strong>8</strong>, false);</p>
<p>...</p>
<p>a.Close();</p>
<p>Consider the following code.</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;SCRIPT LANGUAGE='JavaScript'&gt;</p>
<p>var scr=0;</p>
<p>function WriteToFile() {</p>
<p>var filename = 'c://tmp//score.txt';</p>
<p>var fso = new ActiveXObject('Scripting.FileSystemObject');</p>
<p>if (fso.FileExists(filename)) {</p>
<p>var a, file;</p>
<p>file = fso.OpenTextFile(filename, 2, false);</p>
<p>file.WriteLine(scr);</p>
<p>}</p>
<p>else {</p>
<p>var file = fso.CreateTextFile(filename, true);</p>
<p>file.WriteLine(scr);</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>173</p>
<p><span id="index_split_011.html#p174"></span> file.Close();</p>
<p>scr+=5;</p>
<p>}</p>
<p>function ReadIt() {</p>
<p>var filename = 'c://tmp//score.txt';</p>
<p>var fso, a, ForReading;</p>
<p>fso = new ActiveXObject('Scripting.FileSystemObject');</p>
<p>file = fso.OpenTextFile(filename, 1, false);</p>
<p>p1.innerText = file.readline();</p>
<p>file.Close();</p>
<p>}</p>
<p>&lt;/SCRIPT&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body onload='WriteToFile();ReadIt()'&gt;</p>
<p>&lt;button onClick='WriteToFile();ReadIt()'&gt; Click
&lt;/button&gt;</p>
<p>&lt;p id="p1"&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Keeping score</p>
<p>As the game programmer, you have the power of defining what the game
rules are. However, you based on game</p>
<p>need to keep the score based on the game rule, and you need to
absolutely stick to the rules. In the rules</p>
<p>Slot Machine game, for example, the rules are:</p>
<p>•</p>
<p>If 4 numbers are all 7’s, win 30000 points.</p>
<p>•</p>
<p>If there are any 3 numbers having 7 as values, win 3000 points.</p>
<p>•</p>
<p>If there are any 3 numbers having exactly the same values, win 300
points.</p>
<p>•</p>
<p>If there are any 2 numbers having exactly the same value, assign 0
point.</p>
<p>•</p>
<p>If all the 4 numbers are all different, lose 30 points.</p>
<p>The <strong>check()</strong> code is responsible for validating the
above game rules and keep score based on the rules.</p>
<p>function check() {</p>
<p>clearTimeout(s1);</p>
<p>var v1 = f1.n1.value;</p>
<p>var v2 = f1.n2.value;</p>
<p>var v3 = f1.n3.value;</p>
<p>var v4 = f1.n4.value;</p>
<p><strong>if ((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v3 == 7)
&amp;&amp; (v4==7))</strong></p>
<p><strong>{gd += 30000; score.innerText = 30000;}</strong></p>
<p><strong></strong></p>
<p><strong>else if (((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v3 ==
7)) ||</strong></p>
<p><strong>((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v4 == 7))
||</strong></p>
<p><strong>((v2 == 7) &amp;&amp; (v3 == 7) &amp;&amp; (v4 ==
7)))</strong></p>
<p><strong>{gd += 3000; score.innerText = 3000;}</strong></p>
<p><strong></strong></p>
<p><strong>else if (((v1 == v2) &amp;&amp; (v2 == v3)) ||</strong></p>
<p><strong>((v1 == v2) &amp;&amp; (v2 == v4)) ||</strong></p>
<p><strong>((v2 == v3) &amp;&amp; (v3 == v4))) { gd += 300;</strong></p>
<p><strong>score.innerText = 300; }</strong></p>
<p><strong></strong></p>
<p><strong>else if ((v1 == v2) || (v1 == v3) ||</strong></p>
<p><strong>(v1 == v4) || (v2 == v3) ||</strong></p>
<p><strong>(v2 == v4) || (v3 == v4))</strong></p>
<p><strong>{gd += 0; score.innerText = 0;}</strong></p>
<p>Game Programming – Penn Wu</p>
<p>174</p>
<p><span id="index_split_011.html#p175"></span><strong>else {gd -=30;
score.innerText = "-30";}</strong></p>
<p>credit.innerText = gd;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>The following line, for example, defines the rule “If 4 numbers are
all 7’s,…”</p>
<p><strong>if ((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v3 == 7)
&amp;&amp; (v4==7))</strong> The following detects if there are any 3
variables having the value 7: <strong>if (((v1 == 7) &amp;&amp; (v2 ==
7) &amp;&amp; (v3 == 7)) ||</strong></p>
<p><strong>((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v4 == 7))
||</strong></p>
<p><strong>((v2 == 7) &amp;&amp; (v3 == 7) &amp;&amp; (v4 ==
7)))</strong></p>
<p>The following detects if there are any 3 variables having exactly the
same values (any possible value will work):</p>
<p><strong>if (((v1 == v2) &amp;&amp; (v2 == v3)) ||</strong></p>
<p><strong>((v1 == v2) &amp;&amp; (v2 == v4)) ||</strong></p>
<p><strong>((v2 == v3) &amp;&amp; (v3 == v4)))</strong></p>
<p><strong></strong></p>
<p>The following detects if there are any two variables having the same
values (any possible value will work):</p>
<p><strong>if ((v1 == v2) || (v1 == v3) ||</strong></p>
<p><strong>(v1 == v4) || (v2 == v3) ||</strong></p>
<p><strong>(v2 == v4) || (v3 == v4))</strong></p>
<p>In the Pitching and Catching Baseball game, the game rules are:</p>
<p>•</p>
<p>If the catcher uses his glove to catch the ball, the play wins 10
points.</p>
<p>•</p>
<p>If the catcher does not catch the ball, the player loses 10
points.</p>
<p>•</p>
<p>If the base ball moves out of the body area of the browser, the
player get 5 points for bad pitching.</p>
<p>function play() {</p>
<p>if ( bb.style.pixelLeft &gt;= document.body.clientWidth-50) {</p>
<p>bb.style.display="none"; score-=10; p1.innerText=score;}</p>
<p>else {</p>
<p>if ((bb.style.pixelLeft &gt;= ct.style.pixelLeft + 50) &amp;&amp;
(bb.style.pixelTop &lt;= ct.style.pixelTop + 20) &amp;&amp;</p>
<p>(bb.style.pixelTop &gt;= ct.style.pixelTop)) {</p>
<p>bb.style.display="none"; score+=10; p1.innerText=score;</p>
<p>}</p>
<p>else if ((bb.style.pixelTop &gt;= document.body.clientHeight-20)
||</p>
<p>(bb.style.pixelTop&lt;=0)) {</p>
<p>bb.style.display="none"; score+=5; p1.innerText=score;
msg.innerText="Bad pitch, you got 5 points!";</p>
<p>}</p>
<p>else {</p>
<p>bb.style.pixelLeft+=10;</p>
<p>bb.style.pixelTop+=Math.tan(i);</p>
<p>s1 = setTimeout("play()",50);</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>The following line simply means the baseball move over the catcher’s
defending zone. In other words, the catcher does not catch the ball. The
player loses 10 points.</p>
<p>Game Programming – Penn Wu</p>
<p>175</p>
<p><span id="index_split_011.html#p176"></span><img
src="index-176_1.png" class="calibre5" alt="Image 150" /></p>
<p>if ( bb.style.pixelLeft &gt;= document.body.clientWidth-50) {</p>
<p>bb.style.display="none"; score-=10; p1.innerText=score;}</p>
<p>The following detects if the baseball moves through the glove area,
as shown below.</p>
<p>if ((bb.style.pixelLeft &gt;= ct.style.pixelLeft + 50) &amp;&amp;
(bb.style.pixelLeft &lt;= ct.style.pixelLeft + 77) &amp;&amp;</p>
<p>(bb.style.pixelTop &lt;= ct.style.pixelTop + 20) &amp;&amp;</p>
<p>(bb.style.pixelTop &gt;= ct.style.pixelTop)) {</p>
<p>bb.style.display="none"; score+=10; p1.innerText=score;</p>
<p>}</p>
<p>If the above collision detection returns “True”, the player wins 10
points.</p>
<p>The following code determines if the base ball moves out of the body
area of the browser. If so, the player gets 5 points and the screen
displays “Bad pitch, you got 5 points!”</p>
<p>else if ((bb.style.pixelTop &gt;= document.body.clientHeight-20)
||</p>
<p>(bb.style.pixelTop&lt;=0)) {</p>
<p>bb.style.display="none"; score+=5; p1.innerText=score;
msg.innerText="Bad pitch, you got 5 points!";</p>
<p>}</p>
<p>Review</p>
<p>1. Keeping score for a game player is a task __.</p>
<p>Questions</p>
<p>A. of incrementing or decrementing the value of a variable</p>
<p>B. that requires the player to manually enter the score points to a
textbox.</p>
<p>C. that requires the player to buy a USB scoreboard device and plugs
it in to the computer.</p>
<p>D. All of the above</p>
<p>2. You need to add 10 points to your scoreboard function of your
game, which would you use?</p>
<p>A. score = score ++ 10;</p>
<p>B. score = score += 10;</p>
<p>C. score += 10;</p>
<p>D. score ++ 10;</p>
<p>3. You need to deduct 1 point from your scoreboard function of your
game, which would you use?</p>
<p>A. score -=;</p>
<p>B. --score;</p>
<p>C. score -= score;</p>
<p>D. score -- score;</p>
<p>4. Given the following code segment, which variable keeps a string
literal?</p>
<p>var width = "20";</p>
<p>var height = 17;</p>
<p>var length = 129 + 11;</p>
<p>var area = height * 19;</p>
<p>Game Programming – Penn Wu</p>
<p>176</p>
<p><span id="index_split_011.html#p177"></span>A. width</p>
<p>B. height</p>
<p>C. length</p>
<p>D. area</p>
<p>5. Given the following code segment, which statement is correct?</p>
<p>if (f1.t1.value==f1.t2.value) { .. }</p>
<p>..........</p>
<p>&lt;form name="f1"&gt;</p>
<p>..........</p>
<p>&lt;input type="text" name="t1"&gt;</p>
<p>&lt;input type="hidden" name="t2"&gt;</p>
<p>&lt;/form&gt;</p>
<p>..........</p>
<p>A. f1.t1.value represents the value that is entered to the t1
textbox.</p>
<p>B. t2 is an invisible textbox inside the f1 HTML form.</p>
<p>C. it checks if the value of t1 equals to the value of t2.</p>
<p>D. All of the above</p>
<p>6. Given the following code segment, which is the value that will be
displayed in the p1 object?</p>
<p>var score = 0;</p>
<p>score += 50;</p>
<p>score--;</p>
<p>score -= 5;</p>
<p>p1.innerText = score;</p>
<p>A. 50</p>
<p>B. 49</p>
<p>C. 44</p>
<p>D. 0</p>
<p>7. Given the following code segment, how many image file(s) will pop
up?</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>code1 = "&lt;img src=b.gif&gt;";</p>
<p>area1.innerHTML = code1;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id="area1"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>A. 1</p>
<p>B. 2</p>
<p>C. 3</p>
<p>D. 4</p>
<p>8. Given the following code segment, how many image file(s) will pop
up?</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>code1 = "&lt;img src=b.gif&gt;";</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>177</p>
<p><span id="index_split_011.html#p178"></span> area1.innerHTML +=
code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id="area1"&gt;&lt;/div&gt;</p>
<p>A. 1</p>
<p>B. 2</p>
<p>C. 3</p>
<p>D. 4</p>
<p>9. Given the following code segment, how many image file(s) will pop
up?</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>var code1 = "";</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>code1 += "&lt;img src=b.gif&gt;";</p>
<p>}</p>
<p>area1.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id="area1"&gt;&lt;/div&gt;</p>
<p>A. 1</p>
<p>B. 2</p>
<p>C. 3</p>
<p>D. 4</p>
<p>10. The following code literally means "__".</p>
<p>if ((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v3 == 7) &amp;&amp;
(v4==7)) A. If 4 numbers are all 7’s</p>
<p>B. If there are any 3 numbers having 7 as values</p>
<p>C. If there are any 2 numbers having 7 as values</p>
<p>D. If there is any 1 number having 7 as value</p>
<p>Game Programming – Penn Wu</p>
<p>178</p>
<p><span id="index_split_011.html#p179"></span></p>
<p>Lab #10</p>
<p>Score boards</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab10.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Guessing Number Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab10_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {border:solid 2 black; width:30; height:30;</p>
<p>font-size:20px; text-align:center; color:white;</p>
<p>background-color:green;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var score=0;</p>
<p>function init() {</p>
<p>code1="";</p>
<p>for (i=1; i&lt;=64; i++) {</p>
<p>if (i%8==0) {</p>
<p>code1+="&lt;span id=n"+i+"&gt;"+i+"&lt;/span&gt;&lt;br&gt;";}</p>
<p>else { code1+="&lt;span id=n"+i+"&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>area1.innerHTML=code1;</p>
<p>p1.innerText = 0;</p>
<p>}</p>
<p>function start() {</p>
<p>var k=Math.floor(Math.random()*64);</p>
<p>f1.t2.value=k;</p>
<p>if (k==0 || k&gt;64) {k=Math.floor(Math.random()*64);}</p>
<p>for (i=1; i&lt;=64; i++) {</p>
<p>code1="n"+i+".style.backgroundColor='green';"</p>
<p>eval(code1)</p>
<p>}</p>
<p>eval("n"+k+".style.backgroundColor='red';"); sf =
setTimeout("start()",50);</p>
<p>}</p>
<p>function stop() {</p>
<p>clearTimeout(sf);</p>
<p><strong>if (f1.t1.value==f1.t2.value) { score+=1000; p1.innerText =
score;}</strong></p>
<p><strong>else { score -=1; p1.innerText = score;}</strong></p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>179</p>
<p><span id="index_split_011.html#p180"></span><img
src="index-180_1.png" class="calibre5" alt="Image 151" /></p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id=area1&gt;&lt;/div&gt;</p>
<p>&lt;form name=f1&gt;</p>
<p>Enter a number (1-64):</p>
<p>&lt;input type=text name=t1 size=5&gt;</p>
<p>&lt;input type=hidden name=t2&gt;</p>
<p>&lt;/form&gt;</p>
<p>&lt;p&gt;Your Score: &lt;b id=p1&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;button onClick="start()"&gt;Start&lt;/button&gt;</p>
<p>&lt;button onClick="stop()"&gt;Stop&lt;/button&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #2: Punching duckling</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab10_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img {position: absolute; display:none}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var score=0;</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=10; i++) {</p>
<p>codes="&lt;img id='d"+i+"' src='duck.gif' style='left:10;
top:10'&gt;"; area1.innerHTML += codes;</p>
<p>}</p>
<p>DuckMove()</p>
<p>}</p>
<p>function DuckMove() {</p>
<p>var w=Math.floor(document.body.clientWidth / 10);</p>
<p>for (i=1; i&lt;=9; i++) {</p>
<p>code1="if (d"+i+".style.pixelLeft &gt;= w) "; code1+=" {
d"+(i+1)+".style.display='inline'; "; code1+="d"+(i+1)+".style.pixelLeft
+= 5; }"; eval(code1);</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>180</p>
<p><span id="index_split_011.html#p181"></span></p>
<p>if (d1.style.pixelLeft &gt;= document.body.clientWidth-w)</p>
<p>{ d1.style.display = "none";}</p>
<p>else { d1.style.display='inline';d1.style.pixelLeft += 5;}</p>
<p>for (j=2; j&lt;=9; j++) {</p>
<p>code2="if (d"+j+".style.pixelLeft &gt;=
document.body.clientWidth-w)"; code2+=" { d"+j+".style.display =
'none';}"; eval(code2);</p>
<p>}</p>
<p>if (d10.style.pixelLeft &gt;= document.body.clientWidth-w)</p>
<p>{ d10.style.display = 'none'; gameOver();}</p>
<p>else { s1 = setTimeout("DuckMove()", 100); }</p>
<p>}</p>
<p>function gameOver() {</p>
<p>clearTimeout(s1);</p>
<p>alert("Game Over!");</p>
<p>}</p>
<p>function GloveMove() {</p>
<p>var e=event.keyCode;</p>
<p>switch (e) {</p>
<p>case 37:</p>
<p>gv.style.pixelLeft-=2;</p>
<p>break;</p>
<p>case 39:</p>
<p>gv.style.pixelLeft+=2;</p>
<p>break;</p>
<p>case 83:</p>
<p>punch()</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>function punch() {</p>
<p>gv.style.pixelLeft+=2;</p>
<p>gv.style.pixelTop-=2;</p>
<p>if (gv.style.pixelTop &lt;=0)</p>
<p>{clearTimeout(s2);gv.style.pixelTop=200;gv.style.pixelLeft=10;}</p>
<p>else {s2=setTimeout("punch()", 20);}</p>
<p>for (i=1; i&lt;=10; i++) {</p>
<p>code3="if ((gv.style.pixelLeft &gt;= d"+i+".style.pixelLeft)
&amp;&amp;"; code3+=" (gv.style.pixelLeft &lt;= (d"+i+".style.pixelLeft
+ 61)) &amp;&amp; "; code3+=" (gv.style.pixelTop &lt;=
d"+i+".style.pixelTop)) ";
code3+="{d"+i+".style.display='none';d"+i+".src='noduck.gif';"</p>
<p>code3+="score+=10;p1.innerText=score}";</p>
<p>eval(code3);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init() onKeyDown=GloveMove() bgcolor="white"&gt;</p>
<p>&lt;div id="area1" style="width:100%"&gt;&lt;/div&gt;</p>
<p>&lt;img id='gv' src="glove.gif"
style="left:10;top:200;display:'inline'" width=50&gt;</p>
<p>&lt;p style="position:absolute; top:300"&gt;Your score: &lt;b
id=p1&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>181</p>
<p><span id="index_split_011.html#p182"></span><img
src="index-182_1.png" class="calibre5" alt="Image 152" /></p>
<p>3. Test the program. Press S to punch. Press → or ← to move to left
or right. A sample output looks: <strong>Learning Activity #3: Shooting
Crab Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab10_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.bee {position:relative; z-index: 1}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var score=0;</p>
<p>function moveLeft() {</p>
<p>leftSide = area1.style.pixelLeft + 32;</p>
<p>if (leftSide &gt;= 300) {</p>
<p>if (area1.style.pixelTop &gt;= 200) {</p>
<p>clearTimeout(sf);</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelTop += 20;</p>
<p>clearTimeout(sf); moveRight();</p>
<p>}</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelLeft += 5;</p>
<p>sf = setTimeout("moveLeft()", 50);</p>
<p>}</p>
<p>}</p>
<p>function moveRight() {</p>
<p>if (area1.style.pixelLeft == 0) {</p>
<p>if (area1.style.pixelTop &gt;= 200) {</p>
<p>clearTimeout(sr);</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelTop += 20;</p>
<p>clearTimeout(sr); moveLeft();</p>
<p>}</p>
<p>}</p>
<p>else {</p>
<p>area1.style.pixelLeft -= 5;</p>
<p>sr = setTimeout("moveRight()", 50);</p>
<p>}</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>182</p>
<p><span id="index_split_011.html#p183"></span>function shoot() {</p>
<p>var e=event.keyCode;</p>
<p>switch(e) {</p>
<p>case 37:</p>
<p>shooter.style.pixelLeft-=2; break;</p>
<p>case 39:</p>
<p>shooter.style.pixelLeft+=2; break;</p>
<p>case 83:</p>
<p>b1.style.pixelLeft = shooter.style.pixelLeft + 14;</p>
<p>b1.style.display = 'inline';</p>
<p>fire();</p>
<p>}</p>
<p>}</p>
<p>function fire() {</p>
<p>if (b1.style.pixelTop == 0) {</p>
<p>b1.style.display='none';</p>
<p>b1.style.top = 270;</p>
<p>clearTimeout(ss);</p>
<p>}</p>
<p>else {</p>
<p>b1.style.pixelTop -= 5;</p>
<p>if ((b1.style.pixelTop &lt;= area1.style.pixelTop + 20) &amp;&amp;
(b1.style.pixelTop &gt;=area1.style.pixelTop)) {</p>
<p>if ((b1.style.pixelLeft &gt;= area1.style.pixelLeft) &amp;&amp;
(b1.style.pixelLeft &lt;= area1.style.pixelLeft + 31))</p>
<p>{</p>
<p>c1.style.display='none';b1.style.display="none";</p>
<p>clearTimeout(ss); <strong>score += 10;</strong></p>
<p><strong>gd.innerText = score;</strong> newCrab() }</p>
<p>}</p>
<p>ss = setTimeout("fire()", 20);</p>
<p>}</p>
<p>}</p>
<p>function newCrab() {</p>
<p>area1.style.pixelLeft = 0;</p>
<p>area1.style.pixelTop = 0;</p>
<p>c1.style.display='inline';</p>
<p>if (c1.style.backgroundColor=='yellow')
{c1.style.backgroundColor='red';}</p>
<p>else if (c1.style.backgroundColor=='red')
{c1.style.backgroundColor='blue';}</p>
<p>else if (c1.style.backgroundColor=='blue')
{c1.style.backgroundColor='orange';}</p>
<p>else if (c1.style.backgroundColor=='orange')
{c1.style.backgroundColor='white';}</p>
<p>else if (c1.style.backgroundColor=='white')
{c1.style.backgroundColor='yellow';}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=moveLeft() onKeyDown=shoot()&gt;</p>
<p>&lt;div style="position:absolute; width:300; height:300;
background-color: black"&gt;</p>
<p>&lt;span id="area1" style="position:absolute;"&gt;</p>
<p>&lt;img class='bee' id=c1 src='crab.gif'
style="background-color:yellow" /&gt;</p>
<p>&lt;/span&gt;</p>
<p>&lt;span id="b1" style="position:absolute; top:270; display:none;
color:white; z-index:2"&gt;!&lt;/span&gt;</p>
<p>&lt;span id="shooter" style="position:absolute; top:275;
color:white"&gt;&lt;b&gt;_|_&lt;/b&gt;&lt;/span&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;p style="position:absolute;top: 350"&gt;Your score: &lt;b
id=gd&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>183</p>
<p><span id="index_split_011.html#p184"></span><img
src="index-184_1.png" class="calibre5" alt="Image 153" /></p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #4: Slot Machine</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab10_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.box {position:relative; border:solid 5 black;</p>
<p>font-size:72; font-family:arial; text-align:center;</p>
<p>width:100; height:100}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var gd=0;</p>
<p>function init() {</p>
<p>codes="";</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>codes+="&lt;input type=text name=n"+i+" class='box' /&gt;";</p>
<p>}</p>
<p>area2.innerHTML=codes;</p>
<p>}</p>
<p>function spin() {</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>code2="f1.n"+i+".value = Math.floor(Math.random()*10);";
eval(code2);</p>
<p>}</p>
<p>s1 = setTimeout("spin()", 50);</p>
<p>}</p>
<p>function check() {</p>
<p>clearTimeout(s1);</p>
<p>var v1 = f1.n1.value;</p>
<p>var v2 = f1.n2.value;</p>
<p>var v3 = f1.n3.value;</p>
<p>var v4 = f1.n4.value;</p>
<p>if ((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v3 == 7) &amp;&amp;
(v4==7)) Game Programming – Penn Wu</p>
<p>184</p>
<p><span id="index_split_011.html#p185"></span><img
src="index-185_1.png" class="calibre5" alt="Image 154" /></p>
<p>{gd += 30000; score.innerText = 30000;}</p>
<p>else if (((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v3 == 7)) ||</p>
<p>((v1 == 7) &amp;&amp; (v2 == 7) &amp;&amp; (v4 == 7)) ||</p>
<p>((v2 == 7) &amp;&amp; (v3 == 7) &amp;&amp; (v4 == 7)))</p>
<p>{gd += 3000; score.innerText = 3000;}</p>
<p>else if (((v1 == v2) &amp;&amp; (v2 == v3)) ||</p>
<p>((v1 == v2) &amp;&amp; (v2 == v4)) ||</p>
<p>((v2 == v3) &amp;&amp; (v3 == v4))) { gd += 300; score.innerText =
300; }</p>
<p>else if ((v1 == v2) || (v1 == v3) ||</p>
<p>(v1 == v4) || (v2 == v3) ||</p>
<p>(v2 == v4) || (v3 == v4))</p>
<p>{gd += 0; score.innerText = 0;}</p>
<p>else {gd -=30; score.innerText = "-30";}</p>
<p>credit.innerText = gd;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id="area1" style="position:absolute; background-color:white;
width:400px; height:100px"&gt;</p>
<p>&lt;form name="f1"&gt;</p>
<p>&lt;span id="area2" style="position:relative"&gt;&lt;/span&gt;</p>
<p>&lt;/form&gt;</p>
<p>&lt;p&gt;</p>
<p>Your score: &lt;b id=score&gt;&lt;/b&gt;&lt;br&gt;</p>
<p>Your credit: &lt;b id=credit&gt;&lt;/b&gt;&lt;br&gt;</p>
<p>&lt;/p&gt;</p>
<p>&lt;p&gt;&lt;button onMouseDown="spin()"
onMouseUp="check()"&gt;Spin&lt;/button&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press any key to spin. A sample output looks:
<strong>Learning Activity #5: Pitching &amp; Catching Baseball
Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab10_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>185</p>
<p><span id="index_split_011.html#p186"></span>&lt;script&gt;</p>
<p>var i=Math.floor(Math.random()*360);</p>
<p>var score=0;</p>
<p>function init() {</p>
<p>ct.style.left = document.body.clientWidth-150;</p>
<p>}</p>
<p>function check() {</p>
<p>var e=event.keyCode;</p>
<p>switch (e) {</p>
<p>case 83:</p>
<p>play(); break;</p>
<p>case 38:</p>
<p>ct.style.pixelTop -=5; break;</p>
<p>case 40:</p>
<p>ct.style.pixelTop +=5; break;</p>
<p>}</p>
<p>}</p>
<p>function play() {</p>
<p>if ( bb.style.pixelLeft &gt;= document.body.clientWidth-50) {</p>
<p>bb.style.display="none"; score-=10; p1.innerText=score;}</p>
<p>else {</p>
<p>if ((bb.style.pixelLeft &gt;= ct.style.pixelLeft + 50) &amp;&amp;
(bb.style.pixelTop &lt;= ct.style.pixelTop + 20) &amp;&amp;</p>
<p>(bb.style.pixelTop &gt;= ct.style.pixelTop)) {</p>
<p>bb.style.display="none"; score+=10; p1.innerText=score;</p>
<p>}</p>
<p>else if ((bb.style.pixelTop &gt;= document.body.clientHeight-20)
||</p>
<p>(bb.style.pixelTop&lt;=0)) {</p>
<p>bb.style.display="none"; score+=5; p1.innerText=score;
msg.innerText="Bad pitch, you got 5 points!";</p>
<p>}</p>
<p>else {</p>
<p>bb.style.pixelLeft+=10;</p>
<p>bb.style.pixelTop+=Math.tan(i);</p>
<p>s1 = setTimeout("play()",50);</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init(); onKeyDown=check()&gt;</p>
<p>&lt;img id="bb" width=10 src="ball.gif" style="position:absolute;
top:400;left:10; z-index:3"&gt;</p>
<p>&lt;img id="ct" src="catch.gif" style="position:absolute; top:200;
z-index:1"&gt;</p>
<p>&lt;p&gt;Your score: &lt;b id=p1&gt;&lt;/b&gt;&lt;br&gt;</p>
<p>&lt;b id=msg&gt;&lt;b&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press S to pitch. Use ↑ and ↓ keys to move the
catcher. Use the browser’s Refresh button to play the game again. Only
when the ball hit the catcher’s glove can you get 10 <em>n</em> points
(n is an integer); otherwise you lose 10 points. If the ball moves out
of the body area, you get 5 point for bad pitching. A sample output
looks:</p>
<p>Game Programming – Penn Wu</p>
<p>186</p>
<p><span id="index_split_011.html#p187"></span><img
src="index-187_1.png" class="calibre5" alt="Image 155" /></p>
<p><img src="index-187_2.png" class="calibre5" alt="Image 156" /></p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 10, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab10_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab10_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab10_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab10_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab10_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>187</p>
<p><span id="index_split_011.html#p188"></span><img
src="index-188_1.png" class="calibre5" alt="Image 157" /></p>
<p>Lecture #11</p>
<p>Storyline and Texture</p>
<p>Objective</p>
<p>This lecture is aimed at walking students through some of the basic
knowledge for developing complex games within a restricted coding
environment. Along the way, this lecture provides real codes that will
be useful to everyone who wants to develop basic skills for creating
complex games.</p>
<p>The Art of</p>
<p>A storylines is the setting for the game, including such things as an
introduction to the characters, Storyboarding</p>
<p>their location, and the reason they do what they do. A storyline
forms the spirit of the game.</p>
<p>In the arcade, you frequently see the dancing pad game. It is a game
that uses is a flat electronic game controller for sending inputs to a
dance platform (such as the one used in the arcade version of Dance
Revolution).</p>
<p>Picture of Dance Revolution</p>
<p>To create a computer game as simulation of such game, you have the
freedom to decide the storyline. In the following code example, the
storylines are:</p>
<p>•</p>
<p>Four arrows--left, right, up, and down--are selected randomly, one at
a time.</p>
<p>•</p>
<p>Change the color of the select arrow to red (from black).</p>
<p>•</p>
<p>Detect the player’s response using arrow keys on the keyboard.</p>
<p>•</p>
<p>If the player presses the correct key, he/she wins 10 points.</p>
<p>•</p>
<p>Additionally, add an animated dancing girl as 3D texture of this
game.</p>
<p>The following codes randomly select a number from 1, 2, 3, and 4,
which represent up, left, right, and down respectively. The
<strong>switch..case</strong> statement, then determine which arrow’s
color must be changed to red. The <strong>setTimeout()</strong> method
executes the <strong>init()</strong> function every 500
milliseconds.</p>
<p>function init() {</p>
<p>clear();</p>
<p>var i=Math.floor(Math.random()*4)+1;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>up.src="up_red.gif"; k=38;</p>
<p>break;</p>
<p>case 2:</p>
<p>left.src="left_red.gif"; k=37;</p>
<p>break;</p>
<p>case 3:</p>
<p>right.src="right_red.gif"; k=39;</p>
<p>break;</p>
<p>case 4:</p>
<p>down.src="down_red.gif"; k=40;</p>
<p>break;</p>
<p>Game Programming – Penn Wu</p>
<p>188</p>
<p><span id="index_split_011.html#p189"></span><img
src="index-189_1.png" class="calibre5" alt="Image 158" /></p>
<p>}</p>
<p>s1=setTimeout("init()", 500);</p>
<p>}</p>
<p>The <strong>keyed()</strong> function checks whether or not the
player presses the correct arrow key on the keyboard by comparing the
<strong>keyCode</strong> value with the value of a variable
<strong>k</strong>. The init() function assigns a value to k every time
when it is executed.</p>
<p>function keyed() {</p>
<p>if (event.keyCode==k) { score+=10; p1.innerText=score; }</p>
<p>}</p>
<p>The <strong>score</strong> variable keeps score and let the
<strong>innerText</strong> property insert the updates score to p1. The
following line loads an animated gif file that delivers an effect of
dancing girl.</p>
<p>&lt;img src="dancinggirl.gif" width=250"&gt;</p>
<p>A complete code of this game will screen a theme like:</p>
<p>As a programmer, it is easy for you to convert your thoughts into
flows of game; however, the players may not be able to handle your game
concepts if you fail to stick to the following unwritten rules:</p>
<p>•</p>
<p>Start with a simple game theme. It is always best not to take risks
with games that are too difficult and instead stick to a design that is
simple and intuitive.</p>
<p>•</p>
<p>Consider your target devices. Computers differ in CPU and memory
sizes and color resolutions. A complicated game may not provide
acceptable performance on all target computers.</p>
<p>•</p>
<p>Develop a good storyline. Create a storyboard for every important
screen of your game, so that you have a rough visual idea of your final
product. And, develop a gripping back-story for supporting the gameplay.
The storyline must be closely tied to the game view (top view, side
view, isometric view), gameplay, game characters, levels, obstacles,
game animations and so on.</p>
<p>•</p>
<p>Focus on the right thing. Make sure that the back-story is not the
focal point of the game. Too many background graphics or too complicate
in texturing will take away the player’s attention on the game. Textures
should be created only if it is applicable to the game.</p>
<p>This lecture, from this point on, will focus on how to develop
storylines and create game codes in according to the storylines.</p>
<p>Developing a</p>
<p>Developing a storyline for a game usually consists of a few steps.
First, decide what theme you storyline</p>
<p>want for your story. For example, in the Tetris game, you need to
continuously drop shapes of bricks from the top to bottom. Each shape
can be rotated horizontally or vertically, so you need to define all the
possible shapes.</p>
<p>Your storyline for now will be:</p>
<p>•</p>
<p>Display a square area with 16 cells in it.</p>
<p>•</p>
<p>When the player press any key, make sure all the 16 cells’
backgrounds are in white, and then change the background color of any
predefined set of 4 cells to red.</p>
<p>•</p>
<p>Be ready for the next theme.</p>
<p>Game Programming – Penn Wu</p>
<p>189</p>
<p><span id="index_split_011.html#p190"></span><img
src="index-190_1.png" class="calibre5" alt="Image 159" /></p>
<p><img src="index-190_2.png" class="calibre5" alt="Image 160" /></p>
<p><img src="index-190_3.png" class="calibre5" alt="Image 161" /></p>
<p><img src="index-190_4.png" class="calibre5" alt="Image 162" /></p>
<p><img src="index-190_5.png" class="calibre5" alt="Image 163" /></p>
<p>Once the storyline is developed, you can begin writing code for this
part of the entire storylines.</p>
<p>Given the following code. It generates an output of 16 cells with
numbers in each of them.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.cell {border:solid 1 black;</p>
<p>width:20; height:20;</p>
<p>background-Color: white}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=16; i++) {</p>
<p>if (i<strong>%</strong>4==0) {</p>
<p>code1 += "&lt;span id=c"+i+" class='cell'&gt;"+i+"&lt;/span&gt;
<strong>&lt;br&gt;</strong> ";}</p>
<p>else {code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>area1.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;div id="area1"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>The following lines use the modulus operator (%), which returns the
remainder of two numbers.</p>
<p>if (i<strong>%</strong>4==0) {</p>
<p>code1 += "&lt;span id=c"+i+" class='cell'&gt;"+i+"&lt;/span&gt;
<strong>&lt;br&gt;</strong> ";}</p>
<p>else {code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>The above code uses the <em>for</em> loop to create 16 cells, but it
only allows 4 cells each row. The modulus operator in this case helps to
detect if the current value of <em>i</em> is a multiple of 4. If so,
add</p>
<p>&lt;br&gt; to &lt;span&gt;..&lt;/span&gt; to break the line.</p>
<p>The modulus operator is also commonly used to take a randomly
generated number and reduce that number to a random number on a smaller
range, and it can quickly tell you if one number is a factor of
another.</p>
<p>The above code only lays out the background area, which consists of
16 cells with numbers in them. Notice that these numbers are added only
to help you figure out how you can design shapes (as those in the Tetris
game). For example,</p>
<p>Fig 1</p>
<p>Fig 2</p>
<p>Fig 3</p>
<p>Fig 4</p>
<p>Logically speaking:</p>
<p>•</p>
<p>To create the share of Fig 1, you need to change the background color
of cell 1, 2, 3 and 6.</p>
<p>•</p>
<p>To create the share of Fig 2, you need to change the background color
of cell 2, 5, 6 and 7.</p>
<p>•</p>
<p>To create the share of Fig 3, you need to change the background color
of cell 1, 5, 6 and 9.</p>
<p>•</p>
<p>To create the share of Fig 4, you need to change the background color
of cell 2, 5, 6 and 10.</p>
<p>Game Programming – Penn Wu</p>
<p>190</p>
<p><span id="index_split_011.html#p191"></span></p>
<p>This part of code is included in <strong>shapes()</strong> function.
Variables <strong>n1</strong>, <strong>n2</strong>, <strong>n3</strong>,
and <strong>n4</strong> are used to represent the numbers of the 4
picked cells.</p>
<p><strong></strong></p>
<p>function shapes() {</p>
<p>clear(); // call the clear() function</p>
<p>var i=Math.floor(Math.random()*4)+1;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>n1=1; n2=2; n3=3; n4=6; break;</p>
<p>case 2:</p>
<p>n1=2; n2=5; n3=6; n4=7; break;</p>
<p>case 3:</p>
<p>n1=1; n2=5; n3=6; n4=9; break;</p>
<p>case 4:</p>
<p>n1=2; n2=5; n3=6; n4=10; break;</p>
<p>}</p>
<p>code2 = "c"+n1+".style.backgroundColor='red';"; code2 +=
"c"+n2+".style.backgroundColor='red';"; code2 +=
"c"+n3+".style.backgroundColor='red';"; code2 +=
"c"+n4+".style.backgroundColor='red';"; eval(code2);</p>
<p>}</p>
<p>If case 1 is selected (randomly by the computer), the following code
blocks will become codes as shown in the dashed line area. Consequently,
you see the shape of Fig 1 on screen.</p>
<p>code2 = "c"+n1+".style.backgroundColor='red';"; code2 +=
"c"+n2+".style.backgroundColor='red';"; code2 +=
"c"+n3+".style.backgroundColor='red';"; code2 +=
"c"+n4+".style.backgroundColor='red';"; eval(code2);</p>
<p>c<strong>1</strong>.style.backgroundColor='red';</p>
<p>c<strong>2</strong>.style.backgroundColor='red';</p>
<p>c<strong>3</strong>.style.backgroundColor='red';</p>
<p>c6.style.backgroundColor='red';</p>
<p>The <strong>clear()</strong> function is created to handle the “…make
sure all the 16 cells’ backgrounds are in white…” part of the
storyline.</p>
<p>function clear() {</p>
<p>for (i=1; i&lt;=16; i++) {</p>
<p>code3 = "c"+i+".style.backgroundColor='white';"; eval(code3);</p>
<p>}</p>
<p>}</p>
<p>By adding the following functions, <strong>shapes()</strong> and
<strong>clear()</strong>, you can randomly display a shape in four
directions.</p>
<p>The next step is to decide how the theme will be played out. In a
real Tetris game, you don’t see the numbers in cells, so modify the
following line to prevent the numbers from being display (Compare with
the above codes).</p>
<p>function init() {</p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=16; i++) {</p>
<p>Game Programming – Penn Wu</p>
<p>191</p>
<p><span id="index_split_011.html#p192"></span><img
src="index-192_1.png" class="calibre5" alt="Image 164" /></p>
<p><img src="index-192_2.png" class="calibre5" alt="Image 165" /></p>
<p><img src="index-192_3.png" class="calibre5" alt="Image 166" /></p>
<p><img src="index-192_4.png" class="calibre5" alt="Image 167" /></p>
<p>if (i%4==0) {</p>
<p><strong>code1 += "&lt;span id=c"+i+"
class='cell'&gt;&lt;/span&gt;&lt;br&gt;";}</strong></p>
<p><strong>else {code1 += "&lt;span id=c"+i+"
class='cell'&gt;&lt;/span&gt;";}</strong></p>
<p>}</p>
<p>area1.innerHTML = code1;</p>
<p>}</p>
<p>The outputs now look:</p>
<p>Fig 1</p>
<p>Fig 2</p>
<p>Fig 3</p>
<p>Fig 4</p>
<p>Now that you have the theme set up, you can establish the protagonist
and antagonist. The player is the protagonist in the Tetris game, while
the computer surely is the antagonist. So, you need to decide the game
rules for scoring, game stages (phases), and levels of difficulty, etc..
For example, you can modify the code of dancing pad game to let players
choose the level of difficulty. Consider the following code,</p>
<p>function init() {</p>
<p>clear();</p>
<p>var i=Math.floor(Math.random()*4)+1;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>up.src="up_red.gif"; k=38;</p>
<p>break;</p>
<p>case 2:</p>
<p>left.src="left_red.gif"; k=37;</p>
<p>break;</p>
<p>case 3:</p>
<p>right.src="right_red.gif"; k=39;</p>
<p>break;</p>
<p>case 4:</p>
<p>down.src="down_red.gif"; k=40;</p>
<p>break;</p>
<p>}</p>
<p>s1=setTimeout("init()", <strong>500</strong>);</p>
<p>}</p>
<p>Simply change to the re-execution time value from 500 to 1000, the
player will have more time to decide what arrow key to press. When the
value is lowered to 300, the player has less time to respond.</p>
<p>Seeing that you want to the player to select the level of
difficulty--certainly one at a time, you can add a web form to collect
the player’s entry.</p>
<p>function init() {</p>
<p>clear();</p>
<p>var j=f1.t1.value;</p>
<p>switch(j) {</p>
<p>case 1:</p>
<p>sec = 1000; break;</p>
<p>case 2:</p>
<p>sec = 500; break;</p>
<p>case 3:</p>
<p>Game Programming – Penn Wu</p>
<p>192</p>
<p><span id="index_split_011.html#p193"></span> sec = 300; break;</p>
<p>}</p>
<p>var i=Math.floor(Math.random()*4)+1;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>up.src="up_red.gif"; k=38;</p>
<p>break;</p>
<p>case 2:</p>
<p>left.src="left_red.gif"; k=37;</p>
<p>break;</p>
<p>case 3:</p>
<p>right.src="right_red.gif"; k=39;</p>
<p>break;</p>
<p>case 4:</p>
<p>down.src="down_red.gif"; k=40;</p>
<p>break;</p>
<p>}</p>
<p>s1=setTimeout("init()", <strong>j</strong>);</p>
<p>}</p>
<p>..................</p>
<p>..................</p>
<p>&lt;form name="f1"&gt;</p>
<p>Level [1-3]: &lt;input type="text" name="t1" size=3&gt;&lt;br&gt;</p>
<p>&lt;button onclick="init()"&gt;Start&lt;/button&gt;</p>
<p>&lt;/form&gt;</p>
<p>..................</p>
<p>In the Tetris game, your storylines eventually must include moving
the shapes downwards. This part of code, for example, can be completed
by adding the following bold lines:</p>
<p>...............</p>
<p>function init() {</p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=<strong>64</strong>; i++) { // change the maximum to
64</p>
<p>................</p>
<p>................</p>
<p>code2 = "c"+n1+".style.backgroundColor='red';"; code2 +=
"c"+n2+".style.backgroundColor='red';"; code2 +=
"c"+n3+".style.backgroundColor='red';"; code2 +=
"c"+n4+".style.backgroundColor='red';"; eval(code2);</p>
<p><strong>st1=setInterval("moveDown()", 1000);</strong></p>
<p><strong>}</strong></p>
<p><strong></strong></p>
<p>function clear() {</p>
<p>for (i=1; i&lt;=<strong>64</strong>; i++) { // change the maximum to
64</p>
<p>code3 = "c"+i+".style.backgroundColor='white';"; eval(code3);</p>
<p>}</p>
<p>}</p>
<p><strong></strong></p>
<p><strong>function moveDown() {</strong></p>
<p><strong>clearInterval(st1);</strong></p>
<p><strong></strong></p>
<p><strong>if ((n1&gt;=60) || (n2&gt;=60) || (n1&gt;=60) || (n2&gt;=60))
{</strong></p>
<p><strong>clearTimeout(s1);</strong></p>
<p><strong>}</strong></p>
<p><strong>else {</strong></p>
<p><strong>clear();</strong></p>
<p><strong>n1+=4;</strong></p>
<p><strong>n2+=4;</strong></p>
<p>Game Programming – Penn Wu</p>
<p>193</p>
<p><span id="index_split_011.html#p194"></span><img
src="index-194_1.png" class="calibre5" alt="Image 168" /></p>
<p><img src="index-194_2.png" class="calibre5" alt="Image 169" /></p>
<p><img src="index-194_3.png" class="calibre5" alt="Image 170" /></p>
<p><strong>n3+=4;</strong></p>
<p><strong>n4+=4;</strong></p>
<p><strong></strong></p>
<p><strong>code4 = "c"+n1+".style.backgroundColor='red';";</strong>
<strong>code4 += "c"+n2+".style.backgroundColor='red';";</strong>
<strong>code4 += "c"+n3+".style.backgroundColor='red';";</strong>
<strong>code4 += "c"+n4+".style.backgroundColor='red';";</strong>
<strong>eval(code4);</strong></p>
<p><strong>s1 = setTimeout("moveDown()", 1000);</strong></p>
<p><strong>}</strong></p>
<p><strong>}</strong></p>
<p>So a sample outcome now looks:</p>
<p>Your game will also include storylines that require computer to make
human-like decisions. For example, in a Tic-Tac-Toe game, the player is
the protagonist and the computer will serves the antagonist to play
against the human player. The computer must be able to respond to the
human player’s movement with an intention to win the game. A later
lecture will discuss about how you can program by using concepts of
artificial intelligence to make you game code think like a human.</p>
<p>Developing</p>
<p>Before developing a multi-theme game, be sure to develop a linear
sequence of themes with a storylines for</p>
<p>smooth transition between any two of them.</p>
<p>multi-theme</p>
<p>games</p>
<p>In the <strong>Super Mario</strong> game, Mario needs to overcome two
stages to rescue the princess. You will then need to develop two
separated storylines--one for each stage..</p>
<p>You can create one single program with all the themes in it, or you
can create separated programs on a one-for-each-theme basis. The
decision should be made in according to the complexity of storyline. The
more characters, antagonists, and levels of difficulty the game has, the
more complicated it is.</p>
<p>In the Super Mario Theme 1 game, there is a <strong>theme2()</strong>
function which tells the browser to change the web page to
<strong>lab11_4.htm</strong> (from <strong>lab11_3.htm</strong>) when
Mario jumps into the chimney.</p>
<p>function theme2() {</p>
<p>if (h1.style.pixelTop&gt;=200) {</p>
<p>Game Programming – Penn Wu</p>
<p>194</p>
<p><span id="index_split_011.html#p195"></span><img
src="index-195_1.png" class="calibre5" alt="Image 171" /></p>
<p><img src="index-195_2.png" class="calibre5" alt="Image 172" /></p>
<p>h1.style.display ='none';</p>
<p>clearTimeout(t1);</p>
<p><strong>window.location='lab11_4.htm'} // change to the lab10_4.htm
file</strong> else {h1.style.pixelTop +=2;}</p>
<p>t1= setTimeout("theme2()", 20);</p>
<p>}</p>
<p>In the Bat Battle game, the storylines consist of two themes. In the
first theme:</p>
<p>•</p>
<p>A bat flies to a castle.</p>
<p>•</p>
<p>When the bat approaches the gate, the gate opens by itself.</p>
<p>In the second theme:</p>
<p>•</p>
<p>A bat flies toward a knight, who is watching the bat closely.</p>
<p>•</p>
<p>When the timing is ready, the knight attacks that flying bat.</p>
<p>Theme 1</p>
<p>Theme 2</p>
<p>These two themes are placed in the same code with &lt;body&gt; and
&lt;/body&gt;, as shown below.</p>
<p>&lt;body bgcolor="black" onLoad="init();flyBat()" /&gt;</p>
<p>// theme 1</p>
<p>&lt;div id="theme1"&gt;</p>
<p>&lt;img id="castle" src="gate_close.gif" style="position:absolute;
width:150; left:40" &gt;</p>
<p>&lt;img id="bat" src="bat.gif" style="position:absolute; width:75;
top:250; left:100"&gt;</p>
<p>&lt;/div&gt;</p>
<p>// theme 2</p>
<p>&lt;div id="theme2" style="display:none"&gt;</p>
<p>&lt;img id="knight" src="knight1.gif"</p>
<p>style="position:absolute;left:40"&gt;</p>
<p>&lt;img id="bat2" src="bat.gif" style="position:absolute; width:75;
top:220; left:100"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>Each theme is a panel by itself. A panel is a container that can
include many objects. In the above code, &lt;div&gt; and &lt;/div&gt;
defines the two panels. Objects (such as image files) belonging to the
first theme (the solid line area) are placed within:</p>
<p>&lt;div id="theme1"&gt;......&lt;/div&gt;</p>
<p>Objects that belong to the second theme (the dashed line area) are
placed within:</p>
<p>&lt;div id="theme2" <strong>style="display:none"</strong>
&gt;........&lt;/div&gt; Game Programming – Penn Wu</p>
<p>195</p>
<p><span id="index_split_011.html#p196"></span><img
src="index-196_1.png" class="calibre5" alt="Image 173" /></p>
<p>The second panel (the ID is “theme2”) is not displayed by default,
because the <strong>display</strong> property has the value
“<strong>none</strong>”. Thus, when the game starts, the player only
sees the first theme.</p>
<p>The <strong>flybat()</strong> function controls the transition
between theme 1 and 2, as shown below.</p>
<p>function flyBat() {</p>
<p>if (bat.style.pixelWidth == 0) {</p>
<p><strong>theme1.style.display = "none";</strong></p>
<p><strong>theme2.style.display = "inline";</strong></p>
<p>clearTimeout(s2); flyBat2();</p>
<p>}</p>
<p>else{</p>
<p>bat.style.pixelWidth--;</p>
<p>bat.style.pixelTop-=2;</p>
<p>s2 = setTimeout("flyBat()", 50);</p>
<p>}</p>
<p>}</p>
<p>The logic is simple--set the <strong>display</strong> property of
theme 1 to “<strong>none</strong>”, and set the display property of
theme to “<strong>inline</strong>”. Consequently the first panel is no
longer displayed, the second themes takes the place and is displayed on
the screen.</p>
<p>Noticeably, at the end of the following code block, the
<strong>flyBat2()</strong> function is triggered, which launch the
actions for theme 2.</p>
<p>if (bat.style.pixelWidth == 0) {</p>
<p>theme1.style.display = "none";</p>
<p>theme2.style.display = "inline";</p>
<p>clearTimeout(s2); <strong>flyBat2();</strong></p>
<p>}</p>
<p>The arrangement of this multi-theme is technically simple--whatever
belongs to theme 1 is placed in the area for theme1, whatever belongs to
theme 2 is placed in the area of theme 2. Between</p>
<p>&lt;script&gt; and &lt;/script&gt; tags, functions that will be used
for theme 1 are tied together, while those for theme 2 are in another
batch.</p>
<p>Texturing and</p>
<p>In graphics, the digital representation of the surface of an object
is known as the <strong>texture</strong> of that texture</p>
<p>graphics. In game programming, the effect of having a texture can be
reached by applying a one-, mapping</p>
<p>two-, or three-dimensional image to a given object as surface. Such
programming skill frequently requires the programmer to define a set of
parameters that determine how visible surface are derived from the
image. For example, by using some pre-designed 3D graphics with colorful
texture as background, the Tetris game will look completely different
(possibly more appealing to players).</p>
<p>In addition to two-dimensional qualities, such as color and
brightness, a texture is also encoded with three-dimensional properties,
such as how transparent and reflective the object is. Once a texture has
been defined, it can be wrapped around any 3-dimensional object. This is
called <strong>texture</strong> <strong>mapping</strong>.</p>
<p>Texture mapping is a technique that applies an image onto an object's
surface as if the image were a decal or cellophane shrink-wrap. The
image is created in texture space, with an ( <em>x</em>, <em>y</em>,
<em>z</em>) coordinate Game Programming – Penn Wu</p>
<p>196</p>
<p><span id="index_split_011.html#p197"></span><img
src="index-197_1.png" class="calibre5" alt="Image 174" /></p>
<p>system.</p>
<p>To add textures with DHTML, you can apply the so-called
“<strong>multimedia-style effects</strong>” (Microsoft names them the
“<strong>visual filters</strong>”) to standard HTML controls, such as
text containers, images, and other non-window-specified objects.</p>
<p>By combining filters with JavaScript scripting, you can create
visually engaging and interactive games. For example, the
<strong>alpha</strong> filer can adjust the opacity of the content of
the object. Its syntax is:</p>
<p>&lt;HTMLTag STYLE=</p>
<p>"filter:progid:DXImageTransform.Microsoft.Alpha( <em>Str</em>)"..&gt;
where <em>str</em> is the string that specifies one or more properties
exposed by the filter.</p>
<p>In the following code, the second image uses the alpha filter to fade
out its right-bottom corner.</p>
<p>&lt;img src="101.jpg" alt="without alpha"&gt;</p>
<p>&lt;img src="101.jpg" alt="with alpha"</p>
<p>style="filter:progid:DXImageTransform.Microsoft.Alpha(</p>
<p>Opacity=100, FinishOpacity=0, Style=1, StartX=0, FinishX=100,</p>
<p>StartY=0, FinishY=100)"&gt;</p>
<p>Compare the output of these two image file, the second image is
<strong>textured</strong>.</p>
<p>When writing game codes, you can use the following syntax to
dynamically control the object using visual filters:</p>
<p><em>ObjectID</em>.style.filter =</p>
<p>"progid:DXImageTransform.Microsoft.Alpha(str)";</p>
<p>For example, the following use the <strong>light</strong> filter to
create a texture effect of a blue light shining on the content of the
object.</p>
<p>&lt;script&gt;</p>
<p>window.onload=init;</p>
<p>function init() {</p>
<p>tp101.filters[0].addCone(0,0,1,250,499,0,0,255,20,180);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p><strong>&lt;img src="101.jpg" id="tp101"</strong></p>
<p><strong>style="filter:progid:DXImageTransform.Microsoft.light();"&gt;</strong>
Surprisingly this is how this image looks now:</p>
<p>Game Programming – Penn Wu</p>
<p>197</p>
<p><span id="index_split_011.html#p198"></span><img
src="index-198_1.png" class="calibre5" alt="Image 175" /></p>
<p>The <strong>addCone()</strong> method adds a cone light to the Light
filter effect object to cast a directional light on the page. The
syntax:</p>
<p>ObjectID.filters[ <em>n</em>].addCone( <em>iX1, iY1, iZ1, iX2, iY2,
iRed, iGreen,</em> <em>iBlue, iStrength, iSpread</em>);</p>
<p>where <em>n</em> is an integer that represents a filter in the order
of an array. It is because an object can have more than one filter. The
first filter has a key 0, the second 1, and so on.</p>
<p>All the parameters are:</p>
<p><em>iX1</em></p>
<p>Required. Integer that specifies the left coordinate of the light
source.</p>
<p><em>iY1</em></p>
<p>Required. Integer that specifies the top coordinate of the light
source.</p>
<p><em>iZ1</em></p>
<p>Required. Integer that specifies the z-axis level of the light
source.</p>
<p><em>iX2</em></p>
<p>Required. Integer that specifies the left coordinate of the target
light focus.</p>
<p><em>iY2</em></p>
<p>Required. Integer that specifies the top coordinate of the target
light focus.</p>
<p><em>iRed</em></p>
<p>Required. Integer that specifies the red value. The value can range
from 0</p>
<p>(lowest saturation) to 255 (highest saturation).</p>
<p><em>iGreen</em></p>
<p>Required. Integer that specifies the green value. The value can range
from 0 (lowest saturation) to 255 (highest saturation).</p>
<p><em>iBlue</em></p>
<p>Required. Integer that specifies the blue value. The value can range
from 0 (lowest saturation) to 255 (highest saturation).</p>
<p><em>iStrength</em> Required. Integer that specifies the intensity of
the light filter. The value can range from 0 (lowest intensity) to 100
(highest intensity).</p>
<p><em>iSpread</em></p>
<p>Required. Integer that specifies the angle, or spread, between the
vertical position of the light source and the surface of the object. The
angle can range from 0 to 90 degrees. Smaller angle values produce a
smaller cone of light; larger values produce an oblique oval or circle
of light.</p>
<p>The cone light fades with distance from the target <em>x</em> and y
position. The light displays a hard edge at the near edge of its focus
and fades gradually as it reaches its distance threshold.</p>
<p>You can also integrate the item method with
<strong>addCode()</strong> if you have more than one collections. The
item method retrieves an object from the all collection or various other
collections. Its syntax is: ObjectID.item(vIndex [, iSubindex])</p>
<p>where <em><strong>vIndex</strong></em> is required. It should be an
integer or string that specifies the object or collection to retrieve.
If this parameter is an integer, it is the zero-based index of the
object. If this parameter is a string, all objects with matching name or
id properties are retrieved, and a collection is returned if more than
one match is made.</p>
<p>Also, <em><strong>iSubindex</strong></em> is optional. Integer that
specifies the zero-based index of the object to retrieve Game
Programming – Penn Wu</p>
<p>198</p>
<p><span id="index_split_011.html#p199"></span><img
src="index-199_1.png" class="calibre5" alt="Image 176" /></p>
<p>when a collection is returned.</p>
<p>The syntax to combine <strong>item</strong> and
<strong>addCode</strong> methods is:
ObjectID.filters.item("DXImageTransform.Microsoft.Light").addCone(</p>
<p>iX1, iY1, iZ1, iX2, iY2, iRed, iGreen, iBlue, iStrength, iSpread); In
the Radar game, the <strong>radar.gif</strong> is a graphic with
concentric circles and <em>x</em>, <em>y</em> axis. Its background color
is white.</p>
<p>The code uses the <strong>init()</strong> function to create a
radar-like texture and apply the texture to <strong>radar.gif</strong>
file (its ID is <strong>rd</strong>). The <strong>addCone</strong>
method generates the coned light beam.</p>
<p>function init() {</p>
<p><strong>rd
.filters.item('DXImageTransform.Microsoft.light').addCone(</strong></p>
<p><strong>121, 121, 0, Light_X, Light_Y, 0, 255, 0, 150,
10);</strong></p>
<p>...............</p>
<p>}</p>
<p>................</p>
<p>................</p>
<p>&lt;img src="radar.gif" id=rd style="height:242;width:242;
filter:progid:DXImageTransform.Microsoft.light()"&gt;</p>
<p>In the movies, a radar screen normally uses blue as background color,
so let the addAmbient method adds a blue background to the rd
object.</p>
<p>function init() {</p>
<p>...............</p>
<p><strong>rd
.filters.item('DXImageTransform.Microsoft.light').addAmbient(</strong></p>
<p><strong>0, 0, 255, 80 )</strong></p>
<p>...............</p>
<p>}</p>
<p>The <strong>addAmbient</strong> method adds an ambient light to the
Light filter. Ambient light is non-directional and distributed uniformly
throughout space. Ambient light falling upon a surface approaches from
all directions. The light is reflected from the object independent of
surface location and orientation with equal intensity in all directions.
Its syntax is:</p>
<p>addAmbient(iRed, iGreen, iBlue, iStrength);</p>
<p>where,</p>
<p>•</p>
<p>iRed is an integer that specifies the red value. The value can range
from 0 (lowest saturation) to 255 (highest saturation).</p>
<p>•</p>
<p>iGreen is an integer that specifies the green value. The value can
range from 0 (lowest saturation) to 255 (highest saturation).</p>
<p>•</p>
<p>iBlue is an integer that specifies the blue value. The value can
range from 0 (lowest saturation) to 255 (highest saturation).</p>
<p>•</p>
<p>iStrength is an integer that specifies the intensity of the light
filter. The value can range from 0</p>
<p>(lowest intensity) to 100 (highest intensity). The intensity
specified pertains to the target coordinates.</p>
<p>Game Programming – Penn Wu</p>
<p>199</p>
<p><span id="index_split_011.html#p200"></span><img
src="index-200_1.png" class="calibre5" alt="Image 177" /></p>
<p>On the radar screen, red points represent flying objects. To
dynamically add an red point to the rd object, use the
<strong>addPoint</strong> method.</p>
<p>function init() {</p>
<p>...............</p>
<p><strong>rd
.filters.item('DXImageTransform.Microsoft.light').addPoint(</strong></p>
<p><strong>PlaneLight_X, PlaneLight_Y, 3, 255, 0, 0, 100);</strong></p>
<p>...............</p>
<p>}</p>
<p>The <strong>addPoint</strong> method adds a light source to the Light
filter. The light source originates at a single point and radiates in
all directions.</p>
<p>addPoint(iX, iY, iZ, iRed, iGreen, iBlue, iStrength);</p>
<p>where,</p>
<p>•</p>
<p>iX is an integer that specifies the left coordinate of the light
source.</p>
<p>•</p>
<p>iY is an integer that specifies the top coordinate of the light
source.</p>
<p>•</p>
<p>iZ is an integer that specifies the z-axis level of the light
source.</p>
<p>•</p>
<p>iRed is an integer that specifies the red value. The value can range
from 0 (lowest saturation) to 255 (highest saturation).</p>
<p>•</p>
<p>iGreen is an integer that specifies the green value. The value can
range from 0 (lowest saturation) to 255 (highest saturation).</p>
<p>•</p>
<p>iBlue is an integer that specifies the blue value. The value can
range from 0 (lowest saturation) to 255 (highest saturation).</p>
<p>•</p>
<p>iStrength is an integer that specifies the intensity of the light
filter. The value can range from 0</p>
<p>(lowest intensity) to 100 (highest intensity). The intensity
specified pertains to the target coordinates.</p>
<p>With the above codes, a dynamically created texture is applied to the
rd object (radar.gif file), so it now looks:</p>
<p>Microsoft defined many visual filters and methods to support these
filters. You can visit the Microsoft MSDN site for details about every
filters. As of April, 2007, the URL is
http://msdn.microsoft.com/workshop/author/filter/reference/reference.asp?frame=true
Review</p>
<p>1. Which provides a framework for computer game?</p>
<p>Questions</p>
<p>A. sprite</p>
<p>B. storyboard</p>
<p>C. storyline</p>
<p>D. genre</p>
<p>2. Given the following code segment, which assigns a file source
"flower.gif" to it so the image will appear?</p>
<p>Game Programming – Penn Wu</p>
<p>200</p>
<p><span id="index_split_011.html#p201"></span></p>
<p>&lt;img id="m1"&gt;</p>
<p>A. m1.style.src = "flower.gif"</p>
<p>B. m1.src = "flower.gif"</p>
<p>C. src(m1) = "flower.gif"</p>
<p>D. src.m1 = "flower.gif"</p>
<p>3. Which is the best way to let computer randomly pick a number from
1 to 4?</p>
<p>A. Math.floor(Math.random()*4);</p>
<p>B. Math.floor(Math.random()*4 + 1);</p>
<p>C. Math.floor(Math.random()*4) + 1;</p>
<p>D. Math.floor(Math.random()*4) - 1;</p>
<p>4. Given the following code segment, how will the "area1" object
look?</p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=15; i++) {</p>
<p>if (i%3==0) {</p>
<p>code1 += "&lt;span id=c"+i+"
class='cell'&gt;&lt;/span&gt;&lt;br&gt;";}</p>
<p>else {code1 += "&lt;span id=c"+i+"
class='cell'&gt;&lt;/span&gt;";}</p>
<p>}</p>
<p>area1.innerHTML = code1;</p>
<p>A. 3 rows 5 columns</p>
<p>B. 5 rows 3 columns</p>
<p>C. 3 rows 3 columns</p>
<p>D. 5 rows 5 columns</p>
<p>5. Given the following code segment, which can change the background
color of the "c1" object to red?</p>
<p>&lt;span id="c1" style="width:100"&gt;&lt;/span&gt; A.
c1.style.backgroundColor='red';</p>
<p>B. c1.style.bgcolor='red';</p>
<p>C. c1.backgroundColor='red';</p>
<p>D. c1.style.bgcolor='red';</p>
<p>6. Given the following code segment, if you wish to run the init()
code at a slower but constant speed, you should __.</p>
<p>var spd = 500;</p>
<p>s1=setTimeout("init()", spd);</p>
<p>A. increase the value of spd variable</p>
<p>B. decrease the value of spd variable</p>
<p>C. let the value of spd variable increment by 10 repetitively</p>
<p>D. let the value of spd variable decrement by 10 repetitively</p>
<p>7. Given the following code segment, which statement is correct?</p>
<p>st1=setInterval("init()", 1000);</p>
<p>A. It sets a one-time pause for 1 second and then executes
init().</p>
<p>B. It sets a repeating pause every 1 second before it executes
init().</p>
<p>C. It sets an infinite pause every 1 second before it executes
init().</p>
<p>D. It sets an endless pause every 1 second before it executes
init().</p>
<p>Game Programming – Penn Wu</p>
<p>201</p>
<p><span id="index_split_011.html#p202"></span></p>
<p>8. Which can hide a theme which is included in a pair of &lt;div
id="theme1"&gt; and &lt;/div&gt; tags?</p>
<p>A. theme1.style.show = "false"</p>
<p>B. theme1.style.hide = "true"</p>
<p>C. theme1.style.display = "none"</p>
<p>D. theme1.style.visible = "none"</p>
<p>9. Which Microsoft visual filter can fade out an image partially?</p>
<p>A. beta</p>
<p>B. sigma</p>
<p>C. fade</p>
<p>D. alpha</p>
<p>10. Given the following code, which value specifies the intensity of
the light filter?</p>
<p>addAmbient( 0, 120, 255, 80 )</p>
<p>A. 0</p>
<p>B. 120</p>
<p>C. 255</p>
<p>D. 80</p>
<p>Game Programming – Penn Wu</p>
<p>202</p>
<p><span id="index_split_011.html#p203"></span></p>
<p>Lab #11</p>
<p>Storyline and Texture</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab11.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1: Dancing Pad Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab11_1.htm</strong> with the following contents:</p>
<p>&lt;script&gt;</p>
<p>var score = 0;</p>
<p>var k;</p>
<p>function init() {</p>
<p>clear();</p>
<p>var i=Math.floor(Math.random()*4)+1;</p>
<p>switch (i) {</p>
<p>case 1:</p>
<p>up.src="up_red.gif"; k=38;</p>
<p>break;</p>
<p>case 2:</p>
<p>left.src="left_red.gif"; k=37;</p>
<p>break;</p>
<p>case 3:</p>
<p>right.src="right_red.gif"; k=39;</p>
<p>break;</p>
<p>case 4:</p>
<p>down.src="down_red.gif"; k=40;</p>
<p>break;</p>
<p>}</p>
<p>s1=setTimeout("init()", 500);</p>
<p>}</p>
<p>function clear() {</p>
<p>up.src="up_black.gif";</p>
<p>left.src="left_black.gif";</p>
<p>right.src="right_black.gif";</p>
<p>down.src="down_black.gif";</p>
<p>}</p>
<p>function keyed() {</p>
<p>if (event.keyCode==k) { score+=10; p1.innerText=score; }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init() onKeyDown=keyed() /&gt;</p>
<p>&lt;table&gt;</p>
<p>&lt;tr&gt;&lt;td&gt;</p>
<p>&lt;img src="dancinggirl.gif" width=250"&gt;</p>
<p>&lt;/td&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>203</p>
<p><span id="index_split_011.html#p204"></span><img
src="index-204_1.png" class="calibre5" alt="Image 178" /></p>
<p>&lt;td&gt;</p>
<p>&lt;p&gt;Your Score: &lt;b id=p1&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;table border=1&gt;</p>
<p>&lt;tr&gt;&lt;td&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img id="up" src="up_black.gif"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</p>
<p>&lt;tr&gt;&lt;td&gt;&lt;img id="left"
src="left_black.gif"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img id="right"
src="right_black.gif"&gt;&lt;/td&gt;&lt;/tr&gt;</p>
<p>&lt;tr&gt;&lt;td&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;img id="down" src="down_black.gif"&gt;&lt;/td&gt;</p>
<p>&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;</p>
<p>&lt;/td&gt;</p>
<p>&lt;/table&gt;</p>
<p>3. Test the program. Press the correct arrow keys on the keyboard as
response to the red arrow on screen. A sample output looks:</p>
<p><strong>Learning Activity #2: Multi-theme game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab11_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>// theme 1 functions</p>
<p>function init() {</p>
<p>if (bat.style.pixelTop &lt;= 200) {</p>
<p>castle.src="gate_open.gif";</p>
<p>setInterval("castle.src='gate_opened.gif'",1600);</p>
<p>clearTimeout(s1);</p>
<p>}</p>
<p>else {</p>
<p>s1 = setTimeout("init()", 150);</p>
<p>}</p>
<p>}</p>
<p>function flyBat() {</p>
<p>if (bat.style.pixelWidth == 0) {</p>
<p>theme1.style.display = "none";</p>
<p>theme2.style.display = "inline";</p>
<p>clearTimeout(s2); flyBat2();</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>204</p>
<p><span id="index_split_011.html#p205"></span><img
src="index-205_1.png" class="calibre5" alt="Image 179" /></p>
<p><img src="index-205_2.png" class="calibre5" alt="Image 180" /></p>
<p>else{</p>
<p>bat.style.pixelWidth--;</p>
<p>bat.style.pixelTop-=2;</p>
<p>s2 = setTimeout("flyBat()", 50);</p>
<p>}</p>
<p>}</p>
<p>// theme 2 functions</p>
<p>function flyBat2() {</p>
<p>if (bat2.style.pixelTop &lt;= 170) {</p>
<p>knight.src="knight2.gif";</p>
<p>setInterval("knight.src='knight1.gif'", 4000);</p>
<p>}</p>
<p>if (bat2.style.pixelWidth == 0) {</p>
<p>clearTimeout(s3);</p>
<p>}</p>
<p>else{</p>
<p>bat2.style.pixelWidth--;</p>
<p>bat2.style.pixelTop-=2;</p>
<p>s3 = setTimeout("flyBat2()", 50);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor="black" onLoad="init();flyBat()" /&gt;</p>
<p>// theme 1</p>
<p>&lt;div id="theme1"&gt;</p>
<p>&lt;img id="castle" src="gate_close.gif" style="position:absolute;
width:150; left:40" &gt;</p>
<p>&lt;img id="bat" src="bat.gif" style="position:absolute; width:75;
top:250; left:100"&gt;</p>
<p>&lt;/div&gt;</p>
<p>// theme 2</p>
<p>&lt;div id="theme2" style="display:none"&gt;</p>
<p>&lt;img id="knight" src="knight1.gif"
style="position:absolute;left:40"&gt;</p>
<p>&lt;img id="bat2" src="bat.gif" style="position:absolute; width:75;
top:220; left:100"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p>Theme 1</p>
<p>Theme 2</p>
<p>Game Programming – Penn Wu</p>
<p>205</p>
<p><span id="index_split_011.html#p206"></span></p>
<p><strong>Learning Activity #3: Super Mario Theme 1 (this file and
lab11_4.htm are linked)</strong> Note: This game is meant to be simple
and easy for the sake of demonstrating programming concepts. Please do
not hesitate to enhance the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab11_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0;</p>
<p>var direction = "up";</p>
<p>function keyed() {</p>
<p>var e=event.keyCode;</p>
<p>switch (e) {</p>
<p>case 39:</p>
<p>if ((h1.style.pixelLeft + 36 &lt; b1.style.pixelLeft) ||</p>
<p>(h1.style.pixelLeft &gt; b1.style.pixelLeft + 18)) {</p>
<p>h1.src="4.gif"; h1.style.pixelLeft+=2;</p>
<p>}</p>
<p>else {</p>
<p>h1.style.pixelLeft = b1.style.pixelLeft - 36 ; h1.src="1.gif"; }</p>
<p>break;</p>
<p>case 83:</p>
<p>jump(); break;</p>
<p>}</p>
<p>}</p>
<p>function jump() {</p>
<p>h1.src="2.gif";</p>
<p>if (i==50) { direction = "down"; }</p>
<p>if (direction=="up") { h1.style.pixelTop -=2;</p>
<p>if (i&gt;=20) { h1.style.pixelLeft +=1;}</p>
<p>i++; }</p>
<p>else {h1.style.pixelTop +=2; i--;}</p>
<p>if (i&lt;0) {clearTimeout(s1);h1.style.pixelTop -=2;</p>
<p>i=0; direction="up"; h1.src="1.gif"}</p>
<p>else {</p>
<p>s1 = setTimeout("jump()", 10);</p>
<p>}</p>
<p>if ((h1.style.pixelLeft + 36 &gt;= b1.style.pixelLeft) &amp;&amp;
(h1.style.pixelLeft + 36 &gt;= b1.style.pixelLeft + 18) &amp;&amp;
(h1.style.pixelTop + 46 &gt;= b1.style.pixelTop)) {</p>
<p>clearTimeout(s1);</p>
<p>h1.src="1.gif";</p>
<p>theme2();</p>
<p>}</p>
<p>}</p>
<p>function theme2() {</p>
<p>if (h1.style.pixelTop&gt;=200) {</p>
<p>h1.style.display ='none';</p>
<p>clearTimeout(t1);</p>
<p><strong>window.location='lab11_4.htm'} // change to the lab10_4.htm
file</strong> Game Programming – Penn Wu</p>
<p>206</p>
<p><span id="index_split_011.html#p207"></span><img
src="index-207_1.png" class="calibre5" alt="Image 181" /></p>
<p><img src="index-207_2.png" class="calibre5" alt="Image 182" /></p>
<p>else {h1.style.pixelTop +=2;}</p>
<p>t1= setTimeout("theme2()", 20);</p>
<p>}</p>
<p>function keyUp() {</p>
<p>if (h1.src=="4.gif") { h1.src="1.gif"; }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="keyed()" onKeyUp="keyUp()"&gt;</p>
<p>&lt;img id="h1" src="1.gif" style="position:absolute; top:200;
left:10"&gt;</p>
<p>&lt;img id="b1" src="block.gif" style="position:absolute; top:194;
left:200; width:26;height:50"&gt;</p>
<p>&lt;hr size=1 width=400 style="position:absolute; top:243;"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Use key to move toward the chimney, and then
press S to jump into the chimney. A sample output looks:</p>
<p>Theme 1</p>
<p>Theme 2 (lab11_4.htm)</p>
<p><strong>Learning Activity #4: Super Mario Theme 2 (this file is the
second theme of lab11_3.htm)</strong> Note: This game is meant to be
simple and easy for the sake of demonstrating programming concepts.
Please do not hesitate to enhance the appearance or functions of this
game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab11_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.area {position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var score=0;</p>
<p>var barNh1="false";</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=4; i++) {</p>
<p>code1 = "&lt;img src='brick.gif'&gt;";</p>
<p>area2.innerHTML += code1;</p>
<p>area3.innerHTML += code1;</p>
<p>}</p>
<p>moveBar();</p>
<p>}</p>
<p>function keyed() {</p>
<p>var e=event.keyCode;</p>
<p>switch (e) {</p>
<p>Game Programming – Penn Wu</p>
<p>207</p>
<p><span id="index_split_011.html#p208"></span> case 39:</p>
<p>walk();</p>
<p>break;</p>
<p>case 37:</p>
<p>break;</p>
<p>case 83:</p>
<p>clearTimeout(s1);</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>function walk() {</p>
<p>w1 = area2.style.pixelLeft + 4*60;</p>
<p>w2 = area3.style.pixelLeft;</p>
<p>w3 = area3.style.pixelLeft + 4*60;</p>
<p>if (h1.style.pixelLeft &gt; w2) { barNh1="false"; h1.style.pixelTop =
160;}</p>
<p>if ((barNh1=="false") &amp;&amp; (h1.style.pixelLeft &gt;= w1)
&amp;&amp; (h1.style.pixelLeft &lt;= w2))</p>
<p>{</p>
<p>End(); clearTimeout(s1); }</p>
<p>else if (h1.style.pixelLeft &gt;= w3-60)
{clearTimeout(s1);h1.src="1.gif"; }</p>
<p>else</p>
<p>{</p>
<p>h1.src="4.gif";</p>
<p>h1.style.pixelLeft +=2;</p>
<p>s1 = setTimeout("walk()", 20);</p>
<p>}</p>
<p>}</p>
<p>function End() {</p>
<p>if (h1.style.pixelTop + 46 &lt;= bar.style.pixelTop) {</p>
<p>h1.src="1.gif"; barNh1 = "true";</p>
<p>}</p>
<p>else {</p>
<p>if (h1.style.pixelTop == area2.style.pixelTop + 88) {</p>
<p>h1.style.display = "none";</p>
<p>clearTimeout(s2); score -=10;</p>
<p>p1.innerText=score; }</p>
<p>else {</p>
<p>h1.src="1.gif";</p>
<p>h1.style.pixelTop += 2;</p>
<p>s2 = setTimeout("End()", 20); }</p>
<p>}</p>
<p>}</p>
<p>function moveBar() {</p>
<p>if (barNh1 == "true") {</p>
<p>h1.style.pixelTop = bar.style.pixelTop - 46;</p>
<p>}</p>
<p>if (bar.style.pixelTop &lt;= 10) {</p>
<p>bar.style.pixelTop = 290;}</p>
<p>bar.style.pixelTop -= 5;</p>
<p>s3 = setTimeout("moveBar()", 300);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init() onKeyDown=keyed()&gt;</p>
<p>&lt;div id="area1"&gt;</p>
<p>&lt;img id="h1" src="1.gif" class="area" style="left:10;
top:160"&gt;</p>
<p>&lt;span id="area2" class="area" style="left:10;
top:200"&gt;&lt;/span&gt;</p>
<p>&lt;span id="area3" class="area" style="left:300;
top:200"&gt;&lt;/span&gt; Game Programming – Penn Wu</p>
<p>208</p>
<p><span id="index_split_011.html#p209"></span><img
src="index-209_1.png" class="calibre5" alt="Image 183" /></p>
<p>&lt;span id="area4" class="area" style="left:10; top:289;
background-Color:#abcdef; width:530; height:50"&gt;&lt;/span&gt;</p>
<p>&lt;img src="p.gif" class="area" style="left:510; top:160" /&gt;</p>
<p>&lt;hr id="bar" class="area" size=10 color="brown" style="left:250;
top:290; width:50;" /&gt;</p>
<p>&lt;p&gt;Your Score: &lt;b id=p1&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Use key to move toward the gap. Wait till the
moving bar comes to an appropriate place.</p>
<p>Use key to step on the bar, and then jump to the second area to
rescue the princess. A sample output looks: <strong>Learning Activity
#5: Radar (dynamic texture and texture mapping)</strong> Note: This game
is meant to be simple and easy for the sake of demonstrating programming
concepts. Please do not hesitate to enhance the appearance or functions
of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab11_5.htm</strong> with the following contents:</p>
<p>&lt;HTML&gt;</p>
<p>&lt;HEAD&gt;</p>
<p>&lt;SCRIPT language="JavaScript"&gt;</p>
<p>var Light_X = 20</p>
<p>var Light_Y = 20</p>
<p>var Light_Z = 40</p>
<p>var xInc = 10;</p>
<p>var yInc = 10;</p>
<p>var r = 100;</p>
<p>var deg = 0;</p>
<p>var deg1;</p>
<p>var rad;</p>
<p>var PointAngle;</p>
<p>var PlaneLight_X = 20</p>
<p>var PlaneLight_Y = 120</p>
<p>var PlaneLight_Z = 3</p>
<p>var conversion = (2 * Math.PI)/360</p>
<p>function movefilt()</p>
<p>{</p>
<p>// Do some basic geometry to convert from Polar coordinates to
Cartesian Game Programming – Penn Wu</p>
<p>209</p>
<p><span id="index_split_011.html#p210"></span></p>
<p>Light_X = r + r * Math.cos(deg * conversion);</p>
<p>Light_Y = r + r * Math.sin(deg * conversion);</p>
<p>deg += 10;</p>
<p>if (deg == 360)</p>
<p>deg = 0;</p>
<p>// Rotate the cone</p>
<p>rd .filters[0].moveLight(0, Light_X, Light_Y, Light_Z, 1);</p>
<p>// Figure out where the Plane is in relation to the cone</p>
<p>PointAngle = Math.atan((PlaneLight_Y - r)/(PlaneLight_X -
r))/conversion;</p>
<p>// More basic geometry</p>
<p>if ((PlaneLight_X &lt; r) &amp;&amp; (PlaneLight_Y &lt; r))</p>
<p>PointAngle += 180;</p>
<p>if ((PlaneLight_X &gt; r) &amp;&amp; (PlaneLight_Y &lt; r))</p>
<p>PointAngle += 360</p>
<p>if ((PlaneLight_X &lt; r) &amp;&amp; (PlaneLight_Y &gt; r))</p>
<p>PointAngle += 180</p>
<p>// If the plane is in the cone, update the planes position</p>
<p>if ((deg - 10 &lt;= PointAngle) &amp;&amp; (PointAngle &lt;= deg)) rd
.filters[0].moveLight(2, PlaneLight_X, PlaneLight_Y, PlaneLight_Z,
1);</p>
<p>//Do it all again in about 1/10th of a second</p>
<p>mytimeout=setTimeout('movefilt()', 100);</p>
<p>}</p>
<p>function movePlanes()</p>
<p>{</p>
<p>// Increment the planes position</p>
<p>PlaneLight_X++;</p>
<p>PlaneLight_Y++;</p>
<p>// Wrap the plane if it goes off the screen</p>
<p>if (PlaneLight_Y &gt; 200) PlaneLight_Y = 0;</p>
<p>if (PlaneLight_X &gt; 200) PlaneLight_X = 0;</p>
<p>timeout2 = setTimeout('movePlanes()', 500);</p>
<p>}</p>
<p>function init() {</p>
<p>rd
.filters.item('DXImageTransform.Microsoft.light').addCone(121,121,0,Light_X,
Light_Y, 0, 255, 0, 150, 10);</p>
<p>rd
.filters.item('DXImageTransform.Microsoft.light').addAmbient(0,0,255,80)
rd
.filters.item('DXImageTransform.Microsoft.light').addPoint(PlaneLight_X,
PlaneLight_Y, 3, 255, 0, 0, 100);</p>
<p>var x = 0;</p>
<p>movefilt();</p>
<p>movePlanes();</p>
<p>}</p>
<p>&lt;/SCRIPT&gt;</p>
<p>&lt;/HEAD&gt;</p>
<p>&lt;BODY onload="init()" TOPMARGIN=10 LEFTMARGIN=10
bgcolor="white"&gt; Game Programming – Penn Wu</p>
<p>210</p>
<p><span id="index_split_011.html#p211"></span><img
src="index-211_1.png" class="calibre5" alt="Image 184" /></p>
<p>&lt;img src="radar.gif" id=rd style="height:242;width:242;
filter:progid:DXImageTransform.Microsoft.light()"&gt;</p>
<p>&lt;/BODY&gt;</p>
<p>&lt;/HTML&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 11, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab11_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab11_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab11_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab11_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab11_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>211</p>
<p><span id="index_split_011.html#p212"></span></p>
<p>Lecture #12</p>
<p>Applying artificial intelligence</p>
<p>Concepts</p>
<p>Artificial intelligence (AI) is a relatively new subject in computer
sciences, but it has been used in game programming for decades. AI
refers to the programming techniques that make the computers emulate the
human thought processes. The statement “applying artificial intelligence
to a game“ is simply the attempt to build a human-like decision making
systems in a game.</p>
<p>However, human thought is very complicated in terms of process. Even
brain scientists do not know much about how human brains function, so
the level of AI technology is still in its early infancy.</p>
<p>Many games, or even a section of storylines, require characters to be
“smart” (or smart enough to respond to the changing condition. In the
second theme of Castle game, when the bat approaches the knight, the bat
(with its animal instincts) should know the knight is ready to hit it
down. So the bat will keep a distance from the knight. On the other
hand, the knight should be <strong>smart</strong> enough to move forward
to a place where he can hit down the bat.</p>
<p>Your can add the following codes for this scenario:</p>
<p>function hit() {</p>
<p>if ( knight.style.pixelTop &gt;=70) {</p>
<p>clearTimeout(s2);</p>
<p>setInterval("knight.src='knight1.gif'", 2000);</p>
<p>}</p>
<p>else {</p>
<p>knight.style.pixelTop+=2;</p>
<p>setInterval("bat2.style.display='none'", 2000);</p>
<p>s2 = setTimeout("hit()", 20);</p>
<p>}</p>
<p>}</p>
<p>By doing so, both characters--bat and knight--have more liveliness,
because their actions and behaviors are much closer to animal and
human.</p>
<p>Information-</p>
<p>Most traditional AI techniques use a variety of information-based
algorithms to make decisions, based</p>
<p>just as people use a variety of previous experiences and mental rules
to make a decision. The algorithms</p>
<p>information-based AI algorithms were completely deterministic, which
means that every decision could be traced back to a predictable flow of
logic. This type of AI technique is the simplest way to apply artificial
intelligence.</p>
<p>Consider the following example, the two fishes swim toward each
other, and they will soon face to each other.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.fish {position:absolute;top:100;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>f1.style.pixelLeft=10;</p>
<p>f2.style.pixelLeft=document.body.clientWidth-100;</p>
<p>move();</p>
<p>}</p>
<p>function move() {</p>
<p>if (f1.style.pixelLeft+100 &gt;= f2.style.pixelLeft) {</p>
<p>Game Programming – Penn Wu</p>
<p>212</p>
<p><span id="index_split_011.html#p213"></span><img
src="index-213_1.png" class="calibre5" alt="Image 185" /></p>
<p>clearTimeout(s1);}</p>
<p>else {</p>
<p>f1.style.pixelLeft+=2;</p>
<p>f2.style.pixelLeft-=2;</p>
<p>s1=setTimeout("move()", 20);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;img id="f1" src="fish1.gif" class="fish"&gt;</p>
<p>&lt;img id="f2" src="fish2.gif" class="fish"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Assuming that fish1 is the predator of fish2, fish2’s biological
mechanism will force fish2 to avoid crashing into fish1. You can
simulate such biological mechanism by adding the following code
blocks:</p>
<p>function avoid() {</p>
<p>if (f2.style.pixelTop &gt;= document.body.clientHeight - 100) {</p>
<p>clearTimeout(s2); }</p>
<p>else {</p>
<p>f2.style.pixelTop +=10;</p>
<p>f2.style.pixelLeft-=2;</p>
<p>f1.style.pixelLeft+=2;</p>
<p>s2=setTimeout("avoid()",10);</p>
<p>}</p>
<p>}</p>
<p>In this example, the <strong>if..then</strong> statement formulates a
very simple information-based AI, which helps the computer to make
decisions. However, most games require a much complicated decision
making system, especially when the computer must play the role of
antagonist.</p>
<p>Obviously, the way you do your thinking is not never this simple and
predictable. Using the deterministic approach to program games will
never make the game think like a human. You can only try to apply as
many strategies as you can to let the computer “understand” the
condition, and then “find” the best solution to make decisions.</p>
<p>Developing a</p>
<p>In a chess game, you fight against computer. As a human, your
decisions can result from a large-scale</p>
<p>combination of past experience, personal bias, or the current state
of emotion in addition to the information-completely logical decision
making process. So, there is technically no way to precisely predict
based AI for</p>
<p>how you will play the chess.</p>
<p>games</p>
<p>Luckily, there are strict rules a player must follow in order to play
chess in an acceptable way.</p>
<p>People can develop game strategies (which are basically the result of
past experiences) and use them to make the best move against the
antagonist.</p>
<p>As an AI-oriented game programmer, you need to convert such
“human-developed game strategies” into computer codes, so the computer
can also use these strategies against the human player. And, this is
what “applying artificial intelligence to game programming” is all
about.</p>
<p>Game Programming – Penn Wu</p>
<p>213</p>
<p><span id="index_split_011.html#p214"></span><img
src="index-214_1.png" class="calibre5" alt="Image 186" /></p>
<p><img src="index-214_2.png" class="calibre5" alt="Image 187" /></p>
<p>Noticeably, human don’t always make scientifically predictable
decisions based on analyzing their surroundings and arriving at a
logical conclusion. So, you probably will never be able to include every
strategy in your games.</p>
<p>To develop a large-scale information-based AI for games starts with
simply figuring out how to convert strategies into computer codes. For
example, to make the Tic-Tac-Toe game “smart”, first, create a framework
for the Tic-Tac-Toe game by writing the following HTML codes:</p>
<p>&lt;html&gt;</p>
<p>&lt;img id="c1" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c2" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c3" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"
alt='n'&gt;&lt;br&gt;</p>
<p>&lt;img id="c4" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c5" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c6" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"
alt='n'&gt;&lt;br&gt;</p>
<p>&lt;img id="c7" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c8" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c9" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"
alt='n'&gt;&lt;br&gt;</p>
<p>&lt;/html&gt;</p>
<p>The output looks:</p>
<p>There are three image files used in this game:</p>
<p>•</p>
<p>n.gif – a blank image</p>
<p>•</p>
<p>x.gif – image of x</p>
<p>•</p>
<p>o.gif – imageof o</p>
<p>Inside each <strong>&lt;img&gt;</strong> tag the following part
changes the file source (image file name) from <strong>n.gif</strong> to
<strong>x.gif</strong>, and the <strong>alt</strong> property (which is
the alternative description of the image file) from <strong>n</strong>
to <strong>x</strong>.</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"</p>
<p>When the player click on any cell, the image changes from
<strong>blank</strong> to <strong>x</strong>. For example, When the game
starts, <strong>x</strong> is the player, while <strong>o</strong> is
the antagonist (the computer). You need to add some codes to simulate
human-like decision making mechanism, thus, whenever, the player makes a
move, the computer can responds with an intention to prevent the user
from winning the game.</p>
<p>Game Programming – Penn Wu</p>
<p>214</p>
<p><span id="index_split_011.html#p215"></span><img
src="index-215_1.png" class="calibre5" alt="Image 188" /></p>
<p><img src="index-215_2.png" class="calibre5" alt="Image 189" /></p>
<p><img src="index-215_3.png" class="calibre5" alt="Image 190" /></p>
<p>To help developing the code with strategy against the player, try
marking each cell with its IDs.</p>
<p>For example,</p>
<p>c1 c2 c3</p>
<p>c4 c5 c6</p>
<p>c7 c8 c9</p>
<p>One commonly used strategy (as recommended by a sophisticated player)
is:</p>
<p>•</p>
<p>If c1 is marked x, while c2 and c4 are blank, check c3.</p>
<p>•</p>
<p>If c3 is blank, mark c3 with o; otherwise mark c2 with o.</p>
<p>The code that performs the above human-like decision making is:
function check() {</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c4.alt=='n') {</p>
<p>if (c3.alt=='n') { c3.src='o.gif'; }</p>
<p>else { c2.src='o.gif'; }</p>
<p>}</p>
<p>}</p>
<p>Consequently, when the player clicks c1 to mark <strong>x</strong> on
the c1 cell, the above code immediately marks c3 with <strong>o</strong>
to prevent the player from marking c1, c2, and c3 with
<strong>x</strong>.</p>
<p>If the player marked c3 with <strong>x</strong> first, and then marks
c1 with <strong>x</strong>, the code will be smart enough to mark c2
with <strong>o</strong>. In other words, the computer is now playing the
game by making human-like decisions, so you have just applied
<strong>artificial intelligence</strong> to the programming of this
game.</p>
<p>Of course, this game cannot be so simple. You need to develop as many
strategies to win as possible (or at least let the computer be smart
enough to have a tie with the player). For example, a new strategy is
“if c4 is marked <strong>x</strong>, and the player just marks c4 with
<em>x</em>, then mark c7 with <strong>o</strong>.”</p>
<p>Simply add the following bold lines, the computer can possesses this
“artificial intelligence”</p>
<p>function check() {</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c4.alt=='n') {</p>
<p>if (c3.alt=='n') { c3.src='o.gif'; }</p>
<p>else { c2.src='o.gif'; }</p>
<p>}</p>
<p><strong>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp;
c4.alt=='x') {</strong></p>
<p><strong>c7.src='o.gif'}</strong></p>
<p>}</p>
<p>Apply as many game strategies as you can to this Tic-Tac-Toe game, so
the computer will be very smart and eventually have the intelligence to
win over the player. For example, the following code is enough to reach
a tie between the player and the computer if the player starts with
clicking c1.</p>
<p>Game Programming – Penn Wu</p>
<p>215</p>
<p><span id="index_split_011.html#p216"></span><img
src="index-216_1.png" class="calibre5" alt="Image 191" /></p>
<p>function check() {</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c4.alt=='n') {</p>
<p>if (c3.alt=='n') { c3.src='o.gif'; }</p>
<p>else { c2.src='o.gif'; }</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c4.alt=='x') {</p>
<p>c7.src='o.gif'}</p>
<p><strong>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp;
c5.alt=='n') {</strong></p>
<p><strong>c5.src='o.gif'}</strong></p>
<p><strong>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp;
c7.alt=='x') {</strong></p>
<p><strong>c9.src='o.gif'}</strong></p>
<p>}</p>
<p>Although the above strategies work with the demonstrated conditions,
they may not be the best strategies. Be sure to develop you own game
strategies to make this Tic-Tac-Toe game smart and possibly smarter.</p>
<p>When applying artificial intelligence to your games, one good advice
<strong>is to keep it as simple as</strong> <strong>possible</strong>.
If you know the answer, put the answer into the program. If you know how
to compute the answer, put the algorithm for computing it into the
program. For example, you can use the simplest <strong>if..then</strong>
statement to re-write the above codes.</p>
<p>function check() {</p>
<p>// player starts with c1</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c3.alt=='n'
&amp;&amp; c4.alt=='n') {</p>
<p>c3.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c3.alt=='n') {
c3.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c3.alt=='x') {
c2.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c7.alt=='n') {
c7.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c4.alt=='n' &amp;&amp; c7.alt=='x') {
c4.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c9.alt=='n') {
c9.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c8.alt=='x') {
c5.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c6.alt=='x') {
c7.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c8.alt=='x') {
c7.src='o.gif';</p>
<p>}</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c9.alt=='x') {
c7.src='o.gif';</p>
<p>}</p>
<p>............</p>
<p>............</p>
<p>}</p>
<p>In 1997, the famous supercomputer--IBM's Deep Blue, defeated the
world great chess master Garry Kasparov. It marked the first time that a
computer had defeated a World Champion in a match of several games.
However, in reality, Deep Blue is just a computer that had been Game
Programming – Penn Wu</p>
<p>216</p>
<p><span id="index_split_011.html#p217"></span><img
src="index-217_1.png" class="calibre5" alt="Image 192" /></p>
<p>programmed with millions of chess game strategies (developed by human
in the past, of course).</p>
<p>IBM Deep Blue vs. Garry Kasparov</p>
<p>It is the computation power of the machine and the “artificial
intelligence” the computer was programmed to have won the game. But, be
sure to understand one important fact--Deep Blue do not think, it only
quickly run through all the decision-making codes (just like the ones
above) to search for the best-fit rules and then make decision based on
the rules.</p>
<p>Create games</p>
<p>You can create games that detect and record the player’s skill level,
playing style, or thinking that learns</p>
<p>model, etc. You can also create games that can modify the game
environment in according to the collected data about the player. There
are many ways to reach this goal.</p>
<p>You can, for example, use a server-side scripting language (such as
PHP, Perl, ASP.Net, etc.) to create a file (or set a cookie file) in the
client computer that keeps data for the player. In the Ping Pong game,
the Write_level() function forces the client computer to create a new
file (if not existing) named MyLevel.txt and immediately write a line
“level=2” to it.</p>
<p>function play() {</p>
<p>if (score &gt; 50) { speed = 10; level=2;
<strong>Write_level();}</strong></p>
<p>else {speed = 20; level=1}</p>
<p>...........</p>
<p>...........</p>
<p>}</p>
<p><strong>function Write_level(sText){</strong></p>
<p><strong>var MYFILE = new
ActiveXObject("Scripting.FileSystemObject");</strong> <strong>var
myLevel = MYFILE.CreateTextFile("C:\\MyLevel.txt", true);</strong>
<strong>myLevel.WriteLine("level=2");</strong></p>
<p><strong>myLevel.Close();</strong></p>
<p><strong>}</strong></p>
<p>This function uses ActiveXObject, which is an advanced topic for
Windows-based web programming. However, you can learn the concepts as
how to insert a file to a computer machine.</p>
<p>Additionally, if the MyLevel.txt file already exists, and you need to
update the content, you should use the following format:</p>
<p>var myLevel = MYFILE.OpenTextFile("C:\\MyLevel.txt", 8, true,0);
where, 8=append, true=create if not exist, and 0 = ASCII.</p>
<p>To set a cookie, for example, you can use the following code:</p>
<p>function setCookie() {</p>
<p>document.cookie = "level=2; expires=Fri, 13 Jul 2009 05:28:21 UTC;
path=/";</p>
<p>}</p>
<p>The cookie code only works after you upload the file to a Web server.
In other words, only when the player access the codes from a remote web
server will the cookie file be inserted to the client machine. The path
to file the cookie is usually (Windows XP):</p>
<p>C:\Documents and Settings\%UserName%\Cookies</p>
<p>Game Programming – Penn Wu</p>
<p>217</p>
<p><span id="index_split_011.html#p218"></span><img
src="index-218_1.png" class="calibre5" alt="Image 193" /></p>
<p>Where %UserName% is the name the player uses to log in to the Windows
XP machine. For example,</p>
<p>A sample content of the cookie looks:</p>
<p>level</p>
<p>2</p>
<p>www.geocities.com/</p>
<p>1088</p>
<p>3155626112</p>
<p>30016378</p>
<p>843931136</p>
<p>29854209</p>
<p>*</p>
<p>If your game uses client-side scripting language (such as
JavaScript), you can use variables to store data temporarily, or create
hidden fields of web forms to store data temporarily. Some client-side
scripting languages (such as JavaScript) allows you to set a cookie in a
client machine, too. For example, in the Ping Pong game, several
variables are used to store the player’s data temporarily. The speed of
ping pong ball is determined by the score of the player. If the score is
greater than 50, the speed increases and the level is upgraded to 2.</p>
<p>..........</p>
<p>function play() {</p>
<p><strong>if (score &gt; 50) { speed = 10; level=2</strong>;
Write_level();}</p>
<p><strong>else {speed = 20; level=1}</strong></p>
<p>if (b1.style.pixelLeft &gt; bd.style.pixelWidth-5) {</p>
<p>clearTimeout(s1); p1.innerText="You lose!"; }</p>
<p>else {s1=setTimeout("play()", <strong>speed</strong>);}</p>
<p>..........</p>
<p>}</p>
<p>Review</p>
<p>1. Which statement best describes what "applying artificial
intelligence to a game" is?</p>
<p>Questions</p>
<p>A. It describes a game that has intelligence.</p>
<p>B. It makes the computer functions like a real human.</p>
<p>C. It attempts to build a robot game.</p>
<p>D. It is simply the attempt to build a human-like decision making
systems in a game.</p>
<p>2. Which statement is correct about the term "information-based AI
algorithms"?</p>
<p>A. It is completely referencing.</p>
<p>B. It is completely deterministic.</p>
<p>C. It is completely self-controlled.</p>
<p>D. It is completely empirical.</p>
<p>3. Techniques of artificial intelligence can apply to a game that
__.</p>
<p>A. mimics an animal's self protection mechanism</p>
<p>Game Programming – Penn Wu</p>
<p>218</p>
<p><span id="index_split_011.html#p219"></span>B. plays chess game
against a real human player C. determine the level the player should
play</p>
<p>D. All of the above</p>
<p>4. Which statement is correct?</p>
<p>A. Human logics are complicated, so you should try to make your
computer code as complicated as possible.</p>
<p>B. Although Human logics are complicated; you should try to make your
computer code as simple as possible.</p>
<p>C. Human logics are complicated, you should always use "switch..case"
statement to apply AI to game codes.</p>
<p>D. All of the above</p>
<p>5. Given the following code block of a Tic-Tac-Toe game, which
statement is correct?</p>
<p>Let ci.alt=x represent X, let ci.alt='n' represent blank (where i is
an integer between 1 and 9).</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c3.alt=='n'
&amp;&amp; c4.alt=='n')</p>
<p>{ c3.src='o.gif'; }</p>
<p>A. If the player places x on c1, while c2, c3, and c4 are blank, the
computer placed o on c3.</p>
<p>B. If the player places x on c1, while c2, c3, and c4 are NOT blank,
the computer placed o on c3.</p>
<p>C. If the player places X on c1, while c2, c3, and c4 are all marked
with the letter 'n', the computer placed o on c3.</p>
<p>D. If the player places X on c1, while c2, c3, and c4 are all marked
with the letter 'n', the computer marks the letter 'o' on c3.</p>
<p>6. Given the following code block of a Tic-Tac-Toe game, which
statement is correct?</p>
<p>Let ci.alt=x represent X, let ci.alt='n' represent blank (where i is
an integer between 1 and 9).</p>
<p>if (c5.alt=='x' &amp;&amp; c7.alt=='x' &amp;&amp; c3.alt=='n') {
c3.src='o.gif'; }</p>
<p>A. If the player marked x on c5, and later marks x on c7, the
computer must place o on c3 even when c3 is not blank.</p>
<p>B. If the player marked x on c5, and later marks x on c7, the
computer must place o on c3 only when c3 is blank.</p>
<p>C. If the player marked o on c5, and later marks o on c7, the
computer must place x on c3 even when c3 is not blank.</p>
<p>D. If the player marked o on c5, and later marks o on c7, the
computer must place x on c3 only when c3 is blank.</p>
<p>7. Given the following code block of a Tic-Tac-Toe game, which
statement is correct?</p>
<p>Let ci.alt=x represent X, let ci.alt='n' represent blank (where i is
an integer between 1 and 9).</p>
<p>if (c3.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c7.alt=='n') {
c7.src='o.gif'; }</p>
<p>A. When c3 and c5 are marked x, the computer must check whether or
not c7 is marked o to decide what the next move should be.</p>
<p>B. When c3 and c5 are marked x, the computer must check whether or
not c7 is marked x to decide what the next move should be.</p>
<p>C. When c3 and c5 are marked x, the computer must check whether or
not c7 is b to blank to decide what the next move should be.</p>
<p>D. When c3 and c5 are marked n, the computer must check whether or
not c7 is marked n to decide the next move.</p>
<p>8. Given the following code segment, which statement is correct?</p>
<p>function cc(sText){</p>
<p>Game Programming – Penn Wu</p>
<p>219</p>
<p><span id="index_split_011.html#p220"></span>var f = new
ActiveXObject("Scripting.FileSystemObject"); var s =
f.CreateTextFile("C:\\s.txt", true);</p>
<p>s.WriteLine("Write_file");</p>
<p>s.Close();</p>
<p>}</p>
<p>A. It creates a new file named s.txt in the client machine.</p>
<p>B. It writes the message "write_file" to the newly created file.</p>
<p>C. It uses ActiveXObject.</p>
<p>D. All of the above.</p>
<p>9. Given the following code segment, which statement is correct?</p>
<p>var obj = f.OpenTextFile("C:\\f1.txt", 8, true,0);</p>
<p>A. 8=append</p>
<p>B. true=create if not exist</p>
<p>C. 0 = ASCII</p>
<p>D. All of the above</p>
<p>10. Which would insert a cookie to the client machine?</p>
<p>A. document.cookie();</p>
<p>B. window.cookie()</p>
<p>C. setCookie();</p>
<p>D. insertCookie();</p>
<p>Game Programming – Penn Wu</p>
<p>220</p>
<p><span id="index_split_011.html#p221"></span></p>
<p>Lab #12</p>
<p>Applying artificial intelligence</p>
<p><strong>Preparation #1:</strong></p>
<p>1. Create a new directory named <strong>C:\games</strong>.</p>
<p>2. Use Internt Explorer to go to
<strong>http://business.cypresscollege.edu/~pwu/cis261/download.htm</strong>
to download lab12.zip (a zipped) file. Extract the files to C:\games
directory.</p>
<p><strong>Learning Activity #1:</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab12_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>if (bat2.style.pixelTop &lt;= 170) {</p>
<p>knight.src="knight2.gif";</p>
<p>}</p>
<p>if (bat2.style.pixelWidth == 20) {</p>
<p>clearTimeout(s1);</p>
<p>setInterval("hit()",1000);</p>
<p>}</p>
<p>else{</p>
<p>bat2.style.pixelWidth--;</p>
<p>bat2.style.pixelTop-=2;</p>
<p>s1 = setTimeout("init()", 50);</p>
<p>}</p>
<p>}</p>
<p>function hit() {</p>
<p>if ( knight.style.pixelTop &gt;=70) {</p>
<p>clearTimeout(s2);</p>
<p>setInterval("knight.src='knight1.gif'", 2000);</p>
<p>}</p>
<p>else {</p>
<p>knight.style.pixelTop+=2;</p>
<p>setInterval("bat2.style.display='none'", 2000);</p>
<p>s2 = setTimeout("hit()", 20);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor="black" onLoad="init()" /&gt;</p>
<p>&lt;div id="theme2"&gt;</p>
<p>&lt;img id="knight" src="knight1.gif"
style="position:absolute;left:40; top:20"&gt;</p>
<p>&lt;img id="bat2" src="bat.gif" style="position:absolute; width:75;
top:220; left:100"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>221</p>
<p><span id="index_split_011.html#p222"></span><img
src="index-222_1.png" class="calibre5" alt="Image 194" /></p>
<p><strong>Learning Activity #2: Fish</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab12_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.fish {position:absolute;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>f1.style.pixelLeft=10;</p>
<p>f2.style.pixelLeft=document.body.clientWidth-100;</p>
<p>move();</p>
<p>}</p>
<p>function move() {</p>
<p>if (f1.style.pixelLeft+100 &gt;= f2.style.pixelLeft-100) {</p>
<p>clearTimeout(s1); avoid();}</p>
<p>else {</p>
<p>f1.style.pixelLeft+=2;</p>
<p>f2.style.pixelLeft-=2;</p>
<p>s1=setTimeout("move()", 20);</p>
<p>}</p>
<p>}</p>
<p>function avoid() {</p>
<p>if (f2.style.pixelTop &gt;= document.body.clientHeight - 100) {</p>
<p>clearTimeout(s2); }</p>
<p>else {</p>
<p>f2.style.pixelTop +=10;</p>
<p>f2.style.pixelLeft-=2;</p>
<p>f1.style.pixelLeft+=2;</p>
<p>s2=setTimeout("avoid()",10);</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad=init()&gt;</p>
<p>&lt;img id="f1" src="fish1.gif" class="fish" style="top:100"&gt;</p>
<p>&lt;img id="f2" src="fish2.gif" class="fish" width="40"
style="top:120"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>222</p>
<p><span id="index_split_011.html#p223"></span><img
src="index-223_1.png" class="calibre5" alt="Image 195" /></p>
<p><strong>Learning Activity #3: Tic-Tac-Toe</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game. <strong>Please feel free to
add as many strategies as</strong> <strong>possible.</strong></p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab12_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.cell {border:solid 1 black; width:30px; height:30px}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function check() {</p>
<p>// player starts with c1</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c3.alt=='n'
&amp;&amp; c4.alt=='n') { c3.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c3.alt=='n') {
c3.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='n' &amp;&amp; c3.alt=='x') {
c2.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c7.alt=='n') {
c7.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c4.alt=='n' &amp;&amp; c7.alt=='x') {
c4.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c9.alt=='n') {
c9.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c8.alt=='x') {
c5.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c6.alt=='x') {
c7.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c8.alt=='x') {
c7.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c2.alt=='x' &amp;&amp; c9.alt=='x') {
c7.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c6.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c6.alt=='x' &amp;&amp; c9.alt=='x') {
c7.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c9.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c8.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c8.alt=='x') {
c6.src='o.gif'; }</p>
<p>if (c1.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c6.alt=='x') {
c4.src='o.gif'; }</p>
<p>// player starts with c2</p>
<p>if (c1.alt=='n' &amp;&amp; c2.alt=='x' &amp;&amp; c3.alt=='n'
&amp;&amp; c4.alt=='n') { c1.src='o.gif'; }</p>
<p>if (c2.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c8.alt=='n') {
c8.src='o.gif'; }</p>
<p>if (c5.alt=='x' &amp;&amp; c7.alt=='x' &amp;&amp; c3.alt=='n') {
c3.src='o.gif'; }</p>
<p>if (c2.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c5.alt=='n') {
c5.src='o.gif'; }</p>
<p>if (c2.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c5.alt=='x') {
c6.src='o.gif'; }</p>
<p>if (c2.alt=='x' &amp;&amp; c3.alt=='x' &amp;&amp; c9.alt=='n') {
c9.src='o.gif'; }</p>
<p>if (c2.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c6.alt=='x') {
c4.src='o.gif'; }</p>
<p>if (c2.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c9.alt=='x') {
c7.src='o.gif'; }</p>
<p>// Player starts with c3</p>
<p>if (c1.alt=='n' &amp;&amp; c2.alt=='n' &amp;&amp; c3.alt=='x'
&amp;&amp; c7.alt=='n') { c1.src='o.gif'; }</p>
<p>if (c3.alt=='x' &amp;&amp; c6.alt=='x' &amp;&amp; c9.alt=='n') {
c9.src='o.gif'; }</p>
<p>if (c3.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c7.alt=='n') {
c7.src='o.gif'; }</p>
<p>if (c3.alt=='x' &amp;&amp; c4.alt=='x' &amp;&amp; c5.alt=='x') {
c6.src='o.gif'; }</p>
<p>Game Programming – Penn Wu</p>
<p>223</p>
<p><span id="index_split_011.html#p224"></span><img
src="index-224_1.png" class="calibre5" alt="Image 196" /></p>
<p>// Player starts with c4</p>
<p>if (c1.alt=='n' &amp;&amp; c4.alt=='x' &amp;&amp; c7.alt=='n'
&amp;&amp; c5.alt=='n') { c5.src='o.gif'; }</p>
<p>if (c4.alt=='x' &amp;&amp; c5.alt=='x' &amp;&amp; c8.alt=='x'
&amp;&amp; c2.alt=='n') { c2.src='o.gif'; }</p>
<p>if (c4.alt=='x' &amp;&amp; c7.alt=='x' &amp;&amp; c9.alt=='x'
&amp;&amp; c8.alt=='n') { c8.src='o.gif'; }</p>
<p>if (c1.alt=='n' &amp;&amp; c2.alt=='x' &amp;&amp; c4.alt=='x') {
c1.src='o.gif'; }</p>
<p>if (c1.alt=='n' &amp;&amp; c4.alt=='x' &amp;&amp; c7.alt=='x') {
c1.src='o.gif'; }</p>
<p>if (c4.alt=='x' &amp;&amp; c8.alt=='x' &amp;&amp; c9.alt=='n') {
c9.src='o.gif'; }</p>
<p>if (c4.alt=='x' &amp;&amp; c3.alt=='x' &amp;&amp; c9.alt=='x') {
c6.src='o.gif'; }</p>
<p>if (c4.alt=='x' &amp;&amp; c9.alt=='x' &amp;&amp; c7.alt=='n') {
c7.src='o.gif'; }</p>
<p>if (c4.alt=='x' &amp;&amp; c6.alt=='x' &amp;&amp; c3.alt=='n') {
c3.src='o.gif'; }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;img id="c1" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c2" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c3" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"
alt='n'&gt;&lt;br&gt;</p>
<p>&lt;img id="c4" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c5" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c6" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"
alt='n'&gt;&lt;br&gt;</p>
<p>&lt;img id="c7" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c8" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()" alt='n'&gt;</p>
<p>&lt;img id="c9" src="n.gif" class="cell"</p>
<p>onClick="this.src='x.gif';this.alt='x';check()"
alt='n'&gt;&lt;br&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Learning Activity #4: Ping Pong Game</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab12_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var score=0;</p>
<p>var speed;</p>
<p>var level;</p>
<p>var left_right = "right";</p>
<p>var up_down = "down";</p>
<p>function init() {</p>
<p>b1.style.pixelTop = Math.floor(Math.random()*235);</p>
<p>b1.style.display = "inline";</p>
<p>p1.innerText ="";</p>
<p>Game Programming – Penn Wu</p>
<p>224</p>
<p><span id="index_split_011.html#p225"></span>play();</p>
<p>}</p>
<p>function move() {</p>
<p>ply.style.pixelTop = event.clientY;</p>
<p>}</p>
<p>function play() {</p>
<p>if (score &gt; 50) { speed = 10; level=2; Write_level();}</p>
<p>else {speed = 20; level=1}</p>
<p>if (b1.style.pixelLeft &gt; bd.style.pixelWidth-5) {</p>
<p>clearTimeout(s1); p1.innerText="You lose!"; }</p>
<p>else {s1=setTimeout("play()", speed);}</p>
<p>if ((b1.style.pixelLeft+15 &gt;= ply.style.pixelLeft) &amp;&amp;
(b1.style.pixelTop &gt; ply.style.pixelTop) &amp;&amp;</p>
<p>(b1.style.pixelTop+15 &lt; ply.style.pixelTop+50))</p>
<p>{ left_right = "left"; score+=10; p1.innerText=score;
p2.innerText=level;}</p>
<p>if (b1.style.pixelLeft &lt;= 10) { left_right = "right"; }</p>
<p>switch (left_right) {</p>
<p>case "right":</p>
<p>b1.style.pixelLeft++; break;</p>
<p>case "left":</p>
<p>b1.style.pixelLeft--; break;</p>
<p>}</p>
<p>if (b1.style.pixelTop &lt;=10) { up_down="down"; }</p>
<p>if (b1.style.pixelTop &gt;=250) { up_down="up"; }</p>
<p>switch (up_down) {</p>
<p>case "up":</p>
<p>b1.style.pixelTop--; break;</p>
<p>case "down":</p>
<p>b1.style.pixelTop++; break;</p>
<p>}</p>
<p>}</p>
<p>function Write_level(sText){</p>
<p>var MYFILE = new ActiveXObject("Scripting.FileSystemObject"); var
myLevel = MYFILE.CreateTextFile("C:\\MyLevel.txt", true);
myLevel.WriteLine("level=2");</p>
<p>myLevel.Close();</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onMouseMove="move()"&gt;</p>
<p>&lt;!-- b1-ball, bd-board, ply-player --&gt;</p>
<p>&lt;img id="b1" SRC="ball.gif" style="position:absolute; Left:10;
Width:15; Height:15;z-index=3; display: none"&gt;</p>
<p>&lt;div id="bd" style="position: absolute; Top:10; Left:10;
Width:350; Height:250; background-Color:green;
z-index=2;"&gt;&lt;/div&gt;</p>
<p>&lt;span id="ply" style="position: absolute; Top:10; Left:340;
Width:15; Height:50; background-Color: blue;
z-index:3"&gt;&lt;/span&gt;</p>
<p>&lt;button TYPE="button" onClick="init()" style="position: absolute;
Top:15; Left:400;z-index:3"&gt;Play&lt;/button&gt;</p>
<p>&lt;p style="position: absolute; Top:95; Left:400;z-index:3"&gt;Your
Score: &lt;b id=p1&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>225</p>
<p><span id="index_split_011.html#p226"></span><img
src="index-226_1.png" class="calibre5" alt="Image 197" /></p>
<p>&lt;p style="position: absolute; Top:115; Left:400;z-index:3"&gt;Your
level: &lt;b id=p2&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Test the program. Press the Play button to begin. Move mouse
cursor up or down to move the blue bar. When your score is bigger than
50, the computer automatically upgrades your level to 2. A sample output
looks: <strong>Learning Activity #5: Tetris</strong></p>
<p>Note: This game is meant to be simple and easy for the sake of
demonstrating programming concepts. Please do not hesitate to enhance
the appearance or functions of this game.</p>
<p>1. Change to the C:\games directory.</p>
<p>2. Use Notepad to create a new file named
<strong>C:\games\lab12_5.htm</strong> with the following contents:</p>
<p>&lt;HTML&gt;</p>
<p>&lt;style&gt;</p>
<p>.MB { border: solid 1 white; background-color: red; height: 22px;
width: 22px }</p>
<p>.SB { border: solid 1 white; background-color: teal; height: 22px;
width: 22px</p>
<p>}</p>
<p>.BK { border: solid 1 #abcdef; height: 22px; width: 22px }</p>
<p>.GT { border: solid 1 black; }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var BX=new Array(4);</p>
<p>var BY=new Array(4);</p>
<p>var PX=new Array(4);</p>
<p>var PY=new Array(4);</p>
<p>var mTimer</p>
<p>var firstView</p>
<p>function init() {</p>
<p>var code1="&lt;table cellspacing=0 cellpadding=0 class=gt&gt;"; code1
+= "&lt;tbody id='GameBar'&gt;";</p>
<p>for (i=1; i&lt;=160; i++) {</p>
<p>if (i%10==1) { code1 += "&lt;tr&gt;&lt;td
class=BK&gt;&amp;nbsp;&lt;/td&gt;"; }</p>
<p>else if (i%10==0) { code1 += "&lt;td
class=BK&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"; }</p>
<p>else { code1 += "&lt;td class=BK&gt;&amp;nbsp;&lt;/td&gt;"; }</p>
<p>}</p>
<p>code1 += "&lt;/tbody&gt;&lt;/table&gt;";</p>
<p>area1.innerHTML += code1;</p>
<p>var code2="&lt;table cellspacing=0 cellpadding=0 class=gt&gt;"; code2
+= "&lt;tbody id='previewBar'&gt;";</p>
<p>for (j=1; j&lt;=16; j++) {</p>
<p>if (j%4==1) { code2 += "&lt;tr&gt;&lt;td
class=BK&gt;&amp;nbsp;&lt;/td&gt;"; }</p>
<p>else if (j%4==0) { code2 += "&lt;td
class=BK&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;"; }</p>
<p>else { code2 += "&lt;td class=BK&gt;&amp;nbsp;&lt;/td&gt;"; }</p>
<p>Game Programming – Penn Wu</p>
<p>226</p>
<p><span id="index_split_011.html#p227"></span> }</p>
<p>code2 += "&lt;/tbody&gt;&lt;/table&gt;";</p>
<p>area2.innerHTML += code2;</p>
<p>}</p>
<p>function beginGame()</p>
<p>{</p>
<p>gameState=0;</p>
<p>speed=1;</p>
<p>outTime=1100-speed*100;</p>
<p>if(gameState!=0) return;</p>
<p>firstView=true;</p>
<p>for(j=0;j&lt;16;j++)</p>
<p>for(i=0;i&lt;10;i++)</p>
<p>setClass(i,j,"BK");</p>
<p>randBar();</p>
<p>gameState=1;</p>
<p>Play.disabled=true;</p>
<p>window.clearInterval(mTimer);</p>
<p>mTimer=window.setInterval("moveBar()",outTime);</p>
<p>}</p>
<p>function keyControl()</p>
<p>{</p>
<p>if(gameState!=1)return;</p>
<p>switch(event.keyCode){</p>
<p>case 37: //left</p>
<p>for(i=0;i&lt;4;i++) if(BX[i]==0)return;</p>
<p>for(i=0;i&lt;4;i++) if(getClass(BX[i]-1,BY[i])=="SB") return;
for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"BK");</p>
<p>for(i=0;i&lt;4;i++)BX[i]=BX[i]-1;</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"MB");</p>
<p>break;</p>
<p>case 38: //up</p>
<p>var preMBarX=new Array(4);</p>
<p>var preMBarY=new Array(4);</p>
<p>var cx=Math.round((BX[0]+BX[1]+BX[2]+BX[3])/4);</p>
<p>var cy=Math.round((BY[0]+BY[1]+BY[2]+BY[3])/4);</p>
<p>for(i=0;i&lt;4;i++){</p>
<p>preMBarX[i]=Math.round(cx-cy+BY[i]);</p>
<p>preMBarY[i]=Math.round(cx+cy-BX[i]);</p>
<p>if(preMBarX[i]&lt;0 || preMBarX[i]&gt;9 || preMBarY[i]&lt;0 ||</p>
<p>preMBarY[i]&gt;15)</p>
<p>return;</p>
<p>if(getClass(preMBarX[i],preMBarY[i])=="SB") return;</p>
<p>}</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"BK");</p>
<p>for(i=0;i&lt;4;i++){</p>
<p>BX[i]=preMBarX[i];</p>
<p>BY[i]=preMBarY[i];</p>
<p>}</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"MB");</p>
<p>break;</p>
<p>case 39: //right</p>
<p>for(i=0;i&lt;4;i++) if(BX[i]==9)return;</p>
<p>for(i=0;i&lt;4;i++) if(getClass(BX[i]+1,BY[i])=="SB") return;
for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"BK");</p>
<p>for(i=0;i&lt;4;i++)BX[i]=BX[i]+1;</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"MB");</p>
<p>break;</p>
<p>case 40: //down</p>
<p>moveBar();</p>
<p>break;</p>
<p>Game Programming – Penn Wu</p>
<p>227</p>
<p><span id="index_split_011.html#p228"></span> }</p>
<p>}</p>
<p>function delLine()</p>
<p>{</p>
<p>for(i=0;i&lt;4;i++) setClass(BX[i],BY[i],"SB");</p>
<p>for(j=0;j&lt;16;j++){</p>
<p>dLine=true;</p>
<p>for(i=0;i&lt;9;i++){</p>
<p>if(getClass(i,j)!="SB"){</p>
<p>dLine=false;</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>if(dLine){</p>
<p>for(k=j;k&gt;0;k--)</p>
<p>for(l=0;l&lt;10;l++)</p>
<p>setClass(l,k,getClass(l,k-1));</p>
<p>for(l=0;l&lt;10;l++)setClass(l,0,"BK");</p>
<p>}</p>
<p>}</p>
<p>randBar();</p>
<p>window.clearInterval(mTimer);</p>
<p>mTimer=window.setInterval("moveBar()",outTime);</p>
<p>}</p>
<p>function getClass(x,y){return
GameBar.children[y].children[x].className;}</p>
<p>function
setClass(x,y,cName){GameBar.children[y].children[x].className=cName;}</p>
<p>function moveBar()</p>
<p>{</p>
<p>if(gameState!=1)return;</p>
<p>dropLine=true;</p>
<p>for(i=0;i&lt;4;i++)if(BY[i]==15)dropLine=false;</p>
<p>if(dropLine)for(i=0;i&lt;4;i++)if(getClass(BX[i],BY[i]+1)=="SB")dropLine=false;
if(!dropLine){</p>
<p>window.clearInterval(mTimer);</p>
<p>delLine();</p>
<p>return;</p>
<p>}</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"BK");</p>
<p>for(i=0;i&lt;4;i++)BY[i]=BY[i]+1;</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"MB");</p>
<p>}</p>
<p>function randBar()</p>
<p>{</p>
<p>randNum=Math.floor(Math.random()*20)+1;</p>
<p>if(!firstView)</p>
<p>for(i=0;i&lt;4;i++){</p>
<p>BX[i]=PX[i];</p>
<p>BY[i]=PY[i];</p>
<p>}</p>
<p>switch(randNum){</p>
<p>case 1:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=4;PY[1]=1;PX[2]=5;PY[2]=1;PX[3]=6;PY[3]=1;break;
case 2:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=4;PY[2]=1;PX[3]=4;PY[3]=2;break;
case 3:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=6;PY[2]=0;PX[3]=6;PY[3]=1;break;
case 4:</p>
<p>PX[0]=5;PY[0]=0;PX[1]=5;PY[1]=1;PX[2]=5;PY[2]=2;PX[3]=4;PY[3]=2;break;
Game Programming – Penn Wu</p>
<p>228</p>
<p><span id="index_split_011.html#p229"></span> case 5:</p>
<p>PX[0]=6;PY[0]=0;PX[1]=6;PY[1]=1;PX[2]=4;PY[2]=1;PX[3]=5;PY[3]=1;break;
case 6:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=4;PY[1]=1;PX[2]=4;PY[2]=2;PX[3]=5;PY[3]=2;break;
case 7:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=4;PY[1]=1;PX[2]=5;PY[2]=0;PX[3]=6;PY[3]=0;break;
case 8:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=5;PY[2]=1;PX[3]=5;PY[3]=2;break;
case 9:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=5;PY[2]=1;PX[3]=6;PY[3]=1;break;
case 10:</p>
<p>PX[0]=5;PY[0]=0;PX[1]=5;PY[1]=1;PX[2]=4;PY[2]=1;PX[3]=4;PY[3]=2;break;
case 11:</p>
<p>PX[0]=4;PY[0]=1;PX[1]=5;PY[1]=1;PX[2]=5;PY[2]=0;PX[3]=6;PY[3]=0;break;
case 12:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=4;PY[1]=1;PX[2]=5;PY[2]=1;PX[3]=5;PY[3]=2;break;
case 13:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=6;PY[2]=0;PX[3]=5;PY[3]=1;break;
case 14:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=4;PY[1]=1;PX[2]=4;PY[2]=2;PX[3]=5;PY[3]=1;break;
case 15:</p>
<p>PX[0]=5;PY[0]=0;PX[1]=5;PY[1]=1;PX[2]=4;PY[2]=1;PX[3]=6;PY[3]=1;break;
case 16:</p>
<p>PX[0]=5;PY[0]=0;PX[1]=5;PY[1]=1;PX[2]=5;PY[2]=2;PX[3]=4;PY[3]=1;break;
case 17:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=4;PY[2]=1;PX[3]=5;PY[3]=1;break;
case 18:</p>
<p>PX[0]=4;PY[0]=0;PX[1]=5;PY[1]=0;PX[2]=4;PY[2]=1;PX[3]=5;PY[3]=1;break;
case 19:</p>
<p>PX[0]=3;PY[0]=0;PX[1]=4;PY[1]=0;PX[2]=5;PY[2]=0;PX[3]=6;PY[3]=0;break;
case 20:</p>
<p>PX[0]=5;PY[0]=0;PX[1]=5;PY[1]=1;PX[2]=5;PY[2]=2;PX[3]=5;PY[3]=3;break;</p>
<p>}</p>
<p>if(firstView){</p>
<p>firstView=false;</p>
<p>randBar();</p>
<p>return;</p>
<p>}</p>
<p>for(i=0;i&lt;4;i++){</p>
<p>for(j=0;j&lt;4;j++){</p>
<p>previewBar.children[j].children[i].className="BK";</p>
<p>}</p>
<p>}</p>
<p>for(i=0;i&lt;4;i++)previewBar.children[PY[i]].children[PX[i]-</p>
<p>3].className="MB";</p>
<p>for(i=0;i&lt;4;i++){</p>
<p>if(getClass(BX[i],BY[i])!="BK"){</p>
<p>alert("Game Over!");</p>
<p>window.clearInterval(mTimer);</p>
<p>Play.disabled=false;</p>
<p>gameState=0;</p>
<p>return;</p>
<p>}</p>
<p>}</p>
<p>for(i=0;i&lt;4;i++)setClass(BX[i],BY[i],"MB");</p>
<p>}</p>
<p>function unSel()</p>
<p>{</p>
<p>document.execCommand("Unselect");</p>
<p>window.setTimeout("unSel()",10);</p>
<p>}</p>
<p>unSel();</p>
<p>Game Programming – Penn Wu</p>
<p>229</p>
<p><span id="index_split_011.html#p230"></span><img
src="index-230_1.png" class="calibre5" alt="Image 198" /></p>
<p>window.onunload=rel;</p>
<p>function rel()</p>
<p>{</p>
<p>location.reload();</p>
<p>return false;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;BODY bgcolor=white onLoad="init()" onkeydown="return
keyControl();"&gt;</p>
<p>&lt;div id="area1"
style="position:absolute;left:10px;top:10px;"&gt;&lt;/div&gt;</p>
<p>&lt;div id="area2"
style="position:absolute;left:300px;top:10px;"&gt;&lt;/div&gt;</p>
<p>&lt;button id="Play"
style="position:absolute;left:10px;top:400px;width:100px"</p>
<p>onclick="beginGame();"&gt;Play&lt;/button&gt;</p>
<p>&lt;/BODY&gt;</p>
<p>&lt;/HTML&gt;</p>
<p>3. Test the program. A sample output looks:</p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 12, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab12_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab12_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab12_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab12_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab12_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>230</p>
<p><span id="index_split_011.html#p231"></span></p>
<p>Lecture #13</p>
<p>Code Optimization</p>
<p><span id="index_split_012.html"></span></p>
<h2 class="calibre2"
id="index_split_012.html#calibre_pb_11">Introduction</h2>
<p>In computing, optimization is the process of modifying a system to
make some aspect of it work more efficiently or use fewer resources. A
computer game may be optimized so that it executes more rapidly, or is
capable of operating with less memory storage or other resources, or
draw less power.</p>
<p>Sometimes the biggest problem with a program is that it requires
simply too many resources, and these resources (memory, CPU cycles,
network bandwidth, or a combination) may be limited.</p>
<p>Code fragments that occur multiple times throughout a program are
likely to be size-sensitive, while code with many execution iterations
may be speed-sensitive.</p>
<p>Using a better algorithm probably will yield a bigger performance
increase than any amount of low-level optimizations and is more likely
to deliver an improvement under all execution conditions. As a rule,
high-level optimizations should be considered before doing low-level
optimizations. However, before optimizing, you should carefully consider
whether you need to optimize at all. According to the pioneering
computer scientist Donald Knuth, “Premature optimization is the root of
all evil.”</p>
<p>Modularization If the program contains the same or similar blocks of
statements or it is required to process the same function several times,
you can avoid redundancy by using modularization techniques. By
modularizing the game programs you make them easy to read and improve
their structure.</p>
<p>Modularized programs are also easier to maintain and to update.
Consider the following code, in which all the objects (c1, c2, …, c7)
have some common properties, such as position, width, and height.</p>
<p>&lt;html&gt;</p>
<p>&lt;span id="c1" style=" <strong>position:relative; width:30;
height:30;</strong> background-Color:red"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c2" style=" <strong>position:relative; width:30;
height:30;</strong> background-Color:green"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c3" style=" <strong>position:relative; width:30;
height:30;</strong> backgroundColor:orange"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c4" style=" <strong>position:relative; width:30;
height:30;</strong> background-Color:blue"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c5" style=" <strong>position:relative; width:30;
height:30;</strong> backgroundColor:yellow"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c6" style=" <strong>position:relative; width:30;
height:30;</strong> background-Color:pink"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c7" style=" <strong>position:relative; width:30;
height:30;</strong> background-Color:black"&gt;&lt;/span&gt;</p>
<p>&lt;/html&gt;</p>
<p>Since all these properties have exactly the same values, you can
extract out these common properties and make them an individual code
block that can be access by each object. For example,</p>
<p>&lt;html&gt;</p>
<p><strong>&lt;style&gt;</strong></p>
<p><strong>span { position:relative; width:30; height:30; }</strong></p>
<p><strong>&lt;/style&gt;</strong></p>
<p>Game Programming – Penn Wu</p>
<p>231</p>
<p><span id="index_split_012.html#p232"></span></p>
<p>&lt;span id="c1" style="background-Color:red"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c2" style="background-Color:green"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c3" style="background-Color:orange"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c4" style="background-Color:blue"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c5" style="background-Color:yellow"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c6" style="background-Color:pink"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c7" style="background-Color:black"&gt;&lt;/span&gt;</p>
<p>&lt;/html&gt;</p>
<p>This shareable code block can be shared by as many object as you deem
it necessary. It is a good way to keep the file size small. For
example,</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span { position:relative; width:30; height:30; }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var code = "";</p>
<p>function init(){</p>
<p>for (i=0; i&lt;=255; i++) {</p>
<p>code += "&lt;span style='background-</p>
<p>Color:rgb("+i+","+i+","+i+")'&gt;&lt;/span&gt;";</p>
<p>}</p>
<p>area.innerHTML = code;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p>&lt;div id="area"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Obviously creating reusable codes is a good way of
modularization.</p>
<p>Use repetition</p>
<p>Consider the following code segment. By properly using a repetition
structure, such as the “<em>for</em>”</p>
<p>structure to</p>
<p>loop, in a game script, the length of the code in a game script is
significantly shortened. Thus, the generate codes</p>
<p>client machine downloads a size-reduced game script file, uses its
processing power to generate and display images on the screen without
losing any game functions.</p>
<p>var k=1;</p>
<p>code="";</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=20; i++) {</p>
<p>if (i%5==1) {</p>
<p>code += "&lt;span id='s"+k+"' style='top:"+(k-1)*40+"'&gt;"; code +=
"&lt;img id='b"+i+"' src='bee.gif'&gt;"; k++;</p>
<p>}</p>
<p>else if (i%5==0) { code += "&lt;img id='b"+i+"'</p>
<p>src='bee.gif'&gt;&lt;/span&gt;&lt;br&gt;"; }</p>
<p>else { code += "&lt;img id='b"+i+"' src='bee.gif'&gt;"; }</p>
<p>}</p>
<p>area.innerHTML= code;</p>
<p>Game Programming – Penn Wu</p>
<p>232</p>
<p><span id="index_split_012.html#p233"></span><img
src="index-233_1.png" class="calibre5" alt="Image 199" /></p>
<p><img src="index-233_2.png" class="calibre5" alt="Image 200" /></p>
<p>Notice that the number of images (e.g. 20) to be generated is
technically of no limit, and such code generation is done completely at
the client side. It programmatically solves the problem of file size
augmentation.</p>
<p>Since this method is a combination of repetition structure with
automatic code generation, it has a potential to allow players to decide
how many objects the game has each time he/she plays the game.</p>
<p>Function</p>
<p>“Lossless” is a term used in Computer Sciences to refer to a
compression method in which no data lossless code</p>
<p>is lost. A code optimization method is said to be lossless if it
retains the functions without optimization</p>
<p>degrading any part of it.</p>
<p>In game programming, a game program frequently has to generate codes
by itself as response to the player’s inputs. The term
“<strong>automatic code generation</strong>” (ACG) refers to a technique
programmers can use to tell computers how they generate game codes
automatically according to the patterns and structures the programmer
built inside the program.</p>
<p>Consider the following example. When a user enters a value (e.g. 7)
to <em>x</em> (which in this case is a textbox), the variable <em>y</em>
will be assigned a value of <em>x</em>* <em>x</em> (x squared). The
value of <em>y</em> (e.g. 49) is then used as the terminal value of the
<em>for</em> loop. The <em>for</em> loop in turn create a <em>x</em> ×
<em>x</em> table as shown in the figure below.</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>var x = eval(frm.x.value);</p>
<p>var y = x*x;</p>
<p>frm.style.display="none";</p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=y; i++) {</p>
<p>if (i%x==0) {</p>
<p>code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;&lt;br&gt;";}</p>
<p>else { code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>area.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>Inside the <em>for</em> loop is a predefined code pattern and
structure, as shown below. Notice that <em>i</em> is a value
automatically assigned by the <em>for</em> loop based on whatever value
<em>i</em> currently is, and its value Game Programming – Penn Wu</p>
<p>233</p>
<p><span id="index_split_012.html#p234"></span>is in a range from 1 to
<em>y</em>.</p>
<p>&lt;span id=c <em>i</em> class='cell'&gt; <em>i</em>&lt;/span&gt;</p>
<p>When <em>i</em> is 1, the program automatically generates the
following line (and that builds the first cell):</p>
<p>&lt;span id=c <em>1</em> class='cell'&gt; <em>1</em>&lt;/span&gt;</p>
<p>When <em>i</em> is 2, the program automatically generates the
following line (and that builds the second cell):</p>
<p>&lt;span id=c <em>2</em> class='cell'&gt; <em>2</em>&lt;/span&gt;</p>
<p>When <em>i</em> is 3, 4, 5, …, <em>n</em>, the program automatically
generates the following lines:</p>
<p>&lt;span id=c <em>3</em> class='cell'&gt; <em>3</em>&lt;/span&gt;</p>
<p>&lt;span id=c <em>4</em> class='cell'&gt; <em>4</em>&lt;/span&gt;</p>
<p>&lt;span id=c <em>5</em> class='cell'&gt; <em>5</em>&lt;/span&gt;</p>
<p>......</p>
<p>&lt;span id=c <em>n</em> class='cell'&gt; <em>n</em>&lt;/span&gt;</p>
<p>The following <em>if</em> statement contains a condition <strong>i%
<em>x</em>==0</strong> which defines another pattern. The %</p>
<p>sign is not the percentage sign, it represent the
<strong>modulus</strong> operator. Modulus is a lesser known arithmetic
operator used to find the remainder of division between two numbers. For
example, 6 ÷</p>
<p>2 = 3 with a remainder 0 (the abbreviation is 6/2=3r0) and 7/5 = 1r2.
You can use the modulus operator just to get the remainder and ignore
the quotient, for example, 6%2=0 and 7%5=2. In other words, when a value
<em>i</em>% <em>x</em>==0, then I must be a multiple of <em>x</em>.</p>
<p>if (i%x==0) {</p>
<p>code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;&lt;br&gt;";}</p>
<p>else { code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>The above code use the condition <em>i</em>% <em>x</em>==0 to decide
if the current value of <em>i</em> is a multiple of <em>x</em>. If
<em>i</em> is a multiple of <em>x</em> add an
<strong>&lt;br&gt;</strong> tag as shown below:</p>
<p>&lt;span id=c <em>1</em> class='cell'&gt; <em>1</em>&lt;/span&gt;
<strong>&lt;br&gt;</strong> When <em>x</em>=7, then each time when
<em>i</em> is a multiple of 7 (e.g. 7, 14, 21, 28, …49), the &lt;br&gt;
tag will break a line, so the next number starts a new line. Namely, 1
through 7 make the first line, 8</p>
<p>through 13 make the second line, 14 through 20 make the third line,
and so on.</p>
<p>.......</p>
<p>&lt;span id=c <em>6</em> class='cell'&gt; <em>6</em>&lt;/span&gt;</p>
<p>&lt;span id=c <em>7</em> class='cell'&gt; <em>7</em>&lt;/span&gt;
<strong>&lt;br&gt;</strong></p>
<p>.......</p>
<p>&lt;span id=c <em>13</em> class='cell'&gt;
<em>13</em>&lt;/span&gt;</p>
<p>&lt;span id=c <em>14</em> class='cell'&gt; <em>14</em>&lt;/span&gt;
<strong>&lt;br&gt;</strong></p>
<p>.......</p>
<p>&lt;span id=c <em>20</em> class='cell'&gt;
<em>20</em>&lt;/span&gt;</p>
<p>&lt;span id=c <em>21</em> class='cell'&gt; <em>21</em>&lt;/span&gt;
<strong>&lt;br&gt;</strong></p>
<p><strong>........</strong></p>
<p>ACG (automatic code generation) is also commonly used to
automatically insert new objects to a game. Consider the following code,
which continuously adding color bricks (in red, green, or blue) randomly
to the screen.</p>
<p>&lt;html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>234</p>
<p><span id="index_split_012.html#p235"></span>&lt;style&gt;</p>
<p>span { position: absolute; width:25;height:25 }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0;</p>
<p>var s,t, u, v, x, y;</p>
<p>var code=""</p>
<p>function init() {</p>
<p>s = Math.floor(Math.random()*document.body.clientWidth/25);</p>
<p>t = Math.floor(Math.random()*document.body.clientHeight/25);</p>
<p>u = Math.floor(Math.random()*document.body.clientWidth/25);</p>
<p>v = Math.floor(Math.random()*document.body.clientHeight/25);</p>
<p>x = Math.floor(Math.random()*document.body.clientWidth/25);</p>
<p>y = Math.floor(Math.random()*document.body.clientHeight/25);</p>
<p>code="&lt;span id=r"+i+"
style='left:"+s*25+";top:"+t*25+";backgroundColor:red;'&gt;&lt;/span&gt;"</p>
<p>code+="&lt;span id=g"+i+"
style='left:"+u*25+";top:"+v*25+";backgroundColor:green;'&gt;&lt;/span&gt;"</p>
<p>code+="&lt;span id=b"+i+"
style='left:"+x*25+";top:"+y*25+";backgroundColor:blue;'&gt;&lt;/span&gt;"</p>
<p>bd.innerHTML += code;</p>
<p>i++;</p>
<p>setTimeout("init()", 5);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p>&lt;div id="bd"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>The current width of web browser is represented by
<strong>document.body.clientWidth</strong>, while the current height of
the web browser is represented by
<strong>document.body.clientHeight</strong>. Since the width and height
of each brick is set to be 25 × 25 (pixels).</p>
<p>document.body.clientWdith</p>
<p>document.body.clientHeight</p>
<p>The following will determine the maximum number of brick per row and
per column allows.</p>
<p>document.body.clientWidth/25</p>
<p>document.body.clientHeight/25</p>
<p>The following will randomly specify a value that represents the
<em>x</em>-coordinate of a brick.</p>
<p>Math.floor(Math.random()*document.body.clientWidth/25);</p>
<p>Similarly, the following will randomly specify a value that
represents the <em>y</em>-coordinate of a brick.</p>
<p>Game Programming – Penn Wu</p>
<p>235</p>
<p><span id="index_split_012.html#p236"></span><img
src="index-236_1.png" class="calibre5" alt="Image 201" /></p>
<p>Math.floor(Math.random()*document.body.clientHeight/25);</p>
<p>You then use the randomly generate ( <em>x</em>, <em>y</em>) values
to one red, one green, and one blue brick each time when the
<strong>init()</strong> functions is called. This part of code is:
code="&lt;span id=r"+i+"
style='left:"+s*25+";top:"+t*25+";backgroundColor:red;'&gt;&lt;/span&gt;"</p>
<p>code+="&lt;span id=g"+i+"
style='left:"+u*25+";top:"+v*25+";backgroundColor:green;'&gt;&lt;/span&gt;"</p>
<p>code+="&lt;span id=b"+i+"
style='left:"+x*25+";top:"+y*25+";backgroundColor:blue;'&gt;&lt;/span&gt;"</p>
<p>The innerHTML property will then insert the newly generated codes a
division with an ID <strong>bd</strong>.</p>
<p>bd.innerHTML += code;</p>
<p>The <strong>i++</strong> means to add 1 to the current value of
<em>i</em>, so the value of <em>i</em> is incremented by 1 each time
when this statement is read by computer. The setTimeout() method force
the computer to call the init() function every 5 milliseconds</p>
<p>setTimeout("init()", 5);</p>
<p>A sample output looks:</p>
<p>Colorful bricks will be randomly inserted to blank space.</p>
<p>Clearing</p>
<p>Many game codes create objects that have limited life span
(duration). For example a bullet that physical</p>
<p>the player uses to shoot the enemy. When the bullet is fired, its
life span should soon end if the memory</p>
<p>bullet miss or hit the target. Since each object in the game takes up
certain memory space, it is always a good practice to clear unneeded,
unnecessary or unwanted object from the physical memory.</p>
<p>Consider the following code, which does not delete the unneeded
object from memory.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {position:absolute;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>p1.innerHTML = "&lt;span id='c'&gt;o&lt;/span&gt;";</p>
<p>move();</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>236</p>
<p><span id="index_split_012.html#p237"></span>function move() {</p>
<p>if (c.style.pixelLeft &gt;=200) {</p>
<p>clearTimeout(s1); p1.innerText = '';}</p>
<p>else { c.style.pixelLeft++;</p>
<p>s1=setTimeout('move()', 10);}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="init();"&gt;</p>
<p>&lt;b id="p1"&gt;&lt;/b&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>This game code functions well, but the only problem is. Each time
when the player press a key, the “c” object is created again without
deleting the previously created “c” object. Consequently, after pressing
a key many times, the player will encounted some problem caused by
memory overuse.</p>
<p>Applying object-oriented programming technique, in this case, helps
to remove unneeded objects.</p>
<p>JavaScript support object-oriented programming, so you can create an
object, use the object for a period of time, and delete the object
later.</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {position:absolute;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var i = 1;</p>
<p>function init() {</p>
<p><strong>obj = new Object();</strong></p>
<p>obj.n="&lt;span id='c"+i+"'&gt;o&lt;/span&gt;"; p1.innerHTML =
obj.n;</p>
<p>move();</p>
<p>}</p>
<p>function move() {</p>
<p>code = "if (c"+i+".style.pixelLeft &gt;=200) { "; code += "
clearTimeout(s1); <strong>obj = ''</strong> ;p1.innerText = ''; i++;}";
code += "else { c"+i+".style.pixelLeft++; status=i; "; code += "
s1=setTimeout('move()', 10);}";</p>
<p>eval(code);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="init();"&gt;</p>
<p>&lt;b id="p1"&gt;&lt;/b&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>To create an object, assign an object ID (e.g. obj) to the Object()
method.</p>
<p><strong>obj = new Object();</strong></p>
<p>Game Programming – Penn Wu</p>
<p>237</p>
<p><span id="index_split_012.html#p238"></span>You can then, create
properties for the <strong>obj</strong> object. In the following
example, “text” is a new property of the obj object with a string value
“Test the code”.</p>
<p>obj. <strong>test</strong> = "Test the code";</p>
<p>To delete the object, simply assign the object ID with null value;
<strong>obj = ''</strong> ;</p>
<p>Oncethe object is deleted, the game codes that control it are no
longer kept in physical meory.</p>
<p>Execution</p>
<p>In a previous lecture, you tried the UFO game, whose source code
looks: issues and</p>
<p>speed</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.dots {position:absolute; color:white}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>code1 ="";</p>
<p>function draw_star() {</p>
<p>for (i=1; i&lt;=600; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 += "&lt;span class=dots id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y
+"'&gt;.&lt;/span&gt;";</p>
<p>}</p>
<p>bar.innerHTML = code1;</p>
<p>}</p>
<p>function ufo_fly() {</p>
<p>ufo.style.left = Math.round(Math.random()*screen.width);</p>
<p>ufo.style.top = Math.round(Math.random()*screen.height);</p>
<p>setTimeout("ufo_fly()", 500);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body bgcolor=black onLoad="draw_star();ufo_fly()"&gt;</p>
<p>&lt;div id="bar" style="z-index:0"&gt;&lt;/div&gt;</p>
<p>&lt;img src="ufo.gif" id="ufo"
style="position:absolute;z-index:3;"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>If you modify just the <strong>draw_star()</strong> function to the
following, the loading time will be much longer, and the execution will
be slower.</p>
<p>&lt;script&gt;</p>
<p>function draw_star() {</p>
<p>for (i=1; i&lt;=300; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 = "&lt;span class=dots id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y +"'&gt;.&lt;/span&gt;";
bar.innerHTML += code1;</p>
<p>}</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>238</p>
<p><span id="index_split_012.html#p239"></span>..................</p>
<p>&lt;/script&gt;</p>
<p>Try take a closer look at these two code segments:</p>
<p><strong>code1 ="";</strong></p>
<p>function draw_star() {</p>
<p>for (i=1; i&lt;=600; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 += "&lt;span class=dots id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y
+"'&gt;.&lt;/span&gt;";</p>
<p>}</p>
<p><strong>bar.innerHTML = code1;</strong> // outside the for loop
<strong></strong></p>
<p>}</p>
<p>function draw_star() {</p>
<p>for (i=1; i&lt;=300; i++) {</p>
<p>x = Math.round(Math.random()*screen.width);</p>
<p>y = Math.round(Math.random()*screen.height);</p>
<p>code1 = "&lt;span class=dots id=dot"+i;</p>
<p>code1 += " style='left:" + x + "; top:" + y +"'&gt;.&lt;/span&gt;";
<strong>bar.innerHTML += code1;</strong> // inside the for loop
<strong></strong></p>
<p>}</p>
<p>}</p>
<p>The trick is that in the upper one, the following line is placed
outside the <em>for</em> loop. But, in the lower one, it is place
insider the <em>for</em> loop.</p>
<p>bar.innerHTML = code1;</p>
<p>When being executed, the one outside the <em>for</em> loop, does not
have to insert the HTML code till the entire <em>for</em> loop
completes. Each time the a new line, similar to the following, is
produced by the for loop, they are temporarily stored in the computer’s
memory (buffer) as additional one to the previous ones.</p>
<p>&lt;span class=dots id=dot <em>n</em> style='left: <em>x</em>; top:
<em>y</em>'&gt;.&lt;/span&gt; Where <em>n</em> is one of the number in
{1, 2, 3, …, 300}, while <em>x</em>, <em>y</em> and randomly generated
by the draw_star() function.</p>
<p>At the end of the for loop, the computer memory accumulates the
following new HTML codes, and insert all them to the area defined by
&lt;div id="bar" style="z-index:0"&gt;&lt;/div&gt;.</p>
<p>&lt;span class=dots id=dot1 style='left: <em>x1</em>; top:
<em>y1</em>'&gt;.&lt;/span&gt;</p>
<p>&lt;span class=dots id=dot2 style='left: <em>x2</em>; top:
<em>y2</em>'&gt;.&lt;/span&gt;</p>
<p>&lt;span class=dots id=dot3 style='left: <em>x3</em>; top:
<em>y3</em>'&gt;.&lt;/span&gt;</p>
<p>......</p>
<p>&lt;span class=dots id=dot300 style='left: <em>x300</em>; top:
<em>y300</em>'&gt;.&lt;/span&gt; It is faster to insert all the above
lines to the web page, then inserting then one by one, which is exactly
what the second code segement has to do. When you place the following
line inside the for loop, the processing mechanism becomes
redundant.</p>
<p>bar.innerHTML += code1;</p>
<p>First of all, each time when a for loop starts, the computer needs to
go to the &lt;div id=”bar”</p>
<p>Game Programming – Penn Wu</p>
<p>239</p>
<p><span id="index_split_012.html#p240"></span>…&gt;&lt;/div&gt; area to
read the currently available lines of code similar to following, and
then insert a new one to it:</p>
<p>&lt;span class=dots id=dot <em>n</em> style='left: <em>x</em>; top:
<em>y</em>'&gt;.&lt;/span&gt; It takes a significantly longer time to
find the spot, read the contents, and add new contents to it.</p>
<p>Plus, the computer has to do it 300 times. No wonder why the
execution time is longer, and the speed is significantly slower.</p>
<p>Review</p>
<p>1. __ is the process of modifying a system to make some aspect of it
work more efficiently or use Questions</p>
<p>fewer resources.</p>
<p>A. Optimization</p>
<p>B. File size reduction</p>
<p>C. Performance tuning</p>
<p>D. Finetuning</p>
<p>2. If the program contains the same or similar blocks of statements
or it is required to process the same function several times, you can
avoid redundancy by using __ techniques.</p>
<p>A. reengineering</p>
<p>B. collaboration</p>
<p>C. modularization</p>
<p>D. packaging</p>
<p>3. The following is an example of __.</p>
<p>&lt;style&gt;span { position:relative; width:30; height:30;
backgroundColor:red}</p>
<p>&lt;/style&gt;</p>
<p>&lt;span id="c1"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c2"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c3"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c4"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c5"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c6"&gt;&lt;/span&gt;</p>
<p>&lt;span id="c7"&gt;&lt;/span&gt;</p>
<p>A. automatic code generation</p>
<p>B. modularization</p>
<p>C. object specialization</p>
<p>D. object generalization</p>
<p>4. By properly using a repetition structure, such as the “for” loop,
in a game script, __.</p>
<p>A. the length of the code in a game script is significantly
shortened.</p>
<p>B. the client machine downloads a size-reduced game script file.</p>
<p>C. the client machine uses its processing power to generate and
display images on the screen without losing any game functions.</p>
<p>D. All of the above.</p>
<p>5. The following is an example of __.</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>var x = eval(frm.x.value);</p>
<p>var y = x*x;</p>
<p>frm.style.display="none";</p>
<p>Game Programming – Penn Wu</p>
<p>240</p>
<p><span id="index_split_012.html#p241"></span></p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=y; i++) {</p>
<p>if (i%x==0) {</p>
<p>code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;&lt;br&gt;";}</p>
<p>else { code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>area.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>A. automatic code generation</p>
<p>B. modularization</p>
<p>C. object specialization</p>
<p>D. object generalization</p>
<p>6. In the following code, the condition i%x==0 __.</p>
<p>if (i%x==0) { ...... }</p>
<p>A. decide if i is a percentage of x</p>
<p>B. determine if i equals x</p>
<p>C. decide if the current value of i is a multiple of x</p>
<p>D. determine if i equals 0</p>
<p>7. Given the following code segment, what happens when i=14 and
x=7?</p>
<p>if (i%x==0) {</p>
<p>code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;&lt;br&gt;";}</p>
<p>else { code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>A. Since i is a multiple of x, it the output is &lt;span id=c14
class='cell'&gt;14&lt;/span&gt;&lt;br&gt;.</p>
<p>B. Since i is a multiple of x, it the output is &lt;span id=c14
class='cell'&gt;14&lt;/span&gt;.</p>
<p>C. Since i is a multiple of x, it the output is &lt;span id=c7
class='cell'&gt;7&lt;/span&gt;&lt;br&gt;.</p>
<p>D. Since i is a multiple of x, it the output is &lt;span id=c7
class='cell'&gt;7&lt;/span&gt;.</p>
<p>8. The following line __.</p>
<p>m1 = new Object();</p>
<p>A. assign the variable m1 with a new value "Object()".</p>
<p>B. create a new object with an ID m1.</p>
<p>C. for the computer to ignore the m1 object.</p>
<p>D. delete the m1 object from the current program.</p>
<p>9. In JavaScript, you can delete an object by __.</p>
<p>A. assigning a new value to it.</p>
<p>B. re-declaring the object.</p>
<p>C. assining a null value to it.</p>
<p>D. converting the object to a variable.</p>
<p>10. Given the following incomplete code segemetn, where will you
insert the <strong>bar.innerHTML =</strong></p>
<p><strong>code;</strong> statement for the best execution
performance?</p>
<p>.....</p>
<p>code = "";</p>
<p>function init() {</p>
<p>// area1</p>
<p>Game Programming – Penn Wu</p>
<p>241</p>
<p><span id="index_split_012.html#p242"></span> for (i=1; i&lt; 10; i++)
{</p>
<p>code += "&lt;hr size="+i+" width=100%&gt;";</p>
<p>// area2</p>
<p>}</p>
<p>// area3</p>
<p>}</p>
<p>// area4</p>
<p>.....</p>
<p>&lt;div id="bar"&gt;&lt;/div&gt;</p>
<p>.....</p>
<p>A. area1</p>
<p>B. area2</p>
<p>C. area3</p>
<p>D. area4</p>
<p>Game Programming – Penn Wu</p>
<p>242</p>
<p><span id="index_split_012.html#p243"></span><img
src="index-243_1.png" class="calibre5" alt="Image 202" /></p>
<p>Lab #13</p>
<p>Code Optimization</p>
<p>Learning Activity #1:</p>
<p>1. Use Notepad to create a new file named lab13_1.htm with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {position:absolute;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var i = 1;</p>
<p>function init() {</p>
<p><strong>obj = new Object();</strong></p>
<p>obj.n="&lt;span id='c"+i+"'&gt;o&lt;/span&gt;"; p1.innerHTML =
obj.n;</p>
<p>move();</p>
<p>}</p>
<p>function move() {</p>
<p>code = "if (c"+i+".style.pixelLeft &gt;=200) { "; code += "
clearTimeout(s1); <strong>obj = ''</strong> ;p1.innerText = ''; i++;}";
code += "else { c"+i+".style.pixelLeft++; status=i; "; code += "
s1=setTimeout('move()', 10);}";</p>
<p>eval(code);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onKeyDown="init();"&gt;</p>
<p>&lt;b id="p1"&gt;&lt;/b&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the program. There will be a
continuously changing number displayed in the status bar.</p>
<p>Learning Activity #2:</p>
<p>1. Use Notepad to create a new file named lab13_2.htm with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>.cell {</p>
<p>Game Programming – Penn Wu</p>
<p>243</p>
<p><span id="index_split_012.html#p244"></span><img
src="index-244_1.png" class="calibre5" alt="Image 203" /></p>
<p><img src="index-244_2.png" class="calibre5" alt="Image 204" /></p>
<p>border:solid 1 black; width:30;</p>
<p>height:30;background-Color:white;</p>
<p>text-align:center;text-valign:middle}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function init() {</p>
<p>var x = eval(frm.x.value);</p>
<p>var y = x*x;</p>
<p>frm.style.display="none";</p>
<p>var code1="";</p>
<p>for (i=1; i&lt;=y; i++) {</p>
<p>if (i%x==0) {</p>
<p>code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;&lt;br&gt;";}</p>
<p>else { code1 += "&lt;span id=c"+i+"
class='cell'&gt;"+i+"&lt;/span&gt;";}</p>
<p>}</p>
<p>area.innerHTML = code1;</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;form id="frm"&gt;</p>
<p>&lt;i&gt;x&lt;/i&gt;: &lt;input type="text" id="x" size=3&gt;&lt;br
/&gt;</p>
<p>&lt;input type="button" value="Go" onClick="init()"&gt;</p>
<p>&lt;/form&gt;</p>
<p>&lt;div id="area"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the program. Enter a number (e.g.
12) and then click Go.</p>
<p>Accept User Input</p>
<p>Result of automatic code generation</p>
<p>Learning Activity #3:</p>
<p>1. Use Notepad to create a new file named lab13_3.htm with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span { position: absolute; width:20 }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0;</p>
<p>var s,t, x, y;</p>
<p>var code=""</p>
<p>function init() {</p>
<p>s = Math.floor(Math.random()*document.body.clientWidth);</p>
<p>Game Programming – Penn Wu</p>
<p>244</p>
<p><span id="index_split_012.html#p245"></span><img
src="index-245_1.png" class="calibre5" alt="Image 205" /></p>
<p>t = Math.floor(Math.random()*document.body.clientHeight);</p>
<p>x = Math.floor(Math.random()*document.body.clientWidth);</p>
<p>y = Math.floor(Math.random()*document.body.clientHeight);</p>
<p>code="&lt;span id=r"+i+"
style='left:"+s+";top:"+t+";background-Color:red;'&gt;&lt;/span&gt;"</p>
<p>code+="&lt;span id=b"+i+"
style='left:"+x+";top:"+y+";background-Color:blue;'&gt;&lt;/span&gt;"</p>
<p>bd.innerHTML += code;</p>
<p>i++;</p>
<p>setTimeout("init()", 5);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p>&lt;div id="bd"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the program. A sample output looks:
Learning Activity #4:</p>
<p>1. Use Internet Explorer to go to
http://business.cypresscollege.edu/~pwu/cis261/files/bee.gif and
download the bee.gif file.</p>
<p>2. Use Notepad to create a new file named lab13_4.htm with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>img { position:relative; }</p>
<p>span {position:absolute;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var k=1;</p>
<p>code="";</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=20; i++) {</p>
<p>if (i%5==1) { code += "&lt;span id='s"+k+"'
style='top:"+(k-1)*40+"'&gt;&lt;img id='b"+i+"' src='bee.gif'&gt;"; k++;
}</p>
<p>else if (i%5==0) { code += "&lt;img id='b"+i+"'
src='bee.gif'&gt;&lt;/span&gt;&lt;br&gt;"; }</p>
<p>else { code += "&lt;img id='b"+i+"' src='bee.gif'&gt;"; }</p>
<p>}</p>
<p>area.innerHTML= code;</p>
<p>for (j=1; j&lt;=4; j++) {</p>
<p>eval("s"+j+".style.pixelWidth = 250;");</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>245</p>
<p><span id="index_split_012.html#p246"></span><img
src="index-246_1.png" class="calibre5" alt="Image 206" /></p>
<p>movebee();</p>
<p>}</p>
<p>function movebee() {</p>
<p>if (s1.style.pixelLeft + s1.style.pixelWidth &gt;=
document.body.clientWidth) {</p>
<p>s1.style.pixelLeft = 0</p>
<p>}</p>
<p>else { s1.style.pixelLeft += 5; }</p>
<p>if (s2.style.pixelLeft + s2.style.pixelWidth &gt;=
document.body.clientWidth) {</p>
<p>s2.style.pixelLeft = 0</p>
<p>}</p>
<p>else {</p>
<p>if (s1.style.pixelLeft&lt;=40) { s2.style.pixelLeft =0; }</p>
<p>else { s2.style.pixelLeft += 5; }</p>
<p>}</p>
<p>if (s3.style.pixelLeft + s3.style.pixelWidth &gt;=
document.body.clientWidth) {</p>
<p>s3.style.pixelLeft = 0</p>
<p>}</p>
<p>else { s3.style.pixelLeft += 5; }</p>
<p>if (s4.style.pixelLeft + s4.style.pixelWidth &gt;=
document.body.clientWidth) {</p>
<p>s4.style.pixelLeft = 0</p>
<p>}</p>
<p>else {</p>
<p>if (s3.style.pixelLeft&lt;=40) { s4.style.pixelLeft =0; }</p>
<p>else { s4.style.pixelLeft += 5; }</p>
<p>}</p>
<p>setTimeout("movebee()", 100);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p>&lt;div id="area" style="position:absolute"&gt;&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>3. Use Internet Explorer to test the program.</p>
<p>Learning Activity #5:</p>
<p>Game Programming – Penn Wu</p>
<p>246</p>
<p><span id="index_split_012.html#p247"></span>Note: This code is a
fully functional game code, but if will function better if you apply the
object-oriented programming techniques (as dicussed in the lecture) to
it. Try modify the code with object-oriented programming.</p>
<p>1. Use Notepad to create a new file named lab13_5.htm with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0;</p>
<p>function init() {</p>
<p>if (red.style.pixelLeft &gt;= document.body.clientWidth) {</p>
<p>red.style.pixelLeft=0; red.style.pixelTop+=20;</p>
<p>}</p>
<p>else if (red.style.pixelTop &gt;= document.body.clientHeight-20)
{</p>
<p>red.style.pixelTop=0;</p>
<p>}</p>
<p>red.style.pixelLeft+=5;</p>
<p>for (k=1; k&lt;=i; k++) {</p>
<p>eval("b"+i+".style.pixelTop+=5");</p>
<p>msg1="if (b"+i+".style.pixelTop &gt;=
document.body.clientHeight-100)"; msg1+="
{b"+i+".style.display='none';}";</p>
<p>eval(msg1);</p>
<p>msg2="if (b"+i+".style.pixelLeft&gt;=red.style.pixelLeft &amp;&amp;";
msg2+=" b"+i+".style.pixelLeft&lt;=red.style.pixelLeft+20 &amp;&amp;";
msg2+=" b"+i+".style.pixelTop+20&gt;=red.style.pixelTop &amp;&amp;";
msg2+=" b"+i+".style.pixelTop&lt;=red.style.pixelTop+20) "; msg2+="{
red.style.display='none';p1.innerText='Game Over!';}"; eval(msg2);</p>
<p>}</p>
<p>setTimeout("init()", 20);</p>
<p>}</p>
<p>function fire() {</p>
<p>i=i+1;</p>
<p>b_top=Math.floor(Math.random()*document.body.clientWidth);</p>
<p>code="&lt;span id='b"+i+"' style='position:absolute; "; code+="
background-Color:blue; width:20; ";</p>
<p>code+=" height:20; top:0; left:"+b_top+"'&gt;&lt;/span&gt; ";
bd.innerHTML+=code;</p>
<p>eval("b"+(i-1)+".style.display='none';");</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body id="bd" onLoad="init()" onKeyDown="var f = new fire()"</p>
<p>style="overflow: hidden"&gt;</p>
<p>&lt;span id="red" style="position:absolute; background-Color:red;
width:20; height:20; top:100"&gt;&lt;/span&gt;</p>
<p>&lt;p id="p1"&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the program.</p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>Game Programming – Penn Wu</p>
<p>247</p>
<p><span id="index_split_012.html#p248"></span>1. Upload all files you
created in this lab to your remote web server.</p>
<p>2. Log in to to Blackboard, launch Assignment 13, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab13_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab13_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab13_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab13_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab13_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>248</p>
<p><span id="index_split_012.html#p249"></span></p>
<p>Lecture #14</p>
<p>Using Canvas and ExplorerCanvas</p>
<p><span id="index_split_013.html"></span></p>
<h2 class="calibre2"
id="index_split_013.html#calibre_pb_12">Introduction</h2>
<p>The <strong>canvas</strong> element is part of HTML5 and allows for
dynamic scriptable rendering of bitmap images. Canvas consists of a
drawable region defined in HTML code with height and width attributes.
JavaScript code may access the area through a full set of drawing
functions similar to other common 2D APIs, thus allowing for dynamically
generated graphics. Some anticipated uses of the canvas include building
graphs, animations, games, and image composition.</p>
<p>Firefox, Safari and Opera 9 support the canvas tag by default, but
Internet Explorer does not.</p>
<p>Thanks to Google’s efforts in creating the ExplorerCanvas, which
seems to solve this problem to some extent.</p>
<p>ExplorerCanvas brings the same functionality to Internet Explorer. To
use, web developers only need to include a single script tag in their
existing web pages.</p>
<p>Good news is that Google distributes ExplorerCanvas with the Open
Source <strong>BSD License</strong> and the <strong></strong></p>
<p><strong>Apache License</strong>. This is free license that allows use
of the source code for the development of free and open source software
as well as proprietary software.</p>
<p>Sample codes in this lecture note that use ExplorerCanvas respect
Google’s copyright by adding the following line at the beginning of the
HTML codes. <strong></strong></p>
<p>&lt;!--This code uses ExplorerCanvas, developed by Google Inc.--&gt;
Using</p>
<p>Simply include the ExplorerCanvas tag in the same directory as your
HTML files, and ExplorerCanva</p>
<p>add the following code to your page, preferably in the &lt;head&gt;
tag.</p>
<p>s</p>
<p>&lt;!--[if IE]&gt;</p>
<p>&lt;script type="text/javascript"
src="excanvas.js"&gt;&lt;/script&gt;</p>
<p>&lt;![endif]--&gt;</p>
<p>For example,</p>
<p>&lt;!--This code uses ExplorerCanvas, developed by Google
Inc.--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p><strong>&lt;!--[if IE]&gt;&lt;script
type="text/javascript"</strong></p>
<p><strong>src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</strong></p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p><strong>obj.fillStyle = "rgb(255, 0, 0)";</strong></p>
<p><strong>obj.fillRect (10, 10, 100, 100);</strong></p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();"&gt;</p>
<p>&lt;canvas id="sqr" width="150" height="150"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>249</p>
<p><span id="index_split_013.html#p250"></span></p>
<p>The &lt;canvas&gt;</p>
<p>The &lt;canvas&gt; element creates a fixed size drawing surface that
can render graphics. It has only element</p>
<p>three attributes, <strong>id</strong>, <strong>width</strong> and
<strong>height</strong>. These are both optional and can also be set
using DOM</p>
<p>properties. When no width and height attributes are specified, the
canvas will initially be 300</p>
<p>pixels wide and 150 pixels high. To avoid compatibility issues, be
sure to have an end tag</p>
<p>&lt;/canvas&gt;.</p>
<p>&lt;canvas id="sqr" width="150" height="150"&gt;&lt;/canvas&gt; The
<strong>id</strong> attribute is used to identify the &lt;canvas&gt; tag
so it can be used as an object to work with the Document Object Model
(DOM) API.</p>
<p>The &lt;canvas&gt; element also works with CSS, so it can be styled
with margin, border, background color, etc. For example,</p>
<p>&lt;style type="text/css"&gt;</p>
<p>canvas { border: 1px solid black; }</p>
<p>&lt;/style&gt;</p>
<p>The <strong>getContext()</strong> method is a DOM method that
retrieves the current active document type and document ID. It works
with the <strong>getElementById</strong> method to identify the object
that will serve as the drawing ground. For example,</p>
<p>var sid = document.getElementById('sqr');</p>
<p>..............</p>
<p>var obj = sid.getContext('2d');</p>
<p>..............</p>
<p>&lt;canvas id="sqr" width="150" height="150"&gt;&lt;/canvas&gt; In
the above example, “sqr” is the ID of the &lt;canvas&gt;, which is the
drawing ground. The <strong>getElementById</strong> method retrieve the
ID (sqr) and transfers it a variable <strong>sid</strong>. The sid
variable is then used as a object to retrieve drawing context that will
be specified by getContext() method.</p>
<p>You can combine the following two lines,</p>
<p>var sid = document.getElementById('sqr');</p>
<p>var obj = sid.getContext('2d');</p>
<p>to</p>
<p>var obj = document.getElementById('sqr').getContext('2d');</p>
<p>There are still some browser that do not support the &lt;canvas&gt;
element. You may want to display some message notifying the viewer such
incompatibility. A simple if..then..else statement can do the work. For
example,</p>
<p>var sid = document.getElementById('sqr');</p>
<p>if (sid.getContext){</p>
<p>var obj = canvas.getContext('2d');</p>
<p>// drawing code here</p>
<p>} else {</p>
<p>// message saying canvas unsupported here</p>
<p>}</p>
<p>The drawing</p>
<p>The drawing of the graphics is done by drawing functions. Commonly
used drawing functions are: codes</p>
<p>Table: Drawing functions</p>
<p>Function</p>
<p>Description</p>
<p>Game Programming – Penn Wu</p>
<p>250</p>
<p><span
id="index_split_013.html#p251"></span>fillRect(x,y,width,height)</p>
<p>Draws a filled rectangle</p>
<p>strokeRect(x,y,width,height) Draws a rectangular outline</p>
<p>clearRect(x,y,width,height)</p>
<p>Clears the specified area and makes it fully</p>
<p>transparent</p>
<p>rect(x, y, width, height)</p>
<p>Adds a rectangular path to the path list</p>
<p>where <em>x</em> and <em>y</em> specify the position on the canvas
(relative to the origin) of the top-left corner of the rectangle.
<em>width</em> and <em>height</em> are pretty obvious.</p>
<p>Drawing function only handler the sketching. If you want to apply
colors to a shape, there are two important properties to use:
<strong>fillStyle</strong> and <strong>strokeStyle</strong>. Basically
strokeStyle is used for setting the shape outline color and fillStyle is
for the fill color. Color codes can be a string representing a CSS color
value, a gradient object, or a pattern object. We'll look at gradient
and pattern objects later. By default, the stroke and fill color are set
to black (CSS color value #000000). For example,</p>
<p>obj.fillStyle = "orange";</p>
<p>obj.fillStyle = "#FFA500";</p>
<p>obj.fillStyle = "rgb(255,165,0)";</p>
<p>obj.fillStyle = "rgba(255,165,0,1)";</p>
<p>All the above generates exactly the same color.</p>
<p>The rgb() function has syntax of:</p>
<p>rgb(redvalue, greeValue, blueValue);</p>
<p>Each color value is between 0 and 255.</p>
<p>The <strong>rgba()</strong> function is similar to the
<strong>rgb()</strong> function but it has one extra parameter.</p>
<p>rgba(redvalue, greeValue, blueValue, transparencyValue);</p>
<p>The last parameter of rgba() sets the transparency value of this
particular color. The valid range is from 0.0 (fully transparent) to 1.0
(fully opaque).</p>
<p>To draw an rectangle with red color, use:</p>
<p>obj.fillStyle = "rgb(255, 0, 0)"; // define color</p>
<p>obj.fillRect (10, 10, 100, 100); // sketching</p>
<p>Currently canvas only supports one primitive shape -
<strong>rectangles</strong>. All other shapes must be created by
combining one or more paths.</p>
<p>The drawing</p>
<p>Shapes, such as polygon, are sketched using drawing path with some of
the following functions.</p>
<p>path</p>
<p>•</p>
<p><strong>beginPath()</strong>: creates a path</p>
<p>•</p>
<p><strong>closePath()</strong>: close the shape by drawing a straight
line from the current point to the start</p>
<p>•</p>
<p><strong>stroke()</strong>: draw an outlined shape</p>
<p>•</p>
<p><strong>fill()</strong>: paint a solid shape</p>
<p>When calling the fill() method any open shapes will be closed
automatically and it isn’t necessary to use the closePath() method. The
following code, for example, will not formed a closed rectangle.</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(10,50);</p>
<p>obj.lineTo(10,10);</p>
<p>Game Programming – Penn Wu</p>
<p>251</p>
<p><span id="index_split_013.html#p252"></span><img
src="index-252_1.png" class="calibre5" alt="Image 207" /></p>
<p>obj.lineTo(110,10);</p>
<p>obj.lineTo(110,50);</p>
<p>obj.stroke();</p>
<p>The output looks like:</p>
<p>The following code draws a triangle with filled color in red.</p>
<p>&lt;!--This code uses ExplorerCanvas, developed by Google
Inc.--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"</p>
<p>src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p>obj.fillStyle = "rgba(255, 0, 0)";</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(100,10);</p>
<p>obj.lineTo(50,150);</p>
<p>obj.lineTo(100,200);</p>
<p>obj.fill();</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();"&gt;</p>
<p>&lt;canvas id="sqr" width="600" height="200"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>One important thing to know is that the stroke() function always
display the line in black, so the <strong>fillStyle</strong> project in
the following code will not display the lines in red.</p>
<p>obj.fillStyle = "rgb(255, 0, 0)";</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(100,10);</p>
<p>obj.lineTo(50,150);</p>
<p>obj.lineTo(100,200);</p>
<p>obj.stroke();</p>
<p>When the canvas is initialized or the beginPath method is called, the
starting point is defaulted to the coordinate (0,0). The
<strong>moveTo()</strong> function defines the starting point. You can
probably best think of this as lifting a pen or pencil from one spot on
a piece of paper and placing it on the next.</p>
<p>The syntax is:</p>
<p>moveTo(x, y)</p>
<p>where x and y are the coordinates of the new starting point.</p>
<p>The lineTo method draws straight lines, and the syntax is:</p>
<p>Game Programming – Penn Wu</p>
<p>252</p>
<p><span id="index_split_013.html#p253"></span><img
src="index-253_1.png" class="calibre5" alt="Image 208" /></p>
<p><img src="index-253_2.png" class="calibre5" alt="Image 209" /></p>
<p>lineTo(x, y)</p>
<p>where x and y are the coordinates of the line's end point.</p>
<p>The following draws two triangles.</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(100,10);</p>
<p>obj.lineTo(50,150);</p>
<p>obj.lineTo(150,50);</p>
<p>obj.lineTo(100,200);</p>
<p>obj.fill();</p>
<p>The <strong>arc()</strong> method draws arcs or circles. The syntax
is:</p>
<p>arc(x, y, radius, startAngle, endAngle, anticlockwise);</p>
<p>where x and y are the coordinates of the circle's center. Radius is
self explanatory. The startAngle and endAngle parameters define the
start and end points of the arc in radians. The starting and closing
angle are measured from the x axis. The anticlockwise parameter is a
boolean value which when true draws the arc anticlockwise, otherwise in
a clockwise direction.</p>
<p>For example, to draw an arc with a center (100, 100) and a radius of
50, use:</p>
<p>&lt;!--This code uses ExplorerCanvas, developed by Google
Inc.--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"</p>
<p>src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>var i = 0;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p><strong>obj.arc(100, 100, 50, 2 , Math.PI+(Math.PI*i)/2,
true);</strong></p>
<p>obj.stroke();</p>
<p>}</p>
<p>i+=0.1;</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();" onKeyDown="init()"&gt;</p>
<p>&lt;canvas id="sqr" width="600"</p>
<p>height="600"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>Angles in the arc function are measured in radians, not degrees. To
convert degrees to radians you can use the following JavaScript
expression:</p>
<p>var radians = (Math.PI/180)*degrees</p>
<p>Game Programming – Penn Wu</p>
<p>253</p>
<p><span id="index_split_013.html#p254"></span></p>
<p>Review</p>
<p>1. Which statement is correct?</p>
<p>Questions</p>
<p>A. The canvas element is part of HTML5 and allows for dynamic
scriptable rendering of bitmap images.</p>
<p>B. The canvas element consists of a drawable region defined in HTML
code with height and width attributes.</p>
<p>C. Internet Explorer 6 and 7 do not support the canvas element.</p>
<p>D. All of the above.</p>
<p>2. Google provides the __ library that brings the canvas element to
Internet Explorer.</p>
<p>A. iCanvas</p>
<p>B. J3DJS</p>
<p>C. JSON</p>
<p>D. AJAX</p>
<p>3. Given the following code, which statement is correct?</p>
<p>obj.fillRect(10, 10, 100, 100);</p>
<p>A. The top-left corner of the rectangle is (100, 100).</p>
<p>B. The top-left corner of the rectangle is (10, 10).</p>
<p>C. It generates a square that has width and height of 10 pixels
each.</p>
<p>D. It generates a rectangle that has a width of 10 pixels and height
of 100 pixels.</p>
<p>4. Which defines a drawing ground that has a width of 400 pixels and
height of 300 pixels?</p>
<p>A. &lt;canvas id="sqr"&gt;&lt;td width="400"
height="300"&gt;&lt;/td&gt;&lt;/canvas&gt; B. &lt;canvas id="sqr"
size="300*400"&gt;&lt;/canvas&gt; C. &lt;canvas id="sqr" width="400"
height="300"&gt;&lt;/canvas&gt; D. &lt;canvas id="sqr" w="400"
h="300"&gt;&lt;/canvas&gt; 5. Which function draws a rectangular
outline?</p>
<p>A. fillRect()</p>
<p>B. strokeRect()</p>
<p>C. clearRect()</p>
<p>D. rect()</p>
<p>6. Given the following code with error in it, how will you correct
the error?</p>
<p>obj.fillStyle = "rgba(255,105,10,2)";</p>
<p>A. Change rgba to rgb and keep the rest.</p>
<p>B. remove 2 and the comma before it; keep the rest.</p>
<p>C. change 2 to any value in the range from 0.0 to 1.0.</p>
<p>D. add the # sign before every number.</p>
<p>7. Given the following code segment, the color of line is __.</p>
<p>obj.fillStyle = "rgb(255, 0, 0)";</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(100,10);</p>
<p>obj.lineTo(50,150);</p>
<p>obj.stroke();</p>
<p>A. red</p>
<p>B. black</p>
<p>C. while</p>
<p>D. orange</p>
<p>Game Programming – Penn Wu</p>
<p>254</p>
<p><span id="index_split_013.html#p255"></span></p>
<p>8. Given the following code, __.</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(10,50);</p>
<p>obj.lineTo(10,10);</p>
<p>obj.lineTo(110,10);</p>
<p>obj.lineTo(110,50);</p>
<p>obj.stroke();</p>
<p>A. It creates a closed rectangle.</p>
<p>B. It creates a closed triangle.</p>
<p>C. It creates a closed square.</p>
<p>D. None of the above.</p>
<p>9. Given the following code, __.</p>
<p>obj.arc(100, 100, 50, 2 , Math.PI+(Math.PI*i)/2, true);</p>
<p>A. the center of the arc is (50, 2).</p>
<p>B. the radius is 50.</p>
<p>C. the starting point is (100, 100).</p>
<p>D. the ending point is (100, 50).</p>
<p>10. To convert degrees to radians you can use the following
JavaScript expression: A. var radians = (Math.PI/180)*degrees</p>
<p>B. var radians = Math.PI+(Math.PI*180)/2</p>
<p>C. var radians = (Math.PI/360)*degrees</p>
<p>D. var radians = Math.PI+(Math.PI*360)/2</p>
<p>Game Programming – Penn Wu</p>
<p>255</p>
<p><span id="index_split_013.html#p256"></span></p>
<p>Lab #14</p>
<p>Using Canvas and ExplorerCanvas</p>
<p>Preparation #1:</p>
<p>1. Create a new directory c:\cis261 if it does not exist.</p>
<p>2. Use Internet Explorer to go to
http://business.cypresscollege.edu/~pwu/cis261/files/lab14.zip to
download lab14.zip to the c:\cis261 directory. Extract the excanvas.js
file to C:\cis261 directory.</p>
<p>Learning Activity #1:</p>
<p>1. Change to the C:\cis261 directory.</p>
<p>2. Use Notepad to create a new file named C:\cis261\lab14_1.htm, with
the following:</p>
<p>&lt;!-- This code uses ExplorerCanvas, developed by Google Inc.
--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"
src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>var x=100;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p>obj.fillStyle = "rgb(255, 0, 0)";</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(100,10);</p>
<p>obj.lineTo(x,150);</p>
<p>obj.lineTo(100,200);</p>
<p>obj.fill();</p>
<p>}</p>
<p>if (x&lt;=10) { window.location=window.location; }</p>
<p>x--;</p>
<p>setTimeout("init()", 10);</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();"&gt;</p>
<p>&lt;canvas id="sqr" width="600" height="200"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>3. Test the program. A triangle will grow in size.</p>
<p>Learning Activity #2</p>
<p>1. Use Notepad to create a new file named C:\cis261\lab14_2.htm, with
the following:</p>
<p>&lt;!-- This code uses ExplorerCanvas, developed by Google Inc.
--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"
src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>256</p>
<p><span id="index_split_013.html#p257"></span><img
src="index-257_1.png" class="calibre5" alt="Image 210" /></p>
<p>var y=200;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(10,200);</p>
<p>obj.lineTo(10,10);</p>
<p>obj.lineTo(110,10);</p>
<p>obj.lineTo(110,200);</p>
<p>obj.stroke();</p>
<p>obj.beginPath();</p>
<p>obj.moveTo(10,y);</p>
<p>obj.lineTo(110,y);</p>
<p>obj.stroke();</p>
<p>}</p>
<p>if (y &lt;= 10) { y=10; clearTimeout(s1);}</p>
<p>else { y--; }</p>
<p>s1 = setTimeout("init()", 10);</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();"&gt;</p>
<p>&lt;canvas id="sqr" width="600" height="200"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>2. Test the program. A sample output looks:</p>
<p>Learning Activity #3</p>
<p>1. Use Notepad to create a new file named C:\cis261\lab14_3.htm, with
the following:</p>
<p>&lt;!-- This code uses ExplorerCanvas, developed by Google Inc.
--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"
src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>var i = 1;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p>Game Programming – Penn Wu</p>
<p>257</p>
<p><span id="index_split_013.html#p258"></span> obj.arc(100, 100, 50, 0
, (Math.PI/180)*i, false); obj.stroke();</p>
<p>}</p>
<p>if (i&gt;=360) { window.location=window.location; }</p>
<p>i++;</p>
<p>setTimeout("init()", 10);</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();"&gt;</p>
<p>&lt;canvas id="sqr" width="600" height="600"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>2. Test the program. Watch a small arc grow into a circle.</p>
<p>Learning Activity #4</p>
<p>1. Use Notepad to create a new file named C:\cis261\lab14_4.htm, with
the following:</p>
<p>&lt;!-- This code uses ExplorerCanvas, developed by Google Inc.
--&gt;</p>
<p>&lt;html&gt;&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"
src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>function init() {</p>
<p>var sid = document.getElementById("sqr");</p>
<p>if (sid.getContext) {</p>
<p>var obj = sid.getContext("2d");</p>
<p>obj.fillStyle = "rgb(255, 0, 0)";</p>
<p>for (i=0;i&lt;4;i++){</p>
<p>for(j=0;j&lt;3;j++){</p>
<p>obj.beginPath();</p>
<p>var x = 25+j*50; // x coordinate</p>
<p>var y = 25+i*50; // y coordinate</p>
<p>var radius = 20; // Arc radius</p>
<p>var startAngle = 0; // Starting point on circle var endAngle =
Math.PI+(Math.PI*j)/2; // End point on circle var anticlockwise = i%2==0
? false : true; // clockwise or anticlockwise
obj.arc(x,y,radius,startAngle,endAngle, anticlockwise);</p>
<p>if (i&gt;1){</p>
<p>obj.fill();</p>
<p>} else {</p>
<p>obj.stroke();</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();"&gt;</p>
<p>&lt;canvas id="sqr" width="600" height="200"&gt;&lt;/canvas&gt; Game
Programming – Penn Wu</p>
<p>258</p>
<p><span id="index_split_013.html#p259"></span><img
src="index-259_1.png" class="calibre5" alt="Image 211" /></p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>2. Test the program. A sample output looks:</p>
<p>Learning Activity #5:</p>
<p>1. Use Notepad to create a new file named C:\cis261\lab14_5.htm, with
the following:</p>
<p>&lt;!-- This code uses ExplorerCanvas, developed by Google Inc.
--&gt;</p>
<p>&lt;html&gt;</p>
<p>&lt;meta http-equiv="refresh" content="1"&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;!--[if IE]&gt;&lt;script type="text/javascript"
src="excanvas.js"&gt;&lt;/script&gt;&lt;![endif]--&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>var k = Math.floor(Math.random()*50);</p>
<p>function init() {</p>
<p>var obj = document.getElementById('sqr').getContext('2d');</p>
<p>obj.translate(75,75);</p>
<p>for (i=1;i&lt;8;i++){ // Loop through rings (from inside to out)
obj.save();</p>
<p>obj.fillStyle = 'rgb('+(k*i)+','+(255-k*i)+','+(255-k*i)+')';</p>
<p>for (j=0;j&lt;i*6;j++){ // draw individual dots</p>
<p>obj.rotate(Math.PI*2/(i*6));</p>
<p>obj.beginPath();</p>
<p>obj.arc(0,i*9.5,5,0,Math.PI*2,true);</p>
<p>obj.fill();</p>
<p>}</p>
<p>obj.restore();</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;&lt;/head&gt;</p>
<p>&lt;body onload="init();" onKeyDown="init()"&gt;</p>
<p>&lt;canvas id="sqr"&gt;&lt;/canvas&gt;</p>
<p>&lt;/body&gt;&lt;/html&gt;</p>
<p>2. Test the program. A sample output looks:</p>
<p>Game Programming – Penn Wu</p>
<p>259</p>
<p><span id="index_split_013.html#p260"></span><img
src="index-260_1.png" class="calibre5" alt="Image 212" /></p>
<p><strong></strong></p>
<p><strong>Submittal</strong></p>
<p>Upon completing all the learning activities,</p>
<p>1. Upload all files you created in this lab to your remote web
server.</p>
<p>2. Log in to to Blackboard, launch Assignment 14, and then scroll
down to question 11.</p>
<p>3. Copy and paste the URLs to the textbox. For example,</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab14_1.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab14_2.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab14_3.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab14_4.htm</p>
<p>•</p>
<p>http://www.geocities.com/cis261/lab14_5.htm</p>
<p>No credit is given to broken link(s).</p>
<p>Game Programming – Penn Wu</p>
<p>260</p>
<p><span id="index_split_013.html#p261"></span><img
src="index-261_1.png" class="calibre5" alt="Image 213" /></p>
<p>Lecture #15</p>
<p>Multiple Player Games</p>
<p><span id="index_split_014.html"></span></p>
<h2 class="calibre2"
id="index_split_014.html#calibre_pb_13">Introduction</h2>
<p>A multiplayer game is a game which is played by two or more players.
The players might be independent opponents, formed into teams or be just
a single team pitted against the game.</p>
<p>JavaScript is not an ideal language for multiplayer games because its
code is downloaded locally to the player’s computer. To make sure each
player can see other player’s move, the game code should be written with
a server-side language (such as PHP or ASP.NET) that collect and process
data from each player’s computer and present the output on each player’s
browser.</p>
<p>So you make your move, and your HTML/JavaScript sends form data to
your server script. The script records this move and sends back a web
page containing updated display. At this point, if the other player
refreshes his screen, they will see the same web page as you.
Alternatively you can send back a page that automatically refreshes
using metarefresh or JavaScript timer.</p>
<p>If you just use JavaScript, the results are only visible on your
computer - there must be a central point that both of you can look at
and the only way is a server web page.</p>
<p>Although this lecture chooses to use PHP and MySQL to explain how a
networked game is programmed and played through the Web, PHP and SQL
(using MySQL) programming is beyond the scope of this course.</p>
<p>Standalone</p>
<p>A standalone multiplayer game does not require a computer network.
Players can download the multiplayer</p>
<p>game codes and play it locally with multiple sources of user inputs.
This lecture discusses two game</p>
<p>popular modes:</p>
<p>•</p>
<p>One player at a time.</p>
<p>•</p>
<p>Simultaneous gameplay.</p>
<p>In the simultaneous gameplay mode, two or more players play
simultaneously by sending user inputs to the same signal receiver.
Consider the following example, which allows two players to race the
horseback riding. A screen (which is a browser window) contains two
panels, each supports an individual player. Each player presses a
particular key once to start the running of the horse.</p>
<p>The coding mechanism is simple.</p>
<p>function keyed() {</p>
<p>if(event.ctrlKey) {</p>
<p>if(i==0) { horse1(); i++; }</p>
<p>}</p>
<p>if(event.keyCode==39) {</p>
<p>if(j==0) { horse2(); j++; }</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>261</p>
<p><span id="index_split_014.html#p262"></span></p>
<p>status = hrs1.style.pixelWidth;</p>
<p>}</p>
<p>..............</p>
<p>&lt;body onLoad="init()" onKeyDown="keyed()"&gt; When any of the two
players presses the designated key (Shift or the → arrow key), the
<strong>keyed()</strong> function will calls the
<strong>horse1()</strong> or <strong>horse2()</strong> functions
accordingly. The horse1() function, for example, will move the first
horse (with an ID “<strong>hrs1</strong>”) at a speed of either 1 pixel
or 2 pixels per 50 milliseconds towards the right. The movement is
terminated when hrs1 hits the right border of the panel it belongs
to.</p>
<p>function horse1() {</p>
<p>if ( hrs1.style.pixelLeft + hrs1.style.pixelWidth &gt;=</p>
<p>player1.style.pixelWidth) {</p>
<p>clearTimeout(s2); // terminate hrs2</p>
<p>clearTimeout(s1); // terminate hrs1</p>
<p>}</p>
<p>else { hrs1.style.pixelLeft += Math.floor(Math.random()*2)+1;</p>
<p>s1 = setTimeout("horse1()", 50); }</p>
<p>}</p>
<p>Notice that there are two clearTimeout() methods used in the above
code. One is used to terminate hrs1, while the other terminates
hrs2.</p>
<p>In the one-player-at-a-time mode, the programmer’s job is to find a
way to count the player’s turns. The programming trick is technically
simple. Declare a variable that counts how many times the game has been
restarted. In a two-player situation, the number is either an odd or
even number. When the number is odd, it is the first player’s turn, when
the number is even, it is the second player’s turn.</p>
<p>Consider the following code sample,</p>
<p>...............</p>
<p>var player_turn;</p>
<p>...............</p>
<p>function player() {</p>
<p>player_turn++;</p>
<p>ball.style.display = "inline"</p>
<p>ball.style.pixelTop = 0;</p>
<p>ball.style.pixelLeft = Math.floor(Math.random()*250);</p>
<p>moveBall();</p>
<p>if (player_turn%2 == 0) {</p>
<p>p1.innerText = 2;</p>
<p>area.style.backgroundColor="yellow";</p>
<p>ball.style.backgroundColor="blue";</p>
<p>}</p>
<p>else {</p>
<p>p1.innerText = 1;</p>
<p>area.style.backgroundColor="#abcdef";</p>
<p>ball.style.backgroundColor="red";</p>
<p>}</p>
<p>}</p>
<p>................</p>
<p>&lt;button onClick="player()"</p>
<p>style="position:absolute;top:400"&gt;Change Hand&lt;/button&gt;</p>
<p>................</p>
<p>Game Programming – Penn Wu</p>
<p>262</p>
<p><span id="index_split_014.html#p263"></span><img
src="index-263_1.png" class="calibre5" alt="Image 214" /></p>
<p><img src="index-263_2.png" class="calibre5" alt="Image 215" /></p>
<p>In this code, the variable <strong>player_turn</strong> is
incremented by 1 each time when the <strong>player()</strong> function
is called by clicking the button. The following statement checks if the
current value is an even number.</p>
<p>if (player_turn%2 == 0) {</p>
<p>If so, the following statements will indicate that it is the second
player’s turn, and the background color is changed to yellow, while the
ball is changed to blue.</p>
<p>p1.innerText = 2;</p>
<p>area.style.backgroundColor="yellow";</p>
<p>ball.style.backgroundColor="blue";</p>
<p>If the current number is an odd number, the computer will know it is
the first player’s turn and carry out the following code segement.</p>
<p>p1.innerText = 1;</p>
<p>area.style.backgroundColor="#abcdef";</p>
<p>ball.style.backgroundColor="red";</p>
<p>The following outputs will thus display alternatively on the
screen.</p>
<p>Player 1</p>
<p>Player 2</p>
<p>Online</p>
<p>Networked games have existed for the last decade but their underlying
software architectures (Networked)</p>
<p>have been poorly designed with little in the way of reusability. A
networked game is a software multiplayer</p>
<p>system in which multiple users interact with each other in real-time,
even though those users may game</p>
<p>be physically located around the world.</p>
<p>Typically, each user accesses his/her own computer workstation or
console, using it to provide a user interface to the game environment.
These environments usually aim to provide users with a sense of realism
by incorporating realistic 3D graphics, spatial sound &amp; other
modalities to create an immersive experience.</p>
<p>Usually there is a server that synchronizes the game data among
users. One can try to understand this model through the analogy of a
database model used in the airport. In an airport terminal, crew members
work on different workstations to assign seat numbers to airplane
passengers.</p>
<p>When one crew member confirms and secures a seat for a passenger
through a workstation, the workstation will immediately transmits the
data to the server. The server will simultaneously notify each every
other workstation that a seat is taken, and consequently each seat is
assigned to one and the only one passenger.</p>
<p>Networked game typically must integrate with database systems that
store persistent information about the game environment. These databases
include, for example, detailed information about the environment’s
terrain elevation, the location of buildings and other static items in
the environment, and the initial Networked game configuration.</p>
<p>Game Programming – Penn Wu</p>
<p>263</p>
<p><span id="index_split_014.html#p264"></span></p>
<p>In a networked multiplayer game, each player makes movements and
actively responds to the game themes. There will be many data (each
player generates some of them) to be exchanged, processed, and
calculated by the centralized control server and each participant
computer.</p>
<p>Server</p>
<p>Client1</p>
<p>Client2</p>
<p>Client3</p>
<p>………</p>
<p>Client <em>n</em></p>
<p>.</p>
<p>In this model, clients (workstation) must maintain a live (active)
connection with the server for bilateral (two-way) communication. Data
can then transmit from the client to the server and vice versa
simultaneously.</p>
<p>A networked multiplayer game is a game that accepts inputs from
multiple sources. Consider the following game code, in which one can use
the Shift and Control keys to control the Up and Down direction of an
object (e.g. a red square), the other uses and ↑ and ↓ arrow keys to
controls the second object (e.g. a blue square). Although the input
device is the same--keyboard, there are two sources of user input.</p>
<p>&lt;script&gt;</p>
<p>function move() {</p>
<p>document.body.focus();</p>
<p>// red</p>
<p>if (event.shiftKey) { red.style.pixelTop --; }</p>
<p>else if (event.ctrlKey) { red.style.pixelTop ++; }</p>
<p>// blue</p>
<p>switch (event.keyCode) {</p>
<p>case 38:</p>
<p>blue.style.pixelTop --; break;</p>
<p>case 40:</p>
<p>blue.style.pixelTop ++; break;</p>
<p>}</p>
<p>}</p>
<p>.........</p>
<p>&lt;/script&gt;</p>
<p>Two players can simultaneously use two set of keys to control two
individual objects. However, both players must look at the same screen
and use the same keyboard. This is a physical limitation of JavaScript,
as a client-side scripting language.</p>
<p>A popular solution to this physical boundary is the so-called AJAX
(<strong>A</strong>synchronous <strong>J</strong>avaScript
<strong>A</strong>nd <strong>X</strong>ML), which combines the
technologies of HTML, CSS, JavaScript, DHTML, and DOM</p>
<p>(Document Object Model) with an ability to work with server-side
scripting language. The core technology is the implementation of
<strong>XMLHttpRequest</strong> object allows web programmers to
retrieve data from the web server as a background activity.</p>
<p>When used in game programming, AJAX has four main components.
JavaScript defines game rules and program flow. The Document Object
Model and Cascading Style Sheets set the appearance in response to data
fetched in the background from the server by the XMLHttpRequest
object.</p>
<p>Consider the following code segment,</p>
<p>Game Programming – Penn Wu</p>
<p>264</p>
<p><span id="index_split_014.html#p265"></span></p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>var xmlhttp=false;</p>
<p>if (!xmlhttp &amp;&amp; typeof XMLHttpRequest!='undefined') {</p>
<p>xmlhttp = new XMLHttpRequest();</p>
<p>}</p>
<p>function ajax_call() {</p>
<p>xmlhttp.open("GET", 'http://cis261.comyr.com/sqrgame.php?x1=' +</p>
<p>document.getElementById('red').style.pixelLeft +</p>
<p>'&amp;y1=' + document.getElementById('red').style.pixelTop +</p>
<p>'&amp;x2=' + document.getElementById('blue').style.pixelLeft +</p>
<p>'&amp;y2=' + document.getElementById('blue').style.pixelTop , true);
xmlhttp.onreadystatechange=function() {</p>
<p>if (xmlhttp.readyState==4) {</p>
<p>document.getElementById('bt').innerHTML = xmlhttp.responseText;</p>
<p>}</p>
<p>}</p>
<p>xmlhttp.send(null)</p>
<p>return false;</p>
<p>}</p>
<p>.............</p>
<p>&lt;/script&gt;</p>
<p>.............</p>
<p>&lt;p id="bt"&gt;&lt;/p&gt;</p>
<p>The following is a valid URL that links the instructor’s demo
site.</p>
<p>http://cis261.comyr.com/sqrgame.php</p>
<p>In the above example, when the ajax_call() function is called, the
client browser will attach four parameters (x1, y1, x2, and y2) to the
URL, as shown below. Each parameter represents the current coordinate
pair of the red and blue square.</p>
<p>http://cis261.comyr.com/sqrgame.php?x1=21&amp;y1=74&amp;x2=159&amp;y2=367</p>
<p>The GET method, specified in the xmlhttp.open() method delivers these
four parameter and their associated values to the web server (which is
the host “cis261.comyr.com” in this case), and then particularly to the
“sqrgame.php” server-side script. The source code of “sqrgame.php”,
written in PHP, looks:</p>
<p>&lt;?php</p>
<p>$x1=$_GET["x1"];</p>
<p>$y1=$_GET["y1"];</p>
<p>$x2=$_GET["x2"];</p>
<p>$y2=$_GET["y2"];</p>
<p>$con = mysql_connect("localhost","
<em><strong>MyUserID</strong></em>","
<em><strong>MyPassWord</strong></em>"); if( mysql_select_db("
<em><strong>DatabaseName</strong></em>") )</p>
<p>{</p>
<p>$sql = "UPDATE Coords set x1='$x1', y1='$y1', x2='$x2', y2='$y2'
where cid='c1'";</p>
<p>$query = mysql_query($sql);</p>
<p>$sql2 = mysql_query("select * from Coords where cid='c1'"); if($sql2)
{</p>
<p>while($row = mysql_fetch_array($sql2)){</p>
<p>Game Programming – Penn Wu</p>
<p>265</p>
<p><span id="index_split_014.html#p266"></span> echo $row['x1']
.":".$row['y1'].":".$row['x2'].":".$row['y2'].":";</p>
<p>}</p>
<p>}</p>
<p>mysql_close();</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>die( "Error! Could not connect the database: " . mysql_error() );</p>
<p>}</p>
<p>?&gt;</p>
<p>The following reads the HTTPREQUEST value sent by the client browser,
which is</p>
<p>“http://cis261.comyr.com/sqrgame.php?x1=21&amp;y1=74&amp;x2=159&amp;y2=367”</p>
<p>$x1=$_GET["x1"];</p>
<p>$y1=$_GET["y1"];</p>
<p>$x2=$_GET["x2"];</p>
<p>$y2=$_GET["y2"];</p>
<p>Consequently, 21 is assigned to the PHP variable $x1, 74 to $y1, 159
to $x2, and 367 to $y2. The following SQL-embedded PHP statement, at the
server side, will replace the variables with correct values.</p>
<p>UPDATE Coords set x1='$x1', y1='$y1', x2='$x2', y2='$y2'</p>
<p>where cid='c1'</p>
<p>In other words, the PHP interpreter converts the above line to the
following, and passes the completed SQL statement to MySQL server.</p>
<p>UPDATE Coords set x1=<strong>21</strong>, y1=<strong>74</strong>,
x2=<strong>159</strong>, y2=<strong>367</strong> where cid='c1'</p>
<p>The MySQL server then stores these data into a table named “Coords”.
A visualization of the table is:</p>
<p>mysql&gt; select * from Coords where cid='c1';</p>
<p>+-----+----+----+-----+-----+</p>
<p>| cid | x1 | y1 | x2 | y2 |</p>
<p>+-----+----+----+-----+-----+</p>
<p>| <strong>c1 | 21 | 74 | 159 | 367</strong> |</p>
<p>+-----+----+----+-----+-----+</p>
<p>2 rows in set (0.00 sec)</p>
<p>The following SQL-embedded PHP statements will retrieve the newly
added values of x1, y2, x2, and y2, and output them to the receiver. The
receiver, in this case, is the <strong>ajax_call()</strong> method on
the client side.</p>
<p>$sql2 = mysql_query("select * from Coords where cid='c1'"); if($sql3)
{</p>
<p>while($row = mysql_fetch_array($sql3)){</p>
<p><strong>echo $row['x1'].":".$row['y1'].":".$row['x2'].":".$row['y2'].
":";</strong></p>
<p>}</p>
<p>}</p>
<p>The echo command outputs the values to the xmlhttp.
<strong>responseText</strong> property (of the ajax_call() method) in a
pattern similar to the following. In other words, the new value of
xmlhttp.responseText is:</p>
<p>21:74:159:367:</p>
<p>Game Programming – Penn Wu</p>
<p>266</p>
<p><span id="index_split_014.html#p267"></span>The programmer can then
write JavaScript code to separate the string value
“<strong>21:74:159:367:</strong>”</p>
<p>into an array. For example,</p>
<p>var str = xmlhttp.responseText;</p>
<p>var crd = str.split(":");</p>
<p>The <strong>split()</strong> method is used to split a string into an
array of strings. The syntax is: <em>ObjectID</em>.split(
<em>separator</em>);</p>
<p>After going through the splitting, the string value
“<strong>21:74:159:367:</strong>” is broken down to four elements: 21,
74, 159, and 367. The following statement</p>
<p>var crd = str.split(":");</p>
<p>is equivalent to</p>
<p>var crd= new Array(21, 74, 159, 367);</p>
<p>To retrieve the values of each element, use <strong>crd[0]</strong>,
<strong>crd[1]</strong>, <strong>crd[2]</strong>, and
<strong>crd[3]</strong>. Consequently, the xmlhttp.
<strong>onreadystatechange</strong> property will, based on the
following DHTML statements, assign the initial value of the (x, y)
coordinates to the red and blue squares and send them to the client
browser, each time when the player access the game.</p>
<p>function init() {</p>
<p>...........</p>
<p>xmlhttp.onreadystatechange=function() {</p>
<p>...........</p>
<p>var str = xmlhttp.responseText;</p>
<p>...........</p>
<p>code = "&lt;span id='red' style='background-</p>
<p>Color:red;left:"+<strong>crd[0]</strong>+";top:"+<strong>crd[1]</strong>+"'&gt;&lt;/span&gt;";
code += "&lt;span id='blue'
style='backgroundColor:blue;left:"+<strong>crd[2]</strong>+";top:"+<strong>crd[3]</strong>+"'&gt;&lt;/span&gt;";
bd.innerHTML = code;</p>
<p>.......</p>
<p>}</p>
<p>}</p>
<p>.......</p>
<p>&lt;body id="bd" onLoad=" <strong>init()</strong>"
onKeyDown="move()"&gt; To build a new MySQL database with a new table
using PHP with embedded SQL statements, use:</p>
<p>&lt;?php</p>
<p>$con = mysql_connect("localhost","sqr_game","cis261"); if (!$con)</p>
<p>{</p>
<p>die('Could not connect: ' . mysql_error());</p>
<p>}// Create database</p>
<p>if (mysql_query("CREATE DATABASE sqr_game",$con))</p>
<p>{</p>
<p>echo "Database created";</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>echo "Error creating database: " . mysql_error();</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>267</p>
<p><span id="index_split_014.html#p268"></span>// Create table</p>
<p>mysql_select_db("a6732376_game", $con);</p>
<p>$sql = "CREATE TABLE Coords</p>
<p>(</p>
<p>cid varchar(15) NOT NULL,</p>
<p>x1 int NOT NULL,</p>
<p>y1 int NOT NULL,</p>
<p>x2 int NOT NULL,</p>
<p>y2 int NOT NULL</p>
<p>)";</p>
<p>// Execute query</p>
<p>mysql_query($sql,$con);</p>
<p>mysql_close($con); // destroy the connection to database</p>
<p>?&gt;</p>
<p>When the game is involved in database, the network-based delays can
be very significant. These network delays are particularly difficult to
handle when multiple users or components interact with each other
directly.</p>
<p>For example, a network game must support accurate collision
detection, agreement, and resolution among participants. Accurate
collision detection is difficult because at any given point in time, no
user has accurate information about the other users’ current positions;
as we have seen, the network delay means that all received information
is out-of-date.</p>
<p>It is possible, therefore, that one user might conclude, based on
stale information, which a collision occurred, while, in fact, the other
user actually moved to avoid the collision during the network delay
period.</p>
<p>Game Programming – Penn Wu</p>
<p>268</p>
<p><span id="index_split_014.html#p269"></span></p>
<p>Lab #15</p>
<p>Multiple Player Games</p>
<p>Learning Activity #1: A simple two-player game</p>
<p>1. Use Notepad to create a new text file named lab15_1.htm, with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>div { height:200; border:solid 1 black; background-Color:#abcdef;
position: absolute;}</p>
<p>img { position:relative; }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var i=0; j=0;</p>
<p>function init() {</p>
<p>player1.style.pixelWidth = 400;</p>
<p>player2.style.pixelWidth = 400;</p>
<p>hrs1.style.pixelWidth = 30;</p>
<p>hrs2.style.pixelWidth = 30;</p>
<p>}</p>
<p>function keyed() {</p>
<p>if(event.ctrlKey) {</p>
<p>if(i==0) { horse1(); i++; }</p>
<p>}</p>
<p>if(event.keyCode==39) {</p>
<p>if(j==0) { horse2(); j++; }</p>
<p>}</p>
<p>status = hrs1.style.pixelWidth;</p>
<p>}</p>
<p>function horse1() {</p>
<p>if ( hrs1.style.pixelLeft + hrs1.style.pixelWidth &gt;=
player1.style.pixelWidth) {</p>
<p>clearTimeout(s2);</p>
<p>clearTimeout(s1);</p>
<p>}</p>
<p>else { hrs1.style.pixelLeft += Math.floor(Math.random()*2)+1;</p>
<p>s1 = setTimeout("horse1()", 50); }</p>
<p>}</p>
<p>function horse2() {</p>
<p>if ( hrs2.style.pixelLeft + hrs2.style.pixelWidth &gt;=
player2.style.pixelWidth) {</p>
<p>clearTimeout(s1);</p>
<p>clearTimeout(s2);</p>
<p>}</p>
<p>else { hrs2.style.pixelLeft += Math.floor(Math.random()*2)+1;</p>
<p>s2 = setTimeout("horse2()", 50); }</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>269</p>
<p><span id="index_split_014.html#p270"></span><img
src="index-270_1.png" class="calibre5" alt="Image 216" /></p>
<p>&lt;body onLoad="init()" onKeyDown="keyed()"&gt;</p>
<p>&lt;table border=0 width="100%"&gt;</p>
<p>&lt;tr&gt;</p>
<p>&lt;td&gt;Player 1&lt;/td&gt;&lt;td&gt;Player 2&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;tr&gt;</p>
<p>&lt;td width="50%"&gt;&lt;div id="player1"&gt;</p>
<p>&lt;img id="hrs1" src="hr.gif"&gt;</p>
<p>&lt;/div&gt;&lt;/td&gt;</p>
<p>&lt;td width="50%"&gt;&lt;div id="player2"&gt;</p>
<p>&lt;img id="hrs2" src="hr.gif"&gt;</p>
<p>&lt;/div&gt;&lt;/td&gt;</p>
<p>&lt;/tr&gt;</p>
<p>&lt;/table&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Test the program with Internet Explorer. Player 1 uses the “Ctrl”
key and player 2 use the → arrow key to start the game simultaneously. A
sample output looks:</p>
<p>Learning Activity #2: Two-player game – one player at a time</p>
<p>1. Use Notepad to create a new text file named lab15_2.htm, with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>div { position:absolute; width:300; height:300; border:solid 1 black;
left:10; }</p>
<p>span { position:relative; width:20; height:20; background-Color:
red}</p>
<p>hr { position:absolute; top:280}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var code="";</p>
<p>var player_turn;</p>
<p>function init() {</p>
<p>var i = Math.floor(Math.random()*250);</p>
<p>var j = Math.floor(Math.random()*280);</p>
<p>code = "&lt;span id='ball' style='left:"+j+"'&gt;&lt;/span&gt;"; code
+= "&lt;hr id='bar' size='3' width='50' color='black'
style='left:"+i+"'&gt;"; area.innerHTML = code;</p>
<p>Game Programming – Penn Wu</p>
<p>270</p>
<p><span id="index_split_014.html#p271"></span>
area.style.backgroundColor="#abcdef"; player_turn = 1;</p>
<p>p1.innerText = player_turn;</p>
<p>moveBall();</p>
<p>}</p>
<p>function moveBall() {</p>
<p>if (ball.style.pixelTop &gt;= 275) {</p>
<p>clearTimeout(s1);</p>
<p>ball.style.display = "none"</p>
<p>}</p>
<p>else if ((ball.style.pixelTop + ball.style.pixelHeight &gt;= 260)
&amp;&amp; (ball.style.pixelLeft &gt;= bar.style.pixelLeft)
&amp;&amp;</p>
<p>(ball.style.pixelLeft + 20 &lt;= bar.style.pixelLeft + 50))</p>
<p>{</p>
<p>ball.style.pixelTop = 0;</p>
<p>ball.style.pixelLeft = Math.floor(Math.random()*250);</p>
<p>}</p>
<p>else { ball.style.pixelTop += 2; }</p>
<p>s1 = setTimeout("moveBall()", 20);</p>
<p>}</p>
<p>function player() {</p>
<p>player_turn++;</p>
<p>ball.style.display = "inline"</p>
<p>ball.style.pixelTop = 0;</p>
<p>ball.style.pixelLeft = Math.floor(Math.random()*250);</p>
<p>moveBall();</p>
<p>if (player_turn%2 == 0) {</p>
<p>p1.innerText = 2;</p>
<p>area.style.backgroundColor="yellow";</p>
<p>ball.style.backgroundColor="blue";</p>
<p>}</p>
<p>else {</p>
<p>p1.innerText = 1;</p>
<p>area.style.backgroundColor="#abcdef";</p>
<p>ball.style.backgroundColor="red";</p>
<p>}</p>
<p>}</p>
<p>function moveBar() {</p>
<p>switch(event.keyCode) {</p>
<p>case 37:</p>
<p>if (bar.style.pixelLeft&lt;=10) { bar.style.pixelLeft = 10; }</p>
<p>else { bar.style.pixelLeft-=2; }</p>
<p>break;</p>
<p>case 39:</p>
<p>if (bar.style.pixelLeft &gt;= 250) { bar.style.pixelLeft = 250; }</p>
<p>else { bar.style.pixelLeft+=2; }</p>
<p>break;</p>
<p>}</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()" onKeyDown="moveBar()"&gt; Game Programming –
Penn Wu</p>
<p>271</p>
<p><span id="index_split_014.html#p272"></span><img
src="index-272_1.png" class="calibre5" alt="Image 217" /></p>
<p><img src="index-272_2.png" class="calibre5" alt="Image 218" /></p>
<p>&lt;div id="area"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;p style="position:absolute;top:350"&gt;Current Player: &lt;b
id="p1"&gt;&lt;/b&gt;&lt;/p&gt;</p>
<p>&lt;button onClick="player()"
style="position:absolute;top:400"&gt;Change Hand&lt;/button&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Test the program with Internet Explorer. A sample output looks:
Player 1</p>
<p>Player 2</p>
<p>Learning Activity #3:</p>
<p>1. Use Notepad to create a new text file named lab15_3.htm, with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span { position:absolute; width:20px; height:20px; }</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>function move() {</p>
<p>document.body.focus();</p>
<p>// red</p>
<p>if (event.shiftKey) { red.style.pixelTop --; }</p>
<p>else if (event.ctrlKey) { red.style.pixelTop ++; }</p>
<p>// blue</p>
<p>switch (event.keyCode) {</p>
<p>case 38:</p>
<p>blue.style.pixelTop --; break;</p>
<p>case 40:</p>
<p>blue.style.pixelTop ++; break;</p>
<p>}</p>
<p>}</p>
<p>function init() {</p>
<p>x1 = Math.floor(Math.random()*90) + 10;</p>
<p>y1 = Math.floor(Math.random()*140) + 10;</p>
<p>x2 = Math.floor(Math.random()*90) + 10;</p>
<p>y2 = Math.floor(Math.random()*140) + 10;</p>
<p>x3 = Math.floor(Math.random()*90) + 10;</p>
<p>y3 = Math.floor(Math.random()*140) + 10;</p>
<p>Game Programming – Penn Wu</p>
<p>272</p>
<p><span id="index_split_014.html#p273"></span><img
src="index-273_1.png" class="calibre5" alt="Image 219" /></p>
<p>red.style.pixelLeft = x1;</p>
<p>red.style.pixelTop = y1;</p>
<p>blue.style.pixelLeft = x2;</p>
<p>blue.style.pixelTop = y2;</p>
<p>green.style.pixelLeft = x3;</p>
<p>green.style.pixelTop = y3;</p>
<p>action();</p>
<p>}</p>
<p>var i=1;</p>
<p>var j=1;</p>
<p>var k=2;</p>
<p>function action() {</p>
<p>if (red.style.pixelTop &lt;=10 || red.style.pixelTop &gt;=150) {</p>
<p>i = i * -1;</p>
<p>}</p>
<p>if (blue.style.pixelTop &lt;=10 || blue.style.pixelTop &gt;=150)
{</p>
<p>j = j * -1;</p>
<p>}</p>
<p>if (green.style.pixelLeft &lt;=10 || green.style.pixelLeft &gt;=100)
{</p>
<p>k = k * -1;</p>
<p>}</p>
<p>red.style.pixelTop += i;</p>
<p>blue.style.pixelTop += j;</p>
<p>green.style.pixelLeft += k;</p>
<p>setTimeout("action()", 50);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()" onKeyDown="move();"&gt;</p>
<p>&lt;span id="red" style="background-Color:red;"&gt;&lt;/span&gt;</p>
<p>&lt;span id="blue"
style="background-Color:blue;"&gt;&lt;/span&gt;</p>
<p>&lt;span id="green" style="border: solid 1
green;"&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Test the program with Internet Explorer. A sample output looks:
Learning Activity #4: Networked Two-Player Game</p>
<p>1. Use Notepad to create a new text file named lab15_4.htm, with the
following contents: Game Programming – Penn Wu</p>
<p>273</p>
<p><span id="index_split_014.html#p274"></span></p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span {position:absolute; width:20; height:20}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>//var req=false;</p>
<p>var xmlhttp=false;</p>
<p>if (!xmlhttp &amp;&amp; typeof XMLHttpRequest!='undefined') {</p>
<p>xmlhttp = new XMLHttpRequest();</p>
<p>}</p>
<p>function ajax_call() {</p>
<p>xmlhttp.open("GET", 'http://cis261.comyr.com/sqrgame.php?x1=' +</p>
<p>document.getElementById('red').style.pixelLeft +</p>
<p>'&amp;y1=' + document.getElementById('red').style.pixelTop +</p>
<p>'&amp;x2=' + document.getElementById('blue').style.pixelLeft +</p>
<p>'&amp;y2=' + document.getElementById('blue').style.pixelTop , true);
xmlhttp.setRequestHeader("Content-Type", "text/html");
xmlhttp.onreadystatechange=function() {</p>
<p>if (xmlhttp.readyState==4) {</p>
<p>status = xmlhttp.responseText;</p>
<p>var str = xmlhttp.responseText;</p>
<p>var crd = str.split(":");</p>
<p>status = "red:("+crd[0]+", "+crd[1]+") blue:("+crd[2]+",
"+crd[3]+")";</p>
<p>}</p>
<p>}</p>
<p>xmlhttp.send(null)</p>
<p>return false;</p>
<p>setTimeout("ajax_call()",100);</p>
<p>}</p>
<p>function init() {</p>
<p>xmlhttp.open("GET", "http://cis261.comyr.com/sqrinit.php" , true);
xmlhttp.setRequestHeader("Content-Type", "text/html");
xmlhttp.onreadystatechange=function() {</p>
<p>if (xmlhttp.readyState==4) {</p>
<p>//status = xmlhttp.responseText;</p>
<p>var str = xmlhttp.responseText;</p>
<p>var crd = str.split(":");</p>
<p>status = "red:("+crd[0]+", "+crd[1]+") blue:("+crd[2]+",
"+crd[3]+")"; var code="";</p>
<p>code = "&lt;span id='red' style='background-</p>
<p>Color:red;left:"+crd[0]+";top:"+crd[1]+"'&gt;&lt;/span&gt;"; code +=
"&lt;span id='blue'
style='backgroundColor:blue;left:"+crd[2]+";top:"+crd[3]+"'&gt;&lt;/span&gt;";
bd.innerHTML = code;</p>
<p>}</p>
<p>}</p>
<p>Game Programming – Penn Wu</p>
<p>274</p>
<p><span id="index_split_014.html#p275"></span><img
src="index-275_1.png" class="calibre5" alt="Image 220" /></p>
<p>xmlhttp.send(null)</p>
<p>return false;</p>
<p>}</p>
<p>function move() {</p>
<p>if(event.shiftKey) {</p>
<p>switch(event.keyCode) {</p>
<p>case 37:</p>
<p>red.style.pixelLeft --; break;</p>
<p>case 39:</p>
<p>red.style.pixelLeft ++; break;</p>
<p>case 38:</p>
<p>red.style.pixelTop --; break;</p>
<p>case 40:</p>
<p>red.style.pixelTop ++; break;</p>
<p>}</p>
<p>}</p>
<p>if(event.ctrlKey) {</p>
<p>switch(event.keyCode) {</p>
<p>case 37:</p>
<p>blue.style.pixelLeft --; break;</p>
<p>case 39:</p>
<p>blue.style.pixelLeft ++; break;</p>
<p>case 38:</p>
<p>blue.style.pixelTop --; break;</p>
<p>case 40:</p>
<p>blue.style.pixelTop ++; break;</p>
<p>}</p>
<p>}</p>
<p>ajax_call();</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body id="bd" onLoad="init()" onKeyDown="move()"&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Test the program with Internet Explorer. Hold the Shift key and
press →, ↓, ↑, or → arrow keys to move the red square. Hold the Ctrl key
and press →, ↓, ↑, or → arrow keys to move the blue square. A sample
output looks: Game Programming – Penn Wu</p>
<p>275</p>
<p><span id="index_split_014.html#p276"></span>Learning Activity #5:</p>
<p>1. Use Notepad to create a new text file named lab15_5.htm, with the
following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;style&gt;</p>
<p>span { background-Color: white; border:solid 1 black;</p>
<p>width:50; height:50; text-align:center;</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script&gt;</p>
<p>var req;</p>
<p>var code = "";</p>
<p>var mymark;</p>
<p>var cell = new Array();</p>
<p>function reset() {</p>
<p>for (k=1; k&lt;=9; k++) {</p>
<p>eval("c"+k+".innerText=' '");</p>
<p>}</p>
<p>save_mark();</p>
<p>}</p>
<p>function init() {</p>
<p>for (i=1; i&lt;=9; i++) {</p>
<p>code += "&lt;span id='c"+i+"' onClick='set_mark()'&gt;&lt;/span&gt;";
if (i%3==0) { code += "&lt;br&gt;"; }</p>
<p>}</p>
<p>area.innerHTML = code;</p>
<p>init_request() ;</p>
<p>}</p>
<p>function init_request() {</p>
<p>if (window.XMLHttpRequest) {</p>
<p>req = new XMLHttpRequest();</p>
<p>}</p>
<p>else if (window.ActiveXObject) {</p>
<p>req = new ActiveXObject("Microsoft.XMLHTTP");</p>
<p>}</p>
<p>req.open('GET', "tictoe.php", true);</p>
<p>req.setRequestHeader("Content-Type", "text/html");
req.onreadystatechange = processResponse;</p>
<p>req.send(null);</p>
<p>}</p>
<p>function player_mark() {</p>
<p>frm.innerText = "You chose : " + mymark;</p>
<p>}</p>
<p>function set_mark() {</p>
<p>var keyID = event.srcElement.id;</p>
<p>document.getElementById(keyID).innerHTML = "&lt;b&gt;" + mymark +
"&lt;/b&gt;"; Game Programming – Penn Wu</p>
<p>276</p>
<p><span id="index_split_014.html#p277"></span> cell[keyID] =
mymark;</p>
<p>save_mark();</p>
<p>}</p>
<p>function save_mark() {</p>
<p>if (window.XMLHttpRequest) {</p>
<p>req = new XMLHttpRequest();</p>
<p>}</p>
<p>else if (window.ActiveXObject) {</p>
<p>req = new ActiveXObject("Microsoft.XMLHTTP");</p>
<p>}</p>
<p>var url = "tictoe.php" +</p>
<p>"?c1=" + cell['c1'] +</p>
<p>"&amp;c2=" + cell['c2'] +</p>
<p>"&amp;c3=" + cell['c3'] +</p>
<p>"&amp;c4=" + cell['c4'] +</p>
<p>"&amp;c5=" + cell['c5'] +</p>
<p>"&amp;c6=" + cell['c6'] +</p>
<p>"&amp;c7=" + cell['c7'] +</p>
<p>"&amp;c8=" + cell['c8'] +</p>
<p>"&amp;c9=" + cell['c9'];</p>
<p>req.open('GET', url, true);</p>
<p>req.setRequestHeader("Content-Type", "text/html");
req.onreadystatechange = processResponse;</p>
<p>req.send(null);</p>
<p>}</p>
<p>function processResponse() {</p>
<p>if(req.readyState == 4) {</p>
<p>var str = req.responseText;</p>
<p>status = str;</p>
<p>var crd = str.split(":");</p>
<p>c1.innnerText = crd[0];</p>
<p>c2.innnerText = crd[1];</p>
<p>c3.innnerText = crd[2];</p>
<p>c4.innnerText = crd[3];</p>
<p>c5.innnerText = crd[4];</p>
<p>c6.innnerText = crd[5];</p>
<p>c7.innnerText = crd[6];</p>
<p>c8.innnerText = crd[7];</p>
<p>c9.innnerText = crd[8];</p>
<p>var crd = str.split(":");</p>
<p>}</p>
<p>//setTimeout("save_mark()",100);</p>
<p>}</p>
<p>&lt;/script&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p>&lt;form id="frm"&gt;Choose your mark:</p>
<p>Game Programming – Penn Wu</p>
<p>277</p>
<p><span id="index_split_014.html#p278"></span><img
src="index-278_1.png" class="calibre5" alt="Image 221" /></p>
<p><img src="index-278_2.png" class="calibre5" alt="Image 222" /></p>
<p>&lt;input type="radio" name="mark" onClick="mymark='O';
player_mark()"&gt;O</p>
<p>&lt;input type="radio" name="mark" onClick="mymark='X';
player_mark()"&gt;X</p>
<p>&lt;/form&gt;</p>
<p>&lt;div id="area"&gt;</p>
<p>&lt;/div&gt;</p>
<p>&lt;p&gt;&lt;button
onClick="reset()"&gt;Reset&lt;/button&gt;&lt;/p&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Test the program with Internet Explorer. A sample output looks:
Game Programming – Penn Wu</p>
<p>278</p>
<p><span id="index_split_014.html#p279"></span></p>
<p>Lecture #14</p>
<p>Using Yahoo! User Interface (YUI) Library</p>
<p><span id="index_split_015.html"></span></p>
<h2 class="calibre2"
id="index_split_015.html#calibre_pb_14">Introduction</h2>
<p>The Yahoo! User Interface (YUI) Library is a set of utilities and
controls, written in JavaScript, for building richly interactive web
applications using techniques such as DOM</p>
<p>(Document Object Model) scripting, DHTML and AJAX. The YUI Library
also includes several core CSS resources. All components in the YUI
Library have been released as open source under a BSD license and are
free for all uses.</p>
<p>The YUI Event</p>
<p>The YUI Event Utility is designed for creating event-driven
applications. Yahoo says it can Utility</p>
<p>make in-browser programming easier because there is no full-featured
JavaScript or CSS</p>
<p>library that can work in every browser. Yahoo believes their YUI can
support the vast majority of browsers, and thus make your web
programming journey easier.</p>
<p>All the events provided by DOM (Document Object Model) are in the
yahoo-dom-event.js library file. DOM is an application programming
interface (API). It defines the logical structure of documents and the
way a document is accessed and manipulated. With the DOM</p>
<p>programmers can build documents, navigate their structure, and add,
modify, or delete elements and content.</p>
<p>Technically speaking, the YUI Event Utility is actually a set of
script files. Yahoo currently allows programmers to externally access
this file and includes it in HTML files. Simply add the following
bold-faced lines next to the &lt;HTML&gt; tag.</p>
<p>&lt;html&gt;</p>
<p><strong>&lt;script type="text/javascript"</strong></p>
<p><strong>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-</strong></p>
<p><strong>event/yahoo-dom-event.js"&gt;&lt;/script&gt;</strong></p>
<p>To illustrate event handling syntax, the instructor creates an area
using &lt;div&gt; and &lt;/div&gt; tags.</p>
<p>&lt;div id="btn"&gt; Click Me&lt;/div&gt;</p>
<p>The following CSS style code defines the appearance of this area.</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#btn {background-color:#abcdef; border: solid 1 black;</p>
<p>width:100; cursor:pointer; text-align:center}</p>
<p>&lt;/style&gt;</p>
<p>Next, create a function that receives a single argument, the event
object (e), and pops up an alert which says "Welcome to CIS262!":</p>
<p>var msg = function(e) {</p>
<p>alert("Welcome to CIS262!");</p>
<p>}</p>
<p>This area (with and ID btn) must be associated with the function that
process the event. You need to use the Event Utility’s
<strong>addListener</strong> method to tie the <strong>msg</strong>
function with the <strong>btn</strong> area, so it will serves as a
handler for the <strong>click</strong> event. Add the following line:
YAHOO.util.Event.addListener("btn", "click", msg); The complete source
code now looks:</p>
<p>&lt;html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>279</p>
<p><span id="index_split_015.html#p280"></span><img
src="index-280_1.png" class="calibre5" alt="Image 223" /></p>
<p><img src="index-280_2.png" class="calibre5" alt="Image 224" /></p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-</p>
<p>event/yahoo-dom-event.js"&gt;&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>(function() {</p>
<p>var msg = function(e) {</p>
<p>alert("Welcome to CIS262!");</p>
<p>}</p>
<p>YAHOO.util.Event. <strong>addListener</strong>("btn", "click",
msg);</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#btn {background-color:#abcdef; border: solid 1 black;</p>
<p>width:100; cursor:pointer; text-align:center}</p>
<p>&lt;/style&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;div id="btn"&gt; Click Me&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>When testing the program, you first see the following:</p>
<p>Clicking on it, The Yahoo Event utility fires a pop-up window that
looks: Notice that the <strong>YAHOO.util.Event.on</strong> is an alias
for addListener. In the above example, you can use the following line
instead.</p>
<p>YAHOO.util.Event. <strong>on</strong>("btn", "click", msg); A
complete list of event utility is available at</p>
<p>http://developer.yahoo.com/yui/docs/YAHOO.util.Event.html.</p>
<p>Using the YUI</p>
<p>The Dom Collection comprises a family of convenience methods that
simplify common DOM-Dom Collection</p>
<p>scripting tasks, including element positioning and CSS style
management, while normalizing for cross-browser inconsistencies. It
contains these subsections:</p>
<p>•</p>
<p>Positioning HTML Elements</p>
<p>•</p>
<p>Getting and Setting Styles</p>
<p>•</p>
<p>Getting the Viewport Size</p>
<p>•</p>
<p>Managing Class Names</p>
<p>Consider the following example. It uses the following two methods of
the YUI Dom Collection</p>
<p>•</p>
<p><strong>getXY</strong>: get an element’s position relative to the
document.</p>
<p>•</p>
<p><strong>setXY</strong>: position an element relative to the
document.</p>
<p>&lt;html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>280</p>
<p><span id="index_split_015.html#p281"></span>&lt;script
type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>(function() {</p>
<p>var move = function(e) {</p>
<p><strong>YAHOO.util.Dom.setXY('square',
YAHOO.util.Event.getXY(e));</strong></p>
<p>};</p>
<p>YAHOO.util.Event.on(document, "click", move);</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#square {width:20px; height:20px;background-color:#00f;}</p>
<p>&lt;/style&gt;</p>
<p>&lt;span id="square"&gt;&lt;/span&gt;</p>
<p>&lt;/html&gt;</p>
<p>The following line uses the <strong>getXY()</strong> method to
retrieve the <em>x</em>- and <em>y</em>-coordinates of the mouse cursor
when the user click the mouse relative to the HTML document in the
browser. It then uses the setXY() method to force the “square” object to
move to that position from wherever it is.</p>
<p><strong>YAHOO.util.Dom.setXY('square',
YAHOO.util.Event.getXY(e));</strong></p>
<p>Using the Drag &amp;</p>
<p>The term “<strong>drag and drop</strong>” is defined as moving an
element from one location to another by Drop Utility</p>
<p>dragging it with the mouse. It is a technique to directly manipulate
an object by moving it and placing it somewhere else using mouse.</p>
<p>The <strong>Drag &amp; Drop Utility</strong> allows you to create a
draggable interface efficiently, buffering you from browser-level
abnormalities and enabling you to focus on the interesting logic
surrounding your particular implementation. This component enables you
to create a variety of standard draggable objects with just a few lines
of code and then, using its extensive API, add your own specific
implementation logic.</p>
<p>This Drag &amp; Drop Utility is developed based on the following
logic: The basics are straightforward: the user holds down the mouse</p>
<p>button while the mouse hovers over a page element, and the user then
moves the mouse with the button still depressed. The</p>
<p>element follows the mouse around until the user finally</p>
<p>releases it.</p>
<p>Consider the following object and it styles. It is a red square that
has width and height of 50</p>
<p>pixels and a black border. Its id is “red”.</p>
<p>&lt;style type="text/css"&gt;</p>
<p>span { width:50; height:50; cursor:default; border:solid 1</p>
<p>black}</p>
<p>&lt;/style&gt;</p>
<p>......</p>
<p>&lt;span id="red" style="background-Color:red"&gt;&lt;/span&gt; You
need to include the following library file in your web page with the
script tag:</p>
<p>&lt;script type="text/javascript"</p>
<p>Game Programming – Penn Wu</p>
<p>281</p>
<p><span
id="index_split_015.html#p282"></span>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/<strong>yahoo-dom-event.js</strong>"&gt;&lt;/script&gt;</p>
<p>To use Drag and Drop utilities, include the following library file in
your web page with the script tag:</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/dragdrop/<strong>dragdrop-min.js</strong>"&gt;&lt;/script&gt;</p>
<p>To enable a simple drag and drop of any DOM element, create a new
instance of <strong>YAHOO.util.DD</strong>, providing the constructor
with the HTML id of the element you want to make draggable. Optionally,
you can provide an element reference instead of an id. For example,</p>
<p>var r = new YAHOO.util.DD("red");</p>
<p>Alternatively you can use an element reference. For example,</p>
<p>var r1=YAHOO.util.Dom.get("red");</p>
<p>var r = new YAHOO.util.DD(r1);</p>
<p>In this example, a new instance of <strong>YAHOO.util.DD</strong> is
created for an element whose HTML id is “red”; this enables “red” to be
dragged and dropped.</p>
<p>When dragging an object, the <strong>onDOMReady</strong> event
handler is fired automatically. You can then use it create a visual
effect of moving the object. A sample way to create such function
is:</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>(function() {</p>
<p>var r;</p>
<p>YAHOO.util.Event.onDOMReady(function() {</p>
<p>r = new YAHOO.util.DD("red");</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>Note that while the element can now be moved visually on the page,
this visual motion is accomplished by changing the element's style
properties. Its actual location in the DOM itself remains unchanged.</p>
<p>The basic approach used for drag-and-drop is as follows:</p>
<p>•</p>
<p>Event handlers inspect the incoming event to determine the element
being dragged.</p>
<p>•</p>
<p>A <strong>mousedown</strong> handler saves the starting co-ordinates,
sets the zIndex so that the element appears in front during the drag,
changes some other style settings to indicate a drag has begun, and
performs other initialisation.</p>
<p>•</p>
<p>A <strong>mousemove</strong> handler inspects the mouse's
co-ordinates and moves the element accordingly using its left and top
properties. Here's where cross-browser support gets nasty - mouse
co-ordinates in the event object are seriously platform-specific.</p>
<p>•</p>
<p>A <strong>mouseup</strong> handler restores normal style settings and
performs any other cleaning up.</p>
<p>Using the</p>
<p>The Animation Utility enables the rapid prototyping and
implementation of animations Animation Utility</p>
<p>involving size, opacity, color, position, and other visual
characteristics. <strong>YAHOO.util.Anim</strong> is the base animation
class that provides the interface for building animated effects. Its
syntax is: YAHOO.util.Anim ( el , attributes , duration , method );</p>
<p>Its parameters are:</p>
<p>•</p>
<p><em>el</em> &lt;String | HTMLElement&gt; Reference to the element
that will be animated Game Programming – Penn Wu</p>
<p>282</p>
<p><span id="index_split_015.html#p283"></span>•</p>
<p><em>attributes</em> &lt;Object&gt; The attribute(s) to be animated.
Each attribute is an object with at minimum a "to" or "by" member
defined. Additional optional members are "from"</p>
<p>(defaults to current value), "units" (defaults to "px"). All
attribute names use camelCase.</p>
<p>•</p>
<p><em>duration</em> &lt;Number&gt; (optional, defaults to 1 second)
Length of animation (frames or seconds), defaults to time-based</p>
<p>•</p>
<p><em>method</em> &lt;Function&gt; (optional, defaults to
YAHOO.util.Easing.easeNone) Computes the values that are applied to the
attributes per frame (generally a YAHOO.util.Easing method)</p>
<p>To use the Animation utility, include the following source file:</p>
<p>&lt;script</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/animation/animation-min.js"
type="text/javascript"&gt;&lt;/script&gt; Consider the following
example. In it, the instructor creates an instance of
<strong>YAHOO.util.Anim</strong> to animate an object.</p>
<p>&lt;html&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-</p>
<p>event/yahoo-dom-event.js"&gt;&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/animation/animation-min.js"&gt;&lt;/script&gt;</p>
<p>&lt;button id="btn"&gt;Vanish&lt;/button&gt;</p>
<p>&lt;div id="bar" style="background-Color:red;
width:70%"&gt;&lt;/div&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>(function() {</p>
<p>var attributes = {</p>
<p>width: { to: 0 }</p>
<p>};</p>
<p>var anim = new YAHOO.util.Anim('bar', attributes);</p>
<p>YAHOO.util.Event.on('btn', 'click', function() {</p>
<p>anim.animate();</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/html&gt;</p>
<p>The object to be animated is a red bar defined by:</p>
<p>&lt;div id="bar" style="background-Color:red;
width:100%"&gt;&lt;/div&gt; A button is used to fire the event defined
in YAHOO.util.Event.on method:</p>
<p>&lt;button id="btn"&gt;Vanish&lt;/button&gt;</p>
<p>The final step is to call the animate method on our instance to start
the animation. The button will be the trigger that begins the animation
sequence:</p>
<p>YAHOO.util.Event.on('btn', 'click', function() {</p>
<p>anim.animate();</p>
<p>Game Programming – Penn Wu</p>
<p>283</p>
<p><span id="index_split_015.html#p284"></span><img
src="index-284_1.png" class="calibre5" alt="Image 225" /></p>
<p><img src="index-284_2.png" class="calibre5" alt="Image 226" /></p>
<p>});</p>
<p>When the “Vanish” button is clicked, the width of the red bar
decrease at a constant speed till it disappears.</p>
<p>to</p>
<p>The YUI Animation Utility includes an Easing feature, which allows
you to customize how the animation behaves. For example, add the
duration and easing arguments are optional.</p>
<p>var anim = new YAHOO.util.Anim('bar', attributes,
<strong>2</strong>,</p>
<p><strong>YAHOO.util.Easing.easeOut</strong>);</p>
<p>In this case, the value 2 is the duration of animation. The
<strong>easeOut</strong> property will slow the animation gradually as
it nears the end.</p>
<p>Similarly, you can change <strong>YAHOO.util.Easing.easeOut</strong>
to any of the following for different visual effects:</p>
<p>•</p>
<p>YAHOO.util.Easing.backBoth</p>
<p>•</p>
<p>YAHOO.util.Easing.backIn</p>
<p>•</p>
<p>YAHOO.util.Easing.backOut</p>
<p>•</p>
<p>YAHOO.util.Easing.bounceBoth</p>
<p>•</p>
<p>YAHOO.util.Easing.bounceIn</p>
<p>•</p>
<p>YAHOO.util.Easing.bounceOut</p>
<p>•</p>
<p>YAHOO.util.Easing.easeBoth</p>
<p>•</p>
<p>YAHOO.util.Easing.easeBothStrong</p>
<p>•</p>
<p>YAHOO.util.Easing.easeIn</p>
<p>•</p>
<p>YAHOO.util.Easing.easeInStrong</p>
<p>•</p>
<p>YAHOO.util.Easing.easeNone</p>
<p>•</p>
<p>YAHOO.util.Easing.easeOut</p>
<p>•</p>
<p>YAHOO.util.Easing.easeOutStrong</p>
<p>•</p>
<p>YAHOO.util.Easing.elasticBoth</p>
<p>•</p>
<p>YAHOO.util.Easing.elasticIn</p>
<p>•</p>
<p>YAHOO.util.Easing.elasticOut</p>
<p>The Animation Utility also allows you to animate the motion of an
<strong>HTMLElement</strong> along a curved path using control
points.</p>
<p>Try create a demo object and a button that will move the object:</p>
<p>&lt;button id="btn"&gt;Move&lt;/button&gt; &lt;br/&gt;</p>
<p>&lt;span id="square"&gt;&lt;/span&gt;</p>
<p>Use CSS style to define how this object will look:</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#square {</p>
<p>background-Color:red; height:20px; width:20px;</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>Next, create an instance of <strong>YAHOO.util.Motion</strong>,
passing it the element we wish to animate, and the points attribute (an
array of [x, y] positions), with the point we are animating to, and Game
Programming – Penn Wu</p>
<p>284</p>
<p><span id="index_split_015.html#p285"></span>the control points that
will influence the path:</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>var attributes = {</p>
<p>points: { to: [10,50], control: [[150,400], [300,100],</p>
<p>[50,800], [450,10] ] }</p>
<p>};</p>
<p>var anim = new YAHOO.util.Motion('square', attributes);</p>
<p>&lt;/script&gt;</p>
<p><strong>[10,50]</strong> is the finish point, namely it is last point
the red square will move to. The array,</p>
<p>[150,400], [300,100], [50,800], and [450,10], defines the path of the
movement. In each set</p>
<p>[ <em>x</em>, <em>y</em>], the value represents <em>x</em>- and
<em>y</em>-coordinates on the HTML document.</p>
<p>The syntax of <strong>YAHOO.util.Motion</strong> is:</p>
<p>YAHOO.util.Motion ( <em>el</em> , <em>attributes</em> ,
<em>duration</em> , <em>method</em> ); The parameters are:</p>
<p>•</p>
<p><em>el</em> &lt;String | HTMLElement&gt; Reference to the element
that will be animated</p>
<p>•</p>
<p><em>attributes</em> &lt;Object&gt; The attribute(s) to be animated.
Each attribute is an object with at minimum a "to" or "by" member
defined. Additional optional members are "from"</p>
<p>(defaults to current value), "units" (defaults to "px"). All
attribute names use camelCase.</p>
<p>•</p>
<p><em>duration</em> &lt;Number&gt; (optional, defaults to 1 second)
Length of animation (frames or seconds), defaults to time-based</p>
<p>•</p>
<p><em>method</em> &lt;Function&gt; (optional, defaults to
YAHOO.util.Easing.easeNone) Computes the values that are applied to the
attributes per frame (generally a YAHOO.util.Easing method)</p>
<p>The final step is to call the &lt;code&gt;animate&lt;/code&gt; method
on our instance to start the animation. The button will be the trigger
that begins the animation sequence.</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>YAHOO.util.Event.on('btn', 'click', function() {</p>
<p>anim.animate();</p>
<p>});</p>
<p>&lt;/script&gt;</p>
<p>The complete code will look:</p>
<p>&lt;html&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-</p>
<p>event/yahoo-dom-event.js"&gt;&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/animation/animation-min.js"&gt;&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#square {</p>
<p>background-Color:red; height:20px; width:20px; left:10;</p>
<p>top:50}</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;button id="btn"&gt;Move&lt;/button&gt;&lt;br/&gt;</p>
<p>&lt;span id="square"&gt;&lt;/span&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>(function() {</p>
<p>Game Programming – Penn Wu</p>
<p>285</p>
<p><span id="index_split_015.html#p286"></span><img
src="index-286_1.png" class="calibre5" alt="Image 227" /></p>
<p>var attributes = {</p>
<p>points: { to: [10,50], control: [[150,400], [300,100],</p>
<p>[50,800], [450,10] ] }</p>
<p>};</p>
<p>var anim = new YAHOO.util.Motion('square', attributes);</p>
<p>YAHOO.util.Event.on('btn', 'click', function() {</p>
<p>anim.animate();</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/html&gt;</p>
<p>Coping with the</p>
<p>The Portable Network Graphic (PNG) image format was developed by the
World Wide Web IE transparent</p>
<p>Consortium as a better GIF than GIF many years ago. It is the trend
in the Web developing issue</p>
<p>industry to use .png instead of .gif graphics. However, Internet
Explorer in Windows XP (or early) platform supports PNG transparency
only up to the 256-color palette. When the PNG</p>
<p>transparent image uses a better palette, IE will make transparent
parts opaque. For example, Web developers have long complained about
this problems. Microsoft admits the problem
(http://support.microsoft.com/?scid=kb;en-us;265221) and offers a
workaround that's not entirely satisfactory.</p>
<p>Microsoft’s AlphaImageLoader uses DirectX components to produce the
same transparency effect (http://msdn.microsoft.com/workshop/author/</p>
<p>filter/reference/filters/AlphaImageLoader.asp ). It's a filter you
can apply to any other HTML</p>
<p>element, even a block of text. Here it's applied to DIV.</p>
<p>&lt;DIV ID="oDiv" STYLE="position:absolute; left:140px; height:400;
width:400; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader
(src='image.png', sizing Method='scale');" &gt;</p>
<p>&lt;/DIV&gt;</p>
<p>This may not seem that painful, but if you have several PNGs on your
page, you need to repeat this for each one. Obviously this workaround is
a lot more complicated to use than a simple</p>
<p>&lt;img&gt; tag.</p>
<p>Review Questions</p>
<p>1. Which statement is true about the Yahoo! User Interface?</p>
<p>A. It is a set of utilities and controls, written in C++, for
building application.</p>
<p>B. It is written in Java using techniques such as CSS and DHTML.</p>
<p>C. It is a set of toolkit Yahoo! developed to sell for profits.</p>
<p>D. None of the above.</p>
<p>D</p>
<p>2. Which statement is not true?</p>
<p>Game Programming – Penn Wu</p>
<p>286</p>
<p><span id="index_split_015.html#p287"></span>A. The YUI Event Utility
is designed for creating event-driven applications.</p>
<p>B. DOM is short for Data Object Mode.</p>
<p>C. There is no full-featured JavaScript or CSS library that can work
in every browser.</p>
<p>D. All the events provided by DOM are in the yahoo-dom-event.js
library file B</p>
<p>3. Given the following code segment, which statement is correct?</p>
<p>var msg = function(e) {</p>
<p>alert("Welcome to CIS262!");</p>
<p>}</p>
<p>A. var is the name of function.</p>
<p>B. msg is the name of function.</p>
<p>C. msg is a variable that holds the value "Welcome to CIS262!".</p>
<p>D. alert is a variable that holds the value "Welcome to CIS262!".</p>
<p>B</p>
<p>4. Which has exactly the same functionality as the following:</p>
<p>YAHOO.util.Event.addListener("btn", "click", msg); A.
YAHOO.util.Event.on("btn", "click", msg); B.
YAHOO.util.Event.getListener("btn", "click", msg); C.
YAHOO.util.Event.loadListener("btn", "click", msg); D.
YAHOO.util.Event.get("btn", "click", msg); A</p>
<p>5. Which method of the YAHOO.util.Dom class can position an element
relative to the document?</p>
<p>A. setXY</p>
<p>B. getXY</p>
<p>C. readXY</p>
<p>D. writeXY</p>
<p>A</p>
<p>6. Given the following code segment, which statement is correct?</p>
<p>YAHOO.util.Dom.setXY('square', YAHOO.util.Event.getXY(e));</p>
<p>A. It uses the getXY() method to retrieve the x- and y-coordinates of
the object e.</p>
<p>B. It uses the setXY() method to retrieve the x- and y-coordinates of
the object e.</p>
<p>C. It uses the getXY() method to force the “square” object to move to
a new position from wherever it is.</p>
<p>D. All of the above.</p>
<p>A</p>
<p>7. The term “drag and drop” is defined as __.</p>
<p>A. clicking a button to change its location.</p>
<p>B. clicking an icon to change its location.</p>
<p>C. moving an element from one location to another by dragging it with
the mouse.</p>
<p>Game Programming – Penn Wu</p>
<p>287</p>
<p><span id="index_split_015.html#p288"></span>D. moving an element from
one location to another by holding the Shift key.</p>
<p>C</p>
<p>8. Which class is the one that support "drag and drop"?</p>
<p>A. YAHOO.util.Dom</p>
<p>B. YAHOO.util.Event</p>
<p>C. YAHOO.util.DD</p>
<p>D. YAHOO.util.Anim</p>
<p>C</p>
<p>9. Given the following code segment, which is the name of an animated
object?</p>
<p>var anim = new YAHOO.util.Anim('bar', attributes, 2,
YAHOO.util.Easing.easeOut); A. anim</p>
<p>B. bar</p>
<p>C. 2</p>
<p>D. easeOut</p>
<p>B</p>
<p>10. Given the following code segment, which is the finish point of
the movement?</p>
<p>points: { to: [10,50], control: [[150,400], [300,100], [50,800]]
}</p>
<p>A. (10, 50)</p>
<p>B. (150, 400)</p>
<p>C. (300, 100)</p>
<p>D. (50, 800)</p>
<p>A</p>
<p>Game Programming – Penn Wu</p>
<p>288</p>
<p><span id="index_split_015.html#p289"></span><img
src="index-289_1.png" class="calibre5" alt="Image 228" /></p>
<p><img src="index-289_2.png" class="calibre5" alt="Image 229" /></p>
<p>Lab #14</p>
<p>Using Yahoo! User Interface (YUI) Library</p>
<p><strong>Learning Activity #1: Using YUI Event Utility</strong></p>
<p>1. Use Notepad to create a new file named
<strong>lab14_1.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;script&gt;</p>
<p>(function() {</p>
<p>var msg = function(e) {</p>
<p>alert("Welcome to CIS262!");</p>
<p>}</p>
<p>YAHOO.util.Event. <strong>addListener</strong>("btn", "click",
msg);</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#btn {background-color:#abcdef; border: solid 1 black; width:100;
cursor:pointer; text-align:center}</p>
<p>&lt;/style&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;div id="btn"&gt; Click Me&lt;/div&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the code. Testing the program, and
click on the following button.</p>
<p>3. Clicking on it, The Yahoo Event utility fires a pop-up window that
looks: <strong>Learning Activity #2: Using Drag-&amp;-Drop
Library</strong></p>
<p>1. Use Notepad to create a new file named
<strong>lab14_2.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/dragdrop/dragdrop-min.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>289</p>
<p><span id="index_split_015.html#p290"></span><img
src="index-290_1.png" class="calibre5" alt="Image 230" /></p>
<p>span { width:50; height:50; cursor:default; border:solid 1 black}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>(function() {</p>
<p>var r, g, b;</p>
<p>YAHOO.util.Event.onDOMReady(function() {</p>
<p>r = new YAHOO.util.DD("red");</p>
<p>g = new YAHOO.util.DD("green");</p>
<p>b = new YAHOO.util.DD("blue");</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body&gt;</p>
<p>&lt;span id="red" style="background-Color:red"&gt;&lt;/span&gt;</p>
<p>&lt;span id="green"
style="background-Color:green"&gt;&lt;/span&gt;</p>
<p>&lt;span id="blue" style="background-Color:blue"&gt;&lt;/span&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the code.</p>
<p><strong>Learning Activity #3: Animation with different visual
effects</strong> 1. Use Notepad to create a new file named
<strong>lab14_3.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/animation/animation-min.js"&gt;&lt;/script&gt;</p>
<p>&lt;button id="btn"&gt;Vanish&lt;/button&gt;</p>
<p>&lt;button id="btn_e"&gt;Vanish with easeOut&lt;/button&gt;</p>
<p>&lt;button id="btn_b"&gt;Vanish with
backIn&lt;/button&gt;&lt;p&gt;</p>
<p>&lt;div id="red" style="background-Color:red;
width:90%"&gt;&lt;/div&gt;&lt;br /&gt;</p>
<p>&lt;div id="blue" style="background-Color:blue;
width:90%"&gt;&lt;/div&gt;&lt;br /&gt;</p>
<p>&lt;div id="yellow" style="background-Color:yellow;
width:90%"&gt;&lt;/div&gt;&lt;br /&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>(function() {</p>
<p>var attributes = {</p>
<p>width: { to: 0 }</p>
<p>};</p>
<p>Game Programming – Penn Wu</p>
<p>290</p>
<p><span id="index_split_015.html#p291"></span><img
src="index-291_1.png" class="calibre5" alt="Image 231" /></p>
<p>var anim = new YAHOO.util.Anim('red', attributes);</p>
<p>var anim_e = new YAHOO.util.Anim('blue', attributes, 2,</p>
<p>YAHOO.util.Easing.easeOut);</p>
<p>var anim_b = new YAHOO.util.Anim('yellow', attributes, 2,</p>
<p>YAHOO.util.Easing.backIn);</p>
<p>YAHOO.util.Event.on('btn', 'click', function() {</p>
<p>anim.animate();</p>
<p>});</p>
<p>YAHOO.util.Event.on('btn_e', 'click', function() {</p>
<p>anim_e.animate();</p>
<p>});</p>
<p>YAHOO.util.Event.on('btn_b', 'click', function() {</p>
<p>anim_b.animate();</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the code. Click the buttons to see
the different visual effects.</p>
<p><strong>Learning Activity #4: An online puzzle game</strong></p>
<p>Note: If you are using a browser that supports .png transparency, you
can use the shortened code in Appendix A.</p>
<p><strong></strong></p>
<p>1. Use Notepad to create a new file named
<strong>lab14_4.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/dragdrop/dragdrop-min.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>img { cursor:default; position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>function init() {</p>
<p>m1.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m1.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m2.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m2.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m3.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m3.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m4.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200)); Game
Programming – Penn Wu</p>
<p>291</p>
<p><span id="index_split_015.html#p292"></span>m4.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m5.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m5.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m6.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m6.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));</p>
<p>}</p>
<p>(function() {</p>
<p>YAHOO.util.Event.onDOMReady(function() {</p>
<p>var m1 = new YAHOO.util.DD("m1");</p>
<p>var m2 = new YAHOO.util.DD("m2");</p>
<p>var m3 = new YAHOO.util.DD("m3");</p>
<p>var m4 = new YAHOO.util.DD("m4");</p>
<p>var m5 = new YAHOO.util.DD("m5");</p>
<p>var m6 = new YAHOO.util.DD("m6");</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p>&lt;DIV ID="m1" STYLE="position:absolute; width:128; height:97;
filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(</p>
<p>src='http://business.cypresscollege.edu/~pwu/cis262/1.png',</p>
<p>sizingMethod='scale');"&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>&lt;DIV ID="m2" STYLE="position:absolute; width:127; height:153;
filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(</p>
<p>src='http://business.cypresscollege.edu/~pwu/cis262/2.png',</p>
<p>sizingMethod='scale');"&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>&lt;DIV ID="m3" STYLE="position:absolute; width:126; height:113;
filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(</p>
<p>src='http://business.cypresscollege.edu/~pwu/cis262/3.png',</p>
<p>sizingMethod='scale');"&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>&lt;DIV ID="m4" STYLE="position:absolute; width:95; height:132;
filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(</p>
<p>src='http://business.cypresscollege.edu/~pwu/cis262/4.png',</p>
<p>sizingMethod='scale');"&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>&lt;DIV ID="m5" STYLE="position:absolute; width:130; height:138;
filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(</p>
<p>src='http://business.cypresscollege.edu/~pwu/cis262/5.png',</p>
<p>sizingMethod='scale');"&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>&lt;DIV ID="m6" STYLE="position:absolute; width:109; height:113;
filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(</p>
<p>src='http://business.cypresscollege.edu/~pwu/cis262/6.png',</p>
<p>sizingMethod='scale');"&gt;</p>
<p>&lt;/DIV&gt;</p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>292</p>
<p><span id="index_split_015.html#p293"></span>2. Use Internet Explorer
to test the code.</p>
<p><strong>Learning Activity #5: Moving along a curve</strong></p>
<p>1. Use Notepad to create a new file named
<strong>lab14_5.htm</strong> with the following contents:</p>
<p>&lt;html&gt;</p>
<p>&lt;script type="text/javascript"
src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/animation/animation-min.js"&gt;&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>#square {</p>
<p>background-Color:red; height:20px; width:20px; left:10; top:50}</p>
<p>}</p>
<p>&lt;/style&gt;</p>
<p>&lt;button id="btn"&gt;Move&lt;/button&gt;&lt;br/&gt;</p>
<p>&lt;span id="square"&gt;&lt;/span&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>(function() {</p>
<p>var attributes = {</p>
<p>points: { to: [10,50], control: [[150,400], [300,100], [50,800],
[450,10] ] }</p>
<p>};</p>
<p>var anim = new YAHOO.util.Motion('square', attributes);</p>
<p>YAHOO.util.Event.on('btn', 'click', function() {</p>
<p>anim.animate();</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/html&gt;</p>
<p>2. Use Internet Explorer to test the code. Click the button to move
the object along a curve.</p>
<p><strong>Submittal</strong></p>
<p>1. Complete all the 5 learning activities in this lab.</p>
<p>2. Create a .zip file named lab4.zip containing ONLY the following
self-executable files.</p>
<p>•</p>
<p>Lab14_1.htm</p>
<p>•</p>
<p>Lab14_2.htm</p>
<p>•</p>
<p>Lab14_3.htm</p>
<p>•</p>
<p>Lab14_4.htm</p>
<p>•</p>
<p>Lab14_5.htm</p>
<p>3. Log in to Blackboard, and enter the course site.</p>
<p>4. Upload the zipped file to question 11 of Assignment 04 as
response.</p>
<p>Game Programming – Penn Wu</p>
<p>293</p>
<p><span id="index_split_015.html#p294"></span>Appendix A:</p>
<p>&lt;html&gt;</p>
<p>&lt;head&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/yahoo-dom-event/yahoo-dom-event.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;script type="text/javascript"</p>
<p>src="http://yui.yahooapis.com/2.5.2/build/dragdrop/dragdrop-min.js"&gt;</p>
<p>&lt;/script&gt;</p>
<p>&lt;style type="text/css"&gt;</p>
<p>img { cursor:default; position:absolute}</p>
<p>&lt;/style&gt;</p>
<p>&lt;script type="text/javascript"&gt;</p>
<p>function init() {</p>
<p>m1.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m1.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m2.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m2.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m3.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m3.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m4.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m4.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m5.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m5.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));
m6.style.pixelLeft =
Math.floor(Math.random()*(document.body.clientWidth-200));
m6.style.pixelTop =
Math.floor(Math.random()*(document.body.clientHeight-200));</p>
<p>}</p>
<p>(function() {</p>
<p>YAHOO.util.Event.onDOMReady(function() {</p>
<p>var m1 = new YAHOO.util.DD("m1");</p>
<p>var m2 = new YAHOO.util.DD("m2");</p>
<p>var m3 = new YAHOO.util.DD("m3");</p>
<p>var m4 = new YAHOO.util.DD("m4");</p>
<p>var m5 = new YAHOO.util.DD("m5");</p>
<p>var m6 = new YAHOO.util.DD("m6");</p>
<p>});</p>
<p>})();</p>
<p>&lt;/script&gt;</p>
<p>&lt;/head&gt;</p>
<p>&lt;body onLoad="init()"&gt;</p>
<p><strong>&lt;img id="m1"
src="http://business.cypresscollege.edu/~pwu/cis262/1.png"&gt;</strong></p>
<p><strong>&lt;img id="m2"
src="http://business.cypresscollege.edu/~pwu/cis262/2.png"&gt;</strong></p>
<p><strong>&lt;img id="m3"
src="http://business.cypresscollege.edu/~pwu/cis262/3.png"&gt;</strong></p>
<p><strong>&lt;img id="m4"
src="http://business.cypresscollege.edu/~pwu/cis262/4.png"&gt;</strong></p>
<p><strong>&lt;img id="m5"
src="http://business.cypresscollege.edu/~pwu/cis262/5.png"&gt;</strong></p>
<p><strong>&lt;img id="m6"
src="http://business.cypresscollege.edu/~pwu/cis262/6.png"&gt;</strong></p>
<p>&lt;/body&gt;</p>
<p>&lt;/html&gt;</p>
<p>Game Programming – Penn Wu</p>
<p>294</p>
<p><span id="index_split_015.html#p295"></span></p>
<p>Lecture #14</p>
<p>Basics of 2D/3D Graphics</p>
<p>Using graphics</p>
<p>In computer graphics, graphics software or image editing software is
a program or collection software</p>
<p>of programs that enable a person to manipulate visual images on a
computer. They are very useful in producing high-quality graphics and
image files. Many games use such pre-produced graphics and images to
enhance their multimedia performance.</p>
<p>Most graphics programs have the ability to import and export one or
more graphics file formats. Several graphics programs support animation,
or digital video. Vector graphics animation can be described as a series
of mathematical transformations that are applied in sequence to one or
more shapes in a scene. Raster graphics animation works in a similar
fashion to film-based animation, where a series of still images produces
the illusion of continuous movement.</p>
<p>Graphics and</p>
<p>Graphics images created for use in the World Wide Web have the file
name extensions: <strong>.gif</strong> Images types</p>
<p>(Graphics Interchange Format), <strong>.jpg</strong> or jpeg
(pronounced as jaypeg) or <strong>.png</strong> (stands for portable
network graphics and is pronounced as 'ping'). There are many more less
popular graphics formats used on the world wide web. You can discover
their formats by viewing their file extensions. The file extension is
the three letters that come after the file name.</p>
<p>The .gif, .jpg (jpeg) and .png file formats allow image data to be
stored in a compressed form that maximizes the amount of space used but
describes the colors, dimensions, and excepting jpg format, any
transparent background in the image.</p>
<p>The gif and png formats permit transparent backgrounds, making them
suitable for logos (like the cockerel), web buttons etc. When you don't
want to have a colored background around the image, like this, but want
the background page color to show through. Gifs are used for animated
graphics. Both gif and png are best used when the image contains only a
few colors and are excellent for line drawings. PNG format graphics may
not be visible in all browsers.</p>
<p>The jpg (jpeg) format is good for images that contain a range of
colors and shades, e.g.</p>
<p>photographs but isn't much good for any images with sharp edges,
including lettering or line drawings.</p>
<p>The png format is expected to eventually replace gif. It supports
transparency and is better than gif at displaying color, although image
sizes tend to be larger.</p>
<p>A general rule is that the images have to be of a fairly small size
otherwise they take to long to load when people are looking at web
pages.</p>
<p>Animated Gifs</p>
<p>The so-called " <strong>Animated GIF</strong>" is an animation
created by combining multiple GIF images in one file. The result is
multiple images, displayed one after another, that give the appearance
of movement. You can use a GIF animation tool to create sequences of
images to simulate animation and allows for transparent background
colors. Animated GIFs can generate higher response rates than static
banners.</p>
<p>Creating Animated You can start with a check list of all the things
you need to create animated gifs.</p>
<p>Gifs</p>
<p>•</p>
<p>An imaging software such as paint shop pro or color works,</p>
<p>•</p>
<p>A gif assembling software such as Gif animator, Animation Shop,
Giffy,</p>
<p>•</p>
<p>Creativity, and</p>
<p>•</p>
<p>A lot of patience</p>
<p>A number of software programs are available either for free or
shareware on the Internet. We Game Programming – Penn Wu</p>
<p>295</p>
<p><span id="index_split_015.html#p296"></span><img
src="index-296_1.png" class="calibre5" alt="Image 232" /></p>
<p><img src="index-296_2.png" class="calibre5" alt="Image 233" /></p>
<p><img src="index-296_3.png" class="calibre5" alt="Image 234" /></p>
<p><img src="index-296_4.png" class="calibre5" alt="Image 235" /></p>
<p><img src="index-296_5.png" class="calibre5" alt="Image 236" /></p>
<p><img src="index-296_6.png" class="calibre5" alt="Image 237" /></p>
<p><img src="index-296_7.png" class="calibre5" alt="Image 238" /></p>
<p><img src="index-296_8.png" class="calibre5" alt="Image 239" /></p>
<p><img src="index-296_9.png" class="calibre5" alt="Image 240" /></p>
<p><img src="index-296_10.png" class="calibre5" alt="Image 241" /></p>
<p><img src="index-296_11.png" class="calibre5" alt="Image 242" /></p>
<p>recommend Paint Shop Pro (JASC. Inc.) as the imaging software, and
Gif Animator (Ulead).</p>
<p>You may e familiar with other software programs. A complete list of
software programs available can be found here.</p>
<p>Creating animated gifs is really simple. Let us start off with an
example. Below is an image of a ball.</p>
<p>The aim of this first exercise is to make the ball move from left to
right and then back.</p>
<p>In the imaging software often a new work area 450 pixels wide and
height equal to the original image (in this case it is 49 pixels). Copy
the ball and paste it into the working area at the far left.</p>
<p>Create a new working area same height and width. Paste the ball at a
position more at the right than the previous frame. Repeat this
procedure until the ball is completely at the right. At this point you
should have a number of frames like these shown below.</p>
<p>File 1</p>
<p>File 2</p>
<p>File 3</p>
<p>File 4</p>
<p>File 5</p>
<p>File 6</p>
<p>File 7</p>
<p>File 8</p>
<p>File 9</p>
<p>Now import the individual images in the gif assembler program in
sequential order, and then in the reverse order. Save the animation. The
end result should look something like this: You can use Internet
Explorer to visit</p>
<p>http://business.cypresscollege.edu/~pwu/cis261/files/rolling_ball.gif
to see how this gif file is animated.</p>
<p>Transparency</p>
<p>A major problem which you might encounter when creating animated gifs
is that the background of the image does not blend so well with the
background you are using. This can be solved in two ways:</p>
<p>•</p>
<p>Change the background color of the animation to the one in your
webpage, or else</p>
<p>•</p>
<p>Create a transparent background</p>
<p>The use of transparent backgrounds allows us to blend any kind of
animation (or still gifs) to any background being used. Consider the
following image.</p>
<p>Game Programming – Penn Wu</p>
<p>296</p>
<p><span id="index_split_015.html#p297"></span><img
src="index-297_1.png" class="calibre5" alt="Image 243" /></p>
<p><img src="index-297_2.png" class="calibre5" alt="Image 244" /></p>
<p><img src="index-297_3.png" class="calibre5" alt="Image 245" /></p>
<p><img src="index-297_4.png" class="calibre5" alt="Image 246" /></p>
<p>This image blends well with the white background which this page has.
The reason is that the background color of the animation is also
white.</p>
<p>Now change the background color. Notice that the image will not blend
so well as above.</p>
<p>Now change the white background to a transparent one. The result is
the following.</p>
<p>transparent</p>
<p>Transparent backgrounds may seem the best way how to blend animations
to the background.</p>
<p>At times however the end result will not be the expected one. Let us
consider the following image:</p>
<p>As you can clearly see the different frames of the animation remained
visible. This is a common problem when using transparencies on moving
objects. This can be easily solved.</p>
<p>One of the options of every gif animation program is the way how the
image (frame will be removed from the screen. Usually the current
options are available (notice that the name of option varies from
software to software):</p>
<p>•</p>
<p>Do Not Remove</p>
<p>•</p>
<p>To Background Color</p>
<p>•</p>
<p>To Previous Image</p>
<p>In the above example the animation was set to Do Not Remove. On
changing the settings so that each frame is removed <strong>To
background Color</strong>, so the results looks: Game Programming – Penn
Wu</p>
<p>297</p>
<p><span id="index_split_015.html#p298"></span><img
src="index-298_1.png" class="calibre5" alt="Image 247" /></p>
<p><img src="index-298_2.png" class="calibre5" alt="Image 248" /></p>
<p><img src="index-298_3.png" class="calibre5" alt="Image 249" /></p>
<p><img src="index-298_4.png" class="calibre5" alt="Image 250" /></p>
<p><img src="index-298_5.png" class="calibre5" alt="Image 251" /></p>
<p><img src="index-298_6.png" class="calibre5" alt="Image 252" /></p>
<p>Reducing the file</p>
<p>File size is a very important thing which needs to be kept in mind
when creating animated size</p>
<p>gifs. The smaller they are in size the faster they will load on the
web page. It is not the first time that animations produced have a file
size over 20K. This will mean that they will take far longer to
download.</p>
<p>Well software producers have done something to help us by creating
the so called gif reducers. What is the function of these programs?
These programs will act in 3 different ways:</p>
<p>•</p>
<p><strong>Palette reducers</strong> - This feature will reduce the
number of colors within the animation from the original number (e.g.
256) to a user defined or predefined number (e.g. 64).</p>
<p>Obviously the image will sometimes loose in quality and become
dithered. In this case one can change the number of resulting colors to
an acceptable level.</p>
<p>•</p>
<p>Removal of Redundant pixels - This is a very cool feature. Basically
the software will compare the different frames and will remove/crop any
pixels which do not change from one image to an other. Consider the
following panther. It is composed of 2 frames. In the initial frame the
panther has the eyes open. In the second frame the tiger has the eyes
closed. The software cropped off the pixels which do not change.</p>
<p>+</p>
<p>Removal of redundant pixels</p>
<p>=</p>
<p>This process has reduced the file size by 5,279 bytes which is
equivalent to 63% of the original file size.</p>
<p>•</p>
<p>Removal of Comment Blocks - Comment blocks are text annotations added
to the images which do not appear in the animation. These annotations
usually state who created the animated gif, and which program was used
in creating them. Although the amount of bytes added to the file size
may be few, some programs remove these annotations as well.</p>
<p>These features are shared in the majority of software packages
available.</p>
<p>Game Programming – Penn Wu</p>
<p>298</p>
<p><span id="index_split_015.html#p299"></span><img
src="index-299_1.png" class="calibre5" alt="Image 253" /></p>
<p><img src="index-299_2.png" class="calibre5" alt="Image 254" /></p>
<p>3D graphics</p>
<p>3D computer graphics are works of graphic art created with the aid of
digital computers and 3D software. The term may also refer to the
process of creating such graphics, or the field of study of computer
graphic techniques and related technology. An example of 3D graphics is:
Each 3D object takes up space in three directions, defined in 3D
parlance as the <strong>X</strong>, <strong>Y</strong>, and
<strong>Z</strong></p>
<p>axes. Many computer languages refer the three axes are
<strong>width</strong>, <strong>height</strong>, and
<strong>depth</strong>.</p>
<p>•</p>
<p><strong>width</strong>: the object’s left-to-right dimension</p>
<p>•</p>
<p><strong>height</strong>: the object’s top-to-bottom dimension</p>
<p>•</p>
<p><strong>depth</strong>: the object’s front-to-back dimension</p>
<p>depth</p>
<p>height</p>
<p>width</p>
<p>Take a close look at the above illustration, which the instructor
created for this class. 3D</p>
<p>computer graphics are different from 2D computer graphics in that a
three-dimensional representation of geometric data is stored in the
computer for the purposes of performing calculations and rendering 2D
images. Such images may be for later display or for real-time
viewing.</p>
<p>3D modeling is the process of preparing geometric data for 3D
computer graphics, and is akin to sculpting, whereas the art of 2D
graphics is analogous to photography. Despite these differences, 3D
computer graphics rely on many of the same algorithms as 2D computer
graphics.</p>
<p>In computer graphics software, the distinction between 2D and 3D is
occasionally blurred; 2D</p>
<p>applications may use 3D techniques to achieve effects such as
lighting, and primarily 3D may use 2D rendering techniques.</p>
<p>Although this class is not designed for you to learn 3D graphics, do
not hesitate to download some 3D modeling software and try for yourself.
Use Internet Explorer to visit
http://www.freeserifsoftware.com/software/3dPlus/default.asp, and
download a copy of 3DPlus 2 (which is a completely FREE 3D animation and
modeling software).</p>
<p>By the way, currently, OpenGL and Direct3D are two popular APIs for
generation of real-time imagery. Real-time means that image generation
occurs in 'real time', or 'on the fly', and may be highly
user-interactive. Many modern graphics cards provide some degree of Game
Programming – Penn Wu</p>
<p>299</p>
<p><span id="index_split_015.html#p300"></span>hardware acceleration
based on these APIs, frequently enabling display of complex 3D</p>
<p>graphics in real-time.</p>
<p>Review Questions</p>
<p>8. Which graphics formats permit transparent backgrounds?</p>
<p>A. .jpg</p>
<p>B. .wma</p>
<p>C. .png</p>
<p>D. .bmp</p>
<p>9. To allow an image to blends wells with the background of a given
area, you need to make sure the image file is __.</p>
<p>A. intangible</p>
<p>B. impermeable</p>
<p>C. transparent</p>
<p>D. invisible</p>
<p>10. Which is not a common dimension of a 3D object?</p>
<p>A. width</p>
<p>B. height</p>
<p>C. depth</p>
<p>D. breadth</p>
<p>Game Programming – Penn Wu</p>
<p>300</p>
<p><span id="index_split_015.html#p301"></span><img
src="index-301_1.png" class="calibre5" alt="Image 255" /></p>
<p><img src="index-301_2.png" class="calibre5" alt="Image 256" /></p>
<p><img src="index-301_3.png" class="calibre5" alt="Image 257" /></p>
<p><img src="index-301_4.png" class="calibre5" alt="Image 258" /></p>
<p>Lab #15</p>
<p>Game Graphics</p>
<p><strong></strong></p>
<p><strong>Preparation #1:</strong></p>
<p>3. Create a new directory named <strong>C:\games</strong>.</p>
<p>4. Use Internet Explorer to visit
http://business.cypresscollege.edu/~pwu/cis261/files/lab2.zip and
download the zipped file. Extract the files to C:\games directory. Make
sure the C:\games directory contains:</p>
<p>•</p>
<p>star1.gif</p>
<p>•</p>
<p>star2.gif</p>
<p>•</p>
<p>logo1.gif</p>
<p>•</p>
<p>logo2.gif</p>
<p>•</p>
<p>logo3.gif</p>
<p>5. Use Internet Explorer to visit
http://www.freeserifsoftware.com/software/PhotoPlus/, and download a
copy of PhotoPlus 6 (which is a completely <strong>FREE</strong> image
and photo editing software) to your C:\ drive.</p>
<p>6. Install the PhotoPlus 6 software. An installation tip is available
at
http://www.freeserifsoftware.com/software/PhotoPlus/getting_started.asp.</p>
<p><strong>Learning Activity #1: Using Microsoft Paint to create 2D
image file</strong> 1. Click Start, Programs, Accessories, and then
Paint to open the Microsoft Paint.</p>
<p>2. On the toolbar, click Image, and then Attributes..</p>
<p>3. Set the image width to 300 pixels and height to 300 pixels, as
shown below.</p>
<p>4. Click OK.</p>
<p>5. On the toolbox, click the Line icon.</p>
<p>.</p>
<p>6. Change the color to red.</p>
<p>7. Create a labyrinth. For example,</p>
<p>Game Programming – Penn Wu</p>
<p>301</p>
<p><span id="index_split_015.html#p302"></span><img
src="index-302_1.png" class="calibre5" alt="Image 259" /></p>
<p><img src="index-302_2.png" class="calibre5" alt="Image 260" /></p>
<p><img src="index-302_3.png" class="calibre5" alt="Image 261" /></p>
<p><img src="index-302_4.png" class="calibre5" alt="Image 262" /></p>
<p><img src="index-302_5.png" class="calibre5" alt="Image 263" /></p>
<p>8. Add a background color if you wish. For example,</p>
<p>9. Save the file as <strong>C:\games\lab2_1.gif</strong> for later
use. (You will use this image file in a later lecture.) <strong>Learning
Activity #2: Creating animated Gif file</strong> (using PhotoPlus 6.0 or
your preferred tool) <strong></strong></p>
<p>1. Click Start, (All) Programs, and then Serif PhotoPlus6 to launch
the program.</p>
<p>2. Click the Create New Animation option.</p>
<p>3. Set the Width to be <strong>50</strong>, and Height to be
<strong>50</strong>. Click OK.</p>
<p>4. The screen now looks:</p>
<p>5. Click File, and Open, and then locate the star1.gif file to open
it.</p>
<p>Game Programming – Penn Wu</p>
<p>302</p>
<p><span id="index_split_015.html#p303"></span><img
src="index-303_1.png" class="calibre5" alt="Image 264" /></p>
<p><img src="index-303_2.png" class="calibre5" alt="Image 265" /></p>
<p><img src="index-303_3.png" class="calibre5" alt="Image 266" /></p>
<p><img src="index-303_4.png" class="calibre5" alt="Image 267" /></p>
<p><img src="index-303_5.png" class="calibre5" alt="Image 268" /></p>
<p><img src="index-303_6.png" class="calibre5" alt="Image 269" /></p>
<p>6. Open star2.gif, too.</p>
<p>7. Click on <strong>star1.gif</strong>, click Edit, and then
Copy.</p>
<p>8. Click the <strong>Untitled <em>n</em></strong> <strong></strong>
(where <em>n</em> is a number), click Edit, Paste, and then As New
Layer.</p>
<p>9. The Animation Tab now looks:</p>
<p>10. Right click on the <strong>Frame 1 of 1</strong> picture, as
shown below, and then click New…</p>
<p>11. Click on <strong>star2.gif</strong>, click Edit, and then
Copy.</p>
<p>12. Click the <strong>Untitled <em>n</em></strong> <strong></strong>
(where <em>n</em> is a number), click Edit, Paste, and then As New
Layer.</p>
<p>13. The Animation Tab now looks:</p>
<p>14. Click the</p>
<p>button to test the animation. The star should now rotate.</p>
<p>15. To export the artwork, click File, and the Export....</p>
<p>Game Programming – Penn Wu</p>
<p>303</p>
<p><span id="index_split_015.html#p304"></span><img
src="index-304_1.png" class="calibre5" alt="Image 270" /></p>
<p>16. Save the file as <strong>C:\games\lab2_2.gif</strong>.</p>
<p>Game Programming – Penn Wu</p>
<p>304</p>
<p><span id="index_split_015.html#p305"></span><strong>Misc.
functions</strong></p>
<p>typeof null;</p>
<p>Returns string “object” (or whatever the</p>
<p>thing is).</p>
<p>num.toString(radix);</p>
<p>Returns num var as a string var.</p>
<p>parseInt(“3 blind mice”);</p>
<p>Returns 3.</p>
<p>parseInt(“0xFF”);</p>
<p>Returns 255.</p>
<p>parseInt(“ff”, 16);</p>
<p>Returns 255 also.</p>
<p>parseInt(“eleven”);</p>
<p>Returns NaN.</p>
<p>javascript:alert(“Hi there”);</p>
<p>Execute JS as a URL.</p>
<p>eval(“3 + 12”);</p>
<p>Evaluates a text string as code.</p>
<p>escape(str);</p>
<p>Returns str in web-compliant form. E.g.</p>
<p>“hi ho” = “hi%20ho”.</p>
<p>unescape(str);</p>
<p>Returns str from web-compliant form.</p>
<p>Undoes escape().</p>
<p><strong>Window functions</strong></p>
<p>alert(“Are you sure about that?”);</p>
<p>Prompts with OK box.</p>
<p>confirm(“Continue loading page?”);</p>
<p>Prompts with OK / CANCEL message</p>
<p>box.</p>
<p>prompt(“Enter your name, please.”);</p>
<p>Prompts with text box.</p>
<p>close();</p>
<p>Close the window.</p>
<p>find(), home(), print(), stop();</p>
<p>Duplicates of buttons. Not in IE4.</p>
<p>focus(), blur();</p>
<p>Cause us focus, or lose focus. Not in</p>
<p>IE3.</p>
<p>moveBy(), moveTo();</p>
<p>Move the window.</p>
<p>resizeBy(), resizeTo();</p>
<p>Resize the window.</p>
<p>scrollBy(), scrollTo();</p>
<p>Scroll the document displayed in the</p>
<p>window.</p>
<p>var intervalID = setInterval(“bounce()”, 10000);</p>
<p>Set func to be repeatedly called w/</p>
<p>delay. Call OUT of func.</p>
<p>clearInterval(intervalID);</p>
<p>Cancel function to be repeatedly</p>
<p>invoked with delay.</p>
<p>setTimeout(“display_time()”, 10000);</p>
<p>Call display_time() in 1 sec. Put in</p>
<p>display_time() to loop.</p>
<p>clearTimeout();</p>
<p>Cancel function invoked <em>once</em> after</p>
<p>delay.</p>
<p>var w = window.open(“smallwin.html”, “SmallWin”,</p>
<p>Opens another window, loading</p>
<p>smallwin.html, with name</p>
<p>“width=400,height=300,status,resizeable,menubar”);</p>
<p>SmallWin, and given dimensions.</p>
<p><strong>Window properties</strong></p>
<p>closed</p>
<p>Returns true if window has been closed</p>
<p>(useful for open()).</p>
<p>defaultStatus, status</p>
<p>Sets default status line, current status</p>
<p>line (in status bar).</p>
<p>document</p>
<p>Refers to the current document object</p>
<p>(the HTML page).</p>
<p>frames[]</p>
<p>Refers to frames, if any.</p>
<p>history</p>
<p>A reference to the history object,</p>
<p>represents browsing hist.</p>
<p>history.back();</p>
<p>Go back a link.</p>
<p>history.forward();</p>
<p>Go forward a link.</p>
<p>history.go();</p>
<p>Goes to a link, buggy in NS2&amp;3, weird in</p>
<p>IE3 – best avoid.</p>
<p>innerHeight, innerWidth, outerHeight, outerWidth</p>
<p>Inner and outer dimensions of the</p>
<p>window; not in IE4.</p>
<p>locationbar, menubar, personalbar, scrollbars, statusbar, toolbar
References to visibility of parts. Not in</p>
<p>IE4.</p>
<p>name</p>
<p>Name of current window. Useful for &lt;A</p>
<p>TARGET&gt;, for ex.</p>
<p>opener</p>
<p>Reference to Window opened this, or</p>
<p>null if opened by user.</p>
<p><strong>Document functions</strong></p>
<p>document.write(“&lt;h2&gt;Table of Factorials&lt;/h2&gt;”);</p>
<p>Outputs to current doc, writes HTML.</p>
<p>document.writeln(“Hi there.”);</p>
<p>Outputs with a &lt;CR&gt; appended at end.</p>
<p>document.forms[i].elements[j++];</p>
<p>Access forms and form elements via</p>
<p>array scripting.</p>
<p>Game Programming – Penn Wu</p>
<p>305</p>
<p><span id="index_split_015.html#p306"></span>document.close();</p>
<p>Closes this window-if opened by JS, in</p>
<p>later browsers.</p>
<p><strong>Document properties</strong></p>
<p>document.location</p>
<p>Represents URL document displayed.</p>
<p>Set to load new doc.</p>
<p>document.forms[0], document.myform</p>
<p>Refer to document forms.</p>
<p>document.alinkColor</p>
<p>Color of hyperlink while clicked on</p>
<p>(same as &lt;BODY&gt; tag).</p>
<p>document.anchors[]</p>
<p>Hyperlink array.</p>
<p>document.applets[]</p>
<p>Applet array.</p>
<p>document.bgColor = “#040404”;</p>
<p>Background color of document.</p>
<p>document.cookie</p>
<p>Allows JS to read / write cookies. == “” if</p>
<p>not set.</p>
<p>document.embeds[]</p>
<p>Embedded array.</p>
<p>document.fgColor = “blue”;</p>
<p>Text color of document (same as</p>
<p>&lt;BODY&gt; tag).</p>
<p>document.images[]</p>
<p>Images array.</p>
<p>document.lastModified</p>
<p>Returns string of the date we were last</p>
<p>modified.</p>
<p>document.linkColor</p>
<p>Color of unclicked links. Same as LINK</p>
<p>attr. in &lt;BODY&gt;.</p>
<p>document.links[]</p>
<p>Links array.</p>
<p>document.referrer</p>
<p>URL of doc that ref’d us, if any.</p>
<p>document.title</p>
<p>The title (&lt;TITLE&gt;) of this document.</p>
<p>document.URL</p>
<p>URL we were loaded from, same as</p>
<p>location.href.</p>
<p>document.vlinkColor</p>
<p>Visited link color. Same as VLINK in</p>
<p>&lt;BODY&gt;.</p>
<p>document.domain</p>
<p>Returns the name of the domain you’re</p>
<p>currently at.</p>
<p>Game Programming – Penn Wu</p>
<p>306</p>
<p><span id="index_split_015.html#p307"></span></p>
<p><strong>Navigator properties</strong></p>
<p>navigator.appName</p>
<p>The simple name of the web browser.</p>
<p>navigator.appVersion</p>
<p>The version number and/or other</p>
<p>version info about browser.</p>
<p>navigator.userAgent</p>
<p>appName and appVersion combined,</p>
<p>usually.</p>
<p>navigator.appCodeName</p>
<p>The code name of the browser. E.g.,</p>
<p>“Mozilla.”</p>
<p>navigator.platform</p>
<p>Platform they’re running on as of JS1.2.</p>
<p>navigator.language</p>
<p>Language of browser. “en” (English).</p>
<p>NS4+, not IE.</p>
<p>navigator.userLanguage, navigator.systemLanguage</p>
<p>IE4+ version of navigator.language</p>
<p>property.</p>
<p>navigator.javaEnabled()</p>
<p>Returns true if Java supported and</p>
<p>enabled on this browser.</p>
<p><strong>Math functions</strong></p>
<p>Math.round(x/15);</p>
<p>Rounds to the nearest integer.</p>
<p>Math.pow(x,y);</p>
<p>Returns xy.</p>
<p>Math.sqrt(x*x + y*y);</p>
<p>Returns sqare root of argument.</p>
<p>Math.random();</p>
<p>Returns random between 0.0 – 0.1.</p>
<p>Math.max(i, j);</p>
<p>Returns greater of two numbers.</p>
<p>Math.min(i, j);</p>
<p>Returns lesser of two numbers.</p>
<p>Math.floor(j);</p>
<p>Rounds j down.</p>
<p>Math.ceil(j);</p>
<p>Rounds j up.</p>
<p><strong>String functions</strong></p>
<p>str.length;</p>
<p>Returns a string’s character length.</p>
<p>str.charAt(str.length - 1);</p>
<p>Returns the last character of a string.</p>
<p>SEE NOTES BELOW.</p>
<p>str.substring(1, 4);</p>
<p>Returns str[1] through str[3].</p>
<p>str.indexOf(‘a’), str.lastIndexOf(“ “);</p>
<p>Returns position of first “a” / last “ “ in</p>
<p>string str, -1 if none.</p>
<p>str.anchor(name), str.big(), str.blink(), str.bold(), str.fixed(),
str.italics(), str.link(href); Return str with certain formatting</p>
<p>imposed upon it.</p>
<p>str.small(), str.strike(), str.sub(), str.sup()</p>
<p>anchor=&lt;A NAME=name&gt;, link=&lt;A</p>
<p>HREF&gt;, rest obvious.</p>
<p>str.fontcolor(“#090909”), str.fontsize(1-7 | “+2”);</p>
<p>Set the string’s font color / size.</p>
<p>str.match(), str.replace(), str.search();</p>
<p>Regexp / string match / replace</p>
<p>functions.</p>
<p>str.slice(2[, 6]);</p>
<p>Returns str[2] through str[5], neg. args</p>
<p>start from end.</p>
<p>str = “1,2,3,4,5”; arr = str.split(“,”);</p>
<p>Returns array of substrings, split by</p>
<p>delimiter “,”.</p>
<p>str.substr(5,2);</p>
<p>Returns str[5] through str[5+2].</p>
<p>str.toUpperCase(), str.toLowerCase();</p>
<p>Convert a string’s case.</p>
<p><strong>Vital notes</strong></p>
<p>• · <strong>Semi-colons</strong> are optional, but
<strong>recommended</strong>.</p>
<p>• · JavaScript is <strong>case-sensitive</strong>; HTML embedded
names (such as onClick) are <strong>not</strong>.</p>
<p>• · Always declare variables with <strong>var</strong>. Variables not
declared with var are global automatically. Keep vars declared on top
for clarity. Ex: var ind = 0;</p>
<p>• · Fun with strings: <strong>“Hi there”</strong> and <strong>‘Hi
there’</strong> are both legal string definitions.</p>
<p>• · <strong>Octal</strong> number definitions begin with a 0.
<strong>Hex</strong> begins with 0x (or 0X). Ex: 026, 0xAF, 0377,
0xff...</p>
<p>• · JavaScript represents all numbers as floating point.
<strong>Numbers can be extremely large</strong>, like: -999 tril
&lt;-&gt; +999 tril.</p>
<p>• · <strong>String indexing</strong>, like str[str.length - 1], is
supported by Nav4+, not IE4 though (IE5?).</p>
<p>• · <strong>null</strong> is a special value in JS. It is
<strong>not</strong> equivelant to 0. It represents the lack of an
object, number, string, etc. Sometimes, converted to 0, though.</p>
<p>• · <strong>Functions</strong> can be <strong>nested</strong> since
JS1.2.</p>
<p>• · <strong>undefined</strong> can be tested for by making an
uninitialized variable: var undefined; if (myform[“checkbox” + ind] ==
undefined) …</p>
<p><strong>Useful code tidbits</strong></p>
<p>Game Programming – Penn Wu</p>
<p>307</p>
<p><span id="index_split_015.html#p308"></span>&lt;input type = “button”
... onClick = “alert(‘You clicked me!’)”&gt; When user clicks button,
execute</p>
<p>“onClick” portion.</p>
<p>var square = new Function(“x”, “return x*x;”);</p>
<p>Function literal – variable holds function</p>
<p>definition.</p>
<p>var square = function(x) { return x*x; }</p>
<p>Function literal. square(144) would</p>
<p>execute it.</p>
<p>image.width &lt;-&gt; image[“width”]</p>
<p>Two ways to access object properties.</p>
<p>var pattern = new RegExp(“\bjava\b”, “i”);</p>
<p>Creates RegExp object (regular-</p>
<p>expression).</p>
<p>var o = new Object();</p>
<p>Makes a general object... you can make</p>
<p>up properties.</p>
<p>var point = { x:2.3, y:-1.2 };</p>
<p>Object literal – general object with init’d</p>
<p>properties.</p>
<p>var sq = { upleft: { x:point.x, y:point.y }, lowright: {
x:(point.x+side), y:(point.y+side) }}; Object literal, with sq.upleft.x
== point.x,</p>
<p>for example.</p>
<p>document.images[i].width;</p>
<p>Way to access images as array of</p>
<p>document object.</p>
<p>var a = new Array(); a[0] = 1.2; a[1] = “JavaScript”; a[2] = true;
a[3] = { x:1, y:3 }; Creates an array. Once made, indexed</p>
<p>elems. added easy.</p>
<p>var a = [1.2, “JavaScript”, true, { x:1, y:3 }];</p>
<p>Alternate way since JS1.2.</p>
<p>var matrix = [[1,2,3], [4,5,6], [7,8,9]];</p>
<p>Nested array definition.</p>
<p>var sparseArray = [1,,,,5];</p>
<p>Makes array with some undefined</p>
<p>elements.</p>
<p>for (var i in obj);</p>
<p>The for/in loop loops through the</p>
<p>properties of an object.</p>
<p>Circle.prototype.pi = 3.14159;</p>
<p>Sets a pi val for all Circle objects.</p>
<p>&lt;body bgcolor = “&amp;{favorite_color();};”&gt;</p>
<p>&amp;{ JS-statements; }; used in NS3+, !IE4,</p>
<p>embed JS in HTML.</p>
<p><strong>Notable constants</strong></p>
<p>Number.MAX_VALUE</p>
<p>Largest representable number.</p>
<p>Number.MIN_VALUE</p>
<p>Most negative representable number.</p>
<p>Number.NaN</p>
<p>Special Not-a-number value.</p>
<p>Number.POSITIVE_INFINITY</p>
<p>Special value to represent infinity</p>
<p>Number.NEGATIVE_INFINITY</p>
<p>Special value to represent negative</p>
<p>infinity.</p>
<p>Game Programming – Penn Wu</p>
<p>308</p>
<p><span id="index_split_015.html#p309"></span></p>
<p><strong>Object-based browser detection</strong></p>
<p>Document object</p>
<p>Browser that supports it</p>
<p>document.images</p>
<p>NS3+, IE4+</p>
<p>!document.images</p>
<p>NS2, IE3</p>
<p>document.layers</p>
<p>NS4+</p>
<p>document.all</p>
<p>IE4+</p>
<p>document.layers || document.all</p>
<p>NS4+, IE4+</p>
<p>if (document.images) document.images[0].src = “/images/myimg1.jpg”;
Example usage of browser object</p>
<p>detection.</p>
<p><strong>Useful events</strong></p>
<p>Handler</p>
<p>Triggered when</p>
<p>Supported by</p>
<p>OnAbort</p>
<p>Loading interrupted.</p>
<p>Image</p>
<p>OnBlur</p>
<p>Element loses input focus.</p>
<p>Text elms., Window, all other elms.</p>
<p>OnChange</p>
<p>User changes an elm., moves on.</p>
<p>Select, text input elements</p>
<p>OnClick</p>
<p>User single-click. Ret. false = cancel.</p>
<p>Link, button elements</p>
<p>OnError</p>
<p>Error occurs while loading an image.</p>
<p>Image</p>
<p>OnFocus</p>
<p>Element given input focus.</p>
<p>Text elms., Window, all other elms.</p>
<p>OnLoad</p>
<p>Document or image finishes loading.</p>
<p>Window, Image</p>
<p>OnMouseOut</p>
<p>Mouse moves off element.</p>
<p>Link</p>
<p>OnMouseOver</p>
<p>Mouse moves over elm.</p>
<p>Link</p>
<p>OnReset</p>
<p>Form reset request, false = no reset.</p>
<p>Form</p>
<p>OnSubmit</p>
<p>Form submit, false = no submit.</p>
<p>Form</p>
<p>OnUnload</p>
<p>Document is unloaded.</p>
<p>Window</p>
<p><strong>Cookie stuff</strong></p>
<p>document.cookie = “version=” + escape(document.lastModified) +</p>
<p>Sets persistent cookie. escape()</p>
<p>converts to web form,</p>
<p>“; path=/; expires=” + mydate.toGMTString();</p>
<p>unescape() undoes from web form.</p>
<p>javascript:alert(document.cookie)</p>
<p>Type this in your browser to see the</p>
<p>cookie set for site!</p>
<p>document.cookie = “Name=Joe Bob; path=/”;</p>
<p>Minimal cookie setting.</p>
<p><strong>Variable arguments</strong></p>
<p>function add_all_together() {</p>
<p>The <strong>arguments</strong> method stores the</p>
<p>arguments</p>
<p>for (i = 0; i &lt; add_all_together.arguments.length; i++)</p>
<p>themselves, and the number of</p>
<p>arguments</p>
<p>total += add_all_together.arguments[i];</p>
<p>passed to each function, as we</p>
<p>demonstrate</p>
<p>}</p>
<p>here.</p>
<p><strong>Pre-load and update images</strong></p>
<p>myimg1 = new Image();</p>
<p>Make a new image object,</p>
<p>myimg1.src = “/images/image01.jpg”;</p>
<p>set the image src to preload it.</p>
<p>function imgfilter(imgobj, newimg) {</p>
<p>if (document.images)</p>
<p>If the browser supports the</p>
<p>document.images method,</p>
<p>document.images[imgobj] = newimg.src;</p>
<p>set a new src for the imgobj image</p>
<p>object argument.</p>
<p>}</p>
<p><strong>Date stuff</strong></p>
<p>var now = new Date();</p>
<p>Date obj representing current date and</p>
<p>time.</p>
<p>var xmas = new Date(97, 11, 25);</p>
<p>Date obj for 25-Dec-97, note months</p>
<p>index from 0!</p>
<p>now.toLocaleString();</p>
<p>Returns string of date and time.</p>
<p>xmas.toGMTString();</p>
<p>Returns string of date and time in GMT</p>
<p>time.</p>
<p><strong>Creating a Plain-Text Document</strong></p>
<p>var w = window.open(“”, “console”,
“width=600,height=300,resizeable”); We specify the optional
[window.]open</p>
<p>because there’s</p>
<p>Game Programming – Penn Wu</p>
<p>309</p>
<p><span
id="index_split_015.html#p310"></span>w.document.open(“text/plain”);</p>
<p>a document.open() function too.</p>
<p>w.document.writeln(msg);</p>
<p><strong>To insure a child window you want to update is still
open</strong></p>
<p>This will close the window declared</p>
<p>above if it’s still open,</p>
<p>if (!w.closed) w.close();</p>
<p>only if that window hasn’t been closed</p>
<p>by the user.</p>
<p><strong>To generate a random number between X and Y</strong></p>
<p>function generate( lbound, ubound ) {</p>
<p>return Math.floor( ( ubound - lbound + 1 ) * Math.random() + lbound
);</p>
<p>}</p>
<p>// This one I got somewhere. It doesn’t work. It returns only odd
numbers, and goes 1 beyond the set range sometimes???</p>
<p>function generate( x, y ) {</p>
<p>var range = y-x+1;</p>
<p>var i = ( "" + range ).length;</p>
<p>var num = ( Math.floor( Math.random() * Math.pow( 10, I ) ) % range )
+</p>
<p>parseInt( x );</p>
<p>return num;</p>
<p>}</p>
<p><strong>Detecting Shockwave</strong></p>
<p>&lt;SCRIPT LANGUAGE="JavaScript"&gt;</p>
<p>&lt;!—hiding contents of script from old browsers, just in case</p>
<p>//If this browser understands the mimeTypes property and recognizes
the MIME Type //"application/futuresplash"...</p>
<p>if (navigator.mimeTypes &amp;&amp;
navigator.mimeTypes["application/x-shockwave-flash"]){</p>
<p>//...write out the following &lt;EMBED&gt; tag into the document.</p>
<p>document.write('&lt;EMBED SRC="flash_movie.swf" WIDTH="220"
HEIGHT="110" LOOP="true" QUALITY="high"&gt;');</p>
<p>}</p>
<p>//Otherwise,...</p>
<p>else {</p>
<p>//...write out the following &lt;IMG&gt; tag into the document. The
image need</p>
<p>//not be the same size as the Flash movie, but it may help you lay
out the</p>
<p>/page if you can predict the size of the object reliably.</p>
<p>document.write('&lt;IMG SRC="welcome.gif" WIDTH="220" HEIGHT="110"
ALT="Non-Shockwave Welcome"&gt;');</p>
<p>}</p>
<p>//Done hiding from old browsers. --&gt;</p>
<p>&lt;/SCRIPT&gt;</p>
<p><strong>Using JS to Write to Frames</strong></p>
<p>Just give the frames names, then access them by name:</p>
<p>&lt;frameset cols="*,*"&gt;</p>
<p>&lt;frame name=left src="a.html"&gt;</p>
<p>&lt;frame name=right src="b.html"&gt;</p>
<p>&lt;/frameset&gt;</p>
<p>top . right . document . open ();</p>
<p>top . right . document . writeln ("Hello.");</p>
<p>top . right . document . close ();</p>
<p>top.document.location = “newpage.htm”;</p>
<p>Breaks from frames, goes to new page.</p>
<p>Game Programming – Penn Wu</p>
<p>310</p>
<p><span id="index_split_015.html#p311"></span></p>
<p>1</p>
<p>2</p>
<p>3</p>
<p>4</p>
<p>5</p>
<p>6</p>
<p>7</p>
<p>8</p>
<p>9</p>
<p>10</p>
<p>11</p>
<p>12</p>
<p>13</p>
<p>14</p>
<p>1</p>
<p>D</p>
<p>D</p>
<p>D</p>
<p>C</p>
<p>B</p>
<p>C</p>
<p>D</p>
<p>2</p>
<p>B</p>
<p>B</p>
<p>B</p>
<p>D</p>
<p>B</p>
<p>A</p>
<p>B</p>
<p>3</p>
<p>B</p>
<p>B</p>
<p>C</p>
<p>C</p>
<p>B</p>
<p>D</p>
<p>D</p>
<p>4</p>
<p>C</p>
<p>B</p>
<p>A</p>
<p>A</p>
<p>A</p>
<p>B</p>
<p>B</p>
<p>5</p>
<p>B</p>
<p>C</p>
<p>B</p>
<p>A</p>
<p>B</p>
<p>A</p>
<p>A</p>
<p>6</p>
<p>A</p>
<p>A</p>
<p>A</p>
<p>D</p>
<p>A</p>
<p>A</p>
<p>B</p>
<p>7</p>
<p>A</p>
<p>A</p>
<p>D</p>
<p>B</p>
<p>C</p>
<p>A</p>
<p>C</p>
<p>8</p>
<p>C</p>
<p>A</p>
<p>D</p>
<p>D</p>
<p>D</p>
<p>D</p>
<p>C</p>
<p>9</p>
<p>D</p>
<p>B</p>
<p>B</p>
<p>A</p>
<p>B</p>
<p>D</p>
<p>C</p>
<p>10</p>
<p>D</p>
<p>C</p>
<p>A</p>
<p>A</p>
<p>A</p>
<p>A</p>
<p>D</p>
<p>Game Programming – Penn Wu</p>
<p>311</p>
<p><span id="index_split_015.html#p312"></span></p>
<p>Game Programming – Penn Wu</p>
<p>312</p>
</body>
</html>
